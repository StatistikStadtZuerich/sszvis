{"version":3,"file":"image.js","sources":["../../../src/map/renderer/image.js"],"sourcesContent":["/**\n * image render component\n *\n * @module  sszvis/map/renderer/image\n *\n * Used for rendering an image layer, usually as a complement to a map. This is used in examples\n * for the topographic layer. It could also be used in other contexts, but the map usage is\n * the most straightforward.\n *\n * @property {Function} projection      The map projection function used to position the image in pixels. Uses the upper left\n *                                      and lower right corners of the image as geographical place markers to align with other map layers.\n * @property {String} src               The source of the image you want to use. This should be ither a URL for an image hosted on the same\n *                                      server that hosts the page, or a base64-encoded dataURL. For example, the zurich topolayer map module.\n * @property {Array} geoBounds          This should be a 2D array containing the upper-left (north-west) and lower-right (south-east)\n *                                      coordinates of the corresponding corners of the image. The structure expected is:\n *\n *                                      [[nw-longitude, nw-latitude], [se-longitude, se-latitude]]\n *\n *                                      This is consistent with the way D3 handles similar geographic data. These coordinates are used to represent\n *                                      the edge of the image being used, and to align the image with other map layers (using the projection function).\n *                                      Note: it is possible that even with precise corner coordinates, some mismatch may still occur. This\n *                                      will happen if the image itself is generated using a different type of map projection than the one used by the\n *                                      projection function. SSZVIS uses a Mercator projection by default, but others from d3.geo can be used if desired.\n * @property {Number} opacity           The opacity of the resulting image layer. This will be applied to the entire image, and is sometimes useful when layering.\n *\n * @return {sszvis.component}\n */\n\nimport { select } from \"d3\";\nimport { component } from \"../../d3-component.js\";\n\nexport default function () {\n  return component()\n    .prop(\"projection\")\n    .prop(\"src\")\n    .prop(\"geoBounds\")\n    .prop(\"opacity\")\n    .opacity(1)\n    .render(function () {\n      const selection = select(this);\n      const props = selection.props();\n\n      const image = selection\n        .selectAll(\".sszvis-map__image\")\n        .data([0]) // At the moment, 1 image per container\n        .join(\"img\")\n        .classed(\"sszvis-map__image\", true);\n\n      const topLeft = props.projection(props.geoBounds[0]);\n      const bottomRight = props.projection(props.geoBounds[1]);\n\n      image\n        .attr(\"src\", props.src)\n        .style(\"left\", Math.round(topLeft[0]) + \"px\")\n        .style(\"top\", Math.round(topLeft[1]) + \"px\")\n        .style(\"width\", Math.round(bottomRight[0] - topLeft[0]) + \"px\")\n        .style(\"height\", Math.round(bottomRight[1] - topLeft[1]) + \"px\")\n        .style(\"opacity\", props.opacity);\n    });\n}\n"],"names":["component","prop","opacity","render","selection","select","props","image","selectAll","data","join","classed","topLeft","projection","geoBounds","bottomRight","attr","src","style","Math","round"],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAKe,cAAY,IAAA;AACzB,EAAA,OAAOA,SAAS,EAAE,CACfC,IAAI,CAAC,YAAY,CAAC,CAClBA,IAAI,CAAC,KAAK,CAAC,CACXA,IAAI,CAAC,WAAW,CAAC,CACjBA,IAAI,CAAC,SAAS,CAAC,CACfC,OAAO,CAAC,CAAC,CAAC,CACVC,MAAM,CAAC,YAAY;AAClB,IAAA,MAAMC,SAAS,GAAGC,MAAM,CAAC,IAAI,CAAC;AAC9B,IAAA,MAAMC,KAAK,GAAGF,SAAS,CAACE,KAAK,EAAE;AAE/B,IAAA,MAAMC,KAAK,GAAGH,SAAS,CACpBI,SAAS,CAAC,oBAAoB,CAAC,CAC/BC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;KACTC,IAAI,CAAC,KAAK,CAAC,CACXC,OAAO,CAAC,mBAAmB,EAAE,IAAI,CAAC;AAErC,IAAA,MAAMC,OAAO,GAAGN,KAAK,CAACO,UAAU,CAACP,KAAK,CAACQ,SAAS,CAAC,CAAC,CAAC,CAAC;AACpD,IAAA,MAAMC,WAAW,GAAGT,KAAK,CAACO,UAAU,CAACP,KAAK,CAACQ,SAAS,CAAC,CAAC,CAAC,CAAC;IAExDP,KAAK,CACFS,IAAI,CAAC,KAAK,EAAEV,KAAK,CAACW,GAAG,CAAC,CACtBC,KAAK,CAAC,MAAM,EAAEC,IAAI,CAACC,KAAK,CAACR,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAC5CM,KAAK,CAAC,KAAK,EAAEC,IAAI,CAACC,KAAK,CAACR,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAC3CM,KAAK,CAAC,OAAO,EAAEC,IAAI,CAACC,KAAK,CAACL,WAAW,CAAC,CAAC,CAAC,GAAGH,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAC9DM,KAAK,CAAC,QAAQ,EAAEC,IAAI,CAACC,KAAK,CAACL,WAAW,CAAC,CAAC,CAAC,GAAGH,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAC/DM,KAAK,CAAC,SAAS,EAAEZ,KAAK,CAACJ,OAAO,CAAC;AACpC,GAAC,CAAC;AACN;;;;"}