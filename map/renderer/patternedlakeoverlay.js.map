{"version":3,"file":"patternedlakeoverlay.js","sources":["../../../src/map/renderer/patternedlakeoverlay.js"],"sourcesContent":["/**\n * patternedlakeoverlay component\n *\n * @module sszvis/map/renderer/patternedlakeoverlay\n *\n * A component used internally for rendering Lake Zurich, and the borders of map entities which\n * lie above Lake Zurich.\n *\n * @property {d3.geo.path} mapPath      A path-generator function used to create the path data string of the provided GeoJson.\n * @property {GeoJson} lakeFeature      A GeoJson object which provides data for the outline shape of Lake Zurich. This shape will\n *                                      be filled with a special texture fill and masked with an alpha gradient fade.\n * @property {GeoJson} lakeBounds       A GeoJson object which provides data for the shape of map entity borders which lie over the\n *                                      lake. These borders will be drawn over the lake shape, as grey dotted lines.\n *\n * @return {sszvis.component}\n */\n\nimport { select } from \"d3\";\n\nimport ensureDefsElement from \"../../svgUtils/ensureDefsElement.js\";\nimport { mapLakePattern, mapLakeFadeGradient, mapLakeGradientMask } from \"../../patterns.js\";\nimport { component } from \"../../d3-component.js\";\n\nexport default function () {\n  return component()\n    .prop(\"mapPath\")\n    .prop(\"lakeFeature\")\n    .prop(\"lakeBounds\")\n    .prop(\"lakePathColor\")\n    .prop(\"fadeOut\")\n    .fadeOut(true)\n    .render(function () {\n      const selection = select(this);\n      const props = selection.props();\n\n      // the lake texture\n      ensureDefsElement(selection, \"pattern\", \"lake-pattern\").call(mapLakePattern);\n\n      if (props.fadeOut) {\n        // the fade gradient\n        ensureDefsElement(selection, \"linearGradient\", \"lake-fade-gradient\").call(\n          mapLakeFadeGradient\n        );\n\n        // the mask, which uses the fade gradient\n        ensureDefsElement(selection, \"mask\", \"lake-fade-mask\").call(mapLakeGradientMask);\n      }\n\n      // generate the Lake Zurich path\n      const zurichSee = selection\n        .selectAll(\".sszvis-map__lakezurich\")\n        .data([props.lakeFeature])\n        .join(\"path\")\n        .classed(\"sszvis-map__lakezurich\", true)\n        .attr(\"d\", props.mapPath)\n        .attr(\"fill\", \"url(#lake-pattern)\");\n\n      if (props.fadeOut) {\n        // this mask applies the fade effect\n        zurichSee.attr(\"mask\", \"url(#lake-fade-mask)\");\n      }\n\n      // add a path for the boundaries of map entities which extend over the lake.\n      // This path is rendered as a dotted line over the lake shape\n      const lakePath = selection\n        .selectAll(\".sszvis-map__lakepath\")\n        .data([props.lakeBounds])\n        .join(\"path\")\n        .classed(\"sszvis-map__lakepath\", true)\n        .attr(\"d\", props.mapPath);\n\n      if (props.lakePathColor) {\n        lakePath.style(\"stroke\", props.lakePathColor);\n      }\n    });\n}\n"],"names":["component","prop","fadeOut","render","selection","select","props","ensureDefsElement","call","mapLakePattern","mapLakeFadeGradient","mapLakeGradientMask","zurichSee","selectAll","data","lakeFeature","join","classed","attr","mapPath","lakePath","lakeBounds","lakePathColor","style"],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAQe,wCAAY,IAAA;AACzB,EAAA,OAAOA,SAAS,EAAE,CACfC,IAAI,CAAC,SAAS,CAAC,CACfA,IAAI,CAAC,aAAa,CAAC,CACnBA,IAAI,CAAC,YAAY,CAAC,CAClBA,IAAI,CAAC,eAAe,CAAC,CACrBA,IAAI,CAAC,SAAS,CAAC,CACfC,OAAO,CAAC,IAAI,CAAC,CACbC,MAAM,CAAC,YAAY;AAClB,IAAA,MAAMC,SAAS,GAAGC,MAAM,CAAC,IAAI,CAAC;AAC9B,IAAA,MAAMC,KAAK,GAAGF,SAAS,CAACE,KAAK,EAAE;;AAE/B;IACAC,iBAAiB,CAACH,SAAS,EAAE,SAAS,EAAE,cAAc,CAAC,CAACI,IAAI,CAACC,cAAc,CAAC;IAE5E,IAAIH,KAAK,CAACJ,OAAO,EAAE;AACjB;MACAK,iBAAiB,CAACH,SAAS,EAAE,gBAAgB,EAAE,oBAAoB,CAAC,CAACI,IAAI,CACvEE,mBACF,CAAC;;AAED;MACAH,iBAAiB,CAACH,SAAS,EAAE,MAAM,EAAE,gBAAgB,CAAC,CAACI,IAAI,CAACG,mBAAmB,CAAC;AAClF;;AAEA;IACA,MAAMC,SAAS,GAAGR,SAAS,CACxBS,SAAS,CAAC,yBAAyB,CAAC,CACpCC,IAAI,CAAC,CAACR,KAAK,CAACS,WAAW,CAAC,CAAC,CACzBC,IAAI,CAAC,MAAM,CAAC,CACZC,OAAO,CAAC,wBAAwB,EAAE,IAAI,CAAC,CACvCC,IAAI,CAAC,GAAG,EAAEZ,KAAK,CAACa,OAAO,CAAC,CACxBD,IAAI,CAAC,MAAM,EAAE,oBAAoB,CAAC;IAErC,IAAIZ,KAAK,CAACJ,OAAO,EAAE;AACjB;AACAU,MAAAA,SAAS,CAACM,IAAI,CAAC,MAAM,EAAE,sBAAsB,CAAC;AAChD;;AAEA;AACA;AACA,IAAA,MAAME,QAAQ,GAAGhB,SAAS,CACvBS,SAAS,CAAC,uBAAuB,CAAC,CAClCC,IAAI,CAAC,CAACR,KAAK,CAACe,UAAU,CAAC,CAAC,CACxBL,IAAI,CAAC,MAAM,CAAC,CACZC,OAAO,CAAC,sBAAsB,EAAE,IAAI,CAAC,CACrCC,IAAI,CAAC,GAAG,EAAEZ,KAAK,CAACa,OAAO,CAAC;IAE3B,IAAIb,KAAK,CAACgB,aAAa,EAAE;MACvBF,QAAQ,CAACG,KAAK,CAAC,QAAQ,EAAEjB,KAAK,CAACgB,aAAa,CAAC;AAC/C;AACF,GAAC,CAAC;AACN;;;;"}