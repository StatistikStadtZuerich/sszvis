{"version":3,"file":"resize.js","sources":["../../src/viewport/resize.js"],"sourcesContent":["/**\n * Viewport Resize watcher\n *\n * The resize watcher in the sszvis.viewport module can be used for alerting user code to\n * changes in the browser window size. This includes window resizing on desktop computers\n * and browsers, but also orientation changes on mobile browsers. Functions which listen\n * to the 'resize' event of the sszvis.viewport module will be fired on window resize.\n * You can add a resize listener to your application very easily:\n *\n * sszvis.viewport.on('resize', listenerFunction);\n *\n * The listener function will be called once per resize event, but at a slight delay. This is because,\n * while a user is resizing their browser window, many resize events can fire very quickly. This component\n * automatically throttles the rate at which the listener function is called, since you probably don't need\n * to respond to every single resize event. This throttling provides for a smoother user experience as they\n * resize the browser, and increases performance across the board. The listener function will always be\n * called after one or more window resize events, it just won't be called as often as the window fires the\n * events.\n *\n * @module sszvis/viewport\n *\n * @function {string, function} on      the .on() function is used to listen to the resize event itself.\n *                                      There is only one event supported by this component at the moment, so\n *                                      the first argument to .on must be 'resize' for it to have any effect.\n *                                      Although this is somewhat redundant, it is done to keep this component's\n *                                      API clear and in line with other components.\n *\n * @return {Object}\n */\n\nimport { select } from \"d3\";\nimport throttle from \"nano-throttle\";\n\n// This rather strange set of functions is designed to support the API:\n// sszvis.viewport.on('resize', callback);\n// While still enabling the user to register multiple callbacks for the 'resize'\n// event. Multiple callbacks are a feature which simply returning a d3.dispatch('resize')\n// object would not allow.\nconst callbacks = {\n  resize: [],\n};\n\nif (globalThis.window !== undefined) {\n  select(globalThis).on(\n    \"resize\",\n    throttle(() => {\n      trigger(\"resize\");\n    }, 500)\n  );\n}\n\nconst on = function (name, cb) {\n  if (!callbacks[name]) {\n    callbacks[name] = [];\n  }\n  callbacks[name] = [...callbacks[name].filter((fn) => fn !== cb), cb];\n  return this;\n};\n\nconst off = function (name, cb) {\n  if (!callbacks[name]) {\n    return this;\n  }\n  callbacks[name] = callbacks[name].filter((fn) => fn !== cb);\n  return this;\n};\n\nconst trigger = function (name) {\n  const evtArgs = Array.prototype.slice.call(arguments, 1);\n  if (callbacks[name]) {\n    for (const fn of callbacks[name]) {\n      fn.apply(null, evtArgs);\n    }\n  }\n  return this;\n};\n\nexport const viewport = { on, off, trigger };\n"],"names":["callbacks","resize","globalThis","window","undefined","select","on","throttle","trigger","name","cb","filter","fn","off","evtArgs","Array","prototype","slice","call","arguments","apply","viewport"],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAKA;AACA;AACA;AACA;AACA;AACA,MAAMA,SAAS,GAAG;AAChBC,EAAAA,MAAM,EAAE;AACV,CAAC;AAED,IAAIC,UAAU,CAACC,MAAM,KAAKC,SAAS,EAAE;EACnCC,MAAM,CAACH,UAAU,CAAC,CAACI,EAAE,CACnB,QAAQ,EACRC,QAAQ,CAAC,MAAM;IACbC,OAAO,CAAC,QAAQ,CAAC;GAClB,EAAE,GAAG,CACR,CAAC;AACH;AAEA,MAAMF,EAAE,GAAG,UAAUG,IAAI,EAAEC,EAAE,EAAE;AAC7B,EAAA,IAAI,CAACV,SAAS,CAACS,IAAI,CAAC,EAAE;AACpBT,IAAAA,SAAS,CAACS,IAAI,CAAC,GAAG,EAAE;AACtB;EACAT,SAAS,CAACS,IAAI,CAAC,GAAG,CAAC,GAAGT,SAAS,CAACS,IAAI,CAAC,CAACE,MAAM,CAAEC,EAAE,IAAKA,EAAE,KAAKF,EAAE,CAAC,EAAEA,EAAE,CAAC;AACpE,EAAA,OAAO,IAAI;AACb,CAAC;AAED,MAAMG,GAAG,GAAG,UAAUJ,IAAI,EAAEC,EAAE,EAAE;AAC9B,EAAA,IAAI,CAACV,SAAS,CAACS,IAAI,CAAC,EAAE;AACpB,IAAA,OAAO,IAAI;AACb;AACAT,EAAAA,SAAS,CAACS,IAAI,CAAC,GAAGT,SAAS,CAACS,IAAI,CAAC,CAACE,MAAM,CAAEC,EAAE,IAAKA,EAAE,KAAKF,EAAE,CAAC;AAC3D,EAAA,OAAO,IAAI;AACb,CAAC;AAED,MAAMF,OAAO,GAAG,UAAUC,IAAI,EAAE;AAC9B,EAAA,MAAMK,OAAO,GAAGC,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAACC,SAAS,EAAE,CAAC,CAAC;AACxD,EAAA,IAAInB,SAAS,CAACS,IAAI,CAAC,EAAE;AACnB,IAAA,KAAK,MAAMG,EAAE,IAAIZ,SAAS,CAACS,IAAI,CAAC,EAAE;AAChCG,MAAAA,EAAE,CAACQ,KAAK,CAAC,IAAI,EAAEN,OAAO,CAAC;AACzB;AACF;AACA,EAAA,OAAO,IAAI;AACb,CAAC;AAEM,MAAMO,QAAQ,GAAG;EAAEf,EAAE;EAAEO,GAAG;AAAEL,EAAAA;AAAQ;;;;"}