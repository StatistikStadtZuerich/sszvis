/*! sszvis v2.0.2, Copyright 2014-present Statistik Stadt Zürich */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],e):e(t.sszvis={},t.d3)}(this,function(t,e){"use strict";function r(t){return(String(Math.abs(t)).split(".")[1]||"").length}function n(t){var e=t[0],r=t[t.length-1];return e<r?[e,r]:[r,e]}function a(t){return function(){console&&console[t]&&i(arguments).forEach(function(e){console[t](e)})}}function i(t){return Array.prototype.slice.call(t)}function o(){function t(t){r&&(t.props=function(){return u(e)},r.apply(t,c(arguments))),t.each(function(){this.__props__=u(e),n.apply(this,c(arguments))})}var e={},r=null,n=l;return t.prop=function(r,n){return n||(n=l),t[r]=s(e,r,n.bind(t)).bind(t),t},t.delegate=function(e,r){return t[e]=function(){var n=r[e].apply(r,c(arguments));return 0===arguments.length?n:t},t},t.renderSelection=function(e){return r=e,t},t.render=function(e){return n=e,t},t}function s(t,e,r){return r||(r=l),function(){return arguments.length?(t[e]=r.apply(null,c(arguments)),this):t[e]}}function l(t){return t}function c(t){return Array.prototype.slice.call(t)}function u(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function p(t,e){return Math.abs(t-e)}function d(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}function f(t,e){var r=y(e);return ut(function(t){return v(t,r)},t)}function h(t,e){return ut(function(t){return t.name===e},t)}function v(t,e){var r=t.measurement,n=y(e);return n.width<=r.width&&n.screenHeight<=r.screenHeight}function g(t,e){var r=y(e);return t.filter(function(t){return v(t,r)})}function m(t){return t.map(x).concat(x({name:"_"}))}function y(t){var e=xt("width",1/0),r=xt("screenHeight",1/0);return{width:e(t),screenHeight:r(t)}}function x(t){var e;return e=y(lt(t.measurement)?t.measurement:{width:t.width,screenHeight:t.screenHeight}),{name:t.name,measurement:e}}function b(t){return function(e){return v(h(Vt(),t),e)}}function k(t,e){var r=t/e;return function(t){return t/r}}function _(t,r){var n=null,a=null;0===arguments.length?n={}:1===arguments.length?ht(t)?n=t:it(t)?(n={},a=t):(n={},a=e.select(t)):(n=t,a=it(r)?r:e.select(r));var i={top:z(n.top,0),right:z(n.right,1),bottom:z(n.bottom,0),left:z(n.left,1)},o=lt(a)?gt(a):{width:ee},s=z(n.width,o.width),l=te(o),c=z(n.height,l+i.top+i.bottom);return{innerHeight:c-i.top-i.bottom,innerWidth:s-i.left-i.right,padding:i,height:c,width:s,screenWidth:o.screenWidth,screenHeight:o.screenHeight}}function z(t,e){return void 0===t?e:t}function A(t){return function(){return M(e.scaleOrdinal().range(t.map(E)))}}function w(t){return function(){return F(e.scaleLinear().range(t.map(E)))}}function S(t){return function(){return F(e.scaleLinear().range(t.map(E)))}}function C(t){return function(){return F(e.scaleOrdinal().range(t.map(E)))}}function M(t){return t.darker=function(){return M(t.copy().range(t.range().map(P("darker",re))))},t.brighter=function(){return M(t.copy().range(t.range().map(P("brighter",re))))},t.reverse=function(){return M(t.copy().range(t.range().reverse()))},t}function F(t){return t=T(t),t.reverse=function(){return F(t.copy().range(t.range().reverse()))},t}function T(t){var r=t.domain;return t.domain=function(t){if(1===arguments.length){var n=[t[0],e.mean(t),t[1]];return r.call(this,n)}return r.apply(this,arguments)},t}function E(t){return e.lab(t)}function P(t){var e=Array.prototype.slice.call(arguments,1);return function(r){return r[t].apply(r,e)}}function R(t,e){if(t.invert)return t.invert(e);var r=t.step(),n=t.paddingOuter()*r,a=t.paddingInner()*r,i=t.bandwidth(),o=t.range(),s=t.domain();if(1===s.length)return o[0]<=e&&o[1]>=e?s[0]:null;for(var l=s.map(function(t,e){return 0===e?[o[0],o[0]+n+i+a/2]:e===s.length-1?[o[1]-(n+i+a/2),o[1]]:[o[0]+n+e*r-a/2,o[0]+n+(e+1)*r-a/2]}),c=0,u=l.length;c<u;c++)if(l[c][0]<e&&e<=l[c][1])return s[c];return null}function L(t,e){var r=t.clientX-e[0],n=t.clientY-e[1];return r*r+n*n<Me}function B(t){var e=t.selectAll("defs").data([0]),r=e.enter().append("defs");return e.merge(r)}function O(){var t=[[]];return{addLine:function(){t.push([])},addWord:function(e,r){vt(t).push({text:_t(r),style:e})},lines:function(){return t}}}function D(t){return function(){function e(e){return t(r,e)}var r=O();return e.newline=function(){return r.addLine(),e},["bold","italic","plain"].forEach(function(t){e[t]=function(n){return r.addWord(t,n),e}}),e}}function N(t,e){for(var r,n,a={},i=0,o=t.length;i<o;++i)a[r=e(n=t[i])]?a[r].push(n):a[r]=[n];return a}function W(t,e){for(var r in t)e(t[r],r)}function H(t,e){for(var r=0,n=t.length;r<n;++r)e(t[r],r)}function G(){function t(r,i){if(i>=n.length)return e&&r.sort(e),r;var o=a[i],s=n[i++],l=N(r,s.func);if("obj"===s.type){var c={};return W(l,function(e,r){c[r]=t(e,i)}),c}if("arr"===s.type){var u=[];return o?H(Object.keys(l).sort(o),function(e){u.push(t(l[e],i))}):W(l,function(e){u.push(t(e,i))}),u}}var e,r={},n=[],a=[];return r.apply=function(e){return t(e,0)},r.objectBy=function(t){return n.push({type:"obj",func:t}),r},r.arrayBy=function(t,e){return n.push({type:"arr",func:t}),e&&(a[n.length-1]=e),r},r.sort=function(t){return e=t,r},r}function I(t,e,r){var n=function(r,a){t.text(r);var i=Math.ceil(t.node().clientWidth);return a<1e3&&i>e?n(r.slice(0,r.length-2)+"…",a+1):r};return n(r,0)}function j(t,e){return e.indexOf(t)>=0}function J(t,e,r){return function(n){var a=n.enter().append("circle").classed("sszvis-rangeFlag__mark",!0).classed(t,!0);n.exit().remove(),(n=n.merge(a)).attr("r",3.5).attr("cx",e).attr("cy",r)}}function V(t){return'<table class="sszvis-tooltip__body__table">'+t.map(function(t){return"<tr>"+t.map(function(t){return"<td>"+t+"</td>"}).join("")+"</tr>"}).join("")+"</table>"}function Y(t,e,r,n){function a(t){return t[0]}function i(t){return t[1]}function o(t,e,r,n,a,i,o){var s=r+(a-r)/2,l=n+(i-n)/2,c=["Q",t,e,r,n],u=[];o&&n===i?u=r<a?["L",s-Ie,l,"L",s,l-Ie,"L",s+Ie,l]:["L",s+Ie,l,"L",s,l+Ie,"L",s-Ie,l]:o&&r===a&&(u=n<i?["L",s,l-Ie,"L",s+Ie,l,"L",s,l+Ie]:["L",s,l+Ie,"L",s-Ie,l,"L",s,l-Ie]);var p=["L",a,i];return[].concat(c,u,p)}switch(r){case"top":t[1]=t[1]+Ie;break;case"bottom":e[1]=e[1]-Ie;break;case"left":t[0]=t[0]+Ie;break;case"right":e[0]=e[0]-Ie}return[["M",a(t),i(t)+n],o(a(t),i(t),a(t)+n,i(t),a(e)-n,i(t),"top"===r),o(a(e),i(t),a(e),i(t)+n,a(e),i(e)-n,"right"===r),o(a(e),i(e),a(e)-n,i(e),a(t)+n,i(e),"bottom"===r),o(a(t),i(e),a(t),i(e)-n,a(t),i(t)+n,"left"===r)].map(function(t){return t.join(" ")}).join(" ")}function U(){return void 0!==window.SVGFEColorMatrixElement&&2==SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE}function K(t){return isNaN(t)?0:t}function X(){return o().prop("barPosition").prop("barWidth").prop("mirror").mirror(!1).render(function(t){var r=e.select(this),n=r.props(),a=e.line().x(n.barWidth).y(n.barPosition),i=r.selectAll(".sszvis-pyramid__referenceline").data(t);i.exit().remove();var o=i.enter().append("path").attr("class","sszvis-pyramid__referenceline");(i=i.merge(o)).attr("transform",n.mirror?"scale(-1, 1)":"").transition(Le()).attr("d",a)})}function q(t){return function(r,n,a){return function(i){var o=G().arrayBy(r).objectBy(n).apply(i),s=o.reduce(function(t,e){return bt(t.concat(Object.keys(e)))},[]),l=e.stack().keys(s).value(function(t,e){return a(t[e][0])}).order(t)(o);return l.forEach(function(t){t.forEach(function(e){e.series=t.key,e.data=e.data[t.key][0],e.stack=r(e.data)})}),l.keys=s,l.maxValue=e.max(l,function(t){return e.max(t,function(t){return t[1]})}),l}}}function Q(t){return o().prop("xScale",_t).prop("width",_t).prop("yScale",_t).prop("height",_t).prop("fill").prop("stroke").render(function(r){var n=e.select(this),a=n.props(),i=Je().x(t.x(a)).y(t.y(a)).width(t.width(a)).height(t.height(a)).fill(a.fill).stroke(a.stroke),o=n.selectAll(".sszvis-stack").data(r),s=o.enter().append("g").classed("sszvis-stack",!0);o.exit().remove(),(o=o.merge(s)).call(i)})}function Z(){return o().prop("stackElement").renderSelection(function(t){var r=t.datum(),n=t.props(),a=t.selectAll("[data-sszvis-stack]").data(r),i=a.enter().append("g").attr("data-sszvis-stack","");a.exit().remove(),(a=a.merge(i)).each(function(t){e.select(this).datum(t).call(n.stackElement)})})}function $(){return o().prop("barPosition").prop("barWidth").prop("mirror").mirror(!1).render(function(t){var r=e.select(this),n=r.props(),a=e.line().x(n.barWidth).y(n.barPosition),i=r.selectAll(".sszvis-path").data(t);i.exit().remove();var o=i.enter().append("path").attr("class","sszvis-path").attr("fill","none").attr("stroke","#aaa").attr("stroke-width",2).attr("stroke-dasharray","3 3");(i=i.merge(o)).attr("transform",n.mirror?"scale(-1, 1)":"").transition(Le()).attr("d",a)})}function tt(t){return lt(t)&&lt(t.width)&&lt(t.screenWidth)&&lt(t.screenHeight)}function et(t){return Object.keys(t).reduce(function(e,r){return e[r]=_t(t[r]),e},{})}function rt(t,e){if(!lt(t._))return!1;for(var r in t)if(t.hasOwnProperty(r)&&"_"!==r&&!lt(h(e,r)))return!1;return!0}!function(){if("undefined"!=typeof window){var t=function(e,r){var n=e.nodeType;if(3==n)r.push(e.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"));else if(1==n){if(r.push("<",e.tagName),e.hasAttributes())for(var a=e.attributes,i=0,o=a.length;i<o;++i){var s=a.item(i);r.push(" ",s.name,"='",s.value,"'")}if(e.hasChildNodes()){r.push(">");for(var l=e.childNodes,i=0,o=l.length;i<o;++i)t(l.item(i),r);r.push("</",e.tagName,">")}else r.push("/>")}else{if(8!=n)throw"Error serializing XML. Unhandled node of type: "+n;r.push("\x3c!--",e.nodeValue,"--\x3e")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){for(var e=[],r=this.firstChild;r;)t(r,e),r=r.nextSibling;return e.join("")},set:function(t){for(;this.firstChild;)this.removeChild(this.firstChild);try{var e=new DOMParser;e.async=!1;for(var r="<svg xmlns='http://www.w3.org/2000/svg'>"+t+"</svg>",n=e.parseFromString(r,"text/xml").documentElement.firstChild;n;)this.appendChild(this.ownerDocument.importNode(n,!0)),n=n.nextSibling}catch(t){throw new Error("Error parsing XML string")}}}),Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}})}}(),e.selection.prototype.selectGroup=function(t){var e=this.selectAll('[data-d3-selectgroup="'+t+'"]').data(function(t){return[t]}),r=e.enter().append("g").attr("data-d3-selectgroup",t);return e.merge(r)},e.selection.prototype.selectDiv=function(t){var e=this.selectAll('[data-d3-selectdiv="'+t+'"]').data(function(t){return[t]}),r=e.enter().append("div").attr("data-d3-selectdiv",t).style("position","absolute");return e.merge(r)};var nt=function(t){return t},at=function(t){return"[object String]"===Object.prototype.toString.call(t)},it=function(t){return t instanceof e.selection},ot=function(t,e){switch(t){case 0:return function(){return e.call(this)};case 1:return function(t){return e.call(this,t)};case 2:return function(t,r){return e.call(this,t,r)};case 3:return function(t,r,n){return e.call(this,t,r,n)};case 4:return function(t,r,n,a){return e.call(this,t,r,n,a)};case 5:return function(t,r,n,a,i){return e.call(this,t,r,n,a,i)};case 6:return function(t,r,n,a,i,o){return e.call(this,t,r,n,a,i,o)};case 7:return function(t,r,n,a,i,o,s){return e.call(this,t,r,n,a,i,o,s)};case 8:return function(t,r,n,a,i,o,s,l){return e.call(this,t,r,n,a,i,o,s,l)};case 9:return function(t,r,n,a,i,o,s,l,c){return e.call(this,t,r,n,a,i,o,s,l,c)};case 10:return function(t,r,n,a,i,o,s,l,c,u){return e.call(this,t,r,n,a,i,o,s,l,c,u)};default:return e}},st=function(){var t=arguments,e=arguments.length-1;return function(){for(var r=e,n=t[r].apply(this,arguments);r--;)n=t[r].call(this,n);return n}},lt=function(t){return void 0!==t&&null!=t},ct=function(t,e){for(var r=new Array(t),n=0;n<t;++n)r[n]=e;return r},ut=function(t,e){for(var r=0;r<e.length;r++)if(t(e[r]))return e[r]},pt=function(t){return t[0]},dt=function(t){return t.touches&&t.touches.length?t.touches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null},ft=function(t){return null===t},ht=function(t){return Object(t)===t},vt=function(t){return t[t.length-1]},gt=function(t){var r;return r=at(t)?e.select(t).node():it(t)?t.node():t,{width:r?r.getBoundingClientRect().width:void 0,screenWidth:window.innerWidth,screenHeight:window.innerHeight}},mt=function(t){return function(){return!t.apply(this,arguments)}},yt=function(t){return function(e){return e[t]}},xt=function(t,e){return function(r){var n=void 0!==r?r[t]:void 0;return void 0!==n?n:e}},bt=function(t,e){return e||(e=nt),t.reduce(function(r,n,a){var i=e(n,a,t);return r.indexOf(i)<0?r.concat(i):r},[])},kt=function(t,e){return t.toString()===e.toString()},_t=function(t){return"function"==typeof t?t:function(){return t}},zt=function(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var n=function(){var e=arguments,a=r?r.apply(this,e):e[0],i=n.cache;if(i.has(a))return i.get(a);var o=t.apply(this,e);return n.cache=i.set(a,o)||i,o};return n.cache=e.map(),n},At=function(t){return Math.floor(t)+.5},wt=function(t){var e=st(Math.floor,Number),r=t.match(/(translate\()\s*([0-9.,\- ]+)\s*(\))/i)[2].replace(","," ").replace(/\s+/," ").split(" ").map(Number);1===r.length&&r.push([0]);var n=r.map(e);return[r[0]-n[0],r[1]-n[1]]},St=function(t,e){return"translate("+t+","+e+")"},Ct=function(t,r,n,a){n=n||5,a=(a||5)-2;var i=r;r-=2*n;var o=[];return t.each(function(){var t,s,l=e.select(this),c=l.text().split(/[ \f\n\r\t\v]+/).reverse(),u=[],p=0,d=l.attr("y"),f=parseFloat(l.attr("dy")),h=1,v=l.style("text-anchor")||"start";if(isNaN(f)&&(f=0),e.select(l.node().parentNode).classed("tick"))switch(v){case"start":s=-r/2;break;case"middle":s=0;break;case"end":s=r/2}else switch(v){case"start":s=n;break;case"middle":s=i/2;break;case"end":s=i-n}d=+(null===d?a:d);for(var g=l.text(null).append("tspan").attr("x",s).attr("y",d).attr("dy",f+"em");c.length>0;)t=c.pop(),u.push(t),g.text(u.join(" ")),g.node().getComputedTextLength()>r&&u.length>1&&(u.pop(),g.text(u.join(" ")),u=[t],g=l.append("tspan").attr("x",s).attr("y",d).attr("dy",1.1*++p+f+"em").text(t),++h);o.push(h)}),o},Mt={decimal:".",thousands:" ",grouping:[3],currency:["CHF ",""],dateTime:"%a. %e. %B %X %Y",date:"%d.%m.%Y",time:"%H:%M:%S",periods:[],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},Ft=e.timeFormatLocale(Mt).format,Tt=e.formatLocale(Mt).format,Et=function(t){for(var e=[[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%H:%M",function(t){return t.getMinutes()}],["%H Uhr",function(t){return t.getHours()}],["%a., %d.",function(t){return t.getDay()&&1!=t.getDate()}],["%e. %b",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",function(){return!0}]],r=0;r<e.length;++r)if(e[r][1](t))return Ft(e[r][0])(t)},Pt=st(function(t){return t.toUpperCase()},Ft("%b")),Rt=Ft("%Y"),Lt=function(t){var e,n=Math.abs(t),a=r(t);return isNaN(t)?"–":n>=1e4?Tt(",.0f")(t):n>=100?(e=0===a?0:1,Tt("."+e+"f")(t)):n>0?(e=Math.min(2,a),Tt("."+e+"f")(t)):Tt(".0f")(0)},Bt=function(t,e){return arguments.length>1?Bt(t)(e):function(e){var r=Math.abs(e);return r>=100&&r<1e4?Tt("."+t+"f")(e):Tt(",."+t+"f")(e)}},Ot=function(t){return String(t)},Dt=function(t){return t.rangeExtent?t.rangeExtent():n(t.range())},Nt=(a("log"),a("warn")),Wt=a("error");e.selection.prototype.props=function(){if(arguments.length)throw new Error("selection.props() does not accept any arguments");if(1!=this.size())throw new Error("only one group is supported");if(1!=this._groups[0].length)throw new Error("only one node is supported");return this._groups[0][0].__props__||{}};var Ht=function(){return o().prop("scale").prop("orient").prop("ticks").prop("tickValues").prop("tickSize").prop("tickSizeInner").prop("tickSizeOuter").prop("tickPadding").prop("tickFormat").prop("_scale").prop("orient").orient("bottom").prop("alignOuterLabels").alignOuterLabels(!1).prop("contour").prop("hideBorderTickThreshold").hideBorderTickThreshold(8).prop("hideLabelThreshold").hideLabelThreshold(10).prop("highlightTick",_t).prop("showZeroY").showZeroY(!1).prop("slant").prop("textWrap").prop("tickLength").prop("title").prop("titleAnchor").prop("titleCenter").prop("dxTitle").prop("dyTitle").prop("titleVertical").prop("vertical").vertical(!1).prop("yOffset").yOffset(0).render(function(){var t=e.select(this),r=t.props(),n=!r.vertical&&"bottom"===r.orient,a=function(){switch(r.orient){case"bottom":return e.axisBottom();case"top":return e.axisTop();case"left":return e.axisLeft();case"right":return e.axisRight()}}();["scale","ticks","tickValues","tickSizeInner","tickSizeOuter","tickPadding","tickFormat","tickSize"].forEach(function(t){if(void 0!==r[t]){if(void 0===a[t])throw new Error('axis: "'+t+'" not available');a[t](r[t])}}),r._scale&&a.scale(r._scale);var i=t.selectGroup("sszvis-axis").classed("sszvis-axis",!0).classed("sszvis-axis--top",!r.vertical&&"top"===r.orient).classed("sszvis-axis--bottom",n).classed("sszvis-axis--vertical",r.vertical).attr("transform",St(0,r.yOffset)).call(a);i.attr("fill",null).attr("font-size",null).attr("font-family",null);var o=a.scale(),s=i.selectAll("g.tick"),l=s.selectAll("text");s.each(function(){var t=wt(this.getAttribute("transform")),r=At(0)-t[0],a=At(n?2:0)+t[1];e.select(this).select("line").attr("transform",St(r,a))}),l.each(function(){"top"!==r.orient&&"bottom"!==r.orient||e.select(this).attr("dx","-0.5"),"left"!==r.orient&&"right"!==r.orient||e.select(this).attr("y","-0.5")}),i.selectAll("path.domain");var c=Dt(o);if(s.selectAll("line").each(function(t){var n=o(t),a=e.select(this);a.classed("hidden",!a.classed("sszvis-axis__longtick")&&(p(n,c[0])<r.hideBorderTickThreshold||p(n,c[1])<r.hideBorderTickThreshold))}),lt(r.tickLength)){var u=e.extent(o.domain()),f=s.filter(function(t){return!kt(t,u[0])&&!kt(t,u[1])}),h=r.orient,v=2;"left"!==h&&"right"!==h||(f.selectAll("text").each(function(){v=Math.max(this.getBoundingClientRect().width,v)}),v+=2);var g=f.selectAll("line.sszvis-axis__longtick").data([0]);if(r.tickLength>v){var m=g.enter().append("line").classed("sszvis-axis__longtick",!0);g=g.merge(m),"top"===h?g.attr("y1",v).attr("y2",r.tickLength):"bottom"===h?g.attr("y1",-v).attr("y2",-r.tickLength):"left"===h?g.attr("x1",-v).attr("x2",-r.tickLength):"right"===h&&g.attr("x1",v).attr("x2",r.tickLength)}else g.remove()}if(r.alignOuterLabels){var y=Dt(o),x=y[0],b=y[1];l.style("text-anchor",function(t){var e=o(t);return p(e,x)<12?"start":p(e,b)<12?"end":"middle"})}if(lt(r.textWrap)&&l.call(Ct,r.textWrap),r.slant&&l.call(Jt[r.orient][r.slant]),r.highlightTick){var k=[],_=[];l.classed("hidden",!1).classed("active",r.highlightTick),r.hideLabelThreshold>0&&!r.slant&&(l.each(function(t){var e=this.getBoundingClientRect(),n={node:this,bounds:{top:e.top,right:e.right,bottom:e.bottom,left:e.left}};r.highlightTick(t)?(n.bounds.left-=r.hideLabelThreshold,n.bounds.right+=r.hideLabelThreshold,k.push(n)):_.push(n)}),k.forEach(function(t){_.forEach(function(r){e.select(r.node).classed("hidden",d(r.bounds,t.bounds))})}))}if(r.title){var z=i.selectAll(".sszvis-axis__title").data([r.title]),A=z.enter().append("text").classed("sszvis-axis__title",!0);z.exit().remove(),z.merge(A).text(function(t){return t}).attr("transform",function(){var t,e=r.orient,n=Dt(o);return t=r.titleCenter?{left:"left"===e||"right"===e?0:"top"===e||"bottom"===e?(n[0]+n[1])/2:0,top:"left"===e||"right"===e?(n[0]+n[1])/2:"top"===e?0:"bottom"===e?32:0}:{left:"left"===e||"right"===e||"top"===e?0:"bottom"===e?n[1]:0,top:"left"===e||"right"===e||"top"===e?0:"bottom"===e?32:0},t.vertical=!!r.titleVertical,t.left+=r.dxTitle||0,t.top+=r.dyTitle||0,"translate("+t.left+", "+t.top+") rotate("+(t.vertical?"-90":"0")+")"}).style("text-anchor",function(){var t=r.orient;return void 0!==r.titleAnchor?r.titleAnchor:"left"===t?"end":"right"===t?"start":"top"===t||"bottom"===t?"end":void 0})}r.contour&&r.slant?Nt("Can't apply contour to slanted labels"):r.contour&&s.each(function(){var t=e.select(this),r=t.select("text").node(),n=t.select(".sszvis-axis__label-contour");n.empty()&&(n=e.select(r.cloneNode()).classed("sszvis-axis__label-contour",!0),this.insertBefore(n.node(),r)),n.text(r.textContent)})})},Gt=function(t){var e=this.scale().domain(),r=[],n=Math.round(e.length/t);void 0!==e[0]&&r.push(e[0]);for(var a=n,i=e.length;a<i-1;a+=n)void 0!==e[a]&&r.push(e[a]);return void 0!==e[e.length-1]&&r.push(e[e.length-1]),this.tickValues(r),t},It=function(){return Ht().yOffset(2).ticks(3).tickSizeInner(4).tickSizeOuter(6.5).tickPadding(6).tickFormat(ot(1,Lt))};It.time=function(){return It().tickFormat(Et).alignOuterLabels(!0)},It.ordinal=function(){return It().prop("ticks",Gt).tickFormat(Ot)},It.pyramid=function(){return It().ticks(10).prop("scale",function(t){var e=t.copy(),r=e.domain(),n=e.range();return e.domain([-r[1],r[1]]).range([n[0]-n[1],n[0]+n[1]]),this._scale(e),e}).tickFormat(function(t){return Lt(Math.abs(t))})};var jt=function(){var t=Ht().ticks(6).tickSize(0,0).tickPadding(0).tickFormat(function(e){return 0!==e||t.showZeroY()?Lt(e):null}).vertical(!0);return t};jt.time=function(){return jt().tickFormat(Et)},jt.ordinal=function(){return jt().prop("ticks",Gt).tickFormat(Ot)};var Jt={top:{horizontal:function(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("transform",null)},vertical:function(t){t.style("text-anchor","start").attr("dx","0em").attr("dy","0.35em").attr("transform","rotate(-90)")},diagonal:function(t){t.style("text-anchor","start").attr("dx","0.1em").attr("dy","0.1em").attr("transform","translate(-0.5) rotate(-45)")}},bottom:{horizontal:function(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("transform",null)},vertical:function(t){t.style("text-anchor","end").attr("dx","-1em").attr("dy","-0.75em").attr("transform","rotate(-90)")},diagonal:function(t){t.style("text-anchor","end").attr("dx","-0.8em").attr("dy","0em").attr("transform","rotate(-45)")}}},Vt=function(){var t=m([{name:"palm",width:540},{name:"lap",width:749}]);return function(){return t}}(),Yt=b("palm"),Ut=b("lap"),Kt=k(4,3),Xt=k(16,10),qt=function(t){return Math.min(k(12,5)(t),500)};qt.MAX_HEIGHT=500;var Qt=function(t){return Math.min(k(1,1)(t),420)};Qt.MAX_HEIGHT=420;var Zt=function(t){return Math.min(k(4,5)(t),600)};Zt.MAX_HEIGHT=600;var $t={palm:Kt,lap:Xt,_:qt},te=function(t){var e=f(Vt(),t);return(0,$t[e.name])(t.width)},ee=516,re=.6,ne=A(["#5182B3","#B8CFE6","#60BF97","#B8E6D2","#94BF69","#CFE6B8","#E6CF73","#FAEBAF","#E67D73","#F2CEC2","#CC6788","#E6B7C7"]),ae=A(["#5182B3","#60BF97","#94BF69","#E6CF73","#E67D73","#CC6788"]),ie=A(["#5182B3","#B8CFE6","#60BF97","#B8E6D2","#94BF69","#CFE6B8"]),oe=A(["#E6CF73","#FAEBAF","#E67D73","#F2CEC2","#CC6788","#E6B7C7"]),se=w(["#DDE9FE","#3B76B3","#343F4D"]),le=w(["#FEECEC","#CC6171","#4D353A"]),ce=w(["#D2DFDE","#4A807C","#2C3C3F"]),ue=w(["#E9DFD6","#A67D5A","#4C3735"]),pe=S(["#CC6171","#FFFFFF","#3B76B3"]),de=S(["#CC6171","#F3F3F3","#3B76B3"]),fe=S(["#A67D5A","#FFFFFF","#4A807C"]),he=S(["#A67D5A","#F3F3F3","#4A807C"]),ve=C(["#FAFAFA"]),ge=C(["#EAEAEA"]),me=C(["#D6D6D6"]),ye=C(["#B8B8B8"]),xe=C(["#7C7C7C"]),be=C(["#545454"]),ke=e.timeFormatLocale(Mt).parse,_e=ke("%d.%m.%Y"),ze=ke("%Y"),Ae=function(){var t=e.dispatch("start","move","drag","end"),r=o().prop("debug").prop("xScale").prop("yScale").prop("draggable").prop("cancelScrolling",_t).cancelScrolling(!1).prop("fireOnPanOnly",_t).fireOnPanOnly(!1).prop("padding",function(t){var e={top:0,left:0,bottom:0,right:0};for(var r in t)e[r]=t[r];return e}).padding({}).render(function(){var r=e.select(this),n=r.props(),a=Dt(n.xScale).sort(e.ascending),i=Dt(n.yScale).sort(e.ascending);a[0]-=n.padding.left,a[1]+=n.padding.right,i[0]-=n.padding.top,i[1]+=n.padding.bottom;var o=r.selectAll("[data-sszvis-behavior-move]").data([0]),s=o.enter().append("rect").attr("data-sszvis-behavior-move","").attr("class","sszvis-interactive");o=o.merge(s),n.draggable&&o.classed("sszvis-interactive--draggable",!0),o.attr("x",a[0]).attr("y",i[0]).attr("width",a[1]-a[0]).attr("height",i[1]-i[0]).attr("fill","transparent").on("mouseover",function(){t.apply("start",this,arguments)}).on("mousedown",function(){var r=this,a=e.select(document),i=e.select(window),o=function(){var a=e.mouse(r),i=R(n.xScale,a[0]),o=R(n.yScale,a[1]);e.event.preventDefault(),t.apply("drag",this,[i,o])},s=function(){r.__dragging__=!1,i.on("mouseup.sszvis-behavior-move",null),i.on("mousemove.sszvis-behavior-move",null),a.on("mouseout.sszvis-behavior-move",null),t.apply("end",this,arguments)};i.on("mousemove.sszvis-behavior-move",o),i.on("mouseup.sszvis-behavior-move",s),a.on("mouseout.sszvis-behavior-move",function(){var t=e.event.relatedTarget||e.event.toElement;t&&"HTML"!==t.nodeName||s()}),r.__dragging__=!0,o()}).on("mousemove",function(){var r=this,a=e.mouse(this),i=R(n.xScale,a[0]),o=R(n.yScale,a[1]);r.__dragging__||t.apply("move",this,[i,o])}).on("mouseout",function(){t.apply("end",this,[])}).on("touchstart",function(){var r=pt(e.touches(this)),a=R(n.xScale,r[0]),i=R(n.yScale,r[1]),o=n.cancelScrolling(a,i);if(o&&e.event.preventDefault(),!n.fireOnPanOnly()||o){t.apply("start",this,[a,i]),t.apply("drag",this,[a,i]),t.apply("move",this,[a,i]);e.select(this).on("touchmove",function(){var r=pt(e.touches(this)),a=R(n.xScale,r[0]),i=R(n.yScale,r[1]),o=n.cancelScrolling(a,i);o&&e.event.preventDefault(),!n.fireOnPanOnly()||o?(t.apply("drag",this,[a,i]),t.apply("move",this,[a,i])):t.apply("end",this,[])}).on("touchend",function(){t.apply("end",this,[]),e.select(this).on("touchmove",null).on("touchend",null)})}}),n.debug&&o.attr("fill","rgba(255,0,0,0.2)")});return r.on=function(){var e=t.on.apply(t,arguments);return e===t?r:e},r},we=function(t){return!ft(t)&&lt(t)?document.elementFromPoint(t.clientX,t.clientY):null},Se=function(t){if(!ft(t)){var r=e.select(t);if(!ft(r.attr("data-sszvis-behavior-pannable"))){var n=r.datum();if(lt(n))return n}}return null},Ce=function(t){return Se(we(t))},Me=Math.pow(15,2),Fe=function(){var t=0;return function(){return++t}}(),Te=function(t,e,r){var n=B(t).selectAll(e+"#"+r).data([0]),a=n.enter().append(e).attr("id",r);return n.merge(a)},Ee=D(function(){var t={plain:function(t){return t},italic:function(t){return"<em>"+t+"</em>"},bold:function(t){return"<strong>"+t+"</strong>"}};return function(e,r){return e.lines().map(function(e){return e.map(function(e){return t[e.style].call(null,e.text(r))}).join(" ")}).join("<br/>")}}()),Pe=D(function(){var t={plain:function(t){return"<tspan>"+t+"</tspan>"},italic:function(t){return'<tspan style="font-style:italic">'+t+"</tspan>"},bold:function(t){return'<tspan style="font-weight:bold">'+t+"</tspan>"}};return function(e,r){return e.lines().reduce(function(e,n,a){var i=n.map(function(e){return t[e.style].call(null,e.text(r))}).join(" ");return e+'<tspan x="0" dy="'+(0===a?0:"1.2em")+'">'+i+"</tspan>"},"")}}()),Re=e.easePolyOut,Le=function(){return e.transition().ease(Re).duration(300)},Be=function(){return e.transition().ease(Re).duration(500)},Oe=function(t){t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",14).attr("height",14),t.append("rect").attr("x",0).attr("y",0).attr("width",14).attr("height",14).attr("fill","#FAFAFA"),t.append("line").attr("x1",1).attr("y1",10).attr("x2",5).attr("y2",14).attr("stroke","#CCCCCC"),t.append("line").attr("x1",5).attr("y1",10).attr("x2",1).attr("y2",14).attr("stroke","#CCCCCC"),t.append("line").attr("x1",8).attr("y1",3).attr("x2",12).attr("y2",7).attr("stroke","#CCCCCC"),t.append("line").attr("x1",12).attr("y1",3).attr("x2",8).attr("y2",7).attr("stroke","#CCCCCC")},De=function(t){t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",6).attr("height",6),t.append("rect").attr("x",0).attr("y",0).attr("width",6).attr("height",6).attr("fill","#fff"),t.append("line").attr("x1",0).attr("y1",3).attr("x2",3).attr("y2",0).attr("stroke","#ddd").attr("stroke-linecap","square"),t.append("line").attr("x1",3).attr("y1",6).attr("x2",6).attr("y2",3).attr("stroke","#ddd").attr("stroke-linecap","square")},Ne=function(t){t.attr("x1",0).attr("y1",0).attr("x2",.55).attr("y2",1).attr("id","lake-fade-gradient"),t.append("stop").attr("offset",.74).attr("stop-color","white").attr("stop-opacity",1),t.append("stop").attr("offset",.97).attr("stop-color","white").attr("stop-opacity",0)},We=function(t){t.attr("maskContentUnits","objectBoundingBox"),t.append("rect").attr("fill","url(#lake-fade-gradient)").attr("width",1).attr("height",1)},He=function(t){t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",6).attr("height",6),t.append("line").attr("x1",0).attr("y1",3).attr("x2",3).attr("y2",0).attr("stroke","#e6e6e6").attr("stroke-width",1.1),t.append("line").attr("x1",3).attr("y1",6).attr("x2",6).attr("y2",3).attr("stroke","#e6e6e6").attr("stroke-width",1.1)},Ge=function(){function t(t){return St.apply(null,t)}return o().prop("position").position(_t([0,0])).prop("debug").render(function(r){var n=e.select(this),a=n.props(),i=n.selectAll("[data-tooltip-anchor]").data(r),o=i.enter().append("rect").attr("height",1).attr("width",1).attr("fill","none").attr("stroke","none").attr("visibility","none").attr("data-tooltip-anchor","");if(i.exit().remove(),(i=i.merge(o)).attr("transform",st(t,a.position)),a.debug){var s=n.selectAll("[data-tooltip-anchor-debug]").data(r),l=s.enter().append("circle").attr("data-tooltip-anchor-debug","");s.exit().remove(),(s=s.merge(l)).attr("r",2).attr("fill","#fff").attr("stroke","#f00").attr("stroke-width",1.5).attr("transform",st(t,a.position))}})},Ie=6,je=function(){return o().prop("header").prop("body").prop("orientation",_t).orientation("bottom").prop("dx",_t).dx(1).prop("dy",_t).dy(1).prop("opacity",_t).opacity(1).renderSelection(function(t){var r=t.datum(),n=t.props(),a=lt,i=a(n.header)&&!a(n.body)||!a(n.header)&&a(n.body),o=t.selectAll(".sszvis-tooltip").data(r);o.exit().remove();var s=o.enter().append("div");(o=o.merge(s)).style("pointer-events","none").style("opacity",n.opacity).style("padding-top",function(t){return"top"===n.orientation(t)?Ie+"px":null}).style("padding-right",function(t){return"right"===n.orientation(t)?Ie+"px":null}).style("padding-bottom",function(t){return"bottom"===n.orientation(t)?Ie+"px":null}).style("padding-left",function(t){return"left"===n.orientation(t)?Ie+"px":null}).classed("sszvis-tooltip",!0);var l=s.append("svg").attr("class","sszvis-tooltip__background").attr("height",0).attr("width",0),c=l.append("path");if(U()){var u=l.append("filter").attr("id","sszvisTooltipShadowFilter").attr("height","150%");u.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",2),u.append("feComponentTransfer").append("feFuncA").attr("type","linear").attr("slope",.2);var p=u.append("feMerge");p.append("feMergeNode"),p.append("feMergeNode").attr("in","SourceGraphic"),c.attr("filter","url(#sszvisTooltipShadowFilter)")}else l.classed("sszvis-tooltip__background--fallback",!0);var d=s.append("div").classed("sszvis-tooltip__content",!0);d.append("div").classed("sszvis-tooltip__header",!0),d.append("div").classed("sszvis-tooltip__body",!0),o.select(".sszvis-tooltip__header").datum(yt("datum")).html(n.header||_t("")),o.select(".sszvis-tooltip__body").datum(yt("datum")).html(function(t){var e=n.body?_t(n.body)(t):"";return Array.isArray(e)?V(e):e}),t.selectAll(".sszvis-tooltip").classed("sszvis-tooltip--small",i).each(function(t){var r=e.select(this),a=r.node().getBoundingClientRect(),o=n.orientation.apply(this,arguments);switch(o){case"top":r.style("left",t.x-a.width/2+"px").style("top",t.y+n.dy(t)+"px");break;case"bottom":r.style("left",t.x-a.width/2+"px").style("top",t.y-n.dy(t)-a.height+"px");break;case"left":r.style("left",t.x+n.dx(t)+"px").style("top",t.y-a.height/2+"px");break;case"right":r.style("left",t.x-n.dx(t)-a.width+"px").style("top",t.y-a.height/2+"px")}var s=a.height+10,l=a.width+10;r.select(".sszvis-tooltip__background").attr("height",s).attr("width",l).style("left","-5px").style("top","-5px").select("path").attr("d",Y([5,5],[l-5,s-5],o,i?3:4))})})},Je=function(){return o().prop("x",_t).prop("y",_t).prop("width",_t).prop("height",_t).prop("fill",_t).prop("stroke",_t).prop("centerTooltip").prop("tooltipAnchor").prop("transition").transition(!0).render(function(t){var r=e.select(this),n=r.props(),a=st(K,n.x),i=st(K,n.y),o=st(K,n.width),s=st(K,n.height),l=r.selectAll(".sszvis-bar").data(t);l.exit().remove(),l.enter().append("rect").classed("sszvis-bar",!0).attr("x",a).attr("y",i).attr("width",o).attr("height",s).merge(l).attr("fill",n.fill).attr("stroke",n.stroke),n.transition&&(l=l.transition(Le())),l.attr("x",a).attr("y",i).attr("width",o).attr("height",s);var c;if(n.centerTooltip)c=function(t){return[a(t)+o(t)/2,i(t)+s(t)/2]};else if(n.tooltipAnchor){var u=n.tooltipAnchor.map(parseFloat);c=function(t){return[a(t)+u[0]*o(t),i(t)+u[1]*s(t)]}}else c=function(t){return[a(t)+o(t)/2,i(t)]};var p=Ge().position(c);r.call(p)})},Ve=yt("stack"),Ye=yt("0"),Ue=yt("1"),Ke=q(e.stackOrderNone),Xe=q(e.stackOrderReverse),qe={x:function(t){return st(t.xScale,Ye)},y:function(t){return st(t.yScale,Ve)},width:function(t){return function(e){return t.xScale(e[1])-t.xScale(e[0])}},height:function(t){return t.height}},Qe={x:function(t){return st(t.xScale,Ve)},y:function(t){return st(t.yScale,Ue)},width:function(t){return t.width},height:function(t){return function(e){return t.yScale(e[0])-t.yScale(e[1])}}},Ze=.5,$e=yt("data"),tr=yt("row"),er=2*Math.PI,rr=zt(function(t,r,n){return e.geoMercator().fitSize([t,r],n)},function(t,e,r,n){return t+","+e+","+n}),nr=function(t,r,n,a){return e.geoPath().projection(rr(t,r,n,a))},ar=function(t,e,r){r||(r="geoId");var n=Array.isArray(t)?t.reduce(function(t,e){return t[e[r]]=e,t},{}):{};return e.features.map(function(t){return{geoJson:t,datum:n[t.id]}})},ir=function(t){if(!t.properties.cachedCenter){var r=t.properties.center;t.properties.cachedCenter=r?r.split(",").map(parseFloat):e.geoCentroid(t)}return t.properties.cachedCenter},or=yt("datum"),sr=function(){return o().prop("mergedData").prop("geoJson").prop("mapPath").prop("defined",_t).defined(!0).prop("fill",_t).fill(function(){return"black"}).prop("transitionColor").transitionColor(!0).render(function(){function t(t){return n.defined(t.datum)?n.fill(t.datum):"url(#missing-pattern)"}var r=e.select(this),n=r.props();Te(r,"pattern","missing-pattern").call(Oe);var a=r.selectAll(".sszvis-map__area").data(n.mergedData),i=a.enter().append("path").classed("sszvis-map__area",!0).classed("sszvis-map__area--entering",!0).attr("data-event-target","").attr("fill",t);a.classed("sszvis-map__area--entering",!1),a.exit().remove(),a=a.merge(i),r.selectAll(".sszvis-map__area--undefined").attr("fill",t),a.classed("sszvis-map__area--undefined",function(t){return!lt(t.datum)||!n.defined(t.datum)}).attr("d",function(t){return n.mapPath(t.geoJson)}),n.transitionColor?a.transition().call(Be).attr("fill",t):a.attr("fill",t);var o=Ge().position(function(t){return n.mapPath.projection()(ir(t.geoJson))});r.selectGroup("tooltipAnchors").datum(n.mergedData).call(o)})},lr=function(){return o().prop("keyName").keyName("geoId").prop("geoJson").prop("mapPath").prop("highlight").highlight([]).prop("highlightStroke",_t).highlightStroke("white").prop("highlightStrokeWidth",_t).highlightStrokeWidth(2).render(function(){var t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-map__highlight");if(!r.highlight.length)return n.remove(),!0;var a=r.geoJson.features.reduce(function(t,e){return t[e.id]=e,t},{}),i=r.highlight.reduce(function(t,e){return e&&t.push({geoJson:a[e[r.keyName]],datum:e}),t},[]),o=(n=n.data(i)).enter().append("path").classed("sszvis-map__highlight",!0);n.exit().remove(),(n=n.merge(o)).attr("d",function(t){return r.mapPath(t.geoJson)}).style("stroke",function(t){return r.highlightStroke(t.datum)}).style("stroke-width",function(t){return r.highlightStrokeWidth(t.datum)})})},cr=function(){return o().prop("geoJson").prop("mapPath").prop("borderColor").borderColor("white").prop("strokeWidth").strokeWidth(1.25).render(function(){var t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-map__border").data([r.geoJson]),a=n.enter().append("path").classed("sszvis-map__border",!0);n.exit().remove(),(n=n.merge(a)).attr("d",r.mapPath).style("stroke",r.borderColor).style("stroke-width",r.strokeWidth)})},ur=function(){return o().prop("mapPath").prop("lakeFeature").prop("lakeBounds").prop("lakePathColor").prop("fadeOut").fadeOut(!0).render(function(){var t=e.select(this),r=t.props();Te(t,"pattern","lake-pattern").call(De),r.fadeOut&&(Te(t,"linearGradient","lake-fade-gradient").call(Ne),Te(t,"mask","lake-fade-mask").call(We));var n=t.selectAll(".sszvis-map__lakezurich").data([r.lakeFeature]),a=n.enter().append("path").classed("sszvis-map__lakezurich",!0);n.exit().remove(),(n=n.merge(a)).attr("d",r.mapPath).attr("fill","url(#lake-pattern)"),r.fadeOut&&n.attr("mask","url(#lake-fade-mask)");var i=t.selectAll(".sszvis-map__lakepath").data([r.lakeBounds]),o=i.enter().append("path").classed("sszvis-map__lakepath",!0);i.exit().remove(),(i=i.merge(o)).attr("d",r.mapPath),r.lakePathColor&&i.style("stroke",r.lakePathColor)})},pr={resize:[]};"undefined"!=typeof window&&e.select(window).on("resize",function(t,e){var r,n,a,i=null,o=0,s=function(){o=0,a=e.apply(r,n),i=r=n=null};return function(){var l=Date.now();o||(o=l);var c=t-(l-o);return r=this,n=arguments,c<=0||c>t?(i&&(clearTimeout(i),i=null),o=l,a=e.apply(r,n),i||(r=n=null)):i||(i=setTimeout(s,c)),a}}(500,function(){dr("resize")}));var dr=function(t){var e=Array.prototype.slice.call(arguments,1);return pr[t]&&pr[t].forEach(function(t){t.apply(null,e)}),this},fr={on:function(t,e){return pr[t]||(pr[t]=[]),pr[t]=pr[t].filter(function(t){return t!==e}).concat(e),this},off:function(t,e){return pr[t]?(pr[t]=pr[t].filter(function(t){return t!==e}),this):this},trigger:dr};t.identity=nt,t.isString=at,t.isSelection=it,t.arity=ot,t.compose=st,t.contains=function(t,e){return t.indexOf(e)>=0},t.defined=lt,t.derivedSet=function(t,e){e||(e=nt);for(var r,n,a=[],i=[],o=0,s=t.length;o<s;++o)n=e(r=t[o],o,t),a.indexOf(n)<0&&(a.push(n),i.push(r));return i},t.every=function(t,e){for(var r=0;r<e.length;r++)if(!t(e[r]))return!1;return!0},t.filledArray=ct,t.find=ut,t.first=pt,t.flatten=function(t){return Array.prototype.concat.apply([],t)},t.firstTouch=dt,t.hashableSet=function(t,e){e||(e=nt);for(var r,n={},a=[],i=0,o=t.length;i<o;++i)n[r=e(t[i],i,t)]||(n[r]=!0,a.push(r));return a},t.isFunction=function(t){return"function"==typeof t},t.isNull=ft,t.isNumber=function(t){return"[object Number]"===Object.prototype.toString.call(t)},t.isObject=ht,t.last=vt,t.measureDimensions=gt,t.not=mt,t.prop=yt,t.propOr=xt,t.set=bt,t.some=function(t,e){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1},t.stringEqual=kt,t.functor=_t,t.memoize=zt,t.axisX=It,t.axisY=jt,t.aspectRatio=k,t.aspectRatio4to3=Kt,t.aspectRatio16to10=Xt,t.aspectRatio12to5=qt,t.aspectRatioSquare=Qt,t.aspectRatioPortrait=Zt,t.aspectRatioAuto=te,t.bounds=_,t.DEFAULT_WIDTH=ee,t.RATIO=16/9,t.scaleQual12=ne,t.scaleQual6=ae,t.scaleQual6a=ie,t.scaleQual6b=oe,t.scaleSeqBlu=se,t.scaleSeqRed=le,t.scaleSeqGrn=ce,t.scaleSeqBrn=ue,t.scaleDivVal=pe,t.scaleDivValGry=de,t.scaleDivNtr=fe,t.scaleDivNtrGry=he,t.scaleLightGry=ve,t.scalePaleGry=ge,t.scaleGry=me,t.scaleDimGry=ye,t.scaleMedGry=xe,t.scaleDeepGry=be,t.slightlyDarker=function(t){return e.hsl(t).darker(.4)},t.muchDarker=function(t){return e.hsl(t).darker(.7)},t.withAlpha=function(t,r){var n=e.rgb(t);return"rgba("+n.r+","+n.g+","+n.b+","+r+")"},t.createSvgLayer=function(t,r,n){r||(r=_()),n||(n={});var a=n.key||"default",i=n.title||"",o=n.description||"",s="data-sszvis-svg-"+a,l=(it(t)?t:e.select(t)).selectAll("svg["+s+"]").data([0]),c=l.enter().append("svg");c.classed("sszvis-svg-layer",!0).attr(s,"").attr("role","img").attr("aria-label",i+" – "+o),c.append("title").text(i),c.append("desc").text(o),l.merge(c).attr("height",r.height).attr("width",r.width);var u=l.merge(c).selectAll("[data-sszvis-svg-layer]").data(function(){return[0]}),p=u.enter().append("g").attr("data-sszvis-svg-layer","");return u.merge(p).attr("transform","translate("+r.padding.left+","+r.padding.top+")"),u.merge(p)},t.fallbackUnsupported=function(){return!(document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)},t.fallbackCanvasUnsupported=function(){return!document.createElement("canvas").getContext},t.fallbackRender=function(t,r){r||(r={}),r.src||(r.src="fallback.png"),(it(t)?t:e.select(t)).append("img").attr("class","sszvis-fallback-image").attr("src",r.src)},t.loadError=function(t){Wt(t)},t.parseDate=function(t){return _e(t)},t.parseYear=function(t){return ze(t)},t.parseNumber=function(t){return""===t.trim()?NaN:+t},t.move=Ae,t.panning=function(){var t=e.dispatch("start","pan","end"),r=o().prop("elementSelector").render(function(){var r=e.select(this),n=r.props();r.selectAll(n.elementSelector).attr("data-sszvis-behavior-pannable","").classed("sszvis-interactive",!0).on("mouseenter",function(){t.apply("start",this,arguments)}).on("mousemove",function(){t.apply("pan",this,arguments)}).on("mouseleave",function(){t.apply("end",this,arguments)}).on("touchstart",function(){e.event.preventDefault(),t.apply("start",this,arguments)}).on("touchmove",function(){e.event.preventDefault(),null!==Ce(dt(e.event))?t.apply("pan",this,arguments):t.apply("end",this,arguments)}).on("touchend",function(){t.apply("end",this,arguments)})});return r.on=function(){var e=t.on.apply(t,arguments);return e===t?r:e},r},t.voronoi=function(){var t=e.dispatch("over","out"),r=o().prop("x").prop("y").prop("bounds").prop("debug").render(function(r){var n=e.select(this),a=n.props();if(!a.bounds)return Wt("behavior.voronoi - requires bounds"),!1;var i=e.voronoi().x(a.x).y(a.y).extent(a.bounds),o=n.selectAll("[data-sszvis-behavior-voronoi]").data(i.polygons(r)),s=o.enter().append("path").attr("data-sszvis-behavior-voronoi","").attr("data-sszvis-behavior-pannable","").attr("class","sszvis-interactive");o.exit().remove(),(o=o.merge(s)).attr("d",function(t){return"M"+t.join("L")+"Z"}).attr("fill","transparent").on("mouseover",function(r){var n=this.parentNode.getBoundingClientRect();L(e.event,[n.left+a.x(r.data),n.top+a.y(r.data)])&&t.apply("over",this,[r.data])}).on("mousemove",function(r){var n=this.parentNode.getBoundingClientRect();L(e.event,[n.left+a.x(r.data),n.top+a.y(r.data)])?t.apply("over",this,[r.data]):t.apply("out",this,[])}).on("mouseout",function(){t.apply("out",this,[])}).on("touchstart",function(r){var n=this.parentNode.getBoundingClientRect();L(dt(e.event),[n.left+a.x(r.data),n.top+a.y(r.data)])&&(e.event.preventDefault(),t.apply("over",this,[r.data]),e.select(this).on("touchmove",function(){var r=dt(e.event),n=we(r),i=Se(n);if(null!==i){var o=n.parentNode.getBoundingClientRect();L(r,[o.left+a.x(i.data),o.top+a.y(i.data)])?(e.event.cancelable&&e.event.preventDefault(),t.apply("over",this,[i.data])):t.apply("out",this,[])}else t.apply("out",this,[])}).on("touchend",function(){t.apply("out",this,[]),e.select(this).on("touchmove",null).on("touchend",null)}))}),a.debug&&o.attr("stroke","#f00")});return r.on=function(){var e=t.on.apply(t,arguments);return e===t?r:e},r},t.dimensionsHeatTable=function(t,e,r,n,a){a||(a={}),a.top||(a.top=0),a.right||(a.right=0),a.bottom||(a.bottom=0),a.left||(a.left=0);var i=t-a.left-a.right,o=Math.min((i-e*(r-1))/r,30),s=o+e,l=r*s-e;return{side:o,paddedSide:s,padRatio:1-o/s,width:l,height:n*s-e,centeredOffset:Math.max((i-l)/2,0)}},t.dimensionsHorizontalBarChart=function(t){var e=24*t+20*(t-1);return{barHeight:24,padHeight:20,padRatio:1-24/44,outerRatio:0,axisOffset:-22,barGroupHeight:e,totalHeight:e+0}},t.dimensionsVerticalBarChart=function(t,e){var r=e-1,n=t*(1-.7)/((1-.7)*r+.7*e),a=(t-n*r)/e;a>48&&(n=(t-(a=48)*e)/r),n<2&&(n=2),n>100&&(n=100);var i=a*e+n*r;return{barWidth:a,padWidth:n,padRatio:1-a/(a+n),outerRatio:(t-i)/2/(a+n),barGroupWidth:i,totalWidth:t}},t.layoutPopulationPyramid=function(t,e){for(var r=Math.min(Zt(t),480),n=1*(e-1),a=Math.round((r-n)/e),i=e*(a=Math.max(a,2))+n,o=i-a,s=a+1,l=[];o>=0;)l.push(o),o-=s;var c=Math.min(t/2,.8*Zt.MAX_HEIGHT/2);return{barHeight:a,padding:1,totalHeight:i,positions:l,maxBarLength:c,chartPadding:Math.max((t-2*c)/2,1)}},t.layoutSmallMultiples=function(){return o().prop("width").prop("height").prop("paddingX").prop("paddingY").prop("rows").prop("cols").render(function(t){var r=e.select(this),n=r.props(),a=(n.width-n.paddingX*(n.cols-1))/n.cols,i=(n.height-n.paddingY*(n.rows-1))/n.rows,o=a/2,s=i/2,l=r.selectAll("g.sszvis-multiple").data(t),c=l.enter().append("g").classed("sszvis-g sszvis-multiple",!0);l.exit().remove();var u=(l=l.merge(c)).selectAll("g.sszvis-multiple-chart").data(function(t){return[t.values]}),p=u.enter().append("g").classed("sszvis-multiple-chart",!0);u.exit().remove(),u=u.merge(p),l.datum(function(t,e){return t.gx=e%n.cols*(a+n.paddingX),t.gw=a,t.cx=o,t.gy=Math.floor(e/n.cols)*(i+n.paddingY),t.gh=i,t.cy=s,t}).attr("transform",function(t){return"translate("+t.gx+","+t.gy+")"})})},t.layoutStackedAreaMultiples=function(t,e,r){r||(r=.1);for(var n=t/(e-r),a=n*(1-r),i=a,o=[];i-t<1;)o.push(i),i+=n;return{range:o,bandHeight:a,padHeight:n*r}},t.sankeyPrepareData=function(){var t=nt,r=nt,n=nt,a=[],i=yt("value"),o=function(t,r){return e.ascending(i(t),i(r))},s=function(t,r){return e.descending(i(t),i(r))},l=s,c=function(o){var c=a.reduce(function(t,e,r){return e.forEach(function(e){t.has(e)&&Nt("Duplicate column member id passed to sszvis.layout.sankey.prepareData.column:",e,"The existing value will be overwritten");var n={id:e,columnIndex:r,nodeIndex:0,value:0,valueOffset:0,linksFrom:[],linksTo:[]};t.set(e,n)}),t},e.map()),u=o.map(function(e){var a=t(e),i=r(e),o=+n(e)||0,s=c.get(a),l=c.get(i);if(!s)return Nt("Found invalid source column id:",a),null;if(!l)return Nt("Found invalid target column id:",i),null;var u={id:Fe(),value:o,src:s,srcOffset:0,tgt:l,tgtOffset:0};return s.linksFrom.push(u),l.linksTo.push(u),u}),p=c.values(),d=p.reduce(function(t,r){var n=e.sum(r.linksFrom,i),a=e.sum(r.linksTo,i);return r.value=Math.max(0,n,a),t[r.columnIndex]+=r.value,t},ct(a.length,0)),f=a.map(function(t){return t.length});return p.sort(l),u.sort(s),p.reduce(function(t,e){return e.valueOffset=t[0][e.columnIndex],e.nodeIndex=t[1][e.columnIndex],t[0][e.columnIndex]+=e.value,t[1][e.columnIndex]+=1,t},[ct(a.length,0),ct(a.length,0)]),p.forEach(function(t){t.linksFrom.sort(function(t,e){return t.tgt.nodeIndex-e.tgt.nodeIndex}),t.linksTo.sort(function(t,e){return t.src.nodeIndex-e.src.nodeIndex}),t.linksFrom.reduce(function(t,e){return e.srcOffset=t,t+i(e)},0),t.linksTo.reduce(function(t,e){return e.tgtOffset=t,t+i(e)},0)}),{nodes:p,links:u,columnTotals:d,columnLengths:f}};return c.apply=function(t){return c(t)},c.source=function(e){return t=e,c},c.target=function(t){return r=t,c},c.value=function(t){return n=t,c},c.descendingSort=function(){return l=s,c},c.ascendingSort=function(){return l=o,c},c.idLists=function(t){return a=t,c},c},t.sankeyLayout=function(t,r,n,a){var i=e.min(t.map(function(t){var e=.15*n/(t-1);return Math.max(12,Math.min(50,e))})),o=e.min(t.map(function(t,e){return Math.max(1,n-(t-1)*i)/r[e]})),s=i/o,l=i,c=e.max(r),u=t.map(function(t,e){return r[e]*o+(t-1)*l}),p=e.max(u),d=t.map(function(t,e){return(p-u[e])/2}),f=[0,c],h=[0,c*o],v=t.length;return{valuePadding:s,nodePadding:l,columnPaddings:d,valueDomain:f,valueRange:h,nodeThickness:20,columnDomain:[0,1],columnRange:[0,(a-20)/(v-1)]}},t.sunburstPrepareData=function(){function t(t){function i(t){return[].concat.apply([t],(t.children||[]).map(i))}r.rollup(pt);var o=e.hierarchy({isSunburstRoot:!0,values:r.entries(t)},yt("values")).sort(a).sum(function(t){return t.value?n(t.value):0});return e.partition()(o),i(o).filter(function(t){return!t.data.isSunburstRoot})}var r=e.nest(),n=nt,a=function(){return 0};return t.calculate=function(e){return t(e)},t.layer=function(e){return r.key(e),t},t.value=function(e){return n=e,t},t.sort=function(e){return a=e,t},t},t.sunburstLayout=function(t,e){var r=e/2,n=r/3;return{centerRadius:n,numLayers:t,ringWidth:Math.max(10,Math.min(60,(r-n)/t))}},t.sunburstGetRadiusExtent=function(t){return[e.min(t,function(t){return t.y0}),e.max(t,function(t){return t.y1})]},t.halfPixel=At,t.roundTransformString=function(t){var e=st(Math.floor,Number);return t.replace(/(translate\()\s*([0-9., ]+)\s*(\))/i,function(t,r,n,a){return r+n.replace(","," ").replace(/\s+/," ").split(" ").map(e).join(",")+a})},t.transformTranslateSubpixelShift=wt,t.ensureDefsElement=Te,t.modularTextHTML=Ee,t.modularTextSVG=Pe,t.textWrap=Ct,t.translateString=St,t.cascade=G,t.createHtmlLayer=function(t,r,n){r||(r=_()),n||(n={});var a="data-sszvis-html-"+(n.key||"default"),i=it(t)?t:e.select(t);i.classed("sszvis-outer-container",!0);var o=i.selectAll("[data-sszvis-html-layer]["+a+"]").data([0]),s=o.enter().append("div").classed("sszvis-html-layer",!0).attr("data-sszvis-html-layer","").attr(a,"");return(o=o.merge(s)).style("position","absolute").style("left",r.padding.left+"px").style("top",r.padding.top+"px"),o},t.formatAge=function(t){return String(Math.round(t))},t.formatAxisTimeFormat=Et,t.formatMonth=Pt,t.formatYear=Rt,t.formatNone=function(){return""},t.formatNumber=Lt,t.formatPreciseNumber=Bt,t.formatPercent=function(t){return Lt(t)+" %"},t.formatFractionPercent=function(t){return Lt(100*t)+" %"},t.formatText=Ot,t.defaultTransition=Le,t.fastTransition=function(){return e.transition().ease(Re).duration(50)},t.slowTransition=Be,t.buttonGroup=function(){return o().prop("values").prop("current").prop("width").width(300).prop("change").change(nt).render(function(){var t=e.select(this),r=t.props(),n=r.width/r.values.length,a=t.selectAll(".sszvis-control-optionSelectable").data(["sszvis-control-buttonGroup"],function(t){return t}),i=a.enter().append("div").classed("sszvis-control-optionSelectable",!0).classed("sszvis-control-buttonGroup",!0);a.exit().remove(),(a=a.merge(i)).style("width",r.width+"px");var o=a.selectAll(".sszvis-control-buttonGroup__item").data(r.values),s=o.enter().append("div").classed("sszvis-control-buttonGroup__item",!0);o.exit().remove(),(o=o.merge(s)).style("width",n+"px").classed("selected",function(t){return t===r.current}).text(function(t){return t}).on("click",r.change)})},t.handleRuler=function(){return o().prop("x",_t).prop("y",_t).prop("top").prop("bottom").prop("label").label(_t("")).prop("color").prop("flip",_t).flip(!1).render(function(t){var r=e.select(this),n=r.props(),a=st(At,n.x),i=st(At,n.y),o=n.bottom-4,s=n.top-24,l=r.selectAll(".sszvis-handleRuler__group").data([0]),c=l.enter().append("g").classed("sszvis-handleRuler__group",!0);l.exit().remove(),l=l.merge(c),c.append("line").classed("sszvis-ruler__rule",!0),c.append("rect").classed("sszvis-handleRuler__handle",!0),c.append("line").classed("sszvis-handleRuler__handle-mark",!0),l.selectAll(".sszvis-ruler__rule").attr("x1",a).attr("y1",At(n.top)).attr("x2",a).attr("y2",At(o)),l.selectAll(".sszvis-handleRuler__handle").attr("x",function(t){return a(t)-5}).attr("y",At(s)).attr("width",10).attr("height",24).attr("rx",2).attr("ry",2),l.selectAll(".sszvis-handleRuler__handle-mark").attr("x1",a).attr("y1",At(s+24*.15)).attr("x2",a).attr("y2",At(s+20.4));var u=l.selectAll(".sszvis-ruler__dot").data(t),p=u.enter().append("circle").classed("sszvis-ruler__dot",!0);u.exit().remove(),(u=u.merge(p)).attr("cx",a).attr("cy",i).attr("r",3.5).attr("fill",n.color);var d=r.selectAll(".sszvis-ruler__label-outline").data(t),f=d.enter().append("text").classed("sszvis-ruler__label-outline",!0);d.exit().remove(),d=d.merge(f);var h=r.selectAll(".sszvis-ruler__label").data(t),v=h.enter().append("text").classed("sszvis-ruler__label",!0);h.exit().remove(),h=h.merge(v),r.selectAll(".sszvis-ruler__label, .sszvis-ruler__label-outline").attr("transform",function(t){var e=st(At,n.x)(t),r=st(At,n.y)(t),a=n.flip(t)?-10:10,i=r<n.top+i?2*i:r>n.bottom-i?0:5;return St(e+a,r+i)}).style("text-anchor",function(t){return n.flip(t)?"end":"start"}).html(n.label)})},t.selectMenu=function(){return o().prop("values").prop("current").prop("width").width(300).prop("change").change(nt).render(function(){var t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-control-optionSelectable").data(["sszvis-control-select"],function(t){return t}),a=n.enter().append("div").classed("sszvis-control-optionSelectable",!0).classed("sszvis-control-select",!0);n.exit().remove(),(n=n.merge(a)).style("width",r.width+"px");var i=n.selectDiv("selectMetrics").classed("sszvis-control-select__metrics",!0),o=n.selectAll(".sszvis-control-select__element").data([1]),s=o.enter().append("select").classed("sszvis-control-select__element",!0).on("change",function(){var t=e.select(this).property("value");r.change(r.values[t]),setTimeout(function(){window.focus()},0)});(o=o.merge(s)).style("width",r.width+30+"px");var l=o.selectAll("option").data(r.values),c=l.enter().append("option");l.exit().remove(),l.merge(c).attr("selected",function(t){return t===r.current?"selected":null}).attr("value",function(t,e){return e}).text(function(t){return I(i,r.width-40,t)})})},t.slider=function(){return o().prop("scale").prop("value").prop("onchange").prop("minorTicks").minorTicks([]).prop("majorTicks").majorTicks([]).prop("tickLabels",_t).tickLabels(nt).prop("label",_t).label(nt).render(function(){var t=e.select(this),r=t.props(),n=At(18),a=r.scale.domain(),i=Dt(r.scale),o=r.scale.copy().range([i[0]+5.5,i[1]-5.5]),s=t.selectAll("g.sszvis-control-slider__backgroundgroup").data([1]),l=s.enter().append("g").classed("sszvis-control-slider__backgroundgroup",!0);(s=s.merge(l)).exit().remove();var c=It().scale(o).orient("bottom").hideBorderTickThreshold(0).tickSize(12).tickPadding(6).tickValues(bt([].concat(r.majorTicks,r.minorTicks))).tickFormat(function(t){return j(t,r.majorTicks)?r.tickLabels(t):""}),u=s.selectAll("g.sszvis-axisGroup").data([1]),p=u.enter().append("g").classed("sszvis-axisGroup sszvis-axis sszvis-axis--bottom sszvis-axis--slider",!0);(u=u.merge(p)).attr("transform",St(0,28)).call(c),u.selectAll(".tick line").filter(function(t){return!j(t,r.majorTicks)}).attr("y2",4);var d=u.selectAll(".tick text").filter(function(t){return j(t,r.majorTicks)}),f=d.size();d.style("text-anchor",function(t,e){return 0===e?"start":e===f-1?"end":"middle"});var h=s.selectAll("g.sszvis-slider__background").data([1]),v=h.enter().append("g").classed("sszvis-slider__background",!0);(h=h.merge(v)).attr("transform",St(0,n));var g=h.selectAll(".sszvis-slider__background__bg1").data([1]),m=g.enter().append("line").classed("sszvis-slider__background__bg1",!0).style("stroke-width",6).style("stroke","#888").style("stroke-linecap","round");(g=g.merge(m)).attr("x1",Math.ceil(i[0]+3)).attr("x2",Math.floor(i[1]-3));var y=h.selectAll(".sszvis-slider__background__bg2").data([1]),x=y.enter().append("line").classed("sszvis-slider__background__bg2",!0).style("stroke-width",5).style("stroke","#fff").style("stroke-linecap","round");(y=y.merge(x)).attr("x1",Math.ceil(i[0]+3)).attr("x2",Math.floor(i[1]-3));var b=h.selectAll(".sszvis-slider__backgroundshadow").data([r.value]),k=b.enter().append("line").attr("class","sszvis-slider__backgroundshadow").attr("stroke-width",5).style("stroke","#E0E0E0").style("stroke-linecap","round");(b=b.merge(k)).attr("x1",Math.ceil(i[0]+3)).attr("x2",st(Math.floor,o));var _=t.selectAll("g.sszvis-control-slider__handle").data([r.value]);_.exit().remove();var z=_.enter().append("g").classed("sszvis-control-slider__handle",!0);(_=_.merge(z)).attr("transform",function(t){return St(At(o(t)),.5)}),z.append("text").classed("sszvis-control-slider--label",!0),_.selectAll(".sszvis-control-slider--label").data(function(t){return[t]}).text(r.label).style("text-anchor",function(t){return kt(t,a[0])?"start":kt(t,a[1])?"end":"middle"}).attr("dx",function(t){return kt(t,a[0])?-5:kt(t,a[1])?5:0}),z.append("rect").classed("sszvis-control-slider__handlebox",!0).attr("x",-5).attr("y",n-11.5).attr("width",10).attr("height",23).attr("rx",2).attr("ry",2),z.append("line").classed("sszvis-control-slider__handleline",!0).attr("y1",n-7.5).attr("y2",n+7.5);var A=Ae().xScale(r.scale).yScale(e.scaleLinear().range([-11,40])).draggable(!0).on("drag",r.onchange);t.selectGroup("sliderInteraction").classed("sszvis-control-slider--interactionLayer",!0).attr("transform",St(0,4)).call(A)})},t.annotationCircle=function(){return o().prop("x",_t).prop("y",_t).prop("r",_t).prop("dx",_t).prop("dy",_t).prop("caption",_t).render(function(t){var r=e.select(this),n=r.props();Te(r,"pattern","data-area-pattern").call(He);var a=r.selectAll(".sszvis-dataareacircle").data(t),i=a.enter().append("circle").classed("sszvis-dataareacircle",!0);if((a=a.merge(i)).attr("cx",n.x).attr("cy",n.y).attr("r",n.r).attr("fill","url(#data-area-pattern)"),n.caption){var o=r.selectAll(".sszvis-dataareacircle__caption").data(t),s=o.enter().append("text").classed("sszvis-dataareacircle__caption",!0);(o=o.merge(s)).attr("x",n.x).attr("y",n.y).attr("dx",n.dx).attr("dy",n.dy).text(n.caption)}})},t.annotationLine=function(){return o().prop("x1").prop("x2").prop("y1").prop("y2").prop("xScale").prop("yScale").prop("dx",_t).dx(0).prop("dy",_t).dy(0).prop("caption",_t).render(function(t){var r=e.select(this),n=r.props(),a=n.xScale(n.x1),i=n.yScale(n.y1),o=n.xScale(n.x2),s=n.yScale(n.y2),l=r.selectAll(".sszvis-referenceline").data(t);l.exit().remove();var c=l.enter().append("line").classed("sszvis-referenceline",!0);if((l=l.merge(c)).attr("x1",a).attr("y1",i).attr("x2",o).attr("y2",s),n.caption){var u=r.selectAll(".sszvis-referenceline__caption").data([0]);u.exit().remove();var p=u.enter().append("text").classed("sszvis-referenceline__caption",!0);(u=u.merge(p)).attr("transform",function(){var t=o-a,e=s-i,r=180*Math.atan2(e,t)/Math.PI;return"translate("+(a+o)/2+","+(i+s)/2+") rotate("+r+")"}).attr("dx",n.dx).attr("dy",n.dy).text(n.caption)}})},t.annotationRangeFlag=function(){return o().prop("x",_t).prop("y0",_t).prop("y1",_t).render(function(t){var r=e.select(this),n=r.props(),a=st(At,n.x),i=st(At,n.y0),o=st(At,n.y1);r.selectAll(".sszvis-rangeFlag__mark.bottom").data(t).call(J("bottom",a,i)),r.selectAll(".sszvis-rangeFlag__mark.top").data(t).call(J("top",a,o));var s=Ge().position(function(t){return[a(t),At((n.y0(t)+n.y1(t))/2)]});r.call(s)})},t.annotationRangeRuler=function(){return o().prop("x",_t).prop("y0",_t).prop("y1",_t).prop("top").prop("bottom").prop("label").label(_t("")).prop("total").prop("flip",_t).flip(!1).render(function(t){var r=e.select(this),n=r.props(),a=st(At,n.x),i=st(At,n.y0),o=st(At,n.y1),s=r.selectAll(".sszvis-rangeRuler__rule").data([0]),l=s.enter().append("line").classed("sszvis-rangeRuler__rule",!0);s.exit().remove(),(s=s.merge(l)).attr("x1",a).attr("y1",n.top).attr("x2",a).attr("y2",n.bottom);var c=r.selectAll(".sszvis-rangeRuler--mark").data(t),u=c.enter().append("g").classed("sszvis-rangeRuler--mark",!0);c.exit().remove(),c=c.merge(u),u.append("circle").classed("sszvis-rangeRuler__p1",!0),u.append("circle").classed("sszvis-rangeRuler__p2",!0),u.append("text").classed("sszvis-rangeRuler__label",!0),c.selectAll(".sszvis-rangeRuler__p1").data(function(t){return[t]}).attr("cx",a).attr("cy",i).attr("r",1.5),c.selectAll(".sszvis-rangeRuler__p2").data(function(t){return[t]}).attr("cx",a).attr("cy",o).attr("r",1.5),c.selectAll(".sszvis-rangeRuler__label").data(function(t){return[t]}).attr("x",function(t){var e=n.flip(t)?-10:10;return a(t)+e}).attr("y",function(t){return At((n.y0(t)+n.y1(t))/2)}).attr("dy","0.35em").style("text-anchor",function(t){return n.flip(t)?"end":"start"}).text(st(Lt,n.label));var p=r.selectAll(".sszvis-rangeRuler__total").data([vt(t)]),d=p.enter().append("text").classed("sszvis-rangeRuler__total",!0);p.exit().remove(),(p=p.merge(d)).attr("x",function(t){var e=n.flip(t)?-10:10;return a(t)+e}).attr("y",n.top-10).style("text-anchor",function(t){return n.flip(t)?"end":"start"}).text("Total "+Lt(n.total))})},t.annotationRectangle=function(){return o().prop("x",_t).prop("y",_t).prop("width",_t).prop("height",_t).prop("dx",_t).prop("dy",_t).prop("caption",_t).render(function(t){var r=e.select(this),n=r.props();Te(r,"pattern","data-area-pattern").call(He);var a=r.selectAll(".sszvis-dataarearectangle").data(t),i=a.enter().append("rect").classed("sszvis-dataarearectangle",!0);if((a=a.merge(i)).attr("x",n.x).attr("y",n.y).attr("width",n.width).attr("height",n.height).attr("fill","url(#data-area-pattern)"),n.caption){var o=r.selectAll(".sszvis-dataarearectangle__caption").data(t),s=o.enter().append("text").classed("sszvis-dataarearectangle__caption",!0);(o=o.merge(s)).attr("x",function(t,e){return n.x(t,e)+n.width(t,e)/2}).attr("y",function(t,e){return n.y(t,e)+n.height(t,e)/2}).attr("dx",n.dx).attr("dy",n.dy).text(n.caption)}})},t.annotationRuler=function(){return o().prop("top").prop("bottom").prop("x",_t).prop("y",_t).prop("label").label(_t("")).prop("color").prop("flip",_t).flip(!1).prop("labelId",_t).prop("reduceOverlap").reduceOverlap(!1).render(function(t){var r=e.select(this),n=r.props(),a=n.labelId||function(t){return n.x(t)+"_"+n.y(t)},i=r.selectAll(".sszvis-ruler__rule").data(t,a),o=i.enter().append("line").classed("sszvis-ruler__rule",!0);i.exit().remove(),(i=i.merge(o)).attr("x1",st(At,n.x)).attr("y1",n.y).attr("x2",st(At,n.x)).attr("y2",n.bottom);var s=r.selectAll(".sszvis-ruler__dot").data(t,a),l=s.enter().append("circle").classed("sszvis-ruler__dot",!0);s.exit().remove(),(s=s.merge(l)).attr("cx",st(At,n.x)).attr("cy",st(At,n.y)).attr("r",3.5).attr("fill",n.color);var c=r.selectAll(".sszvis-ruler__label-outline").data(t,a),u=c.enter().append("text").classed("sszvis-ruler__label-outline",!0);c.exit().remove(),c=c.merge(u);var p=r.selectAll(".sszvis-ruler__label").data(t,a),d=p.enter().append("text").classed("sszvis-ruler__label",!0);p.exit().remove(),p=p.merge(d);var f=st(At,n.x),h=st(At,n.y),v=r.selectAll(".sszvis-ruler__label, .sszvis-ruler__label-outline").attr("transform",function(t){var e=f(t),r=h(t),a=n.flip(t)?-10:10,i=r<n.top+i?2*i:r>n.bottom-i?0:5;return St(e+a,r+i)}).style("text-anchor",function(t){return n.flip(t)?"end":"start"}).html(n.label);if(n.reduceOverlap){var g=10,m=[],y={};for(v.attr("y",""),p.each(function(t){var e=this.getBoundingClientRect(),r={top:e.top,bottom:e.bottom,dy:0};m.push(r),y[a(t)]=r}),m.sort(function(t,r){return e.ascending(t.top,r.top)});g--;)m.forEach(function(t,e){m.slice(e+1).forEach(function(e){var r=t.bottom-e.top;if(r>=2){var n=r/2;t.bottom-=n,t.top-=n,t.dy-=n,e.bottom+=n,e.top+=n,e.dy+=n}})});v.attr("y",function(t){return y[a(t)].dy})}})},t.tooltip=function(){var t=je();return o().delegate("header",t).delegate("body",t).delegate("orientation",t).delegate("dx",t).delegate("dy",t).delegate("opacity",t).prop("renderInto").prop("visible",_t).visible(!1).renderSelection(function(e){var r=e.props(),n=r.renderInto.node().getBoundingClientRect(),a=[];e.each(function(t){if(r.visible(t)){var e=this.getBoundingClientRect(),i=[e.left-n.left,e.top-n.top];a.push({datum:t,x:i[0],y:i[1]})}}),r.renderInto.datum(a).call(t)})},t.tooltipAnchor=Ge,t.fitTooltip=function(t,e){var r=Math.min(1*e.innerWidth/4,100),n=Math.max(3*e.innerWidth/4,e.innerWidth-100);return function(e){var a=e.x;return a>n?"right":a<r?"left":t}},t.bar=Je,t.dot=function(){return o().prop("x",_t).prop("y",_t).prop("radius").prop("stroke").prop("fill").prop("transition").transition(!0).render(function(t){var r=e.select(this),n=r.props(),a=r.selectAll(".sszvis-circle").data(t);a.exit().remove(),a.enter().append("circle").classed("sszvis-circle",!0).attr("cx",n.x).attr("cy",n.y).attr("r",n.radius).merge(a).attr("stroke",n.stroke).attr("fill",n.fill),n.transition&&(a=a.transition(Le())),a.attr("cx",n.x).attr("cy",n.y).attr("r",n.radius);var i=Ge().position(function(t){return[n.x(t),n.y(t)]});r.call(i)})},t.groupedBars=function(){return o().prop("groupScale").prop("groupSize").prop("groupWidth").prop("groupSpace").groupSpace(.05).prop("y",_t).prop("height").prop("fill").prop("stroke").prop("defined",_t).defined(!0).render(function(t){var r=e.select(this),n=r.props(),a=e.scaleBand().domain(e.range(n.groupSize)).padding(n.groupSpace).paddingOuter(0).rangeRound([0,n.groupWidth]),i=r.selectAll("g.sszvis-bargroup").data(t),o=i.enter().append("g").classed("sszvis-bargroup",!0);i.exit().remove();var s=(i=i.merge(o)).selectAll("g.sszvis-barunit").data(function(t){return t}),l=s.enter().append("g").classed("sszvis-barunit",!0);s.exit().remove(),(s=s.merge(l)).each(function(t,e){t.__sszvisGroupedBarIndex__=e});var c=s.filter(n.defined);c.selectAll("*").remove(),c.attr("transform",function(){return St(0,0)}),c.append("rect").classed("sszvis-bar",!0).attr("fill",n.fill).attr("x",function(t){return n.groupScale(t)+a(t.__sszvisGroupedBarIndex__)}).attr("y",n.y).attr("width",a.bandwidth()).attr("height",n.height);var u=s.filter(mt(n.defined));u.selectAll("*").remove(),u.attr("transform",function(t,e){return St(n.groupScale(t)+a(t.__sszvisGroupedBarIndex__)+a.bandwidth()/2,n.y(t,e))}),u.append("line").classed("sszvis-bar--missing line1",!0).attr("x1",-4).attr("y1",-4).attr("x2",4).attr("y2",4),u.append("line").classed("sszvis-bar--missing line2",!0).attr("x1",4).attr("y1",-4).attr("x2",-4).attr("y2",4);var p=Ge().position(function(t){var e=0,r=1/0;return t.forEach(function(t,i){e+=n.groupScale(t)+a(t.__sszvisGroupedBarIndex__)+a.bandwidth()/2,r=Math.min(r,n.y(t,i))}),[e/t.length,r]});r.call(p)})},t.line=function(){return o().prop("x").prop("y").prop("stroke").prop("strokeWidth").prop("defined").prop("key").key(function(t,e){return e}).prop("valuesAccessor").valuesAccessor(nt).prop("transition").transition(!0).render(function(t){var r=e.select(this),n=r.props(),a=e.line().defined(void 0!==n.defined?n.defined:st(mt(isNaN),n.y)).x(n.x).y(n.y),i=r.selectAll(".sszvis-line").data(t,n.key),o=i.enter().append("path").classed("sszvis-line",!0).style("stroke",n.stroke);(i=i.merge(o)).exit().remove(),i.order(),n.transition&&(i=i.transition(Le())),i.attr("d",st(a,n.valuesAccessor)).style("stroke",n.stroke).style("stroke-width",n.strokeWidth)})},t.pie=function(){return o().prop("radius").prop("fill").prop("stroke").prop("angle",_t).render(function(t){var r=e.select(this),n=r.props(),a=0;t.forEach(function(t){t._a0=a,isNaN(t.a0)&&(t.a0=a),a+=n.angle(t),t._a1=a,isNaN(t.a1)&&(t.a1=a)});var i=e.arc().innerRadius(4).outerRadius(n.radius).startAngle(function(t){return t.a0}).endAngle(function(t){return t.a1}),o=r.selectAll(".sszvis-path").each(function(e,r){t[r]&&(t[r].a0=e.a0,t[r].a1=e.a1)}).data(t),s=o.enter().append("path").classed("sszvis-path",!0).attr("transform","translate("+n.radius+","+n.radius+")").attr("fill",n.fill).attr("stroke",n.stroke);o.exit().remove(),(o=o.merge(s)).transition(Le()).attr("transform","translate("+n.radius+","+n.radius+")").attrTween("d",function(t){var r=e.interpolate(t.a0,t._a0),n=e.interpolate(t.a1,t._a1);return function(e){return t.a0=r(e),t.a1=n(e),i(t)}}).attr("fill",n.fill).attr("stroke",n.stroke);var l=Ge().position(function(t){var e=t.a0+Math.abs(t.a1-t.a0)/2-Math.PI/2,r=2*n.radius/3;return[n.radius+Math.cos(e)*r,n.radius+Math.sin(e)*r]});r.datum(t).call(l)})},t.pyramid=function(){return o().prop("barHeight",_t).prop("barWidth",_t).prop("barPosition",_t).prop("barFill",_t).barFill("#000").prop("tooltipAnchor").tooltipAnchor([.5,.5]).prop("leftAccessor").prop("rightAccessor").prop("leftRefAccessor").prop("rightRefAccessor").render(function(t){var r=e.select(this),n=r.props(),a=Je().x(function(t){return-.5-n.barWidth(t)}).y(n.barPosition).height(n.barHeight).width(n.barWidth).fill(n.barFill).tooltipAnchor(n.tooltipAnchor),i=Je().x(.5).y(n.barPosition).height(n.barHeight).width(n.barWidth).fill(n.barFill).tooltipAnchor(n.tooltipAnchor),o=X().barPosition(n.barPosition).barWidth(n.barWidth).mirror(!0),s=X().barPosition(n.barPosition).barWidth(n.barWidth);r.selectGroup("left").datum(n.leftAccessor(t)).call(a),r.selectGroup("right").datum(n.rightAccessor(t)).call(i),r.selectGroup("leftReference").datum(n.leftRefAccessor?[n.leftRefAccessor(t)]:[]).call(o),r.selectGroup("rightReference").datum(n.rightRefAccessor?[n.rightRefAccessor(t)]:[]).call(s)})},t.sankey=function(){return o().prop("sizeScale").prop("columnPosition").prop("nodeThickness").prop("nodePadding").prop("columnPadding",_t).prop("columnLabel",_t).columnLabel("").prop("columnLabelOffset",_t).columnLabelOffset(0).prop("linkCurvature").linkCurvature(.5).prop("nodeColor",_t).prop("linkColor",_t).prop("linkSort",_t).linkSort(function(t,e){return t.value-e.value}).prop("labelSide",_t).labelSide("left").prop("labelSideSwitch").prop("labelOpacity",_t).labelOpacity(1).prop("labelHitBoxSize").labelHitBoxSize(0).prop("nameLabel").nameLabel(nt).prop("linkSourceLabels").linkSourceLabels([]).prop("linkTargetLabels").linkTargetLabels([]).prop("linkLabel",_t).render(function(t){var r=e.select(this),n=r.props(),a=yt("id"),i=function(t){return Math.floor(n.columnPadding(t.columnIndex)+n.sizeScale(t.valueOffset)+n.nodePadding*t.nodeIndex)},o=function(t){return n.columnPosition(t.columnIndex)},s=function(t){return i(t)},l=function(){return Math.max(n.nodeThickness,1)},c=function(t){return Math.ceil(Math.max(n.sizeScale(t.value),1))},u=function(t,e,r,n,a,i){return"M"+t+","+a+"C"+e+","+a+" "+r+","+i+" "+n+","+i},p=function(t,e,r,n){return[t,e,r,n]},d=Je().x(o).y(s).width(l).height(c).fill(n.nodeColor),f=r.selectGroup("nodes").datum(t.nodes);f.call(d);var h=Ge().position(function(t){return[o(t)+l()/2,s(t)+c(t)/2]});f.call(h);var v=function(t){return n.columnPosition(t)+n.nodeThickness/2},g=f.selectAll(".sszvis-sankey-column-label").data(t.columnLengths),m=g.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-weak-label sszvis-sankey-column-label");(g=g.merge(m)).exit().remove(),g.attr("transform",function(t,e){return St(v(e)+n.columnLabelOffset(t,e),-24)}).text(function(t,e){return n.columnLabel(e)});var y=f.selectAll(".sszvis-sankey-column-label-tick").data(t.columnLengths),x=y.enter().append("line").attr("class","sszvis-sankey-column-label-tick");(y=y.merge(x)).exit().remove(),y.attr("x1",function(t,e){return At(v(e))}).attr("x2",function(t,e){return At(v(e))}).attr("y1",At(-16)).attr("y2",At(-12));var b=function(t){return[n.columnPosition(t.src.columnIndex)+n.nodeThickness+1,n.columnPosition(t.tgt.columnIndex)-1,i(t.src)+n.sizeScale(t.srcOffset)+n.sizeScale(t.value)/2,i(t.tgt)+n.sizeScale(t.tgtOffset)+n.sizeScale(t.value)/2]},k=function(t){var e=b(t);return p(e[0],e[1],e[2],e[3])},_=r.selectGroup("links"),z=_.selectAll(".sszvis-link").data(t.links,a),A=z.enter().append("path").attr("class","sszvis-link");(z=z.merge(A)).exit().remove(),z.attr("fill","none").attr("d",function(t){var r=b(t),a=e.interpolateNumber(r[0],r[1]),i=a(n.linkCurvature),o=a(1-n.linkCurvature);return u(r[0],i,o,r[1],r[2],r[3])}).attr("stroke-width",function(t){return Math.max(n.sizeScale(t.value),1)}).attr("stroke",n.linkColor).sort(n.linkSort),_.datum(t.links);var w=Ge().position(function(t){var e=k(t);return[(e[0]+e[1])/2,(e[2]+e[3])/2]});_.call(w);var S=r.selectGroup("linklabels"),C=S.selectAll(".sszvis-sankey-link-source-label").data(n.linkSourceLabels),M=C.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-strong-label sszvis-sankey-link-source-label");(C=C.merge(M)).exit().remove(),C.attr("transform",function(t){var e=k(t);return St(e[0]+6,e[2])}).text(n.linkLabel);var F=S.selectAll(".sszvis-sankey-link-target-label").data(n.linkTargetLabels),T=F.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-strong-label sszvis-sankey-link-target-label");(F=F.merge(T)).exit().remove(),F.attr("transform",function(t){var e=k(t);return St(e[1]-6,e[3])}).text(n.linkLabel);var E=function(t){var e=n.labelSide(t);return n.labelSideSwitch&&(e="left"===e?"right":"left"),e},P=r.selectGroup("nodelabels"),R=P.selectAll(".sszvis-sankey-node-label").data(t.nodes),L=R.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-weak-label sszvis-sankey-node-label");(R=R.merge(L)).exit().remove(),R.text(function(t){return n.nameLabel(t.id)}).attr("text-align","middle").attr("text-anchor",function(t){return"left"===E(t.columnIndex)?"end":"start"}).attr("x",function(t){return"left"===E(t.columnIndex)?o(t)-6:o(t)+n.nodeThickness+6}).attr("y",function(t){return s(t)+c(t)/2}).style("opacity",n.labelOpacity);var B=P.selectAll(".sszvis-sankey-hitbox").data(t.nodes),O=B.enter().append("rect").attr("class","sszvis-sankey-hitbox");(B=B.merge(O)).exit().remove(),B.attr("fill","transparent").attr("x",function(t){return o(t)+("left"===E(t.columnIndex)?-n.labelHitBoxSize:0)}).attr("y",function(t){return s(t)-n.nodePadding/2}).attr("width",n.labelHitBoxSize+n.nodeThickness).attr("height",function(t){return c(t)+n.nodePadding})})},t.stackedArea=function(){return o().prop("x").prop("y0").prop("y1").prop("fill").prop("stroke").prop("defined").prop("key").key(function(t,e){return e}).prop("transition").transition(!0).render(function(t){var r=e.select(this),n=r.props(),a=e.area().defined(void 0!==n.defined?n.defined:function(){return st(mt(isNaN),n.y0)&&st(mt(isNaN),n.y1)}).x(n.x).y0(n.y0).y1(n.y1),i=r.selectAll("path.sszvis-path").data(t,n.key),o=i.enter().append("path").classed("sszvis-path",!0);i.exit().remove(),i=i.merge(o),n.transition&&(i=i.transition(Le())),i.attr("d",a).attr("fill",n.fill).attr("stroke",n.stroke)})},t.stackedAreaMultiples=function(){return o().prop("x").prop("y0").prop("y1").prop("fill").prop("stroke").prop("defined").prop("key").key(function(t,e){return e}).prop("valuesAccessor").valuesAccessor(nt).prop("transition").transition(!0).render(function(t){var r=e.select(this),n=r.props();t=t.slice().reverse();var a=e.area().defined(void 0!==n.defined?n.defined:function(){return st(mt(isNaN),n.y0)&&st(mt(isNaN),n.y1)}).x(n.x).y0(n.y0).y1(n.y1),i=r.selectAll("path.sszvis-path").data(t,n.key),o=i.enter().append("path").classed("sszvis-path",!0);i.exit().remove(),i=o.merge(i),n.transition&&(i=i.transition(Le())),i.attr("d",st(a,n.valuesAccessor)).attr("fill",n.fill).attr("stroke",n.stroke)})},t.sunburst=function(){return o().prop("angleScale").angleScale(e.scaleLinear().range([0,2*Math.PI])).prop("radiusScale").prop("centerRadius").prop("fill").prop("stroke").stroke("white").render(function(t){function r(t){if(t.data.isSunburstRoot)return"transparent";if(t.parent){if(t.parent.data.isSunburstRoot)return e.hsl(a.fill(t.data.key));var n=r(t.parent);return n.l*=1.15,n}return Nt("Data passed to sszvis.component.sunburst does not have the expected tree structure. You should prepare it using sszvis.format.sunburst.prepareData"),e.hsl(a.fill(t.data.key))}var n=e.select(this),a=n.props(),i=function(t){return Math.max(0,Math.min(er,a.angleScale(t.x0)))},o=function(t){return Math.max(0,Math.min(er,a.angleScale(t.x1)))},s=function(t){return a.centerRadius+Math.max(0,a.radiusScale(t.y0))},l=function(t){return a.centerRadius+Math.max(0,a.radiusScale(t.y1))},c=e.arc().startAngle(i).endAngle(o).innerRadius(s).outerRadius(l);t.forEach(function(t){t._x0=t.x0,t._x1=t.x1});var u=n.selectAll(".sszvis-sunburst-arc").each(function(e,r){t[r]&&(t[r].x0=e.x0,t[r].x1=e.x1)}).data(t),p=u.enter().append("path").attr("class","sszvis-sunburst-arc");u.exit().remove(),(u=u.merge(p)).attr("stroke",a.stroke).attr("fill",r),u.transition(Le()).attrTween("d",function(t){var r=e.interpolate(t.x0,t._x0),n=e.interpolate(t.x1,t._x1);return function(e){return t.x0=r(e),t.x1=n(e),c(t)}});var d=Ge().position(function(t){var e=i(t),r=o(t),n=e+Math.abs(r-e)/2-Math.PI/2,a=(s(t)+l(t))/2;return[Math.cos(n)*a,Math.sin(n)*a]});n.call(d)})},t.stackedBarHorizontalData=Ke,t.stackedBarVerticalData=Xe,t.stackedBarHorizontal=function(){return Q(qe)},t.stackedBarVertical=function(){return Q(Qe)},t.stackedPyramidData=function(t,r,n,a){return function(i){var o=G().arrayBy(t).arrayBy(r).objectBy(n).apply(i).map(function(r){var n=Object.keys(r[0]),i=t(r[0][n[0]][0]),o=e.stack().keys(n).value(function(t,e){return a(t[e][0])})(r);return o.forEach(function(t,e){t.forEach(function(t,r){return t.data=t.data[n[e]][0],t.series=n[e],t.side=i,t.row=r,t.value=a(t.data),t})}),o});return o.maxValue=e.max(o,function(t){return e.max(t,function(t){return e.max(t,function(t){return t[1]})})}),o}},t.stackedPyramid=function(){return o().prop("barHeight",_t).prop("barWidth",_t).prop("barPosition",_t).prop("barFill",_t).barFill("#000").prop("tooltipAnchor").tooltipAnchor([.5,.5]).prop("leftAccessor").prop("rightAccessor").prop("leftRefAccessor").prop("rightRefAccessor").render(function(t){var r=e.select(this),n=r.props(),a=Je().x(function(t){return-Ze-n.barWidth(t[1])}).y(st(n.barPosition,tr)).height(n.barHeight).width(function(t){return n.barWidth(t[1])-n.barWidth(t[0])}).fill(st(n.barFill,$e)).tooltipAnchor(n.tooltipAnchor),i=Je().x(function(t){return Ze+n.barWidth(t[0])}).y(st(n.barPosition,tr)).height(n.barHeight).width(function(t){return n.barWidth(t[1])-n.barWidth(t[0])}).fill(st(n.barFill,$e)).tooltipAnchor(n.tooltipAnchor),o=Z().stackElement(a),s=Z().stackElement(i),l=$().barPosition(n.barPosition).barWidth(n.barWidth).mirror(!0),c=$().barPosition(n.barPosition).barWidth(n.barWidth);r.selectGroup("leftStack").datum(n.leftAccessor(t)).call(o),r.selectGroup("rightStack").datum(n.rightAccessor(t)).call(s),r.selectGroup("leftReference").datum(n.leftRefAccessor?[n.leftRefAccessor(t)]:[]).call(l),r.selectGroup("rightReference").datum(n.rightRefAccessor?[n.rightRefAccessor(t)]:[]).call(c)})},t.legendColorBinned=function(){return o().prop("scale").prop("displayValues").prop("endpoints").prop("width").width(200).prop("labelFormat").labelFormat(nt).render(function(){var t=e.select(this),r=t.props();if(!r.scale)return Wt("legend.binnedColorScale - a scale must be specified.");if(!r.displayValues)return Wt("legend.binnedColorScale - display values must be specified.");if(!r.endpoints)return Wt("legend.binnedColorScale - endpoints must be specified");var n=[0,r.width-10],a=e.scaleLinear().domain(r.endpoints).range(n),i=0,o=[],s=r.endpoints[0];r.displayValues.forEach(function(t){var e=a(t)-i,n=i%1;o.push({x:Math.floor(5+i),w:e+n,c:r.scale(s),p:t}),i+=e,s=t}),o.push({x:Math.floor(5+i),w:n[1]-i,c:r.scale(s)});var l=t.selectAll("circle.sszvis-legend__circle").data(r.endpoints),c=l.enter().append("circle").classed("sszvis-legend__circle",!0);(l=l.merge(c)).exit().remove(),l.attr("r",5).attr("cy",5).attr("cx",function(t,e){return 0===e?5:r.width-5}).attr("fill",r.scale);var u=t.selectAll("rect.sszvis-legend__crispmark").data(o),p=u.enter().append("rect").classed("sszvis-legend__crispmark",!0);(u=u.merge(p)).exit().remove(),u.attr("x",function(t){return t.x}).attr("y",0).attr("width",function(t){return t.w}).attr("height",10).attr("fill",function(t){return t.c});var d=o.slice(0,-1),f=t.selectAll("line.sszvis-legend__crispmark").data(d),h=f.enter().append("line").classed("sszvis-legend__crispmark",!0);f.merge(h),f.exit().remove(),f.attr("x1",function(t){return At(t.x+t.w)}).attr("x2",function(t){return At(t.x+t.w)}).attr("y1",11).attr("y2",16).attr("stroke","#B8B8B8");var v=t.selectAll(".sszvis-legend__axislabel").data(d),g=v.enter().append("text").classed("sszvis-legend__axislabel",!0);(v=v.merge(g)).exit().remove(),v.style("text-anchor","middle").attr("transform",function(t){return"translate("+(t.x+t.w)+",30)"}).text(function(t){return r.labelFormat(t.p)})})},t.legendColorLinear=function(){return o().prop("scale").prop("displayValues").displayValues([]).prop("width").width(200).prop("segments").segments(8).prop("labelText").prop("labelFormat").labelFormat(nt).render(function(){var t=e.select(this),r=t.props();if(!r.scale)return Wt("legend.linearColorScale - a scale must be specified."),!1;var n=r.scale.domain(),a=r.displayValues;!a.length&&r.scale.ticks&&(a=r.scale.ticks(r.segments-1)),a.push(vt(n));var i=a.length>0?r.width/a.length:0,o=t.selectAll("rect.sszvis-legend__mark").data(a),s=o.enter().append("rect").classed("sszvis-legend__mark",!0);o.exit().remove(),(o=o.merge(s)).attr("x",function(t,e){return e*i-1}).attr("y",0).attr("width",i+1).attr("height",10).attr("fill",function(t){return r.scale(t)});var l=[pt(n),vt(n)],c=r.labelText||l,u=t.selectAll("circle.ssvis-legend--mark").data(l),p=u.enter().append("circle").attr("class","ssvis-legend--mark");u.exit().remove(),(u=u.merge(p)).attr("cx",function(t,e){return e*r.width}).attr("cy",5).attr("r",5).attr("fill",function(t){return r.scale(t)});var d=t.selectAll(".sszvis-legend__label").data(c),f=d.enter().append("text").classed("sszvis-legend__label",!0);d.exit().remove(),(d=d.merge(f)).style("text-anchor",function(t,e){return 0===e?"end":"start"}).attr("dy","0.35em").attr("transform",function(t,e){return"translate("+(e*r.width+16*(0===e?-1:1))+", 5)"}).text(function(t,e){return r.labelFormat(t,e)})})},t.legendColorOrdinal=function(){return o().prop("scale").prop("rowHeight").rowHeight(21).prop("columnWidth").columnWidth(200).prop("rows").rows(3).prop("columns").columns(3).prop("verticallyCentered").verticallyCentered(!1).prop("orientation").prop("reverse").reverse(!1).prop("rightAlign").rightAlign(!1).prop("horizontalFloat").horizontalFloat(!1).prop("floatPadding").floatPadding(20).prop("floatWidth").floatWidth(600).render(function(){var t=e.select(this),r=t.props(),n=r.scale.domain();r.reverse&&(n=n.slice().reverse());var a,i;"horizontal"===r.orientation?(i=Math.ceil(r.columns),a=Math.ceil(n.length/i)):"vertical"===r.orientation&&(a=Math.ceil(r.rows),i=Math.ceil(n.length/a));var o=t.selectAll(".sszvis-legend--entry").data(n),s=o.enter().append("g").classed("sszvis-legend--entry",!0);o.exit().remove();var l=o.merge(s).selectAll(".sszvis-legend__mark").data(function(t){return[t]}),c=l.enter().append("circle").classed("sszvis-legend__mark",!0);l.exit().remove(),l.merge(c).attr("cx",r.rightAlign?-5:5).attr("cy",At(r.rowHeight/2)).attr("r",5).attr("fill",function(t){return r.scale(t)}).attr("stroke",function(t){return r.scale(t)}).attr("stroke-width",1);var u=o.merge(s).selectAll(".sszvis-legend__label").data(function(t){return[t]}),p=u.enter().append("text").classed("sszvis-legend__label",!0);u.exit().remove(),u.merge(p).text(function(t){return t}).attr("dy","0.35em").style("text-anchor",function(){return r.rightAlign?"end":"start"}).attr("transform",function(){var t=r.rightAlign?-18:18,e=At(r.rowHeight/2);return St(t,e)});var d="";if(r.verticallyCentered&&(d="translate(0,"+String(-n.length*r.rowHeight/2)+") "),r.horizontalFloat){var f=0,h=0;o.merge(s).attr("transform",function(){var t=this.getBoundingClientRect().width;h+t>r.floatWidth&&(f+=r.rowHeight,h=0);var e=St(h,f);return h+=t+r.floatPadding,d+e})}else o.merge(s).attr("transform",function(t,e){return"horizontal"===r.orientation?d+"translate("+e%i*r.columnWidth+","+Math.floor(e/i)*r.rowHeight+")":"vertical"===r.orientation?d+"translate("+Math.floor(e/a)*r.columnWidth+","+e%a*r.rowHeight+")":void 0})})},t.legendRadius=function(){return o().prop("scale").prop("tickFormat").tickFormat(nt).prop("tickValues").render(function(){function t(t){return o-2*n.scale(t)}var r=e.select(this),n=r.props(),a=n.scale.domain(),i=n.tickValues||[a[1],n.scale.invert(e.mean(n.scale.range())),a[0]],o=Dt(n.scale)[1],s=r.selectAll("g.sszvis-legend__elementgroup").data([0]),l=s.enter().append("g").attr("class","sszvis-legend__elementgroup");(s=s.merge(l)).attr("transform",St(At(o),At(o)));var c=s.selectAll("circle.sszvis-legend__greyline").data(i),u=c.enter().append("circle").classed("sszvis-legend__greyline",!0);c.exit().remove(),(c=c.merge(u)).attr("r",n.scale).attr("stroke-width",1).attr("cy",function(t){return o-n.scale(t)});var p=s.selectAll("line.sszvis-legend__dashedline").data(i),d=p.enter().append("line").classed("sszvis-legend__dashedline",!0);p.exit().remove(),(p=p.merge(d)).attr("x1",0).attr("y1",t).attr("x2",o+15).attr("y2",t);var f=s.selectAll(".sszvis-legend__label").data(i),h=f.enter().append("text").attr("class","sszvis-legend__label sszvis-legend__label--small");f.exit().remove(),(f=f.merge(h)).attr("dx",o+18).attr("y",t).attr("dy","0.35em").text(n.tickFormat)})},t.responsiveProps=function(){function t(t){if(!ht(t)||!tt(t))return Nt("Could not determine the current breakpoint, returning the default props"),Object.keys(r).reduce(function(t,e,r){return t[r]=e._,t},{});var n=g(e,t);return Object.keys(r).reduce(function(a,i){var o=r[i];if(!rt(o,e))return Nt('responsiveProps was given an invalid propSpec for property: "'+i+'". The spec: ',o),a;var s=ut(function(t){return lt(o[t.name])},n);return a[i]=o[s.name](t.width),a},{})}var e=Vt(),r={};return t.prop=function(e,n){return r[e]=et(n),t},t.breakpoints=function(r){return 0===arguments.length?e:(e=m(r),t)},t},t.range=Dt,t.locale=Mt,t.breakpointFind=f,t.breakpointFindByName=h,t.breakpointTest=v,t.breakpointMatch=g,t.breakpointCreateSpec=m,t.breakpointDefaultSpec=Vt,t.breakpointPalm=Yt,t.breakpointLap=Ut,t.heatTableMissingValuePattern=function(t){var e=ve();t.attr("patternUnits","objectBoundingBox").attr("patternContentUnits","objectBoundingBox").attr("x",0).attr("y",0).attr("width",1).attr("height",1),t.append("rect").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("fill",e),t.append("line").attr("x1",.35).attr("y1",.35).attr("x2",.65).attr("y2",.65).attr("stroke-width",.035).attr("stroke","#A4A4A4"),t.append("line").attr("x1",.65).attr("y1",.35).attr("x2",.35).attr("y2",.65).attr("stroke-width",.035).attr("stroke","#A4A4A4")},t.mapMissingValuePattern=Oe,t.mapLakePattern=De,t.mapLakeFadeGradient=Ne,t.mapLakeGradientMask=We,t.dataAreaPattern=He,t.mapRendererBubble=function(){var t=e.dispatch("over","out","click"),r=o().prop("mergedData").prop("mapPath").prop("radius",_t).prop("fill",_t).prop("strokeColor",_t).strokeColor("#ffffff").prop("strokeWidth",_t).strokeWidth(1).prop("transition").transition(!0).render(function(){var r=e.select(this),n=r.props(),a=st(n.radius,or),i=r.selectGroup("anchoredCircles").selectAll(".sszvis-anchored-circle").data(n.mergedData,function(t){return t.geoJson.id});if(i.enter().append("circle").attr("class","sszvis-anchored-circle sszvis-anchored-circle--entering").attr("r",a).on("mouseover",function(e){t.call("over",this,e.datum)}).on("mouseout",function(e){t.call("out",this,e.datum)}).on("click",function(e){t.call("click",this,e.datum)}).merge(i).attr("transform",function(t){var e=n.mapPath.projection()(ir(t.geoJson));return St(e[0],e[1])}).style("fill",function(t){return n.fill(t.datum)}).style("stroke",function(t){return n.strokeColor(t.datum)}).style("stroke-width",function(t){return n.strokeWidth(t.datum)}).sort(function(t,e){return n.radius(e.datum)-n.radius(t.datum)}),i.classed("sszvis-anchored-circle--entering",!1),n.transition){var o=Le();i.exit().transition(o).attr("r",0).remove(),i.transition(o).attr("r",a)}else i.exit().remove(),i.attr("r",a)});return r.on=function(){var e=t.on.apply(t,arguments);return e===t?r:e},r},t.mapRendererBase=sr,t.mapRendererGeoJson=function(){var t=e.dispatch("over","out","click"),r=o().prop("dataKeyName").dataKeyName("geoId").prop("geoJsonKeyName").geoJsonKeyName("id").prop("geoJson").prop("mapPath").prop("defined",_t).defined(!0).prop("fill",_t).fill("black").prop("stroke",_t).stroke("black").prop("strokeWidth",_t).strokeWidth(1.25).prop("transitionColor").transitionColor(!0).render(function(r){function n(t){return lt(t.datum)&&i.defined(t.datum)?i.fill(t.datum):"url(#missing-pattern)"}var a=e.select(this),i=a.props();Te(a,"pattern","missing-pattern").call(Oe);var o=yt(i.dataKeyName),s=yt(i.geoJsonKeyName),l=r.reduce(function(t,e){return t[o(e)]=e,t}),c=i.geoJson.features.map(function(t){return{geoJson:t,datum:l[s(t.properties)]}}),u=a.selectAll(".sszvis-map__geojsonelement").data(c),p=u.enter().append("path").classed("sszvis-map__geojsonelement",!0).attr("data-event-target","").attr("fill",n);u.exit().remove(),u=u.merge(p),a.selectAll(".sszvis-map__geojsonelement--undefined").attr("fill",n),u.classed("sszvis-map__geojsonelement--undefined",function(t){return!lt(t.datum)||!i.defined(t.datum)}).attr("d",function(t){return i.mapPath(t.geoJson)}),i.transitionColor?u.transition().call(Be).attr("fill",n):u.attr("fill",n),u.attr("stroke",function(t){return lt(t.datum)&&i.defined(t.datum)?i.stroke(t.datum):""}).attr("stroke-width",i.strokeWidth),a.selectAll("[data-event-target]").on("mouseover",function(e){t.over(e.datum)}).on("mouseout",function(e){t.out(e.datum)}).on("click",function(e){t.click(e.datum)});var d=Ge().position(function(t){t.geoJson.properties||(t.geoJson.properties={});var r=t.geoJson.properties.sphericalCentroid;return r||(t.geoJson.properties.sphericalCentroid=r=e.geoCentroid(t.geoJson)),i.mapPath.projection()(r)});a.selectGroup("tooltipAnchors").datum(c).call(d)});return r.on=function(){var e=t.on.apply(t,arguments);return e===t?r:e},r},t.mapRendererHighlight=lr,t.mapRendererImage=function(){return o().prop("projection").prop("src").prop("geoBounds").prop("opacity").opacity(1).render(function(){var t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-map__image").data([0]),a=n.enter().append("img").classed("sszvis-map__image",!0);n.exit().remove(),n=n.merge(a);var i=r.projection(r.geoBounds[0]),o=r.projection(r.geoBounds[1]);n.attr("src",r.src).style("left",Math.round(i[0])+"px").style("top",Math.round(i[1])+"px").style("width",Math.round(o[0]-i[0])+"px").style("height",Math.round(o[1]-i[1])+"px").style("opacity",r.opacity)})},t.mapRendererMesh=cr,t.mapRendererPatternedLakeOverlay=ur,t.mapRendererRaster=function(){return o().prop("debug").debug(!1).prop("width").prop("height").prop("position").prop("cellSide").cellSide(2).prop("fill",_t).prop("opacity").opacity(1).render(function(t){var r=e.select(this),n=r.props(),a=r.selectAll(".sszvis-map__rasterimage").data([0]),i=a.enter().append("canvas").classed("sszvis-map__rasterimage",!0);a.exit().remove(),(a=a.merge(i)).attr("width",n.width).attr("height",n.height).style("opacity",n.opacity);var o=a.node().getContext("2d");o.clearRect(0,0,n.width,n.height),n.debug&&(o.fillStyle="rgba(255, 0, 0, 0.2)",o.fillRect(0,0,n.width,n.height));var s=n.cellSide/2;t.forEach(function(t){var e=n.position(t);o.fillStyle=n.fill(t),o.fillRect(e[0]-s,e[1]-s,n.cellSide,n.cellSide)})})},t.STADT_KREISE_KEY="zurichStadtKreise",t.STATISTISCHE_QUARTIERE_KEY="zurichStatistischeQuartiere",t.STATISTISCHE_ZONEN_KEY="zurichStatistischeZonen",t.WAHL_KREISE_KEY="zurichWahlKreise",t.AGGLOMERATION_2012_KEY="zurichAgglomeration2012",t.SWITZERLAND_KEY="switzerland",t.swissMapProjection=rr,t.swissMapPath=nr,t.pixelsFromGeoDistance=function(t,e,r){var n=r/(2*Math.PI*6367475)*360/2,a=[[e[0]-n,e[1]-n],[e[0]+n,e[1]+n]].map(t);return(Math.abs(a[1][0]-a[0][0])+Math.abs(a[1][1]-a[0][1]))/2},t.GEO_KEY_DEFAULT="geoId",t.prepareMergedGeoData=ar,t.getGeoJsonCenter=ir,t.widthAdaptiveMapPathStroke=function(t){return Math.min(Math.max(.8,t/400),1.1)},t.viewport=fr,t.choropleth=function(){var t=e.dispatch("over","out","click"),r=sr(),n=cr(),a=ur(),i=lr(),s=o().prop("width").prop("height").prop("keyName").keyName("geoId").prop("withLake").withLake(!0).prop("anchoredShape").prop("features").prop("borders").prop("lakeFeatures").prop("lakeBorders").prop("lakeFadeOut").lakeFadeOut(!1).delegate("defined",r).delegate("fill",r).delegate("transitionColor",r).delegate("borderColor",n).delegate("strokeWidth",n).delegate("highlight",i).delegate("highlightStroke",i).delegate("highlightStrokeWidth",i).delegate("lakePathColor",a).render(function(o){var s=e.select(this),l=s.props(),c=nr(l.width,l.height,l.features,"zurichStadtfeatures"),u=ar(o,l.features,l.keyName);r.geoJson(l.features).mergedData(u).mapPath(c),n.geoJson(l.borders).mapPath(c),a.lakeFeature(l.lakeFeatures).lakeBounds(l.lakeBorders).mapPath(c).fadeOut(l.lakeFadeOut),i.geoJson(l.features).keyName(l.keyName).mapPath(c),s.call(r).call(n),l.withLake&&s.call(a),s.call(i),l.anchoredShape&&(l.anchoredShape.mergedData(u).mapPath(c),s.call(l.anchoredShape)),s.selectAll("[data-event-target]").on("mouseover",function(e){t.call("over",this,e.datum)}).on("mouseout",function(e){t.call("out",this,e.datum)}).on("click",function(e){t.call("click",this,e.datum)})});return s.on=function(){var e=t.on.apply(t,arguments);return e===t?s:e},s},Object.defineProperty(t,"__esModule",{value:!0})});
