/*! sszvis v2.1.1, Copyright 2014-present Statistik Stadt Zürich */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],e):e((t=t||self).sszvis={},t.d3)}(this,(function(t,e){"use strict";var r="default"in e?e.default:e;function n(t){var e=this.constructor;return this.then((function(r){return e.resolve(t()).then((function(){return r}))}),(function(r){return e.resolve(t()).then((function(){return e.reject(r)}))}))}var a=setTimeout;function o(t){return Boolean(t&&void 0!==t.length)}function i(){}function s(t){if(!(this instanceof s))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(t,this)}function l(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,s._immediateFn((function(){var r=1===t._state?e.onFulfilled:e.onRejected;if(null!==r){var n;try{n=r(t._value)}catch(t){return void u(e.promise,t)}c(e.promise,n)}else(1===t._state?c:u)(e.promise,t._value)}))):t._deferreds.push(e)}function c(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if(e instanceof s)return t._state=3,t._value=e,void p(t);if("function"==typeof r)return void f((n=r,a=e,function(){n.apply(a,arguments)}),t)}t._state=1,t._value=e,p(t)}catch(e){u(t,e)}var n,a}function u(t,e){t._state=2,t._value=e,p(t)}function p(t){2===t._state&&0===t._deferreds.length&&s._immediateFn((function(){t._handled||s._unhandledRejectionFn(t._value)}));for(var e=0,r=t._deferreds.length;e<r;e++)l(t,t._deferreds[e]);t._deferreds=null}function d(t,e,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=r}function f(t,e){var r=!1;try{t((function(t){r||(r=!0,c(e,t))}),(function(t){r||(r=!0,u(e,t))}))}catch(t){if(r)return;r=!0,u(e,t)}}s.prototype.catch=function(t){return this.then(null,t)},s.prototype.then=function(t,e){var r=new this.constructor(i);return l(this,new d(t,e,r)),r},s.prototype.finally=n,s.all=function(t){return new s((function(e,r){if(!o(t))return r(new TypeError("Promise.all accepts an array"));var n=Array.prototype.slice.call(t);if(0===n.length)return e([]);var a=n.length;function i(t,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var s=o.then;if("function"==typeof s)return void s.call(o,(function(e){i(t,e)}),r)}n[t]=o,0==--a&&e(n)}catch(t){r(t)}}for(var s=0;s<n.length;s++)i(s,n[s])}))},s.resolve=function(t){return t&&"object"==typeof t&&t.constructor===s?t:new s((function(e){e(t)}))},s.reject=function(t){return new s((function(e,r){r(t)}))},s.race=function(t){return new s((function(e,r){if(!o(t))return r(new TypeError("Promise.race accepts an array"));for(var n=0,a=t.length;n<a;n++)s.resolve(t[n]).then(e,r)}))},s._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){a(t,0)},s._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var h=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();"Promise"in h?h.Promise.prototype.finally||(h.Promise.prototype.finally=n):h.Promise=s;var v="undefined"!=typeof self?self:window,m="URLSearchParams"in v,g="Symbol"in v&&"iterator"in Symbol,y="FileReader"in v&&"Blob"in v&&function(){try{return new Blob,!0}catch(t){return!1}}(),b="FormData"in v,x="ArrayBuffer"in v;if(x)var k=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(t){return t&&k.indexOf(Object.prototype.toString.call(t))>-1};function w(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function z(t){return"string"!=typeof t&&(t=String(t)),t}function A(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return g&&(e[Symbol.iterator]=function(){return e}),e}function S(t){this.map={},t instanceof S?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function T(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function C(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function E(t){var e=new FileReader,r=C(e);return e.readAsArrayBuffer(t),r}function F(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function P(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:y&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:b&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:m&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():x&&y&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=F(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):x&&(ArrayBuffer.prototype.isPrototypeOf(t)||_(t))?this._bodyArrayBuffer=F(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):m&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y&&(this.blob=function(){var t=T(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?T(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(E)}),this.text=function(){var t,e,r,n=T(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,r=C(e),e.readAsText(t),r;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},b&&(this.formData=function(){return this.text().then(B)}),this.json=function(){return this.text().then(JSON.parse)},this}S.prototype.append=function(t,e){t=w(t),e=z(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},S.prototype.delete=function(t){delete this.map[w(t)]},S.prototype.get=function(t){return t=w(t),this.has(t)?this.map[t]:null},S.prototype.has=function(t){return this.map.hasOwnProperty(w(t))},S.prototype.set=function(t,e){this.map[w(t)]=z(e)},S.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},S.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),A(t)},S.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),A(t)},S.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),A(t)},g&&(S.prototype[Symbol.iterator]=S.prototype.entries);var M=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function R(t,e){var r,n,a=(e=e||{}).body;if(t instanceof R){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new S(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,a||null==t._bodyInit||(a=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new S(e.headers)),this.method=(r=e.method||this.method||"GET",n=r.toUpperCase(),M.indexOf(n)>-1?n:r),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&a)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(a),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var o=/([?&])_=[^&]*/;if(o.test(this.url))this.url=this.url.replace(o,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function B(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),a=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(a))}})),e}function L(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"",this.headers=new S(e.headers),this.url=e.url||"",this._initBody(t)}R.prototype.clone=function(){return new R(this,{body:this._bodyInit})},P.call(R.prototype),P.call(L.prototype),L.prototype.clone=function(){return new L(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new S(this.headers),url:this.url})},L.error=function(){var t=new L(null,{status:0,statusText:""});return t.type="error",t};var O=[301,302,303,307,308];L.redirect=function(t,e){if(-1===O.indexOf(e))throw new RangeError("Invalid status code");return new L(null,{status:e,headers:{location:t}})};var D=v.DOMException;function N(t,e){return new Promise((function(r,n){var a=new R(t,e);if(a.signal&&a.signal.aborted)return n(new D("Aborted","AbortError"));var o=new XMLHttpRequest;function i(){o.abort()}o.onload=function(){var t,e,n={status:o.status,statusText:o.statusText,headers:(t=o.getAllResponseHeaders()||"",e=new S,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var r=t.split(":"),n=r.shift().trim();if(n){var a=r.join(":").trim();e.append(n,a)}})),e)};n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");var a="response"in o?o.response:o.responseText;setTimeout((function(){r(new L(a,n))}),0)},o.onerror=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},o.ontimeout=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},o.onabort=function(){setTimeout((function(){n(new D("Aborted","AbortError"))}),0)},o.open(a.method,function(t){try{return""===t&&v.location.href?v.location.href:t}catch(e){return t}}(a.url),!0),"include"===a.credentials?o.withCredentials=!0:"omit"===a.credentials&&(o.withCredentials=!1),"responseType"in o&&(y?o.responseType="blob":x&&a.headers.get("Content-Type")&&-1!==a.headers.get("Content-Type").indexOf("application/octet-stream")&&(o.responseType="arraybuffer")),a.headers.forEach((function(t,e){o.setRequestHeader(e,t)})),a.signal&&(a.signal.addEventListener("abort",i),o.onreadystatechange=function(){4===o.readyState&&a.signal.removeEventListener("abort",i)}),o.send(void 0===a._bodyInit?null:a._bodyInit)}))}function j(t){function e(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return function(e){t.apply(void 0,r).then((function(t){e(void 0,t)})).catch(e)}}return function(r,n){return{then:function(e){return t(r,n).then(e)},get:e(r),row:function(t){return{get:e(r,t)}}}}}"function"!=typeof D&&((D=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack}).prototype=Object.create(Error.prototype),D.prototype.constructor=D),N.polyfill=!0,v.fetch||(v.fetch=N,v.Headers=S,v.Request=R,v.Response=L),r.csv=j(r.csv),r.json=j(r.json),function(){if("undefined"!=typeof window){var t=function t(e,r){var n=e.nodeType;if(3==n)r.push(e.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"));else if(1==n){if(r.push("<",e.tagName),e.hasAttributes())for(var a=e.attributes,o=0,i=a.length;o<i;++o){var s=a.item(o);r.push(" ",s.name,"='",s.value,"'")}if(e.hasChildNodes()){r.push(">");var l=e.childNodes;for(o=0,i=l.length;o<i;++o)t(l.item(o),r);r.push("</",e.tagName,">")}else r.push("/>")}else{if(8!=n)throw"Error serializing XML. Unhandled node of type: "+n;r.push("\x3c!--",e.nodeValue,"--\x3e")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){for(var e=[],r=this.firstChild;r;)t(r,e),r=r.nextSibling;return e.join("")},set:function(t){for(;this.firstChild;)this.removeChild(this.firstChild);try{var e=new DOMParser;e.async=!1;for(var r="<svg xmlns='http://www.w3.org/2000/svg'>"+t+"</svg>",n=e.parseFromString(r,"text/xml").documentElement.firstChild;n;)this.appendChild(this.ownerDocument.importNode(n,!0)),n=n.nextSibling}catch(t){throw new Error("Error parsing XML string")}}}),Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}})}}(),Number.isNaN=Number.isNaN||function(t){return"number"==typeof t&&t!=t},e.selection.prototype.selectDiv=function(t){var e=this.selectAll('[data-d3-selectdiv="'+t+'"]').data((function(t){return[t]})),r=e.enter().append("div").attr("data-d3-selectdiv",t).style("position","absolute");return e.merge(r)},e.selection.prototype.selectGroup=function(t){var e=this.selectAll('[data-d3-selectgroup="'+t+'"]').data((function(t){return[t]})),r=e.enter().append("g").attr("data-d3-selectgroup",t);return e.merge(r)};var I=function(t){return t},W=function(t){return"[object String]"===Object.prototype.toString.call(t)},H=function(t){return t instanceof e.selection},G=function(t,e){switch(t){case 0:return function(){return e.call(this)};case 1:return function(t){return e.call(this,t)};case 2:return function(t,r){return e.call(this,t,r)};case 3:return function(t,r,n){return e.call(this,t,r,n)};case 4:return function(t,r,n,a){return e.call(this,t,r,n,a)};case 5:return function(t,r,n,a,o){return e.call(this,t,r,n,a,o)};case 6:return function(t,r,n,a,o,i){return e.call(this,t,r,n,a,o,i)};case 7:return function(t,r,n,a,o,i,s){return e.call(this,t,r,n,a,o,i,s)};case 8:return function(t,r,n,a,o,i,s,l){return e.call(this,t,r,n,a,o,i,s,l)};case 9:return function(t,r,n,a,o,i,s,l,c){return e.call(this,t,r,n,a,o,i,s,l,c)};case 10:return function(t,r,n,a,o,i,s,l,c,u){return e.call(this,t,r,n,a,o,i,s,l,c,u)};default:return e}},U=function(){var t=arguments,e=arguments.length-1;return function(){for(var r=e,n=t[r].apply(this,arguments);r--;)n=t[r].call(this,n);return n}},J=function(t){return void 0!==t&&null!=t&&!Number.isNaN(t)},V=function(t,e){for(var r=new Array(t),n=0;n<t;++n)r[n]=e;return r},Y=function(t,e){for(var r=0;r<e.length;r++)if(t(e[r]))return e[r]},q=function(t){return t[0]},K=function(t){return t.touches&&t.touches.length?t.touches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null},X=function(t){return null===t},Q=function(t){return Object(t)===t},Z=function(t){return t[t.length-1]},$=function(t){return function(){return!t.apply(this,arguments)}},tt=function(t){return function(e){return e[t]}},et=function(t,e){return function(r){var n=void 0!==r?r[t]:void 0;return void 0!==n?n:e}},rt=function(t,e){return e||(e=I),t.reduce((function(r,n,a){var o=e(n,a,t);return r.indexOf(o)<0?r.concat(o):r}),[])},nt=function(t,e){return t.toString()===e.toString()},at=function(t){return"function"==typeof t?t:function(){return t}},ot=function(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var n=function e(){var n=arguments,a=r?r.apply(this,n):n[0],o=e.cache;if(o.has(a))return o.get(a);var i=t.apply(this,n);return e.cache=o.set(a,i)||o,i};return n.cache=e.map(),n};function it(t,e,r){var n=function(t){var e=t.selectAll("defs").data([0]),r=e.enter().append("defs");return e.merge(r)}(t).selectAll(e+"#"+r).data([0]),a=n.enter().append(e).attr("id",r);return n.merge(a)}function st(t){return function(){return function t(e){return e.darker=function(){return t(e.copy().range(e.range().map(Pt("darker",.6))))},e.brighter=function(){return t(e.copy().range(e.range().map(Pt("brighter",.6))))},e.reverse=function(){return t(e.copy().range(e.range().reverse()))},e}(e.scaleOrdinal().range(t.map(Ft)))}}var lt=st(["#5182B3","#B8CFE6","#60BF97","#B8E6D2","#94BF69","#CFE6B8","#E6CF73","#FAEBAF","#E67D73","#F2CEC2","#CC6788","#E6B7C7"]),ct=st(["#5182B3","#60BF97","#94BF69","#E6CF73","#E67D73","#CC6788"]),ut=st(["#5182B3","#B8CFE6","#60BF97","#B8E6D2","#94BF69","#CFE6B8"]),pt=st(["#E6CF73","#FAEBAF","#E67D73","#F2CEC2","#CC6788","#E6B7C7"]);function dt(t){return function(){return Et(e.scaleLinear().range(t.map(Ft)))}}var ft=dt(["#DDE9FE","#3B76B3","#343F4D"]),ht=dt(["#FEECEC","#CC6171","#4D353A"]),vt=dt(["#D2DFDE","#4A807C","#2C3C3F"]),mt=dt(["#E9DFD6","#A67D5A","#4C3735"]);function gt(t){return function(){return Et(e.scaleLinear().range(t.map(Ft)))}}var yt=gt(["#CC6171","#FFFFFF","#3B76B3"]),bt=gt(["#CC6171","#F3F3F3","#3B76B3"]),xt=gt(["#A67D5A","#FFFFFF","#4A807C"]),kt=gt(["#A67D5A","#F3F3F3","#4A807C"]);function _t(t){return function(){return Et(e.scaleOrdinal().range(t.map(Ft)))}}var wt=_t(["#FAFAFA"]),zt=_t(["#EAEAEA"]),At=_t(["#D6D6D6"]),St=_t(["#B8B8B8"]),Tt=_t(["#7C7C7C"]),Ct=_t(["#545454"]);function Et(t){return(t=function(t){var r=t.domain;return t.domain=function(t){if(1===arguments.length){var n=[t[0],e.mean(t),t[1]];return r.call(this,n)}return r.apply(this,arguments)},t}(t)).reverse=function(){return Et(t.copy().range(t.range().reverse()))},t}function Ft(t){return e.lab(t)}function Pt(t){var e=Array.prototype.slice.call(arguments,1);return function(r){return r[t].apply(r,e)}}var Mt=function(t){t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",14).attr("height",14),t.append("rect").attr("x",0).attr("y",0).attr("width",14).attr("height",14).attr("fill","#FAFAFA"),t.append("line").attr("x1",1).attr("y1",10).attr("x2",5).attr("y2",14).attr("stroke","#CCCCCC"),t.append("line").attr("x1",5).attr("y1",10).attr("x2",1).attr("y2",14).attr("stroke","#CCCCCC"),t.append("line").attr("x1",8).attr("y1",3).attr("x2",12).attr("y2",7).attr("stroke","#CCCCCC"),t.append("line").attr("x1",12).attr("y1",3).attr("x2",8).attr("y2",7).attr("stroke","#CCCCCC")},Rt=function(t){t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",6).attr("height",6),t.append("rect").attr("x",0).attr("y",0).attr("width",6).attr("height",6).attr("fill","#fff"),t.append("line").attr("x1",0).attr("y1",3).attr("x2",3).attr("y2",0).attr("stroke","#ddd").attr("stroke-linecap","square"),t.append("line").attr("x1",3).attr("y1",6).attr("x2",6).attr("y2",3).attr("stroke","#ddd").attr("stroke-linecap","square")},Bt=function(t){t.attr("x1",0).attr("y1",0).attr("x2",.55).attr("y2",1).attr("id","lake-fade-gradient"),t.append("stop").attr("offset",.74).attr("stop-color","white").attr("stop-opacity",1),t.append("stop").attr("offset",.97).attr("stop-color","white").attr("stop-opacity",0)},Lt=function(t){t.attr("maskContentUnits","objectBoundingBox"),t.append("rect").attr("fill","url(#lake-fade-gradient)").attr("width",1).attr("height",1)},Ot=function(t){t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",6).attr("height",6),t.append("line").attr("x1",0).attr("y1",3).attr("x2",3).attr("y2",0).attr("stroke","#e6e6e6").attr("stroke-width",1.1),t.append("line").attr("x1",3).attr("y1",6).attr("x2",6).attr("y2",3).attr("stroke","#e6e6e6").attr("stroke-width",1.1)};function Dt(){var t={},e=null,r=Nt;function n(n){e&&(n.props=function(){return It(t)},e.apply(n,jt(arguments))),n.each((function(){this.__props__=It(t),r.apply(this,jt(arguments))}))}return n.prop=function(e,r){return r||(r=Nt),n[e]=function(t,e,r){return r||(r=Nt),function(){return arguments.length?(t[e]=r.apply(null,jt(arguments)),this):t[e]}}(t,e,r.bind(n)).bind(n),n},n.delegate=function(t,e){return n[t]=function(){var r=e[t].apply(e,jt(arguments));return 0===arguments.length?r:n},n},n.renderSelection=function(t){return e=t,n},n.render=function(t){return r=t,n},n}function Nt(t){return t}function jt(t){return Array.prototype.slice.call(t)}function It(t){var e={};for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}e.selection.prototype.props=function(){if(arguments.length)throw new Error("selection.props() does not accept any arguments");if(1!=this.size())throw new Error("only one group is supported");if(1!=this._groups[0].length)throw new Error("only one node is supported");var t=this._groups[0],e=t[0];return e.__props__||{}};var Wt=function(t){return Math.floor(t)+.5},Ht=function(t){var e=U(Math.floor,Number),r=t.match(/(translate\()\s*([0-9.,\- ]+)\s*(\))/i)[2].replace(","," ").replace(/\s+/," ").split(" ").map(Number);1===r.length&&r.push([0]);var n=r.map(e);return[r[0]-n[0],r[1]-n[1]]};function Gt(t,e){return"translate("+t+","+e+")"}function Ut(){return Dt().prop("position").position(at([0,0])).prop("debug").render((function(r){var n=e.select(this),a=n.props(),o=n.selectAll("[data-tooltip-anchor]").data(r),i=o.enter().append("rect").attr("height",1).attr("width",1).attr("fill","none").attr("stroke","none").attr("visibility","none").attr("data-tooltip-anchor","");if(o.exit().remove(),(o=o.merge(i)).attr("transform",U(t,a.position)),a.debug){var s=n.selectAll("[data-tooltip-anchor-debug]").data(r),l=s.enter().append("circle").attr("data-tooltip-anchor-debug","");s.exit().remove(),(s=s.merge(l)).attr("r",2).attr("fill","#fff").attr("stroke","#f00").attr("stroke-width",1.5).attr("transform",U(t,a.position))}}));function t(t){return Gt.apply(null,t)}}function Jt(t,e,r){return function(n){var a=n.enter().append("circle").classed("sszvis-rangeFlag__mark",!0).classed(t,!0);n.exit().remove(),(n=n.merge(a)).attr("r",3.5).attr("cx",e).attr("cy",r)}}var Vt={decimal:".",thousands:" ",grouping:[3],currency:["CHF ",""],dateTime:"%a. %e. %B %X %Y",date:"%d.%m.%Y",time:"%H:%M:%S",periods:[],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},Yt=e.timeFormatLocale(Vt).format,qt=e.formatLocale(Vt).format,Kt=function(t){for(var e=[[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%H:%M",function(t){return t.getMinutes()}],["%H Uhr",function(t){return t.getHours()}],["%a., %d.",function(t){return t.getDay()&&1!=t.getDate()}],["%e. %b",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",function(){return!0}]],r=0;r<e.length;++r)if(e[r][1](t))return Yt(e[r][0])(t)},Xt=U((function(t){return t.toUpperCase()}),Yt("%b")),Qt=Yt("%Y"),Zt=function(t){var e,r=Math.abs(t);return null==t||isNaN(t)?"–":r>=1e4?qt(",.0f")(t):r>=100?(e=Math.min(1,te(t)),ee(qt("."+e+"f")(t))):r>0?(e=Math.min(2,te(t)),ee(qt("."+e+"f")(t))):qt(".0f")(0)},$t=function(t){return String(t)};function te(t){return(String(Math.abs(t)).split(".")[1]||"").length}function ee(t){return t.replace(/(\.[0-9]*[1-9])0+$|\.0*$/,"$1")}var re=function(){return Dt().prop("header").prop("body").prop("orientation",at).orientation("bottom").prop("dx",at).dx(1).prop("dy",at).dy(1).prop("opacity",at).opacity(1).renderSelection((function(t){var r=t.datum(),n=t.props(),a=J,o=a(n.header)&&!a(n.body)||!a(n.header)&&a(n.body),i=t.selectAll(".sszvis-tooltip").data(r);i.exit().remove();var s=i.enter().append("div");(i=i.merge(s)).style("pointer-events","none").style("opacity",n.opacity).style("padding-top",(function(t){return"top"===n.orientation(t)?"6px":null})).style("padding-right",(function(t){return"right"===n.orientation(t)?"6px":null})).style("padding-bottom",(function(t){return"bottom"===n.orientation(t)?"6px":null})).style("padding-left",(function(t){return"left"===n.orientation(t)?"6px":null})).classed("sszvis-tooltip",!0);var l=s.append("svg").attr("class","sszvis-tooltip__background").attr("height",0).attr("width",0),c=l.append("path");if(void 0!==window.SVGFEColorMatrixElement&&2==SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE){var u=l.append("filter").attr("id","sszvisTooltipShadowFilter").attr("height","150%");u.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",2),u.append("feComponentTransfer").append("feFuncA").attr("type","linear").attr("slope",.2);var p=u.append("feMerge");p.append("feMergeNode"),p.append("feMergeNode").attr("in","SourceGraphic"),c.attr("filter","url(#sszvisTooltipShadowFilter)")}else l.classed("sszvis-tooltip__background--fallback",!0);var d=s.append("div").classed("sszvis-tooltip__content",!0);d.append("div").classed("sszvis-tooltip__header",!0),d.append("div").classed("sszvis-tooltip__body",!0),i.select(".sszvis-tooltip__header").datum(tt("datum")).html(n.header||at("")),i.select(".sszvis-tooltip__body").datum(tt("datum")).html((function(t){var e=n.body?at(n.body)(t):"";return Array.isArray(e)?'<table class="sszvis-tooltip__body__table">'+e.map((function(t){return"<tr>"+t.map((function(t){return"<td>"+t+"</td>"})).join("")+"</tr>"})).join("")+"</table>":e})),t.selectAll(".sszvis-tooltip").classed("sszvis-tooltip--small",o).each((function(t){var r=e.select(this),a=r.node().getBoundingClientRect(),i=n.orientation.apply(this,arguments);switch(i){case"top":r.style("left",t.x-a.width/2+"px").style("top",t.y+n.dy(t)+"px");break;case"bottom":r.style("left",t.x-a.width/2+"px").style("top",t.y-n.dy(t)-a.height+"px");break;case"left":r.style("left",t.x+n.dx(t)+"px").style("top",t.y-a.height/2+"px");break;case"right":r.style("left",t.x-n.dx(t)-a.width+"px").style("top",t.y-a.height/2+"px")}var s=a.height+10,l=a.width+10;r.select(".sszvis-tooltip__background").attr("height",s).attr("width",l).style("left","-5px").style("top","-5px").select("path").attr("d",ne([5,5],[l-5,s-5],i,o?3:4))}))}))};function ne(t,e,r,n){switch(r){case"top":t[1]=t[1]+6;break;case"bottom":e[1]=e[1]-6;break;case"left":t[0]=t[0]+6;break;case"right":e[0]=e[0]-6}function a(t){return t[0]}function o(t){return t[1]}function i(t,e,r,n,a,o,i){var s=r+(a-r)/2,l=n+(o-n)/2,c=[];return i&&n===o?c=r<a?["L",s-6,l,"L",s,l-6,"L",s+6,l]:["L",s+6,l,"L",s,l+6,"L",s-6,l]:i&&r===a&&(c=n<o?["L",s,l-6,"L",s+6,l,"L",s,l+6]:["L",s,l+6,"L",s-6,l,"L",s,l-6]),[].concat(["Q",t,e,r,n],c,["L",a,o])}return[["M",a(t),o(t)+n],i(a(t),o(t),a(t)+n,o(t),a(e)-n,o(t),"top"===r),i(a(e),o(t),a(e),o(t)+n,a(e),o(e)-n,"right"===r),i(a(e),o(e),a(e)-n,o(e),a(t)+n,o(e),"bottom"===r),i(a(t),o(e),a(t),o(e)-n,a(t),o(t)+n,"left"===r)].map((function(t){return t.join(" ")})).join(" ")}function ae(t,e){var r=fe(e);return Y((function(t){return ie(t,r)}),t)}function oe(t,e){return Y((function(t){return t.name===e}),t)}function ie(t,e){var r=t.measurement,n=fe(e);return n.width<=r.width&&n.screenHeight<=r.screenHeight}function se(t,e){var r=fe(e);return t.filter((function(t){return ie(t,r)}))}function le(t){return t.map(he).concat(he({name:"_"}))}var ce,ue=(ce=le([{name:"palm",width:540},{name:"lap",width:749}]),function(){return ce}),pe=ve("palm"),de=ve("lap");function fe(t){var e=et("width",1/0),r=et("screenHeight",1/0);return{width:e(t),screenHeight:r(t)}}function he(t){var e;return e=J(t.measurement)?fe(t.measurement):fe({width:t.width,screenHeight:t.screenHeight}),{name:t.name,measurement:e}}function ve(t){return function(e){return ie(oe(ue(),t),e)}}function me(t,e){var r=t/e;return function(t){return t/r}}var ge=me(4,3),ye=me(16,10),be=function(t){return Math.min(me(12,5)(t),500)};be.MAX_HEIGHT=500;var xe=function(t){return Math.min(me(1,1)(t),420)};xe.MAX_HEIGHT=420;var ke=function(t){return Math.min(me(4,5)(t),600)};ke.MAX_HEIGHT=600;var _e={palm:ge,lap:ye,_:be},we=function(t){var e=ae(ue(),t);return(0,_e[e.name])(t.width)},ze=Se("warn"),Ae=Se("error");function Se(t){return function(){console&&console[t]&&Te(arguments).forEach((function(e){console[t](e)}))}}function Te(t){return Array.prototype.slice.call(t)}var Ce=function(t){return t.rangeExtent?t.rangeExtent():(e=t.range(),r=e[0],n=e[e.length-1],r<n?[r,n]:[n,r]);var e,r,n};function Ee(t,r,n,a){a=(a||5)-2;var o=r;r-=2*(n=n||5);var i=[];return t.each((function(){var t,s,l=e.select(this),c=l.text().split(/[ \f\n\r\t\v]+/).reverse(),u=[],p=0,d=l.attr("y"),f=parseFloat(l.attr("dy")),h=1,v=l.style("text-anchor")||"start";if(isNaN(f)&&(f=0),e.select(l.node().parentNode).classed("tick"))switch(v){case"start":s=-r/2;break;case"middle":s=0;break;case"end":s=r/2}else switch(v){case"start":s=n;break;case"middle":s=o/2;break;case"end":s=o-n}d=+(null===d?a:d);for(var m=l.text(null).append("tspan").attr("x",s).attr("y",d).attr("dy",f+"em");c.length>0;)t=c.pop(),u.push(t),m.text(u.join(" ")),m.node().getComputedTextLength()>r&&u.length>1&&(u.pop(),m.text(u.join(" ")),u=[t],m=l.append("tspan").attr("x",s).attr("y",d).attr("dy",1.1*++p+f+"em").text(t),++h);i.push(h)})),i}var Fe=function(){return Dt().prop("scale").prop("orient").prop("ticks").prop("tickValues").prop("tickSize").prop("tickSizeInner").prop("tickSizeOuter").prop("tickPadding").prop("tickFormat").prop("_scale").prop("orient").orient("bottom").prop("alignOuterLabels").alignOuterLabels(!1).prop("contour").prop("hideBorderTickThreshold").hideBorderTickThreshold(8).prop("hideLabelThreshold").hideLabelThreshold(10).prop("highlightTick",at).prop("showZeroY").showZeroY(!1).prop("slant").prop("textWrap").prop("tickLength").prop("title").prop("titleAnchor").prop("titleCenter").prop("dxTitle").prop("dyTitle").prop("titleVertical").prop("vertical").vertical(!1).prop("yOffset").yOffset(0).render((function(){var t=e.select(this),r=t.props(),n=!r.vertical&&"bottom"===r.orient,a=function(){switch(r.orient){case"bottom":return e.axisBottom();case"top":return e.axisTop();case"left":return e.axisLeft();case"right":return e.axisRight()}}();["scale","ticks","tickValues","tickSizeInner","tickSizeOuter","tickPadding","tickFormat","tickSize"].forEach((function(t){if(void 0!==r[t]){if(void 0===a[t])throw new Error('axis: "'+t+'" not available');a[t](r[t])}})),r._scale&&a.scale(r._scale);var o=t.selectGroup("sszvis-axis").classed("sszvis-axis",!0).classed("sszvis-axis--top",!r.vertical&&"top"===r.orient).classed("sszvis-axis--bottom",n).classed("sszvis-axis--vertical",r.vertical).attr("transform",Gt(0,r.yOffset)).call(a);o.attr("fill",null).attr("font-size",null).attr("font-family",null);var i=a.scale(),s=o.selectAll("g.tick"),l=s.selectAll("text");s.each((function(){var t=Ht(this.getAttribute("transform")),r=Wt(0)-t[0],a=Wt(n?2:0)+t[1];e.select(this).select("line").attr("transform",Gt(r,a))})),l.each((function(){"top"!==r.orient&&"bottom"!==r.orient||e.select(this).attr("dx","-0.5"),"left"!==r.orient&&"right"!==r.orient||e.select(this).attr("y","-0.5")})),o.selectAll("path.domain");var c=Ce(i);if(s.selectAll("line").each((function(t){var n=i(t),a=e.select(this);a.classed("hidden",!a.classed("sszvis-axis__longtick")&&(Be(n,c[0])<r.hideBorderTickThreshold||Be(n,c[1])<r.hideBorderTickThreshold))})),J(r.tickLength)){var u=e.extent(i.domain()),p=s.filter((function(t){return!nt(t,u[0])&&!nt(t,u[1])})),d=r.orient,f=2;"left"!==d&&"right"!==d||(p.selectAll("text").each((function(){f=Math.max(this.getBoundingClientRect().width,f)})),f+=2);var h=p.selectAll("line.sszvis-axis__longtick").data([0]);if(r.tickLength>f){var v=h.enter().append("line").classed("sszvis-axis__longtick",!0);h=h.merge(v),"top"===d?h.attr("y1",f).attr("y2",r.tickLength):"bottom"===d?h.attr("y1",-f).attr("y2",-r.tickLength):"left"===d?h.attr("x1",-f).attr("x2",-r.tickLength):"right"===d&&h.attr("x1",f).attr("x2",r.tickLength)}else h.remove()}if(r.alignOuterLabels){var m=Ce(i),g=m[0],y=m[1];l.style("text-anchor",(function(t){var e=i(t);return Be(e,g)<12?"start":Be(e,y)<12?"end":"middle"}))}if(J(r.textWrap)&&l.call(Ee,r.textWrap),r.slant&&l.call(Le[r.orient][r.slant]),r.highlightTick){var b=[],x=[];l.classed("hidden",!1).classed("active",r.highlightTick),r.hideLabelThreshold>0&&!r.slant&&(l.each((function(t){var e=this.getBoundingClientRect(),n={node:this,bounds:{top:e.top,right:e.right,bottom:e.bottom,left:e.left}};r.highlightTick(t)?(n.bounds.left-=r.hideLabelThreshold,n.bounds.right+=r.hideLabelThreshold,b.push(n)):x.push(n)})),b.forEach((function(t){x.forEach((function(r){var n,a;e.select(r.node).classed("hidden",(n=r.bounds,!((a=t.bounds).left>n.right||a.right<n.left||a.top>n.bottom||a.bottom<n.top)))}))})))}if(r.title){var k=o.selectAll(".sszvis-axis__title").data([r.title]),_=k.enter().append("text").classed("sszvis-axis__title",!0);k.exit().remove(),k.merge(_).text((function(t){return t})).attr("transform",(function(){var t,e=r.orient,n=Ce(i);return(t=r.titleCenter?{left:"left"===e||"right"===e?0:"top"===e||"bottom"===e?(n[0]+n[1])/2:0,top:"left"===e||"right"===e?(n[0]+n[1])/2:"top"===e?0:"bottom"===e?32:0}:{left:"left"===e||"right"===e||"top"===e?0:"bottom"===e?n[1]:0,top:"left"===e||"right"===e||"top"===e?0:"bottom"===e?32:0}).vertical=!!r.titleVertical,t.left+=r.dxTitle||0,t.top+=r.dyTitle||0,"translate("+t.left+", "+t.top+") rotate("+(t.vertical?"-90":"0")+")"})).style("text-anchor",(function(){var t=r.orient;return void 0!==r.titleAnchor?r.titleAnchor:"left"===t?"end":"right"===t?"start":"top"===t||"bottom"===t?"end":void 0}))}r.contour&&r.slant?ze("Can't apply contour to slanted labels"):r.contour&&s.each((function(){var t=e.select(this),r=t.select("text").node(),n=t.select(".sszvis-axis__label-contour");n.empty()&&(n=e.select(r.cloneNode()).classed("sszvis-axis__label-contour",!0),this.insertBefore(n.node(),r)),n.text(r.textContent)}))}))},Pe=function(t){var e=this.scale().domain(),r=[],n=Math.round(e.length/t);void 0!==e[0]&&r.push(e[0]);for(var a=n,o=e.length;a<o-1;a+=n)void 0!==e[a]&&r.push(e[a]);return void 0!==e[e.length-1]&&r.push(e[e.length-1]),this.tickValues(r),t},Me=function(){return Fe().yOffset(2).ticks(3).tickSizeInner(4).tickSizeOuter(6.5).tickPadding(6).tickFormat(G(1,Zt))};Me.time=function(){return Me().tickFormat(Kt).alignOuterLabels(!0)},Me.ordinal=function(){return Me().prop("ticks",Pe).tickFormat($t)},Me.pyramid=function(){return Me().ticks(10).prop("scale",(function(t){var e=t.copy(),r=e.domain(),n=e.range();return e.domain([-r[1],r[1]]).range([n[0]-n[1],n[0]+n[1]]),this._scale(e),e})).tickFormat((function(t){return Zt(Math.abs(t))}))};var Re=function(){var t=Fe().ticks(6).tickSize(0,0).tickPadding(0).tickFormat((function(e){return 0!==e||t.showZeroY()?Zt(e):null})).vertical(!0);return t};function Be(t,e){return Math.abs(t-e)}Re.time=function(){return Re().tickFormat(Kt)},Re.ordinal=function(){return Re().prop("ticks",Pe).tickFormat($t)};var Le={top:{horizontal:function(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("dy","0.71em").attr("transform",null)},vertical:function(t){t.style("text-anchor","start").attr("dx","0em").attr("dy","0.35em").attr("transform","rotate(-90)")},diagonal:function(t){t.style("text-anchor","start").attr("dx","0.1em").attr("dy","0.1em").attr("transform","translate(-0.5) rotate(-45)")}},bottom:{horizontal:function(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("dy","0.71em").attr("transform",null)},vertical:function(t){t.style("text-anchor","end").attr("dx","-1em").attr("dy","-0.75em").attr("transform","rotate(-90)")},diagonal:function(t){t.style("text-anchor","end").attr("dx","-0.8em").attr("dy","0em").attr("transform","rotate(-45)")}}};function Oe(){var t=e.dispatch("start","move","drag","end"),r=Dt().prop("debug").prop("xScale").prop("yScale").prop("draggable").prop("cancelScrolling",at).cancelScrolling(!1).prop("fireOnPanOnly",at).fireOnPanOnly(!1).prop("padding",(function(t){var e={top:0,left:0,bottom:0,right:0};for(var r in t)e[r]=t[r];return e})).padding({}).render((function(){var r=e.select(this),n=r.props(),a=Ce(n.xScale).sort(e.ascending),o=Ce(n.yScale).sort(e.ascending);a[0]-=n.padding.left,a[1]+=n.padding.right,o[0]-=n.padding.top,o[1]+=n.padding.bottom;var i=r.selectAll("[data-sszvis-behavior-move]").data([0]),s=i.enter().append("rect").attr("data-sszvis-behavior-move","").attr("class","sszvis-interactive");i=i.merge(s),n.draggable&&i.classed("sszvis-interactive--draggable",!0),i.attr("x",a[0]).attr("y",o[0]).attr("width",a[1]-a[0]).attr("height",o[1]-o[0]).attr("fill","transparent").on("mouseover",(function(){t.apply("start",this,arguments)})).on("mousedown",(function(){var r=this,a=e.select(document),o=e.select(window),i=function(){var a=e.mouse(r),o=De(n.xScale,a[0]),i=De(n.yScale,a[1]);e.event.preventDefault(),t.apply("drag",this,[o,i])},s=function(){r.__dragging__=!1,o.on("mouseup.sszvis-behavior-move",null),o.on("mousemove.sszvis-behavior-move",null),a.on("mouseout.sszvis-behavior-move",null),t.apply("end",this,arguments)};o.on("mousemove.sszvis-behavior-move",i),o.on("mouseup.sszvis-behavior-move",s),a.on("mouseout.sszvis-behavior-move",(function(){var t=e.event.relatedTarget||e.event.toElement;t&&"HTML"!==t.nodeName||s()})),r.__dragging__=!0,i()})).on("mousemove",(function(){var r=e.mouse(this),a=De(n.xScale,r[0]),o=De(n.yScale,r[1]);this.__dragging__||t.apply("move",this,[a,o])})).on("mouseout",(function(){t.apply("end",this,[])})).on("touchstart",(function(){var r=q(e.touches(this)),a=De(n.xScale,r[0]),o=De(n.yScale,r[1]),i=n.cancelScrolling(a,o);if(i&&e.event.preventDefault(),!n.fireOnPanOnly()||i){t.apply("start",this,[a,o]),t.apply("drag",this,[a,o]),t.apply("move",this,[a,o]);e.select(this).on("touchmove",(function(){var r=q(e.touches(this)),a=De(n.xScale,r[0]),o=De(n.yScale,r[1]),i=n.cancelScrolling(a,o);i&&e.event.preventDefault(),!n.fireOnPanOnly()||i?(t.apply("drag",this,[a,o]),t.apply("move",this,[a,o])):t.apply("end",this,[])})).on("touchend",(function(){t.apply("end",this,[]),e.select(this).on("touchmove",null).on("touchend",null)}))}})),n.debug&&i.attr("fill","rgba(255,0,0,0.2)")}));return r.on=function(){var e=t.on.apply(t,arguments);return e===t?r:e},r}function De(t,e){switch(t.invert?"Linear":t.paddingInner?"Band":"Point"){case"Linear":return t.invert(e);case"Band":return function(t,e){var r=t.step(),n=t.paddingOuter()*r,a=t.paddingInner()*r,o=t.bandwidth(),i=t.range(),s=t.domain();if(1===s.length)return i[0]<=e&&i[1]>=e?s[0]:null;for(var l=s.map((function(t,e){return 0===e?[i[0],i[0]+n+o+a/2]:e===s.length-1?[i[1]-(n+o+a/2),i[1]]:[i[0]+n+e*r-a/2,i[0]+n+(e+1)*r-a/2]})),c=0,u=l.length;c<u;c++)if(l[c][0]<e&&e<=l[c][1])return s[c];return null}(t,e);case"Point":return function(t,e){var r=t.step(),n=t.padding()*r,a=t.range(),o=t.domain();if(1===o.length)return a[0]<=e&&a[1]>=e?o[0]:null;for(var i=o.map((function(t,e){return 0===e?[a[0],a[0]+n+r/2]:e===o.length-1?[a[1]-(n+r/2),a[1]]:[a[0]+n+e*r-r/2,a[0]+n+e*r+r/2]})),s=0,l=i.length;s<l;s++)if(i[s][0]<e&&e<=i[s][1])return o[s];return null}(t,e);default:throw new Error("Unknown scale type, could not invert")}}var Ne=function(t){return!X(t)&&J(t)?document.elementFromPoint(t.clientX,t.clientY):null},je=function(t){if(!X(t)){var r=e.select(t);if(!X(r.attr("data-sszvis-behavior-pannable"))){var n=r.datum();if(J(n))return n}}return null},Ie=function(t){return je(Ne(t))};var We=Math.pow(15,2);function He(t,e){var r=t.clientX-e[0],n=t.clientY-e[1];return r*r+n*n<We}var Ge,Ue,Je=function(t){var r;return{width:(r=W(t)?e.select(t).node():H(t)?t.node():t)?r.getBoundingClientRect().width:void 0,screenWidth:window.innerWidth,screenHeight:window.innerHeight}},Ve=(Ge=document.createElement("canvas").getContext("2d"),Ue={},function(t,e,r){var n=[t,e,r].join("-");return Ge.font=t+"px "+e,Ue[n]||(Ue[n]=Ge.measureText(r).width)}),Ye=function(t){return Ve(10,"Arial, sans-serif",t)},qe=function(t){return Ve(12,"Arial, sans-serif",t)};function Ke(t,r){var n=null,a=null;0===arguments.length?n={}:1===arguments.length?Q(t)?n=t:H(t)?(n={},a=t):(n={},a=e.select(t)):(n=t,a=H(r)?r:e.select(r));var o={top:Xe(n.top,0),right:Xe(n.right,1),bottom:Xe(n.bottom,0),left:Xe(n.left,1)},i=J(a)?Je(a):{width:516},s=Xe(n.width,i.width),l=we(i),c=Xe(n.height,l+o.top+o.bottom);return{innerHeight:c-o.top-o.bottom,innerWidth:s-o.left-o.right,padding:o,height:c,width:s,screenWidth:i.screenWidth,screenHeight:i.screenHeight}}function Xe(t,e){return void 0===t?e:t}function Qe(t,e){for(var r in t)e(t[r],r)}function Ze(){var t,e={},r=[],n=[];return e.apply=function(e){return function e(a,o){if(o>=r.length)return t&&a.sort(t),a;var i=n[o],s=r[o++],l=function(t,e){for(var r,n,a={},o=0,i=t.length;o<i;++o)a[r=e(n=t[o])]?a[r].push(n):a[r]=[n];return a}(a,s.func);if("obj"===s.type){var c={};return Qe(l,(function(t,r){c[r]=e(t,o)})),c}if("arr"===s.type){var u=[];if(i)!function(t,e){for(var r=0,n=t.length;r<n;++r)e(t[r],r)}(Object.keys(l).sort(i),(function(t){u.push(e(l[t],o))}));else Qe(l,(function(t){u.push(e(t,o))}));return u}}(e,0)},e.objectBy=function(t){return r.push({type:"obj",func:t}),e},e.arrayBy=function(t,a){return r.push({type:"arr",func:t}),a&&(n[r.length-1]=a),e},e.sort=function(r){return t=r,e},e}var $e=e.easePolyOut,tr=function(){return e.transition().ease($e).duration(300)},er=function(){return e.transition().ease($e).duration(500)};function rr(t){return isNaN(t)?0:t}function nr(){return Dt().prop("x",at).prop("y",at).prop("width",at).prop("height",at).prop("fill",at).prop("stroke",at).prop("centerTooltip").prop("tooltipAnchor").prop("transition").transition(!0).render((function(t){var r,n=e.select(this),a=n.props(),o=U(rr,a.x),i=U(rr,a.y),s=U(rr,a.width),l=U(rr,a.height),c=n.selectAll(".sszvis-bar").data(t);if(c.exit().remove(),c.enter().append("rect").classed("sszvis-bar",!0).attr("x",o).attr("y",i).attr("width",s).attr("height",l).merge(c).attr("fill",a.fill).attr("stroke",a.stroke),a.transition&&(c=c.transition(tr())),c.attr("x",o).attr("y",i).attr("width",s).attr("height",l),a.centerTooltip)r=function(t){return[o(t)+s(t)/2,i(t)+l(t)/2]};else if(a.tooltipAnchor){var u=a.tooltipAnchor.map(parseFloat);r=function(t){return[o(t)+u[0]*s(t),i(t)+u[1]*l(t)]}}else r=function(t){return[o(t)+s(t)/2,i(t)]};var p=Ut().position(r);n.call(p)}))}function ar(){return Dt().prop("barPosition").prop("barWidth").prop("mirror").mirror(!1).render((function(t){var r=e.select(this),n=r.props(),a=e.line().x(n.barWidth).y(n.barPosition),o=r.selectAll(".sszvis-pyramid__referenceline").data(t);o.exit().remove();var i=o.enter().append("path").attr("class","sszvis-pyramid__referenceline");(o=o.merge(i)).attr("transform",n.mirror?"scale(-1, 1)":"").transition(tr()).attr("d",a)}))}var or=tt("stack"),ir=tt("0"),sr=tt("1");function lr(t){return function(r,n,a){return function(o){var i=Ze().arrayBy(r).objectBy(n).apply(o),s=i.reduce((function(t,e){return rt(t.concat(Object.keys(e)))}),[]),l=e.stack().keys(s).value((function(t,e){return a(t[e][0])})).order(t)(i);return l.forEach((function(t){t.forEach((function(e){e.series=t.key,e.data=e.data[t.key][0],e.stack=r(e.data)}))})),l.keys=s,l.maxValue=e.max(l,(function(t){return e.max(t,(function(t){return t[1]}))})),l}}}var cr=lr(e.stackOrderNone),ur=lr(e.stackOrderReverse);function pr(t){return Dt().prop("xScale",at).prop("width",at).prop("yScale",at).prop("height",at).prop("fill").prop("stroke").render((function(r){var n=e.select(this),a=n.props(),o=nr().x(t.x(a)).y(t.y(a)).width(t.width(a)).height(t.height(a)).fill(a.fill).stroke(a.stroke),i=n.selectAll(".sszvis-stack").data(r),s=i.enter().append("g").classed("sszvis-stack",!0);i.exit().remove(),(i=i.merge(s)).call(o)}))}var dr={x:function(t){return U(t.xScale,ir)},y:function(t){return U(t.yScale,or)},width:function(t){return function(e){return t.xScale(e[1])-t.xScale(e[0])}},height:function(t){return t.height}},fr={x:function(t){return U(t.xScale,or)},y:function(t){return U(t.yScale,sr)},width:function(t){return t.width},height:function(t){return function(e){return t.yScale(e[0])-t.yScale(e[1])}}},hr=tt("data"),vr=tt("row");function mr(){return Dt().prop("stackElement").renderSelection((function(t){var r=t.datum(),n=t.props(),a=t.selectAll("[data-sszvis-stack]").data(r),o=a.enter().append("g").attr("data-sszvis-stack","");a.exit().remove(),(a=a.merge(o)).each((function(t){e.select(this).datum(t).call(n.stackElement)}))}))}function gr(){return Dt().prop("barPosition").prop("barWidth").prop("mirror").mirror(!1).render((function(t){var r=e.select(this),n=r.props(),a=e.line().x(n.barWidth).y(n.barPosition),o=r.selectAll(".sszvis-path").data(t);o.exit().remove();var i=o.enter().append("path").attr("class","sszvis-path").attr("fill","none").attr("stroke","#aaa").attr("stroke-width",2).attr("stroke-dasharray","3 3");(o=o.merge(i)).attr("transform",n.mirror?"scale(-1, 1)":"").transition(tr()).attr("d",a)}))}var yr=2*Math.PI;function br(t,e){return e.indexOf(t)>=0}function xr(){return Dt().prop("scale").prop("rowHeight").rowHeight(21).prop("columnWidth").columnWidth(200).prop("rows").rows(3).prop("columns").columns(3).prop("verticallyCentered").verticallyCentered(!1).prop("orientation").prop("reverse").reverse(!1).prop("rightAlign").rightAlign(!1).prop("horizontalFloat").horizontalFloat(!1).prop("floatPadding").floatPadding(20).prop("floatWidth").floatWidth(600).render((function(){var t,r,n=e.select(this),a=n.props(),o=a.scale.domain();a.reverse&&(o=o.slice().reverse()),"horizontal"===a.orientation?(r=Math.ceil(a.columns),t=Math.ceil(o.length/r)):"vertical"===a.orientation&&(t=Math.ceil(a.rows),r=Math.ceil(o.length/t));var i=n.selectAll(".sszvis-legend--entry").data(o),s=i.enter().append("g").classed("sszvis-legend--entry",!0);i.exit().remove();var l=i.merge(s).selectAll(".sszvis-legend__mark").data((function(t){return[t]})),c=l.enter().append("circle").classed("sszvis-legend__mark",!0);l.exit().remove(),l.merge(c).attr("cx",a.rightAlign?-6:6).attr("cy",Wt(a.rowHeight/2)).attr("r",5).attr("fill",(function(t){return a.scale(t)})).attr("stroke",(function(t){return a.scale(t)})).attr("stroke-width",1);var u=i.merge(s).selectAll(".sszvis-legend__label").data((function(t){return[t]})),p=u.enter().append("text").classed("sszvis-legend__label",!0);u.exit().remove(),u.merge(p).text((function(t){return t})).attr("dy","0.35em").style("text-anchor",(function(){return a.rightAlign?"end":"start"})).attr("transform",(function(){return Gt(a.rightAlign?-18:18,Wt(a.rowHeight/2))}));var d="";if(a.verticallyCentered&&(d="translate(0,"+String(-o.length*a.rowHeight/2)+") "),a.horizontalFloat){var f=0,h=0;i.merge(s).attr("transform",(function(){var t=this.getBoundingClientRect().width;h+t>a.floatWidth&&(f+=a.rowHeight,h=0);var e=Gt(h,f);return h+=t+a.floatPadding,d+e}))}else i.merge(s).attr("transform",(function(e,n){return"horizontal"===a.orientation?d+"translate("+n%r*a.columnWidth+","+Math.floor(n/r)*a.rowHeight+")":"vertical"===a.orientation?d+"translate("+Math.floor(n/t)*a.columnWidth+","+n%t*a.rowHeight+")":void 0}))}))}function kr(t,r){var n=t.length,a=e.max(t,_r),o=e.sum(t,_r),i=n<=4?1:function t(e,r,n){return n<=1?1:r<=e/n?n:t(e,r,n-1)}(r,a,2),s=1===i&&o<=r;return{columns:i,rows:s?1:Math.ceil(n/i),columnWidth:1===i?null:a,legendWidth:i*a,horizontalFloat:s,orientation:s?null:"vertical"}}function _r(t){return qe(t)+40}var wr,zr=(wr=0,function(){return++wr});var Ar=ot((function(t,r,n){return e.geoMercator().fitSize([t,r],n)}),(function(t,e,r,n){return t+","+e+","+n})),Sr=function(t,r,n,a){return e.geoPath().projection(Ar(t,r,n,a))},Tr=function(t,e,r){r||(r="geoId");var n=Array.isArray(t)?t.reduce((function(t,e){return t[e[r]]=e,t}),{}):{};return e.features.map((function(t){return{geoJson:t,datum:n[t.id]}}))},Cr=function(t){if(!t.properties.cachedCenter){var r=t.properties.center;t.properties.cachedCenter=r?r.split(",").map(parseFloat):e.geoCentroid(t)}return t.properties.cachedCenter},Er=tt("datum");function Fr(){return Dt().prop("mergedData").prop("geoJson").prop("mapPath").prop("defined",at).defined(!0).prop("fill",at).fill((function(){return"black"})).prop("transitionColor").transitionColor(!0).render((function(){var t=e.select(this),r=t.props();function n(t){return r.defined(t.datum)?r.fill(t.datum):"url(#missing-pattern)"}it(t,"pattern","missing-pattern").call(Mt);var a=t.selectAll(".sszvis-map__area").data(r.mergedData),o=a.enter().append("path").classed("sszvis-map__area",!0).classed("sszvis-map__area--entering",!0).attr("data-event-target","").attr("fill",n);a.classed("sszvis-map__area--entering",!1),a.exit().remove(),a=a.merge(o),t.selectAll(".sszvis-map__area--undefined").attr("fill",n),a.classed("sszvis-map__area--undefined",(function(t){return!J(t.datum)||!r.defined(t.datum)})).attr("d",(function(t){return r.mapPath(t.geoJson)})),r.transitionColor?a.transition().call(er).attr("fill",n):a.attr("fill",n);var i=Ut().position((function(t){return r.mapPath.projection()(Cr(t.geoJson))}));t.selectGroup("tooltipAnchors").datum(r.mergedData).call(i)}))}function Pr(){return Dt().prop("keyName").keyName("geoId").prop("geoJson").prop("mapPath").prop("highlight").highlight([]).prop("highlightStroke",at).highlightStroke("white").prop("highlightStrokeWidth",at).highlightStrokeWidth(2).render((function(){var t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-map__highlight");if(!r.highlight.length)return n.remove(),!0;var a=r.geoJson.features.reduce((function(t,e){return t[e.id]=e,t}),{}),o=r.highlight.reduce((function(t,e){return e&&t.push({geoJson:a[e[r.keyName]],datum:e}),t}),[]),i=(n=n.data(o)).enter().append("path").classed("sszvis-map__highlight",!0);n.exit().remove(),(n=n.merge(i)).attr("d",(function(t){return r.mapPath(t.geoJson)})).style("stroke",(function(t){return r.highlightStroke(t.datum)})).style("stroke-width",(function(t){return r.highlightStrokeWidth(t.datum)}))}))}function Mr(){return Dt().prop("geoJson").prop("mapPath").prop("borderColor").borderColor("white").prop("strokeWidth").strokeWidth(1.25).render((function(){var t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-map__border").data([r.geoJson]),a=n.enter().append("path").classed("sszvis-map__border",!0);n.exit().remove(),(n=n.merge(a)).attr("d",r.mapPath).style("stroke",r.borderColor).style("stroke-width",r.strokeWidth)}))}function Rr(){return Dt().prop("mapPath").prop("lakeFeature").prop("lakeBounds").prop("lakePathColor").prop("fadeOut").fadeOut(!0).render((function(){var t=e.select(this),r=t.props();it(t,"pattern","lake-pattern").call(Rt),r.fadeOut&&(it(t,"linearGradient","lake-fade-gradient").call(Bt),it(t,"mask","lake-fade-mask").call(Lt));var n=t.selectAll(".sszvis-map__lakezurich").data([r.lakeFeature]),a=n.enter().append("path").classed("sszvis-map__lakezurich",!0);n.exit().remove(),(n=n.merge(a)).attr("d",r.mapPath).attr("fill","url(#lake-pattern)"),r.fadeOut&&n.attr("mask","url(#lake-fade-mask)");var o=t.selectAll(".sszvis-map__lakepath").data([r.lakeBounds]),i=o.enter().append("path").classed("sszvis-map__lakepath",!0);o.exit().remove(),(o=o.merge(i)).attr("d",r.mapPath),r.lakePathColor&&o.style("stroke",r.lakePathColor)}))}var Br=e.timeFormatLocale(Vt).parse,Lr=Br("%d.%m.%Y"),Or=Br("%Y");function Dr(t){return function(){var e,r=(e=[[]],{addLine:function(){e.push([])},addWord:function(t,r){Z(e).push({text:at(r),style:t})},lines:function(){return e}});function n(e){return t(r,e)}return n.newline=function(){return r.addLine(),n},["bold","italic","plain"].forEach((function(t){n[t]=function(e){return r.addWord(t,e),n}})),n}}var Nr,jr=Dr((Nr={plain:function(t){return t},italic:function(t){return"<em>"+t+"</em>"},bold:function(t){return"<strong>"+t+"</strong>"}},function(t,e){return t.lines().map((function(t){return t.map((function(t){return Nr[t.style].call(null,t.text(e))})).join(" ")})).join("<br/>")})),Ir=Dr(function(){var t={plain:function(t){return"<tspan>"+t+"</tspan>"},italic:function(t){return'<tspan style="font-style:italic">'+t+"</tspan>"},bold:function(t){return'<tspan style="font-weight:bold">'+t+"</tspan>"}};return function(e,r){return e.lines().reduce((function(e,n,a){return e+'<tspan x="0" dy="'+(0===a?0:"1.2em")+'">'+n.map((function(e){return t[e.style].call(null,e.text(r))})).join(" ")+"</tspan>"}),"")}}()),Wr={resize:[]};"undefined"!=typeof window&&e.select(window).on("resize",function(t,e,r){var n,a=0;return arguments.length<3&&(r=!0),function(){var o=arguments,i=this;n=function(){t.apply(i,o),a=(new Date).getTime()+e,n=null,r&&setTimeout((function(){n&&n()}),e)},(new Date).getTime()>a&&n()}}((function(){Hr("resize")}),500));var Hr=function(t){var e=Array.prototype.slice.call(arguments,1);return Wr[t]&&Wr[t].forEach((function(t){t.apply(null,e)})),this},Gr={on:function(t,e){return Wr[t]||(Wr[t]=[]),Wr[t]=Wr[t].filter((function(t){return t!==e})).concat(e),this},off:function(t,e){return Wr[t]?(Wr[t]=Wr[t].filter((function(t){return t!==e})),this):this},trigger:Hr};t.AGGLOMERATION_2012_KEY="zurichAgglomeration2012",t.DEFAULT_LEGEND_COLOR_ORDINAL_ROW_HEIGHT=21,t.DEFAULT_WIDTH=516,t.GEO_KEY_DEFAULT="geoId",t.RATIO=16/9,t.STADT_KREISE_KEY="zurichStadtKreise",t.STATISTISCHE_QUARTIERE_KEY="zurichStatistischeQuartiere",t.STATISTISCHE_ZONEN_KEY="zurichStatistischeZonen",t.SWITZERLAND_KEY="switzerland",t.WAHL_KREISE_KEY="zurichWahlKreise",t.annotationCircle=function(){return Dt().prop("x",at).prop("y",at).prop("r",at).prop("dx",at).prop("dy",at).prop("caption",at).render((function(t){var r=e.select(this),n=r.props();it(r,"pattern","data-area-pattern").call(Ot);var a=r.selectAll(".sszvis-dataareacircle").data(t),o=a.enter().append("circle").classed("sszvis-dataareacircle",!0);if((a=a.merge(o)).attr("cx",n.x).attr("cy",n.y).attr("r",n.r).attr("fill","url(#data-area-pattern)"),n.caption){var i=r.selectAll(".sszvis-dataareacircle__caption").data(t),s=i.enter().append("text").classed("sszvis-dataareacircle__caption",!0);(i=i.merge(s)).attr("x",n.x).attr("y",n.y).attr("dx",n.dx).attr("dy",n.dy).text(n.caption)}}))},t.annotationLine=function(){return Dt().prop("x1").prop("x2").prop("y1").prop("y2").prop("xScale").prop("yScale").prop("dx",at).dx(0).prop("dy",at).dy(0).prop("caption",at).render((function(t){var r=e.select(this),n=r.props(),a=n.xScale(n.x1),o=n.yScale(n.y1),i=n.xScale(n.x2),s=n.yScale(n.y2),l=r.selectAll(".sszvis-referenceline").data(t);l.exit().remove();var c=l.enter().append("line").classed("sszvis-referenceline",!0);if((l=l.merge(c)).attr("x1",a).attr("y1",o).attr("x2",i).attr("y2",s),n.caption){var u=r.selectAll(".sszvis-referenceline__caption").data([0]);u.exit().remove();var p=u.enter().append("text").classed("sszvis-referenceline__caption",!0);(u=u.merge(p)).attr("transform",(function(){var t=i-a,e=s-o,r=180*Math.atan2(e,t)/Math.PI;return"translate("+(a+i)/2+","+(o+s)/2+") rotate("+r+")"})).attr("dx",n.dx).attr("dy",n.dy).text(n.caption)}}))},t.annotationRangeFlag=function(){return Dt().prop("x",at).prop("y0",at).prop("y1",at).render((function(t){var r=e.select(this),n=r.props(),a=U(Wt,n.x),o=U(Wt,n.y0),i=U(Wt,n.y1);r.selectAll(".sszvis-rangeFlag__mark.bottom").data(t).call(Jt("bottom",a,o)),r.selectAll(".sszvis-rangeFlag__mark.top").data(t).call(Jt("top",a,i));var s=Ut().position((function(t){return[a(t),Wt((n.y0(t)+n.y1(t))/2)]}));r.call(s)}))},t.annotationRangeRuler=function(){return Dt().prop("x",at).prop("y0",at).prop("y1",at).prop("top").prop("bottom").prop("label").label(at("")).prop("total").prop("flip",at).flip(!1).render((function(t){var r=e.select(this),n=r.props(),a=U(Wt,n.x),o=U(Wt,n.y0),i=U(Wt,n.y1),s=r.selectAll(".sszvis-rangeRuler__rule").data([0]),l=s.enter().append("line").classed("sszvis-rangeRuler__rule",!0);s.exit().remove(),(s=s.merge(l)).attr("x1",a).attr("y1",n.top).attr("x2",a).attr("y2",n.bottom);var c=r.selectAll(".sszvis-rangeRuler--mark").data(t),u=c.enter().append("g").classed("sszvis-rangeRuler--mark",!0);c.exit().remove(),c=c.merge(u),u.append("circle").classed("sszvis-rangeRuler__p1",!0),u.append("circle").classed("sszvis-rangeRuler__p2",!0),u.append("text").classed("sszvis-rangeRuler__label",!0),c.selectAll(".sszvis-rangeRuler__p1").data((function(t){return[t]})).attr("cx",a).attr("cy",o).attr("r",1.5),c.selectAll(".sszvis-rangeRuler__p2").data((function(t){return[t]})).attr("cx",a).attr("cy",i).attr("r",1.5),c.selectAll(".sszvis-rangeRuler__label").data((function(t){return[t]})).attr("x",(function(t){var e=n.flip(t)?-10:10;return a(t)+e})).attr("y",(function(t){return Wt((n.y0(t)+n.y1(t))/2)})).attr("dy","0.35em").style("text-anchor",(function(t){return n.flip(t)?"end":"start"})).text(U(Zt,n.label));var p=r.selectAll(".sszvis-rangeRuler__total").data([Z(t)]),d=p.enter().append("text").classed("sszvis-rangeRuler__total",!0);p.exit().remove(),(p=p.merge(d)).attr("x",(function(t){var e=n.flip(t)?-10:10;return a(t)+e})).attr("y",n.top-10).style("text-anchor",(function(t){return n.flip(t)?"end":"start"})).text("Total "+Zt(n.total))}))},t.annotationRectangle=function(){return Dt().prop("x",at).prop("y",at).prop("width",at).prop("height",at).prop("dx",at).prop("dy",at).prop("caption",at).render((function(t){var r=e.select(this),n=r.props();it(r,"pattern","data-area-pattern").call(Ot);var a=r.selectAll(".sszvis-dataarearectangle").data(t),o=a.enter().append("rect").classed("sszvis-dataarearectangle",!0);if((a=a.merge(o)).attr("x",n.x).attr("y",n.y).attr("width",n.width).attr("height",n.height).attr("fill","url(#data-area-pattern)"),n.caption){var i=r.selectAll(".sszvis-dataarearectangle__caption").data(t),s=i.enter().append("text").classed("sszvis-dataarearectangle__caption",!0);(i=i.merge(s)).attr("x",(function(t,e){return n.x(t,e)+n.width(t,e)/2})).attr("y",(function(t,e){return n.y(t,e)+n.height(t,e)/2})).attr("dx",n.dx).attr("dy",n.dy).text(n.caption)}}))},t.annotationRuler=function(){return Dt().prop("top").prop("bottom").prop("x",at).prop("y",at).prop("label").label(at("")).prop("color").prop("flip",at).flip(!1).prop("labelId",at).prop("reduceOverlap").reduceOverlap(!0).render((function(t){var r=e.select(this),n=r.props(),a=n.labelId||function(t){return n.x(t)+"_"+n.y(t)},o=r.selectAll(".sszvis-ruler__rule").data(t,a),i=o.enter().append("line").classed("sszvis-ruler__rule",!0);o.exit().remove(),(o=o.merge(i)).attr("x1",U(Wt,n.x)).attr("y1",n.y).attr("x2",U(Wt,n.x)).attr("y2",n.bottom);var s=r.selectAll(".sszvis-ruler__dot").data(t,a),l=s.enter().append("circle").classed("sszvis-ruler__dot",!0);s.exit().remove(),(s=s.merge(l)).attr("cx",U(Wt,n.x)).attr("cy",U(Wt,n.y)).attr("r",3.5).attr("fill",n.color);var c=r.selectAll(".sszvis-ruler__label-outline").data(t,a),u=c.enter().append("text").classed("sszvis-ruler__label-outline",!0);c.exit().remove(),c=c.merge(u);var p=r.selectAll(".sszvis-ruler__label").data(t,a),d=p.enter().append("text").classed("sszvis-ruler__label",!0);p.exit().remove(),p=p.merge(d);var f=U(Wt,n.x),h=U(Wt,n.y),v=r.selectAll(".sszvis-ruler__label, .sszvis-ruler__label-outline").attr("transform",(function(t){var e=f(t),r=h(t),a=n.flip(t)?-10:10,o=r<n.top+o?2*o:r>n.bottom-o?0:5;return Gt(e+a,r+o)})).style("text-anchor",(function(t){return n.flip(t)?"end":"start"})).html(n.label);if(n.reduceOverlap){var m=10,g=[],y={};for(v.attr("y",""),p.each((function(t){var e=this.getBoundingClientRect(),r={top:e.top,bottom:e.bottom,dy:0};g.push(r),y[a(t)]=r})),g.sort((function(t,r){return e.ascending(t.top,r.top)}));m--;)g.forEach((function(t,e){g.slice(e+1).forEach((function(e){var r=t.bottom-e.top;if(r>=2){var n=r/2;t.bottom-=n,t.top-=n,t.dy-=n,e.bottom+=n,e.top+=n,e.dy+=n}}))}));v.attr("y",(function(t){return y[a(t)].dy}))}}))},t.arity=G,t.aspectRatio=me,t.aspectRatio12to5=be,t.aspectRatio16to10=ye,t.aspectRatio4to3=ge,t.aspectRatioAuto=we,t.aspectRatioPortrait=ke,t.aspectRatioSquare=xe,t.axisX=Me,t.axisY=Re,t.bar=nr,t.bounds=Ke,t.breakpointCreateSpec=le,t.breakpointDefaultSpec=ue,t.breakpointFind=ae,t.breakpointFindByName=oe,t.breakpointLap=de,t.breakpointMatch=se,t.breakpointPalm=pe,t.breakpointTest=ie,t.buttonGroup=function(){return Dt().prop("values").prop("current").prop("width").width(300).prop("change").change(I).render((function(){var t=e.select(this),r=t.props(),n=r.width/r.values.length,a=t.selectAll(".sszvis-control-optionSelectable").data(["sszvis-control-buttonGroup"],(function(t){return t})),o=a.enter().append("div").classed("sszvis-control-optionSelectable",!0).classed("sszvis-control-buttonGroup",!0);a.exit().remove(),(a=a.merge(o)).style("width",r.width+"px");var i=a.selectAll(".sszvis-control-buttonGroup__item").data(r.values),s=i.enter().append("div").classed("sszvis-control-buttonGroup__item",!0);i.exit().remove(),(i=i.merge(s)).style("width",n+"px").classed("selected",(function(t){return t===r.current})).text((function(t){return t})).on("click",r.change)}))},t.cascade=Ze,t.choropleth=function(){var t=e.dispatch("over","out","click"),r=Fr(),n=Mr(),a=Rr(),o=Pr(),i=Dt().prop("width").prop("height").prop("keyName").keyName("geoId").prop("withLake").withLake(!0).prop("anchoredShape").prop("features").prop("borders").prop("lakeFeatures").prop("lakeBorders").prop("lakeFadeOut").lakeFadeOut(!1).delegate("defined",r).delegate("fill",r).delegate("transitionColor",r).delegate("borderColor",n).delegate("strokeWidth",n).delegate("highlight",o).delegate("highlightStroke",o).delegate("highlightStrokeWidth",o).delegate("lakePathColor",a).render((function(i){var s=e.select(this),l=s.props(),c=Sr(l.width,l.height,l.features,"zurichStadtfeatures"),u=Tr(i,l.features,l.keyName);r.geoJson(l.features).mergedData(u).mapPath(c),n.geoJson(l.borders).mapPath(c),a.lakeFeature(l.lakeFeatures).lakeBounds(l.lakeBorders).mapPath(c).fadeOut(l.lakeFadeOut),o.geoJson(l.features).keyName(l.keyName).mapPath(c),s.call(r).call(n),l.withLake&&s.call(a),s.call(o),l.anchoredShape&&(l.anchoredShape.mergedData(u).mapPath(c),s.call(l.anchoredShape)),s.selectAll("[data-event-target]").on("mouseover",(function(e){t.call("over",this,e.datum)})).on("mouseout",(function(e){t.call("out",this,e.datum)})).on("click",(function(e){t.call("click",this,e.datum)}))}));return i.on=function(){var e=t.on.apply(t,arguments);return e===t?i:e},i},t.colorLegendDimensions=kr,t.colorLegendLayout=function(t,r){var n=t.legendLabels,a=t.axisLabels,o=void 0===a?[]:a,i=t.slant,s=void 0===i?"horizontal":i,l=kr(n,Je(r).width),c=n.length>6?lt().domain(n):ct().domain(n),u=xr().scale(c).horizontalFloat(l.horizontalFloat).rows(l.rows).columnWidth(l.columnWidth).orientation(l.orientation),p=function(t,r){switch(t){case"vertical":return 40+e.max(r,Ye);case"diagonal":return 40+Math.sqrt(2*Math.pow(e.max(r,Ye)/2,2));default:return 60}}(s,o),d=21*l.rows;return{axisLabelPadding:p,legendPadding:d,bottomPadding:p+d,legendWidth:l.legendWidth,legend:u,scale:c}},t.compose=U,t.contains=function(t,e){return t.indexOf(e)>=0},t.createHtmlLayer=function(t,r,n){r||(r=Ke()),n||(n={});var a="data-sszvis-html-"+(n.key||"default"),o=H(t)?t:e.select(t);o.classed("sszvis-outer-container",!0);var i=o.selectAll("[data-sszvis-html-layer]["+a+"]").data([0]),s=i.enter().append("div").classed("sszvis-html-layer",!0).attr("data-sszvis-html-layer","").attr(a,"");return(i=i.merge(s)).style("position","absolute").style("left",r.padding.left+"px").style("top",r.padding.top+"px"),i},t.createSvgLayer=function(t,r,n){r||(r=Ke()),n||(n={});var a="data-sszvis-svg-"+(n.key||"default"),o=n.title||"",i=n.description||"",s=(H(t)?t:e.select(t)).selectAll("svg["+a+"]").data([0]),l=s.enter().append("svg");l.classed("sszvis-svg-layer",!0).attr(a,"").attr("role","img").attr("aria-label",o+" – "+i),l.append("title").text(o),l.append("desc").text(i).classed("sszvis-svg-layer",!0).attr(a,"").attr("role","img"),s.merge(l).attr("height",r.height).attr("width",r.width);var c=s.merge(l).selectAll("[data-sszvis-svg-layer]").data((function(){return[0]})),u=c.enter().append("g").attr("data-sszvis-svg-layer","");return c.merge(u).attr("transform","translate("+r.padding.left+","+r.padding.top+")"),c.merge(u)},t.dataAreaPattern=Ot,t.defaultTransition=tr,t.defined=J,t.derivedSet=function(t,e){e||(e=I);for(var r,n,a=[],o=[],i=0,s=t.length;i<s;++i)n=e(r=t[i],i,t),a.indexOf(n)<0&&(a.push(n),o.push(r));return o},t.dimensionsHeatTable=function(t,e,r,n,a){a||(a={}),a.top||(a.top=0),a.right||(a.right=0),a.bottom||(a.bottom=0),a.left||(a.left=0);var o=t-a.left-a.right,i=Math.min((o-e*(r-1))/r,30),s=i+e,l=r*s-e;return{side:i,paddedSide:s,padRatio:1-i/s,width:l,height:n*s-e,centeredOffset:Math.max((o-l)/2,0)}},t.dimensionsHorizontalBarChart=function(t){var e=24*t+20*(t-1);return{barHeight:24,padHeight:20,padRatio:1-24/44,outerRatio:0,axisOffset:-22,barGroupHeight:e,totalHeight:e+0}},t.dimensionsVerticalBarChart=function(t,e){var r=e-1,n=t*(1-.7)/((1-.7)*r+.7*e),a=(t-n*r)/e;a>48&&(n=(t-(a=48)*e)/r),n<2&&(n=2),n>100&&(n=100);var o=a*e+n*r;return{barWidth:a,padWidth:n,padRatio:1-a/(a+n),outerRatio:(t-o)/2/(a+n),barGroupWidth:o,totalWidth:t}},t.dot=function(){return Dt().prop("x",at).prop("y",at).prop("radius").prop("stroke").prop("fill").prop("transition").transition(!0).render((function(t){var r=e.select(this),n=r.props(),a=r.selectAll(".sszvis-circle").data(t);a.exit().remove(),a.enter().append("circle").classed("sszvis-circle",!0).attr("cx",n.x).attr("cy",n.y).attr("r",n.radius).merge(a).attr("stroke",n.stroke).attr("fill",n.fill),n.transition&&(a=a.transition(tr())),a.attr("cx",n.x).attr("cy",n.y).attr("r",n.radius);var o=Ut().position((function(t){return[n.x(t),n.y(t)]}));r.call(o)}))},t.ensureDefsElement=it,t.every=function(t,e){for(var r=0;r<e.length;r++)if(!t(e[r]))return!1;return!0},t.fallbackCanvasUnsupported=function(){return!!!document.createElement("canvas").getContext},t.fallbackRender=function(t,r){r||(r={}),r.src||(r.src="fallback.png"),(H(t)?t:e.select(t)).append("img").attr("class","sszvis-fallback-image").attr("src",r.src)},t.fallbackUnsupported=function(){return!(!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)},t.fastTransition=function(){return e.transition().ease($e).duration(50)},t.filledArray=V,t.find=Y,t.first=q,t.firstTouch=K,t.fitTooltip=function(t,e){var r=Math.min(1*e.innerWidth/4,100),n=Math.max(3*e.innerWidth/4,e.innerWidth-100);return function(e){var a=e.x;return a>n?"right":a<r?"left":t}},t.flatten=function(t){return Array.prototype.concat.apply([],t)},t.foldPattern=function(t,e){var r=e[t];if("function"==typeof r)return r();throw new Error("[foldPattern] No definition provided for key: "+t)},t.formatAge=function(t){return String(Math.round(t))},t.formatAxisTimeFormat=Kt,t.formatFractionPercent=function(t){return Zt(100*t)+" %"},t.formatMonth=Xt,t.formatNone=function(){return""},t.formatNumber=Zt,t.formatPercent=function(t){return Zt(t)+" %"},t.formatPreciseNumber=function t(e,r){return arguments.length>1?t(e)(r):function(t){var r=Math.abs(t);return r>=100&&r<1e4?qt("."+e+"f")(t):qt(",."+e+"f")(t)}},t.formatText=$t,t.formatYear=Qt,t.functor=at,t.getGeoJsonCenter=Cr,t.groupedBars=function(){return Dt().prop("groupScale").prop("groupSize").prop("groupWidth").prop("groupSpace").groupSpace(.05).prop("y",at).prop("height").prop("fill").prop("stroke").prop("defined",at).defined(!0).render((function(t){var r=e.select(this),n=r.props(),a=e.scaleBand().domain(e.range(n.groupSize)).padding(n.groupSpace).paddingOuter(0).rangeRound([0,n.groupWidth]),o=r.selectAll("g.sszvis-bargroup").data(t),i=o.enter().append("g").classed("sszvis-bargroup",!0);o.exit().remove();var s=(o=o.merge(i)).selectAll("g.sszvis-barunit").data((function(t){return t})),l=s.enter().append("g").classed("sszvis-barunit",!0);s.exit().remove(),(s=s.merge(l)).each((function(t,e){t.__sszvisGroupedBarIndex__=e}));var c=s.filter(n.defined);c.selectAll("*").remove(),c.attr("transform",(function(){return Gt(0,0)})),c.append("rect").classed("sszvis-bar",!0).attr("fill",n.fill).attr("x",(function(t){return n.groupScale(t)+a(t.__sszvisGroupedBarIndex__)})).attr("y",n.y).attr("width",a.bandwidth()).attr("height",n.height);var u=s.filter($(n.defined));u.selectAll("*").remove(),u.attr("transform",(function(t,e){return Gt(n.groupScale(t)+a(t.__sszvisGroupedBarIndex__)+a.bandwidth()/2,n.y(t,e))})),u.append("line").classed("sszvis-bar--missing line1",!0).attr("x1",-4).attr("y1",-4).attr("x2",4).attr("y2",4),u.append("line").classed("sszvis-bar--missing line2",!0).attr("x1",4).attr("y1",-4).attr("x2",-4).attr("y2",4);var p=Ut().position((function(t){var e=0,r=1/0;return t.forEach((function(t,o){e+=n.groupScale(t)+a(t.__sszvisGroupedBarIndex__)+a.bandwidth()/2,r=Math.min(r,n.y(t,o))})),[e/t.length,r]}));r.call(p)}))},t.halfPixel=Wt,t.handleRuler=function(){return Dt().prop("x",at).prop("y",at).prop("top").prop("bottom").prop("label").label(at("")).prop("color").prop("flip",at).flip(!1).render((function(t){var r=e.select(this),n=r.props(),a=U(Wt,n.x),o=U(Wt,n.y),i=n.bottom-4,s=n.top-24,l=r.selectAll(".sszvis-handleRuler__group").data([0]),c=l.enter().append("g").classed("sszvis-handleRuler__group",!0);l.exit().remove(),l=l.merge(c),c.append("line").classed("sszvis-ruler__rule",!0),c.append("rect").classed("sszvis-handleRuler__handle",!0),c.append("line").classed("sszvis-handleRuler__handle-mark",!0),l.selectAll(".sszvis-ruler__rule").attr("x1",a).attr("y1",Wt(n.top)).attr("x2",a).attr("y2",Wt(i)),l.selectAll(".sszvis-handleRuler__handle").attr("x",(function(t){return a(t)-5})).attr("y",Wt(s)).attr("width",10).attr("height",24).attr("rx",2).attr("ry",2),l.selectAll(".sszvis-handleRuler__handle-mark").attr("x1",a).attr("y1",Wt(s+24*.15)).attr("x2",a).attr("y2",Wt(s+20.4));var u=l.selectAll(".sszvis-ruler__dot").data(t),p=u.enter().append("circle").classed("sszvis-ruler__dot",!0);u.exit().remove(),(u=u.merge(p)).attr("cx",a).attr("cy",o).attr("r",3.5).attr("fill",n.color);var d=r.selectAll(".sszvis-ruler__label-outline").data(t),f=d.enter().append("text").classed("sszvis-ruler__label-outline",!0);d.exit().remove(),d=d.merge(f);var h=r.selectAll(".sszvis-ruler__label").data(t),v=h.enter().append("text").classed("sszvis-ruler__label",!0);h.exit().remove(),h=h.merge(v),r.selectAll(".sszvis-ruler__label, .sszvis-ruler__label-outline").attr("transform",(function(t){var e=U(Wt,n.x)(t),r=U(Wt,n.y)(t),a=n.flip(t)?-10:10,o=r<n.top+o?2*o:r>n.bottom-o?0:5;return Gt(e+a,r+o)})).style("text-anchor",(function(t){return n.flip(t)?"end":"start"})).html(n.label)}))},t.hashableSet=function(t,e){e||(e=I);for(var r,n={},a=[],o=0,i=t.length;o<i;++o)n[r=e(t[o],o,t)]||(n[r]=!0,a.push(r));return a},t.heatTableMissingValuePattern=function(t){var e=wt();t.attr("patternUnits","objectBoundingBox").attr("patternContentUnits","objectBoundingBox").attr("x",0).attr("y",0).attr("width",1).attr("height",1),t.append("rect").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("fill",e),t.append("line").attr("x1",.35).attr("y1",.35).attr("x2",.65).attr("y2",.65).attr("stroke-width",.035).attr("stroke","#A4A4A4"),t.append("line").attr("x1",.65).attr("y1",.35).attr("x2",.35).attr("y2",.65).attr("stroke-width",.035).attr("stroke","#A4A4A4")},t.identity=I,t.isFunction=function(t){return"function"==typeof t},t.isNull=X,t.isNumber=function(t){return"[object Number]"===Object.prototype.toString.call(t)&&!Number.isNaN(t)},t.isObject=Q,t.isSelection=H,t.isString=W,t.last=Z,t.layoutPopulationPyramid=function(t,e){for(var r=Math.min(ke(t),480),n=1*(e-1),a=Math.round((r-n)/e),o=e*(a=Math.max(a,2))+n,i=o-a,s=a+1,l=[];i>=0;)l.push(i),i-=s;var c=Math.min(t/2,.8*ke.MAX_HEIGHT/2);return{barHeight:a,padding:1,totalHeight:o,positions:l,maxBarLength:c,chartPadding:Math.max((t-2*c)/2,1)}},t.layoutSmallMultiples=function(){return Dt().prop("width").prop("height").prop("paddingX").prop("paddingY").prop("rows").prop("cols").render((function(t){var r=e.select(this),n=r.props(),a=(n.width-n.paddingX*(n.cols-1))/n.cols,o=(n.height-n.paddingY*(n.rows-1))/n.rows,i=a/2,s=o/2,l=r.selectAll("g.sszvis-multiple").data(t),c=l.enter().append("g").classed("sszvis-g sszvis-multiple",!0);l.exit().remove();var u=(l=l.merge(c)).selectAll("g.sszvis-multiple-chart").data((function(t){return[t.values]})),p=u.enter().append("g").classed("sszvis-multiple-chart",!0);u.exit().remove(),u=u.merge(p),l.datum((function(t,e){return t.gx=e%n.cols*(a+n.paddingX),t.gw=a,t.cx=i,t.gy=Math.floor(e/n.cols)*(o+n.paddingY),t.gh=o,t.cy=s,t})).attr("transform",(function(t){return"translate("+t.gx+","+t.gy+")"}))}))},t.layoutStackedAreaMultiples=function(t,e,r){r||(r=.1);for(var n=t/(e-r),a=n*(1-r),o=a,i=[];o-t<1;)i.push(o),o+=n;return{range:i,bandHeight:a,padHeight:n*r}},t.legendColorBinned=function(){return Dt().prop("scale").prop("displayValues").prop("endpoints").prop("width").width(200).prop("labelFormat").labelFormat(I).render((function(){var t=e.select(this),r=t.props();if(!r.scale)return Ae("legend.binnedColorScale - a scale must be specified.");if(!r.displayValues)return Ae("legend.binnedColorScale - display values must be specified.");if(!r.endpoints)return Ae("legend.binnedColorScale - endpoints must be specified");var n=[0,r.width-10],a=e.scaleLinear().domain(r.endpoints).range(n),o=0,i=[],s=r.endpoints[0];r.displayValues.forEach((function(t){var e=a(t)-o,n=o%1;i.push({x:Math.floor(5+o),w:e+n,c:r.scale(s),p:t}),o+=e,s=t})),i.push({x:Math.floor(5+o),w:n[1]-o,c:r.scale(s)});var l=t.selectAll("circle.sszvis-legend__circle").data(r.endpoints),c=l.enter().append("circle").classed("sszvis-legend__circle",!0);(l=l.merge(c)).exit().remove(),l.attr("r",5).attr("cy",5).attr("cx",(function(t,e){return 0===e?5:r.width-5})).attr("fill",r.scale);var u=t.selectAll("rect.sszvis-legend__crispmark").data(i),p=u.enter().append("rect").classed("sszvis-legend__crispmark",!0);(u=u.merge(p)).exit().remove(),u.attr("x",(function(t){return t.x})).attr("y",0).attr("width",(function(t){return t.w})).attr("height",10).attr("fill",(function(t){return t.c}));var d=i.slice(0,-1),f=t.selectAll("line.sszvis-legend__crispmark").data(d),h=f.enter().append("line").classed("sszvis-legend__crispmark",!0);f.merge(h),f.exit().remove(),f.attr("x1",(function(t){return Wt(t.x+t.w)})).attr("x2",(function(t){return Wt(t.x+t.w)})).attr("y1",11).attr("y2",16).attr("stroke","#B8B8B8");var v=t.selectAll(".sszvis-legend__axislabel").data(d),m=v.enter().append("text").classed("sszvis-legend__axislabel",!0);(v=v.merge(m)).exit().remove(),v.style("text-anchor","middle").attr("transform",(function(t){return"translate("+(t.x+t.w)+",30)"})).text((function(t){return r.labelFormat(t.p)}))}))},t.legendColorLinear=function(){return Dt().prop("scale").prop("displayValues").displayValues([]).prop("width").width(200).prop("segments").segments(8).prop("labelText").prop("labelFormat").labelFormat(I).render((function(){var t=e.select(this),r=t.props();if(!r.scale)return Ae("legend.linearColorScale - a scale must be specified."),!1;var n=r.scale.domain(),a=r.displayValues;!a.length&&r.scale.ticks&&(a=r.scale.ticks(r.segments-1)),a.push(Z(n));var o=a.length>0?r.width/a.length:0,i=t.selectAll("rect.sszvis-legend__mark").data(a),s=i.enter().append("rect").classed("sszvis-legend__mark",!0);i.exit().remove(),(i=i.merge(s)).attr("x",(function(t,e){return e*o-1})).attr("y",0).attr("width",o+1).attr("height",10).attr("fill",(function(t){return r.scale(t)}));var l=[q(n),Z(n)],c=r.labelText||l,u=t.selectAll("circle.ssvis-legend--mark").data(l),p=u.enter().append("circle").attr("class","ssvis-legend--mark");u.exit().remove(),(u=u.merge(p)).attr("cx",(function(t,e){return e*r.width})).attr("cy",5).attr("r",5).attr("fill",(function(t){return r.scale(t)}));var d=t.selectAll(".sszvis-legend__label").data(c),f=d.enter().append("text").classed("sszvis-legend__label",!0);d.exit().remove(),d=d.merge(f);d.style("text-anchor",(function(t,e){return 0===e?"end":"start"})).attr("dy","0.35em").attr("transform",(function(t,e){return"translate("+(e*r.width+16*(0===e?-1:1))+", 5)"})).text((function(t,e){return r.labelFormat(t,e)}))}))},t.legendColorOrdinal=xr,t.legendRadius=function(){return Dt().prop("scale").prop("tickFormat").tickFormat(I).prop("tickValues").render((function(){var t=e.select(this),r=t.props(),n=r.scale.domain(),a=r.tickValues||[n[1],r.scale.invert(e.mean(r.scale.range())),n[0]],o=Ce(r.scale)[1],i=t.selectAll("g.sszvis-legend__elementgroup").data([0]),s=i.enter().append("g").attr("class","sszvis-legend__elementgroup");(i=i.merge(s)).attr("transform",Gt(Wt(o),Wt(o)));var l=i.selectAll("circle.sszvis-legend__greyline").data(a),c=l.enter().append("circle").classed("sszvis-legend__greyline",!0);function u(t){return o-2*r.scale(t)}l.exit().remove(),(l=l.merge(c)).attr("r",r.scale).attr("stroke-width",1).attr("cy",(function(t){return o-r.scale(t)}));var p=i.selectAll("line.sszvis-legend__dashedline").data(a),d=p.enter().append("line").classed("sszvis-legend__dashedline",!0);p.exit().remove(),(p=p.merge(d)).attr("x1",0).attr("y1",u).attr("x2",o+15).attr("y2",u);var f=i.selectAll(".sszvis-legend__label").data(a),h=f.enter().append("text").attr("class","sszvis-legend__label sszvis-legend__label--small");f.exit().remove(),(f=f.merge(h)).attr("dx",o+18).attr("y",u).attr("dy","0.35em").text(r.tickFormat)}))},t.line=function(){return Dt().prop("x").prop("y").prop("stroke").prop("strokeWidth").prop("defined").prop("key").key((function(t,e){return e})).prop("valuesAccessor").valuesAccessor(I).prop("transition").transition(!0).render((function(t){var r=e.select(this),n=r.props(),a=e.line().defined(void 0!==n.defined?n.defined:U($(isNaN),n.y)).x(n.x).y(n.y),o=r.selectAll(".sszvis-line").data(t,n.key),i=o.enter().append("path").classed("sszvis-line",!0).style("stroke",n.stroke);(o=o.merge(i)).exit().remove(),o.order(),n.transition&&(o=o.transition(tr())),o.attr("d",U(a,n.valuesAccessor)).style("stroke",n.stroke).style("stroke-width",n.strokeWidth)}))},t.loadError=function(t){Ae(t)},t.locale=Vt,t.mapLakeFadeGradient=Bt,t.mapLakeGradientMask=Lt,t.mapLakePattern=Rt,t.mapMissingValuePattern=Mt,t.mapRendererBase=Fr,t.mapRendererBubble=function(){var t=e.dispatch("over","out","click"),r=Dt().prop("mergedData").prop("mapPath").prop("radius",at).prop("fill",at).prop("strokeColor",at).strokeColor("#ffffff").prop("strokeWidth",at).strokeWidth(1).prop("transition").transition(!0).render((function(){var r=e.select(this),n=r.props(),a=U(n.radius,Er),o=r.selectGroup("anchoredCircles").selectAll(".sszvis-anchored-circle").data(n.mergedData,(function(t){return t.geoJson.id}));if(o.enter().append("circle").attr("class","sszvis-anchored-circle sszvis-anchored-circle--entering").attr("r",a).on("mouseover",(function(e){t.call("over",this,e.datum)})).on("mouseout",(function(e){t.call("out",this,e.datum)})).on("click",(function(e){t.call("click",this,e.datum)})).merge(o).attr("transform",(function(t){var e=n.mapPath.projection()(Cr(t.geoJson));return Gt(e[0],e[1])})).style("fill",(function(t){return n.fill(t.datum)})).style("stroke",(function(t){return n.strokeColor(t.datum)})).style("stroke-width",(function(t){return n.strokeWidth(t.datum)})).sort((function(t,e){return n.radius(e.datum)-n.radius(t.datum)})),o.classed("sszvis-anchored-circle--entering",!1),n.transition){var i=tr();o.exit().transition(i).attr("r",0).remove(),o.transition(i).attr("r",a)}else o.exit().remove(),o.attr("r",a)}));return r.on=function(){var e=t.on.apply(t,arguments);return e===t?r:e},r},t.mapRendererGeoJson=function(){var t=e.dispatch("over","out","click"),r=Dt().prop("dataKeyName").dataKeyName("geoId").prop("geoJsonKeyName").geoJsonKeyName("id").prop("geoJson").prop("mapPath").prop("defined",at).defined(!0).prop("fill",at).fill("black").prop("stroke",at).stroke("black").prop("strokeWidth",at).strokeWidth(1.25).prop("transitionColor").transitionColor(!0).render((function(r){var n=e.select(this),a=n.props();it(n,"pattern","missing-pattern").call(Mt);var o=tt(a.dataKeyName),i=tt(a.geoJsonKeyName),s=r.reduce((function(t,e){return t[o(e)]=e,t})),l=a.geoJson.features.map((function(t){return{geoJson:t,datum:s[i(t.properties)]}}));function c(t){return J(t.datum)&&a.defined(t.datum)?a.fill(t.datum):"url(#missing-pattern)"}var u=n.selectAll(".sszvis-map__geojsonelement").data(l),p=u.enter().append("path").classed("sszvis-map__geojsonelement",!0).attr("data-event-target","").attr("fill",c);u.exit().remove(),u=u.merge(p),n.selectAll(".sszvis-map__geojsonelement--undefined").attr("fill",c),u.classed("sszvis-map__geojsonelement--undefined",(function(t){return!J(t.datum)||!a.defined(t.datum)})).attr("d",(function(t){return a.mapPath(t.geoJson)})),a.transitionColor?u.transition().call(er).attr("fill",c):u.attr("fill",c),u.attr("stroke",(function(t){return J(t.datum)&&a.defined(t.datum)?a.stroke(t.datum):""})).attr("stroke-width",a.strokeWidth),n.selectAll("[data-event-target]").on("mouseover",(function(e){t.over(e.datum)})).on("mouseout",(function(e){t.out(e.datum)})).on("click",(function(e){t.click(e.datum)}));var d=Ut().position((function(t){t.geoJson.properties||(t.geoJson.properties={});var r=t.geoJson.properties.sphericalCentroid;return r||(t.geoJson.properties.sphericalCentroid=r=e.geoCentroid(t.geoJson)),a.mapPath.projection()(r)}));n.selectGroup("tooltipAnchors").datum(l).call(d)}));return r.on=function(){var e=t.on.apply(t,arguments);return e===t?r:e},r},t.mapRendererHighlight=Pr,t.mapRendererImage=function(){return Dt().prop("projection").prop("src").prop("geoBounds").prop("opacity").opacity(1).render((function(){var t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-map__image").data([0]),a=n.enter().append("img").classed("sszvis-map__image",!0);n.exit().remove(),n=n.merge(a);var o=r.projection(r.geoBounds[0]),i=r.projection(r.geoBounds[1]);n.attr("src",r.src).style("left",Math.round(o[0])+"px").style("top",Math.round(o[1])+"px").style("width",Math.round(i[0]-o[0])+"px").style("height",Math.round(i[1]-o[1])+"px").style("opacity",r.opacity)}))},t.mapRendererMesh=Mr,t.mapRendererPatternedLakeOverlay=Rr,t.mapRendererRaster=function(){return Dt().prop("debug").debug(!1).prop("width").prop("height").prop("position").prop("cellSide").cellSide(2).prop("fill",at).prop("opacity").opacity(1).render((function(t){var r=e.select(this),n=r.props(),a=r.selectAll(".sszvis-map__rasterimage").data([0]),o=a.enter().append("canvas").classed("sszvis-map__rasterimage",!0);a.exit().remove(),(a=a.merge(o)).attr("width",n.width).attr("height",n.height).style("opacity",n.opacity);var i=a.node().getContext("2d");i.clearRect(0,0,n.width,n.height),n.debug&&(i.fillStyle="rgba(255, 0, 0, 0.2)",i.fillRect(0,0,n.width,n.height));var s=n.cellSide/2;t.forEach((function(t){var e=n.position(t);i.fillStyle=n.fill(t),i.fillRect(e[0]-s,e[1]-s,n.cellSide,n.cellSide)}))}))},t.measureAxisLabel=Ye,t.measureDimensions=Je,t.measureLegendLabel=qe,t.measureText=Ve,t.memoize=ot,t.modularTextHTML=jr,t.modularTextSVG=Ir,t.move=Oe,t.muchDarker=function(t){return e.hsl(t).darker(.7)},t.not=$,t.panning=function(){var t=e.dispatch("start","pan","end"),r=Dt().prop("elementSelector").render((function(){var r=e.select(this),n=r.props();r.selectAll(n.elementSelector).attr("data-sszvis-behavior-pannable","").classed("sszvis-interactive",!0).on("mouseenter",(function(){t.apply("start",this,arguments)})).on("mousemove",(function(){t.apply("pan",this,arguments)})).on("mouseleave",(function(){t.apply("end",this,arguments)})).on("touchstart",(function(){e.event.preventDefault(),t.apply("start",this,arguments)})).on("touchmove",(function(){e.event.preventDefault();var r=Ie(K(e.event));null!==r?t.apply("pan",this,arguments):t.apply("end",this,arguments)})).on("touchend",(function(){t.apply("end",this,arguments)}))}));return r.on=function(){var e=t.on.apply(t,arguments);return e===t?r:e},r},t.parseDate=function(t){return Lr(t)},t.parseNumber=function(t){return""===t.trim()?NaN:+t},t.parseYear=function(t){return Or(t)},t.pie=function(){return Dt().prop("radius").prop("fill").prop("stroke").prop("angle",at).render((function(t){var r=e.select(this),n=r.props(),a=0;t.forEach((function(t){t._a0=a,isNaN(t.a0)&&(t.a0=a),a+=n.angle(t),t._a1=a,isNaN(t.a1)&&(t.a1=a)}));var o=e.arc().innerRadius(4).outerRadius(n.radius).startAngle((function(t){return t.a0})).endAngle((function(t){return t.a1})),i=r.selectAll(".sszvis-path").each((function(e,r){t[r]&&(t[r].a0=e.a0,t[r].a1=e.a1)})).data(t),s=i.enter().append("path").classed("sszvis-path",!0).attr("transform","translate("+n.radius+","+n.radius+")").attr("fill",n.fill).attr("stroke",n.stroke);i.exit().remove(),(i=i.merge(s)).transition(tr()).attr("transform","translate("+n.radius+","+n.radius+")").attrTween("d",(function(t){var r=e.interpolate(t.a0,t._a0),n=e.interpolate(t.a1,t._a1);return function(e){return t.a0=r(e),t.a1=n(e),o(t)}})).attr("fill",n.fill).attr("stroke",n.stroke);var l=Ut().position((function(t){var e=t.a0+Math.abs(t.a1-t.a0)/2-Math.PI/2,r=2*n.radius/3;return[n.radius+Math.cos(e)*r,n.radius+Math.sin(e)*r]}));r.datum(t).call(l)}))},t.pixelsFromGeoDistance=function(t,e,r){var n=r/(2*Math.PI*6367475)*360/2,a=[[e[0]-n,e[1]-n],[e[0]+n,e[1]+n]].map(t);return(Math.abs(a[1][0]-a[0][0])+Math.abs(a[1][1]-a[0][1]))/2},t.prepareMergedGeoData=Tr,t.prop=tt,t.propOr=et,t.pyramid=function(){return Dt().prop("barHeight",at).prop("barWidth",at).prop("barPosition",at).prop("barFill",at).barFill("#000").prop("tooltipAnchor").tooltipAnchor([.5,.5]).prop("leftAccessor").prop("rightAccessor").prop("leftRefAccessor").prop("rightRefAccessor").render((function(t){var r=e.select(this),n=r.props(),a=nr().x((function(t){return-.5-n.barWidth(t)})).y(n.barPosition).height(n.barHeight).width(n.barWidth).fill(n.barFill).tooltipAnchor(n.tooltipAnchor),o=nr().x(.5).y(n.barPosition).height(n.barHeight).width(n.barWidth).fill(n.barFill).tooltipAnchor(n.tooltipAnchor),i=ar().barPosition(n.barPosition).barWidth(n.barWidth).mirror(!0),s=ar().barPosition(n.barPosition).barWidth(n.barWidth);r.selectGroup("left").datum(n.leftAccessor(t)).call(a),r.selectGroup("right").datum(n.rightAccessor(t)).call(o),r.selectGroup("leftReference").datum(n.leftRefAccessor?[n.leftRefAccessor(t)]:[]).call(i),r.selectGroup("rightReference").datum(n.rightRefAccessor?[n.rightRefAccessor(t)]:[]).call(s)}))},t.range=Ce,t.responsiveProps=function(){var t=ue(),e={};function r(r){if(!(Q(r)&&(n=r,J(n)&&J(n.width)&&J(n.screenWidth)&&J(n.screenHeight))))return ze("Could not determine the current breakpoint, returning the default props"),Object.keys(e).reduce((function(t,e,r){return t[r]=e._,t}),{});var n,a=se(t,r);return Object.keys(e).reduce((function(n,o){var i=e[o];if(!function(t,e){if(!J(t._))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&"_"!==r&&!J(oe(e,r)))return!1;return!0}(i,t))return ze('responsiveProps was given an invalid propSpec for property: "'+o+'". The spec: ',i),n;var s=Y((function(t){return J(i[t.name])}),a);return n[o]=i[s.name](r.width),n}),{})}return r.prop=function(t,n){var a;return e[t]=(a=n,Object.keys(a).reduce((function(t,e){return t[e]=at(a[e]),t}),{})),r},r.breakpoints=function(e){return 0===arguments.length?t:(t=le(e),r)},r},t.roundTransformString=function(t){var e=U(Math.floor,Number);return t.replace(/(translate\()\s*([0-9., ]+)\s*(\))/i,(function(t,r,n,a){return r+n.replace(","," ").replace(/\s+/," ").split(" ").map(e).join(",")+a}))},t.sankey=function(){return Dt().prop("sizeScale").prop("columnPosition").prop("nodeThickness").prop("nodePadding").prop("columnPadding",at).prop("columnLabel",at).columnLabel("").prop("columnLabelOffset",at).columnLabelOffset(0).prop("linkCurvature").linkCurvature(.5).prop("nodeColor",at).prop("linkColor",at).prop("linkSort",at).linkSort((function(t,e){return t.value-e.value})).prop("labelSide",at).labelSide("left").prop("labelSideSwitch").prop("labelOpacity",at).labelOpacity(1).prop("labelHitBoxSize").labelHitBoxSize(0).prop("nameLabel").nameLabel(I).prop("linkSourceLabels").linkSourceLabels([]).prop("linkTargetLabels").linkTargetLabels([]).prop("linkLabel",at).render((function(t){var r=e.select(this),n=r.props(),a=tt("id"),o=function(t){return Math.floor(n.columnPadding(t.columnIndex)+n.sizeScale(t.valueOffset)+n.nodePadding*t.nodeIndex)},i=function(t){return n.columnPosition(t.columnIndex)},s=function(t){return o(t)},l=function(){return Math.max(n.nodeThickness,1)},c=function(t){return Math.ceil(Math.max(n.sizeScale(t.value),1))},u=nr().x(i).y(s).width(l).height(c).fill(n.nodeColor),p=r.selectGroup("nodes").datum(t.nodes);p.call(u);var d=Ut().position((function(t){return[i(t)+l()/2,s(t)+c(t)/2]}));p.call(d);var f=function(t){return n.columnPosition(t)+n.nodeThickness/2},h=p.selectAll(".sszvis-sankey-column-label").data(t.columnLengths),v=h.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-weak-label sszvis-sankey-column-label");(h=h.merge(v)).exit().remove(),h.attr("transform",(function(t,e){return Gt(f(e)+n.columnLabelOffset(t,e),-24)})).text((function(t,e){return n.columnLabel(e)}));var m=p.selectAll(".sszvis-sankey-column-label-tick").data(t.columnLengths),g=m.enter().append("line").attr("class","sszvis-sankey-column-label-tick");(m=m.merge(g)).exit().remove(),m.attr("x1",(function(t,e){return Wt(f(e))})).attr("x2",(function(t,e){return Wt(f(e))})).attr("y1",Wt(-16)).attr("y2",Wt(-12));var y=function(t){return[n.columnPosition(t.src.columnIndex)+n.nodeThickness+1,n.columnPosition(t.tgt.columnIndex)-1,o(t.src)+n.sizeScale(t.srcOffset)+n.sizeScale(t.value)/2,o(t.tgt)+n.sizeScale(t.tgtOffset)+n.sizeScale(t.value)/2]},b=function(t){var e,r,n,a,o=y(t);return e=o[0],r=o[1],n=o[2],a=o[3],[e,r,n,a]},x=r.selectGroup("links"),k=x.selectAll(".sszvis-link").data(t.links,a),_=k.enter().append("path").attr("class","sszvis-link");(k=k.merge(_)).exit().remove(),k.attr("fill","none").attr("d",(function(t){var r,a,o,i,s,l,c=y(t),u=e.interpolateNumber(c[0],c[1]),p=u(n.linkCurvature),d=u(1-n.linkCurvature);return r=c[0],a=p,o=d,i=c[1],s=c[2],l=c[3],"M"+r+","+s+"C"+a+","+s+" "+o+","+l+" "+i+","+l})).attr("stroke-width",(function(t){return Math.max(n.sizeScale(t.value),1)})).attr("stroke",n.linkColor).sort(n.linkSort),x.datum(t.links);var w=Ut().position((function(t){var e=b(t);return[(e[0]+e[1])/2,(e[2]+e[3])/2]}));x.call(w);var z=r.selectGroup("linklabels"),A=z.selectAll(".sszvis-sankey-link-source-label").data(n.linkSourceLabels),S=A.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-strong-label sszvis-sankey-link-source-label");(A=A.merge(S)).exit().remove(),A.attr("transform",(function(t){var e=b(t);return Gt(e[0]+6,e[2])})).text(n.linkLabel);var T=z.selectAll(".sszvis-sankey-link-target-label").data(n.linkTargetLabels),C=T.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-strong-label sszvis-sankey-link-target-label");(T=T.merge(C)).exit().remove(),T.attr("transform",(function(t){var e=b(t);return Gt(e[1]-6,e[3])})).text(n.linkLabel);var E=function(t){var e=n.labelSide(t);return n.labelSideSwitch&&(e="left"===e?"right":"left"),e},F=r.selectGroup("nodelabels"),P=F.selectAll(".sszvis-sankey-node-label").data(t.nodes),M=P.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-weak-label sszvis-sankey-node-label");(P=P.merge(M)).exit().remove(),P.text((function(t){return n.nameLabel(t.id)})).attr("text-align","middle").attr("text-anchor",(function(t){return"left"===E(t.columnIndex)?"end":"start"})).attr("x",(function(t){return"left"===E(t.columnIndex)?i(t)-6:i(t)+n.nodeThickness+6})).attr("y",(function(t){return s(t)+c(t)/2})).style("opacity",n.labelOpacity);var R=F.selectAll(".sszvis-sankey-hitbox").data(t.nodes),B=R.enter().append("rect").attr("class","sszvis-sankey-hitbox");(R=R.merge(B)).exit().remove(),R.attr("fill","transparent").attr("x",(function(t){return i(t)+("left"===E(t.columnIndex)?-n.labelHitBoxSize:0)})).attr("y",(function(t){return s(t)-n.nodePadding/2})).attr("width",n.labelHitBoxSize+n.nodeThickness).attr("height",(function(t){return c(t)+n.nodePadding}))}))},t.sankeyLayout=function(t,r,n,a){var o=e.min(t.map((function(t){var e=.15*n/(t-1);return Math.max(12,Math.min(50,e))}))),i=e.min(t.map((function(t,e){return Math.max(1,n-(t-1)*o)/r[e]}))),s=o/i,l=o,c=e.max(r),u=t.map((function(t,e){return r[e]*i+(t-1)*l})),p=e.max(u),d=t.map((function(t,e){return(p-u[e])/2})),f=[0,c],h=[0,c*i],v=t.length;return{valuePadding:s,nodePadding:l,columnPaddings:d,valueDomain:f,valueRange:h,nodeThickness:20,columnDomain:[0,1],columnRange:[0,(a-20)/(v-1)]}},t.sankeyPrepareData=function(){var t=I,r=I,n=I,a=[],o=tt("value"),i=function(t,r){return e.ascending(o(t),o(r))},s=function(t,r){return e.descending(o(t),o(r))},l=s,c=function(i){var c=a.reduce((function(t,e,r){return e.forEach((function(e){t.has(e)&&ze("Duplicate column member id passed to sszvis.layout.sankey.prepareData.column:",e,"The existing value will be overwritten");var n={id:e,columnIndex:r,nodeIndex:0,value:0,valueOffset:0,linksFrom:[],linksTo:[]};t.set(e,n)})),t}),e.map()),u=i.map((function(e){var a=t(e),o=r(e),i=+n(e)||0,s=c.get(a),l=c.get(o);if(!s)return ze("Found invalid source column id:",a),null;if(!l)return ze("Found invalid target column id:",o),null;var u={id:zr(),value:i,src:s,srcOffset:0,tgt:l,tgtOffset:0};return s.linksFrom.push(u),l.linksTo.push(u),u})),p=c.values(),d=p.reduce((function(t,r){var n=e.sum(r.linksFrom,o),a=e.sum(r.linksTo,o);return r.value=Math.max(0,n,a),t[r.columnIndex]+=r.value,t}),V(a.length,0)),f=a.map((function(t){return t.length}));return p.sort(l),u.sort(s),p.reduce((function(t,e){return e.valueOffset=t[0][e.columnIndex],e.nodeIndex=t[1][e.columnIndex],t[0][e.columnIndex]+=e.value,t[1][e.columnIndex]+=1,t}),[V(a.length,0),V(a.length,0)]),p.forEach((function(t){t.linksFrom.sort((function(t,e){return t.tgt.nodeIndex-e.tgt.nodeIndex})),t.linksTo.sort((function(t,e){return t.src.nodeIndex-e.src.nodeIndex})),t.linksFrom.reduce((function(t,e){return e.srcOffset=t,t+o(e)}),0),t.linksTo.reduce((function(t,e){return e.tgtOffset=t,t+o(e)}),0)})),{nodes:p,links:u,columnTotals:d,columnLengths:f}};return c.apply=function(t){return c(t)},c.source=function(e){return t=e,c},c.target=function(t){return r=t,c},c.value=function(t){return n=t,c},c.descendingSort=function(){return l=s,c},c.ascendingSort=function(){return l=i,c},c.idLists=function(t){return a=t,c},c},t.scaleDeepGry=Ct,t.scaleDimGry=St,t.scaleDivNtr=xt,t.scaleDivNtrGry=kt,t.scaleDivVal=yt,t.scaleDivValGry=bt,t.scaleGry=At,t.scaleLightGry=wt,t.scaleMedGry=Tt,t.scalePaleGry=zt,t.scaleQual12=lt,t.scaleQual6=ct,t.scaleQual6a=ut,t.scaleQual6b=pt,t.scaleSeqBlu=ft,t.scaleSeqBrn=mt,t.scaleSeqGrn=vt,t.scaleSeqRed=ht,t.selectMenu=function(){return Dt().prop("values").prop("current").prop("width").width(300).prop("change").change(I).render((function(){var t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-control-optionSelectable").data(["sszvis-control-select"],(function(t){return t})),a=n.enter().append("div").classed("sszvis-control-optionSelectable",!0).classed("sszvis-control-select",!0);n.exit().remove(),(n=n.merge(a)).style("width",r.width+"px");var o=n.selectDiv("selectMetrics").classed("sszvis-control-select__metrics",!0),i=n.selectAll(".sszvis-control-select__element").data([1]),s=i.enter().append("select").classed("sszvis-control-select__element",!0).on("change",(function(){var t=e.select(this).property("value");r.change(r.values[t]),setTimeout((function(){window.focus()}),0)}));(i=i.merge(s)).style("width",r.width+30+"px");var l=i.selectAll("option").data(r.values),c=l.enter().append("option");l.exit().remove(),l.merge(c).attr("selected",(function(t){return t===r.current?"selected":null})).attr("value",(function(t,e){return e})).text((function(t){return function(t,e,r){return function r(n,a){t.text(n);var o=Math.ceil(t.node().clientWidth);return a<1e3&&o>e?r(n.slice(0,n.length-2)+"…",a+1):n}(r,0)}(o,r.width-40,t)}))}))},t.set=rt,t.slider=function(){return Dt().prop("scale").prop("value").prop("onchange").prop("minorTicks").minorTicks([]).prop("majorTicks").majorTicks([]).prop("tickLabels",at).tickLabels(I).prop("label",at).label(I).render((function(){var t=e.select(this),r=t.props(),n=Wt(18),a=r.scale.domain(),o=Ce(r.scale),i=r.scale.copy().range([o[0]+5.5,o[1]-5.5]),s=t.selectAll("g.sszvis-control-slider__backgroundgroup").data([1]),l=s.enter().append("g").classed("sszvis-control-slider__backgroundgroup",!0);(s=s.merge(l)).exit().remove();var c=Me().scale(i).orient("bottom").hideBorderTickThreshold(0).tickSize(12).tickPadding(6).tickValues(rt([].concat(r.majorTicks,r.minorTicks))).tickFormat((function(t){return br(t,r.majorTicks)?r.tickLabels(t):""})),u=s.selectAll("g.sszvis-axisGroup").data([1]),p=u.enter().append("g").classed("sszvis-axisGroup sszvis-axis sszvis-axis--bottom sszvis-axis--slider",!0);(u=u.merge(p)).attr("transform",Gt(0,28)).call(c),u.selectAll(".tick line").filter((function(t){return!br(t,r.majorTicks)})).attr("y2",4);var d=u.selectAll(".tick text").filter((function(t){return br(t,r.majorTicks)})),f=d.size();d.style("text-anchor",(function(t,e){return 0===e?"start":e===f-1?"end":"middle"}));var h=s.selectAll("g.sszvis-slider__background").data([1]),v=h.enter().append("g").classed("sszvis-slider__background",!0);(h=h.merge(v)).attr("transform",Gt(0,n));var m=h.selectAll(".sszvis-slider__background__bg1").data([1]),g=m.enter().append("line").classed("sszvis-slider__background__bg1",!0).style("stroke-width",6).style("stroke","#888").style("stroke-linecap","round");(m=m.merge(g)).attr("x1",Math.ceil(o[0]+3)).attr("x2",Math.floor(o[1]-3));var y=h.selectAll(".sszvis-slider__background__bg2").data([1]),b=y.enter().append("line").classed("sszvis-slider__background__bg2",!0).style("stroke-width",5).style("stroke","#fff").style("stroke-linecap","round");(y=y.merge(b)).attr("x1",Math.ceil(o[0]+3)).attr("x2",Math.floor(o[1]-3));var x=h.selectAll(".sszvis-slider__backgroundshadow").data([r.value]),k=x.enter().append("line").attr("class","sszvis-slider__backgroundshadow").attr("stroke-width",5).style("stroke","#E0E0E0").style("stroke-linecap","round");(x=x.merge(k)).attr("x1",Math.ceil(o[0]+3)).attr("x2",U(Math.floor,i));var _=t.selectAll("g.sszvis-control-slider__handle").data([r.value]);_.exit().remove();var w=_.enter().append("g").classed("sszvis-control-slider__handle",!0);(_=_.merge(w)).attr("transform",(function(t){return Gt(Wt(i(t)),.5)})),w.append("text").classed("sszvis-control-slider--label",!0),_.selectAll(".sszvis-control-slider--label").data((function(t){return[t]})).text(r.label).style("text-anchor",(function(t){return nt(t,a[0])?"start":nt(t,a[1])?"end":"middle"})).attr("dx",(function(t){return nt(t,a[0])?-5:nt(t,a[1])?5:0})),w.append("rect").classed("sszvis-control-slider__handlebox",!0).attr("x",-5).attr("y",n-11.5).attr("width",10).attr("height",23).attr("rx",2).attr("ry",2);w.append("line").classed("sszvis-control-slider__handleline",!0).attr("y1",n-7.5).attr("y2",n+7.5);var z=Oe().xScale(r.scale).yScale(e.scaleLinear().range([-11,40])).draggable(!0).on("drag",r.onchange);t.selectGroup("sliderInteraction").classed("sszvis-control-slider--interactionLayer",!0).attr("transform",Gt(0,4)).call(z)}))},t.slightlyDarker=function(t){return e.hsl(t).darker(.4)},t.slowTransition=er,t.some=function(t,e){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1},t.stackedArea=function(){return Dt().prop("x").prop("y0").prop("y1").prop("fill").prop("stroke").prop("defined").prop("key").key((function(t,e){return e})).prop("transition").transition(!0).render((function(t){var r=e.select(this),n=r.props(),a=e.area().defined(void 0!==n.defined?n.defined:function(){return U($(isNaN),n.y0)&&U($(isNaN),n.y1)}).x(n.x).y0(n.y0).y1(n.y1),o=r.selectAll("path.sszvis-path").data(t,n.key),i=o.enter().append("path").classed("sszvis-path",!0);o.exit().remove(),o=o.merge(i),n.transition&&(o=o.transition(tr())),o.attr("d",a).attr("fill",n.fill).attr("stroke",n.stroke)}))},t.stackedAreaMultiples=function(){return Dt().prop("x").prop("y0").prop("y1").prop("fill").prop("stroke").prop("defined").prop("key").key((function(t,e){return e})).prop("valuesAccessor").valuesAccessor(I).prop("transition").transition(!0).render((function(t){var r=e.select(this),n=r.props();t=t.slice().reverse();var a=e.area().defined(void 0!==n.defined?n.defined:function(){return U($(isNaN),n.y0)&&U($(isNaN),n.y1)}).x(n.x).y0(n.y0).y1(n.y1),o=r.selectAll("path.sszvis-path").data(t,n.key),i=o.enter().append("path").classed("sszvis-path",!0);o.exit().remove(),o=i.merge(o),n.transition&&(o=o.transition(tr())),o.attr("d",U(a,n.valuesAccessor)).attr("fill",n.fill).attr("stroke",n.stroke)}))},t.stackedBarHorizontal=function(){return pr(dr)},t.stackedBarHorizontalData=cr,t.stackedBarVertical=function(){return pr(fr)},t.stackedBarVerticalData=ur,t.stackedPyramid=function(){return Dt().prop("barHeight",at).prop("barWidth",at).prop("barPosition",at).prop("barFill",at).barFill("#000").prop("tooltipAnchor").tooltipAnchor([.5,.5]).prop("leftAccessor").prop("rightAccessor").prop("leftRefAccessor").prop("rightRefAccessor").render((function(t){var r=e.select(this),n=r.props(),a=nr().x((function(t){return-.5-n.barWidth(t[1])})).y(U(n.barPosition,vr)).height(n.barHeight).width((function(t){return n.barWidth(t[1])-n.barWidth(t[0])})).fill(U(n.barFill,hr)).tooltipAnchor(n.tooltipAnchor),o=nr().x((function(t){return.5+n.barWidth(t[0])})).y(U(n.barPosition,vr)).height(n.barHeight).width((function(t){return n.barWidth(t[1])-n.barWidth(t[0])})).fill(U(n.barFill,hr)).tooltipAnchor(n.tooltipAnchor),i=mr().stackElement(a),s=mr().stackElement(o),l=gr().barPosition(n.barPosition).barWidth(n.barWidth).mirror(!0),c=gr().barPosition(n.barPosition).barWidth(n.barWidth);r.selectGroup("leftStack").datum(n.leftAccessor(t)).call(i),r.selectGroup("rightStack").datum(n.rightAccessor(t)).call(s),r.selectGroup("leftReference").datum(n.leftRefAccessor?[n.leftRefAccessor(t)]:[]).call(l),r.selectGroup("rightReference").datum(n.rightRefAccessor?[n.rightRefAccessor(t)]:[]).call(c)}))},t.stackedPyramidData=function(t,r,n,a){return function(o){var i=Ze().arrayBy(t).arrayBy(r).objectBy(n).apply(o).map((function(r){var n=Object.keys(r[0]),o=t(r[0][n[0]][0]),i=e.stack().keys(n).value((function(t,e){return a(t[e][0])}))(r);return i.forEach((function(t,e){t.forEach((function(t,r){return t.data=t.data[n[e]][0],t.series=n[e],t.side=o,t.row=r,t.value=a(t.data),t}))})),i}));return i.maxValue=e.max(i,(function(t){return e.max(t,(function(t){return e.max(t,(function(t){return t[1]}))}))})),i}},t.stringEqual=nt,t.sunburst=function(){return Dt().prop("angleScale").angleScale(e.scaleLinear().range([0,2*Math.PI])).prop("radiusScale").prop("centerRadius").prop("fill").prop("stroke").stroke("white").render((function(t){var r=e.select(this),n=r.props();var a=function(t){return Math.max(0,Math.min(yr,n.angleScale(t.x0)))},o=function(t){return Math.max(0,Math.min(yr,n.angleScale(t.x1)))},i=function(t){return n.centerRadius+Math.max(0,n.radiusScale(t.y0))},s=function(t){return n.centerRadius+Math.max(0,n.radiusScale(t.y1))},l=e.arc().startAngle(a).endAngle(o).innerRadius(i).outerRadius(s);t.forEach((function(t){t._x0=t.x0,t._x1=t.x1}));var c=r.selectAll(".sszvis-sunburst-arc").each((function(e,r){t[r]&&(t[r].x0=e.x0,t[r].x1=e.x1)})).data(t),u=c.enter().append("path").attr("class","sszvis-sunburst-arc");c.exit().remove(),(c=c.merge(u)).attr("stroke",n.stroke).attr("fill",(function t(r){if(r.data.isSunburstRoot)return"transparent";if(r.parent){if(r.parent.data.isSunburstRoot)return e.hsl(n.fill(r.data.key));var a=t(r.parent);return a.l*=1.15,a}return ze("Data passed to sszvis.component.sunburst does not have the expected tree structure. You should prepare it using sszvis.format.sunburst.prepareData"),e.hsl(n.fill(r.data.key))})),c.transition(tr()).attrTween("d",(function(t){var r=e.interpolate(t.x0,t._x0),n=e.interpolate(t.x1,t._x1);return function(e){return t.x0=r(e),t.x1=n(e),l(t)}}));var p=Ut().position((function(t){var e=a(t),r=o(t),n=e+Math.abs(r-e)/2-Math.PI/2,l=(i(t)+s(t))/2;return[Math.cos(n)*l,Math.sin(n)*l]}));r.call(p)}))},t.sunburstGetRadiusExtent=function(t){return[e.min(t,(function(t){return t.y0})),e.max(t,(function(t){return t.y1}))]},t.sunburstLayout=function(t,e){var r=e/2,n=r/3;return{centerRadius:n,numLayers:t,ringWidth:Math.max(10,Math.min(60,(r-n)/t))}},t.sunburstPrepareData=function(){var t=e.nest(),r=I,n=function(){return 0};function a(a){t.rollup(q);var o=e.hierarchy({isSunburstRoot:!0,values:t.entries(a)},tt("values")).sort(n).sum((function(t){return t.value?r(t.value):0}));return e.partition()(o),function t(e){return[].concat.apply([e],(e.children||[]).map(t))}(o).filter((function(t){return!t.data.isSunburstRoot}))}return a.calculate=function(t){return a(t)},a.layer=function(e){return t.key(e),a},a.value=function(t){return r=t,a},a.sort=function(t){return n=t,a},a},t.swissMapPath=Sr,t.swissMapProjection=Ar,t.textWrap=Ee,t.tooltip=function(){var t=re();return Dt().delegate("header",t).delegate("body",t).delegate("orientation",t).delegate("dx",t).delegate("dy",t).delegate("opacity",t).prop("renderInto").prop("visible",at).visible(!1).renderSelection((function(e){var r=e.props(),n=r.renderInto.node().getBoundingClientRect(),a=[];e.each((function(t){if(r.visible(t)){var e=this.getBoundingClientRect(),o=[e.left-n.left,e.top-n.top];a.push({datum:t,x:o[0],y:o[1]})}})),r.renderInto.datum(a).call(t)}))},t.tooltipAnchor=Ut,t.transformTranslateSubpixelShift=Ht,t.translateString=Gt,t.viewport=Gr,t.voronoi=function(){var t=e.dispatch("over","out"),r=Dt().prop("x").prop("y").prop("bounds").prop("debug").render((function(r){var n=e.select(this),a=n.props();if(!a.bounds)return Ae("behavior.voronoi - requires bounds"),!1;var o=e.voronoi().x(a.x).y(a.y).extent(a.bounds),i=n.selectAll("[data-sszvis-behavior-voronoi]").data(o.polygons(r)),s=i.enter().append("path").attr("data-sszvis-behavior-voronoi","").attr("data-sszvis-behavior-pannable","").attr("class","sszvis-interactive");i.exit().remove(),(i=i.merge(s)).attr("d",(function(t){return"M"+t.join("L")+"Z"})).attr("fill","transparent").on("mouseover",(function(r){var n=this.parentNode.getBoundingClientRect();He(e.event,[n.left+a.x(r.data),n.top+a.y(r.data)])&&t.apply("over",this,[r.data])})).on("mousemove",(function(r){var n=this.parentNode.getBoundingClientRect();He(e.event,[n.left+a.x(r.data),n.top+a.y(r.data)])?t.apply("over",this,[r.data]):t.apply("out",this,[])})).on("mouseout",(function(){t.apply("out",this,[])})).on("touchstart",(function(r){var n=this.parentNode.getBoundingClientRect();if(He(K(e.event),[n.left+a.x(r.data),n.top+a.y(r.data)])){e.event.preventDefault(),t.apply("over",this,[r.data]);e.select(this).on("touchmove",(function(){var r=K(e.event),n=Ne(r),o=je(n);if(null!==o){var i=n.parentNode.getBoundingClientRect();He(r,[i.left+a.x(o.data),i.top+a.y(o.data)])?(e.event.cancelable&&e.event.preventDefault(),t.apply("over",this,[o.data])):t.apply("out",this,[])}else t.apply("out",this,[])})).on("touchend",(function(){t.apply("out",this,[]),e.select(this).on("touchmove",null).on("touchend",null)}))}})),a.debug&&i.attr("stroke","#f00")}));return r.on=function(){var e=t.on.apply(t,arguments);return e===t?r:e},r},t.widthAdaptiveMapPathStroke=function(t){return Math.min(Math.max(.8,t/400),1.1)},t.withAlpha=function(t,r){var n=e.rgb(t);return"rgba("+n.r+","+n.g+","+n.b+","+r+")"},Object.defineProperty(t,"__esModule",{value:!0})}));
