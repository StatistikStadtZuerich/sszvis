/*! sszvis v2.1.1, Copyright 2014-present Statistik Stadt Zürich */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],e):e((t=t||self).sszvis={},t.d3)}(this,function(t,R){"use strict";R.selection.prototype.selectDiv=function(t){var e=this.selectAll('[data-d3-selectdiv="'+t+'"]').data(function(t){return[t]}),r=e.enter().append("div").attr("data-d3-selectdiv",t).style("position","absolute");return e.merge(r)},R.selection.prototype.selectGroup=function(t){var e=this.selectAll('[data-d3-selectgroup="'+t+'"]').data(function(t){return[t]}),r=e.enter().append("g").attr("data-d3-selectgroup",t);return e.merge(r)},function(){if("undefined"!=typeof window){var r=function t(e,r){var n=e.nodeType;if(3==n)r.push(e.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"));else if(1==n){if(r.push("<",e.tagName),e.hasAttributes())for(var a=e.attributes,i=0,o=a.length;i<o;++i){var s=a.item(i);r.push(" ",s.name,"='",s.value,"'")}if(e.hasChildNodes()){r.push(">");var l=e.childNodes;for(i=0,o=l.length;i<o;++i)t(l.item(i),r);r.push("</",e.tagName,">")}else r.push("/>")}else{if(8!=n)throw"Error serializing XML. Unhandled node of type: "+n;r.push("\x3c!--",e.nodeValue,"--\x3e")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){for(var t=[],e=this.firstChild;e;)r(e,t),e=e.nextSibling;return t.join("")},set:function(t){for(;this.firstChild;)this.removeChild(this.firstChild);try{var e=new DOMParser;e.async=!1;for(var r="<svg xmlns='http://www.w3.org/2000/svg'>"+t+"</svg>",n=e.parseFromString(r,"text/xml").documentElement.firstChild;n;)this.appendChild(this.ownerDocument.importNode(n,!0)),n=n.nextSibling}catch(t){throw new Error("Error parsing XML string")}}}),Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}})}}();var f=function(t){return t},r=function(t){return"[object String]"===Object.prototype.toString.call(t)},u=function(t){return t instanceof R.selection},e=function(t,u){switch(t){case 0:return function(){return u.call(this)};case 1:return function(t){return u.call(this,t)};case 2:return function(t,e){return u.call(this,t,e)};case 3:return function(t,e,r){return u.call(this,t,e,r)};case 4:return function(t,e,r,n){return u.call(this,t,e,r,n)};case 5:return function(t,e,r,n,a){return u.call(this,t,e,r,n,a)};case 6:return function(t,e,r,n,a,i){return u.call(this,t,e,r,n,a,i)};case 7:return function(t,e,r,n,a,i,o){return u.call(this,t,e,r,n,a,i,o)};case 8:return function(t,e,r,n,a,i,o,s){return u.call(this,t,e,r,n,a,i,o,s)};case 9:return function(t,e,r,n,a,i,o,s,l){return u.call(this,t,e,r,n,a,i,o,s,l)};case 10:return function(t,e,r,n,a,i,o,s,l,c){return u.call(this,t,e,r,n,a,i,o,s,l,c)};default:return u}},A=function(){var r=arguments,n=arguments.length-1;return function(){for(var t=n,e=r[t].apply(this,arguments);t--;)e=r[t].call(this,e);return e}},_=function(t){return void 0!==t&&null!=t},h=function(t,e){for(var r=new Array(t),n=0;n<t;++n)r[n]=e;return r},l=function(t,e){for(var r=0;r<e.length;r++)if(t(e[r]))return e[r]},v=function(t){return t[0]},s=function(t){return t.touches&&t.touches.length?t.touches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null},n=function(t){return null===t},c=function(t){return Object(t)===t},g=function(t){return t[t.length-1]},p=function(t){return function(){return!t.apply(this,arguments)}},B=function(e){return function(t){return t[e]}},a=function(r,n){return function(t){var e=void 0!==t?t[r]:void 0;return void 0!==e?e:n}},w=function(a,i){return i||(i=f),a.reduce(function(t,e,r){var n=i(e,r,a);return t.indexOf(n)<0?t.concat(n):t},[])},S=function(t,e){return t.toString()===e.toString()},d=function(t){return"function"==typeof t?t:function(){return t}},i=function(i,o){if("function"!=typeof i||null!=o&&"function"!=typeof o)throw new TypeError("Expected a function");var t=function t(){var e=arguments,r=o?o.apply(this,e):e[0],n=t.cache;if(n.has(r))return n.get(r);var a=i.apply(this,e);return t.cache=n.set(r,a)||n,a};return t.cache=R.map(),t};function m(t,e,r){var n,a,i,o=(n=t,a=n.selectAll("defs").data([0]),i=a.enter().append("defs"),a.merge(i)).selectAll(e+"#"+r).data([0]),s=o.enter().append(e).attr("id",r);return o.merge(s)}var o=.6;function y(t){return function(){return function t(e){e.darker=function(){return t(e.copy().range(e.range().map(K("darker",o))))};e.brighter=function(){return t(e.copy().range(e.range().map(K("brighter",o))))};e.reverse=function(){return t(e.copy().range(e.range().reverse()))};return e}(R.scaleOrdinal().range(t.map(Y)))}}var x=y(["#5182B3","#B8CFE6","#60BF97","#B8E6D2","#94BF69","#CFE6B8","#E6CF73","#FAEBAF","#E67D73","#F2CEC2","#CC6788","#E6B7C7"]),b=y(["#5182B3","#60BF97","#94BF69","#E6CF73","#E67D73","#CC6788"]),k=y(["#5182B3","#B8CFE6","#60BF97","#B8E6D2","#94BF69","#CFE6B8"]),z=y(["#E6CF73","#FAEBAF","#E67D73","#F2CEC2","#CC6788","#E6B7C7"]);function M(t){return function(){return U(R.scaleLinear().range(t.map(Y)))}}var C=M(["#DDE9FE","#3B76B3","#343F4D"]),F=M(["#FEECEC","#CC6171","#4D353A"]),T=M(["#D2DFDE","#4A807C","#2C3C3F"]),E=M(["#E9DFD6","#A67D5A","#4C3735"]);function P(t){return function(){return U(R.scaleLinear().range(t.map(Y)))}}var L=P(["#CC6171","#FFFFFF","#3B76B3"]),O=P(["#CC6171","#F3F3F3","#3B76B3"]),D=P(["#A67D5A","#FFFFFF","#4A807C"]),W=P(["#A67D5A","#F3F3F3","#4A807C"]);function N(t){return function(){return U(R.scaleOrdinal().range(t.map(Y)))}}var H=N(["#FAFAFA"]),G=N(["#EAEAEA"]),I=N(["#D6D6D6"]),j=N(["#B8B8B8"]),J=N(["#7C7C7C"]),V=N(["#545454"]);function U(t){var e,r;return r=(e=t).domain,e.domain=function(t){if(1!==arguments.length)return r.apply(this,arguments);var e=[t[0],R.mean(t),t[1]];return r.call(this,e)},(t=e).reverse=function(){return U(t.copy().range(t.range().reverse()))},t}function Y(t){return R.lab(t)}function K(e){var r=Array.prototype.slice.call(arguments,1);return function(t){return t[e].apply(t,r)}}var X=function(t){var e="#CCCCCC";t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",14).attr("height",14),t.append("rect").attr("x",0).attr("y",0).attr("width",14).attr("height",14).attr("fill","#FAFAFA"),t.append("line").attr("x1",1).attr("y1",10).attr("x2",5).attr("y2",14).attr("stroke",e),t.append("line").attr("x1",5).attr("y1",10).attr("x2",1).attr("y2",14).attr("stroke",e),t.append("line").attr("x1",8).attr("y1",3).attr("x2",12).attr("y2",7).attr("stroke",e),t.append("line").attr("x1",12).attr("y1",3).attr("x2",8).attr("y2",7).attr("stroke",e)},q=function(t){t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",6).attr("height",6),t.append("rect").attr("x",0).attr("y",0).attr("width",6).attr("height",6).attr("fill","#fff"),t.append("line").attr("x1",0).attr("y1",3).attr("x2",3).attr("y2",0).attr("stroke","#ddd").attr("stroke-linecap","square"),t.append("line").attr("x1",3).attr("y1",6).attr("x2",6).attr("y2",3).attr("stroke","#ddd").attr("stroke-linecap","square")},Q=function(t){t.attr("x1",0).attr("y1",0).attr("x2",.55).attr("y2",1).attr("id","lake-fade-gradient"),t.append("stop").attr("offset",.74).attr("stop-color","white").attr("stop-opacity",1),t.append("stop").attr("offset",.97).attr("stop-color","white").attr("stop-opacity",0)},Z=function(t){t.attr("maskContentUnits","objectBoundingBox"),t.append("rect").attr("fill","url(#lake-fade-gradient)").attr("width",1).attr("height",1)},$=function(t){t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",6).attr("height",6),t.append("line").attr("x1",0).attr("y1",3).attr("x2",3).attr("y2",0).attr("stroke","#e6e6e6").attr("stroke-width",1.1),t.append("line").attr("x1",3).attr("y1",6).attr("x2",6).attr("y2",3).attr("stroke","#e6e6e6").attr("stroke-width",1.1)};function tt(){var i={},e=null,r=et;function o(t){e&&(t.props=function(){return nt(i)},e.apply(t,rt(arguments))),t.each(function(){this.__props__=nt(i),r.apply(this,rt(arguments))})}return o.prop=function(t,e){var r,n,a;return e||(e=et),o[t]=(r=i,n=t,a=e.bind(o),a||(a=et),function(){return arguments.length?(r[n]=a.apply(null,rt(arguments)),this):r[n]}).bind(o),o},o.delegate=function(e,r){return o[e]=function(){var t=r[e].apply(r,rt(arguments));return 0===arguments.length?t:o},o},o.renderSelection=function(t){return e=t,o},o.render=function(t){return r=t,o},o}function et(t){return t}function rt(t){return Array.prototype.slice.call(t)}function nt(t){var e={};for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}R.selection.prototype.props=function(){if(arguments.length)throw new Error("selection.props() does not accept any arguments");if(1!=this.size())throw new Error("only one group is supported");if(1!=this._groups[0].length)throw new Error("only one node is supported");return this._groups[0][0].__props__||{}};var at=function(t){return Math.floor(t)+.5},it=function(t){var e=A(Math.floor,Number),r=t.match(/(translate\()\s*([0-9.,\- ]+)\s*(\))/i)[2].replace(","," ").replace(/\s+/," ").split(" ").map(Number);1===r.length&&r.push([0]);var n=r.map(e);return[r[0]-n[0],r[1]-n[1]]};function ot(t,e){return"translate("+t+","+e+")"}function st(){return tt().prop("position").position(d([0,0])).prop("debug").render(function(t){var e=R.select(this),r=e.props(),n=e.selectAll("[data-tooltip-anchor]").data(t),a=n.enter().append("rect").attr("height",1).attr("width",1).attr("fill","none").attr("stroke","none").attr("visibility","none").attr("data-tooltip-anchor","");if(n.exit().remove(),(n=n.merge(a)).attr("transform",A(s,r.position)),r.debug){var i=e.selectAll("[data-tooltip-anchor-debug]").data(t),o=i.enter().append("circle").attr("data-tooltip-anchor-debug","");i.exit().remove(),(i=i.merge(o)).attr("r",2).attr("fill","#fff").attr("stroke","#f00").attr("stroke-width",1.5).attr("transform",A(s,r.position))}});function s(t){return ot.apply(null,t)}}function lt(r,n,a){return function(t){var e=t.enter().append("circle").classed("sszvis-rangeFlag__mark",!0).classed(r,!0);t.exit().remove(),(t=t.merge(e)).attr("r",3.5).attr("cx",n).attr("cy",a)}}var ct={decimal:".",thousands:" ",grouping:[3],currency:["CHF ",""],dateTime:"%a. %e. %B %X %Y",date:"%d.%m.%Y",time:"%H:%M:%S",periods:[],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},ut=R.timeFormatLocale(ct).format,pt=R.formatLocale(ct).format,dt=function(t){for(var e=[[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%H:%M",function(t){return t.getMinutes()}],["%H Uhr",function(t){return t.getHours()}],["%a., %d.",function(t){return t.getDay()&&1!=t.getDate()}],["%e. %b",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",function(){return!0}]],r=0;r<e.length;++r)if(e[r][1](t))return ut(e[r][0])(t)},ft=A(function(t){return t.toUpperCase()},ut("%b")),ht=ut("%Y"),vt=function(t){var e,r=Math.abs(t);return null==t||isNaN(t)?"–":1e4<=r?pt(",.0f")(t):100<=r?(e=Math.min(1,mt(t)),yt(pt("."+e+"f")(t))):0<r?(e=Math.min(2,mt(t)),yt(pt("."+e+"f")(t))):pt(".0f")(0)},gt=function(t){return String(t)};function mt(t){return(String(Math.abs(t)).split(".")[1]||"").length}function yt(t){return t.replace(/(\.[0-9]*[1-9])0+$|\.0*$/,"$1")}function xt(t,e){var r=Ct(e);return l(function(t){return kt(t,r)},t)}function bt(t,e){return l(function(t){return t.name===e},t)}function kt(t,e){var r=t.measurement,n=Ct(e);return n.width<=r.width&&n.screenHeight<=r.screenHeight}function _t(t,e){var r=Ct(e);return t.filter(function(t){return kt(t,r)})}function zt(t){return t.map(Ft).concat(Ft({name:"_"}))}var At,wt=(At=zt([{name:"palm",width:540},{name:"lap",width:749}]),function(){return At}),St=Tt("palm"),Mt=Tt("lap");function Ct(t){var e=a("width",1/0),r=a("screenHeight",1/0);return{width:e(t),screenHeight:r(t)}}function Ft(t){var e;return e=_(t.measurement)?Ct(t.measurement):Ct({width:t.width,screenHeight:t.screenHeight}),{name:t.name,measurement:e}}function Tt(e){return function(t){return kt(bt(wt(),e),t)}}function Et(t,e){var r=t/e;return function(t){return t/r}}var Pt=Et(4,3),Lt=Et(16,10),Rt=function(t){return Math.min(Et(12,5)(t),500)};Rt.MAX_HEIGHT=500;var Bt=function(t){return Math.min(Et(1,1)(t),420)};Bt.MAX_HEIGHT=420;var Ot=function(t){return Math.min(Et(4,5)(t),600)};Ot.MAX_HEIGHT=600;var Dt={palm:Pt,lap:Lt,_:Rt},Wt=function(t){var e=xt(wt(),t);return(0,Dt[e.name])(t.width)},Nt=Gt("warn"),Ht=Gt("error");function Gt(e){return function(){var t;console&&console[e]&&(t=arguments,Array.prototype.slice.call(t)).forEach(function(t){console[e](t)})}}var It=function(t){return t.rangeExtent?t.rangeExtent():(e=t.range(),r=e[0],n=e[e.length-1],r<n?[r,n]:[n,r]);var e,r,n};function jt(t,p,d,f){f=(f||5)-2;var h=p;p-=2*(d=d||5);var v=[];return t.each(function(){var t,e,r=R.select(this),n=r.text().split(/[ \f\n\r\t\v]+/).reverse(),a=[],i=0,o=r.attr("y"),s=parseFloat(r.attr("dy")),l=1,c=r.style("text-anchor")||"start";if(isNaN(s)&&(s=0),R.select(r.node().parentNode).classed("tick"))switch(c){case"start":e=-p/2;break;case"middle":e=0;break;case"end":e=p/2}else switch(c){case"start":e=d;break;case"middle":e=h/2;break;case"end":e=h-d}o=+(null===o?f:o);for(var u=r.text(null).append("tspan").attr("x",e).attr("y",o).attr("dy",s+"em");0<n.length;)t=n.pop(),a.push(t),u.text(a.join(" ")),u.node().getComputedTextLength()>p&&1<a.length&&(a.pop(),u.text(a.join(" ")),a=[t],u=r.append("tspan").attr("x",e).attr("y",o).attr("dy",1.1*++i+s+"em").text(t),++l);v.push(l)}),v}var Jt=function(){return tt().prop("scale").prop("orient").prop("ticks").prop("tickValues").prop("tickSize").prop("tickSizeInner").prop("tickSizeOuter").prop("tickPadding").prop("tickFormat").prop("_scale").prop("orient").orient("bottom").prop("alignOuterLabels").alignOuterLabels(!1).prop("contour").prop("hideBorderTickThreshold").hideBorderTickThreshold(8).prop("hideLabelThreshold").hideLabelThreshold(10).prop("highlightTick",d).prop("showZeroY").showZeroY(!1).prop("slant").prop("textWrap").prop("tickLength").prop("title").prop("titleAnchor").prop("titleCenter").prop("dxTitle").prop("dyTitle").prop("titleVertical").prop("vertical").vertical(!1).prop("yOffset").yOffset(0).render(function(){var t=R.select(this),n=t.props(),a=!n.vertical&&"bottom"===n.orient,e=function(){switch(n.orient){case"bottom":return R.axisBottom();case"top":return R.axisTop();case"left":return R.axisLeft();case"right":return R.axisRight()}}();["scale","ticks","tickValues","tickSizeInner","tickSizeOuter","tickPadding","tickFormat","tickSize"].forEach(function(t){if(void 0!==n[t]){if(void 0===e[t])throw new Error('axis: "'+t+'" not available');e[t](n[t])}}),n._scale&&e.scale(n._scale);var r=t.selectGroup("sszvis-axis").classed("sszvis-axis",!0).classed("sszvis-axis--top",!n.vertical&&"top"===n.orient).classed("sszvis-axis--bottom",a).classed("sszvis-axis--vertical",n.vertical).attr("transform",ot(0,n.yOffset)).call(e);r.attr("fill",null).attr("font-size",null).attr("font-family",null);var i=e.scale(),o=r.selectAll("g.tick"),s=o.selectAll("text");o.each(function(){var t=it(this.getAttribute("transform")),e=at(0)-t[0],r=at(a?2:0)+t[1];R.select(this).select("line").attr("transform",ot(e,r))}),s.each(function(){"top"!==n.orient&&"bottom"!==n.orient||R.select(this).attr("dx","-0.5"),"left"!==n.orient&&"right"!==n.orient||R.select(this).attr("y","-0.5")}),r.selectAll("path.domain");var l=It(i);if(o.selectAll("line").each(function(t){var e=i(t),r=R.select(this);r.classed("hidden",!r.classed("sszvis-axis__longtick")&&(Kt(e,l[0])<n.hideBorderTickThreshold||Kt(e,l[1])<n.hideBorderTickThreshold))}),_(n.tickLength)){var c=R.extent(i.domain()),u=o.filter(function(t){return!S(t,c[0])&&!S(t,c[1])}),p=n.orient,d=2;"left"!==p&&"right"!==p||(u.selectAll("text").each(function(){d=Math.max(this.getBoundingClientRect().width,d)}),d+=2);var f=u.selectAll("line.sszvis-axis__longtick").data([0]);if(n.tickLength>d){var h=f.enter().append("line").classed("sszvis-axis__longtick",!0);f=f.merge(h),"top"===p?f.attr("y1",d).attr("y2",n.tickLength):"bottom"===p?f.attr("y1",-d).attr("y2",-n.tickLength):"left"===p?f.attr("x1",-d).attr("x2",-n.tickLength):"right"===p&&f.attr("x1",d).attr("x2",n.tickLength)}else f.remove()}if(n.alignOuterLabels){var v=It(i),g=v[0],m=v[1];s.style("text-anchor",function(t){var e=i(t);return Kt(e,g)<12?"start":Kt(e,m)<12?"end":"middle"})}if(_(n.textWrap)&&s.call(jt,n.textWrap),n.slant&&s.call(Xt[n.orient][n.slant]),n.highlightTick){var y=[],x=[];s.classed("hidden",!1).classed("active",n.highlightTick),0<n.hideLabelThreshold&&!n.slant&&(s.each(function(t){var e=this.getBoundingClientRect(),r={node:this,bounds:{top:e.top,right:e.right,bottom:e.bottom,left:e.left}};n.highlightTick(t)?(r.bounds.left-=n.hideLabelThreshold,r.bounds.right+=n.hideLabelThreshold,y.push(r)):x.push(r)}),y.forEach(function(n){x.forEach(function(t){var e,r;R.select(t.node).classed("hidden",(e=t.bounds,!((r=n.bounds).left>e.right||r.right<e.left||r.top>e.bottom||r.bottom<e.top)))})}))}if(n.title){var b=r.selectAll(".sszvis-axis__title").data([n.title]),k=b.enter().append("text").classed("sszvis-axis__title",!0);b.exit().remove(),b.merge(k).text(function(t){return t}).attr("transform",function(){var t,e=n.orient,r=It(i);return(t=n.titleCenter?{left:"left"===e||"right"===e?0:"top"===e||"bottom"===e?(r[0]+r[1])/2:0,top:"left"===e||"right"===e?(r[0]+r[1])/2:"top"===e?0:"bottom"===e?32:0}:{left:"left"===e||"right"===e||"top"===e?0:"bottom"===e?r[1]:0,top:"left"===e||"right"===e||"top"===e?0:"bottom"===e?32:0}).vertical=!!n.titleVertical,t.left+=n.dxTitle||0,t.top+=n.dyTitle||0,"translate("+t.left+", "+t.top+") rotate("+(t.vertical?"-90":"0")+")"}).style("text-anchor",function(){var t=n.orient;return void 0!==n.titleAnchor?n.titleAnchor:"left"===t?"end":"right"===t?"start":"top"===t||"bottom"===t?"end":void 0})}n.contour&&n.slant?Nt("Can't apply contour to slanted labels"):n.contour&&o.each(function(){var t=R.select(this),e=t.select("text").node(),r=t.select(".sszvis-axis__label-contour");r.empty()&&(r=R.select(e.cloneNode()).classed("sszvis-axis__label-contour",!0),this.insertBefore(r.node(),e)),r.text(e.textContent)})})},Vt=function(t){var e=this.scale().domain(),r=[],n=Math.round(e.length/t);void 0!==e[0]&&r.push(e[0]);for(var a=n,i=e.length;a<i-1;a+=n)void 0!==e[a]&&r.push(e[a]);return void 0!==e[e.length-1]&&r.push(e[e.length-1]),this.tickValues(r),t},Ut=function(){return Jt().yOffset(2).ticks(3).tickSizeInner(4).tickSizeOuter(6.5).tickPadding(6).tickFormat(e(1,vt))};Ut.time=function(){return Ut().tickFormat(dt).alignOuterLabels(!0)},Ut.ordinal=function(){return Ut().prop("ticks",Vt).tickFormat(gt)},Ut.pyramid=function(){return Ut().ticks(10).prop("scale",function(t){var e=t.copy(),r=e.domain(),n=e.range();return e.domain([-r[1],r[1]]).range([n[0]-n[1],n[0]+n[1]]),this._scale(e),e}).tickFormat(function(t){return vt(Math.abs(t))})};var Yt=function(){var e=Jt().ticks(6).tickSize(0,0).tickPadding(0).tickFormat(function(t){return 0!==t||e.showZeroY()?vt(t):null}).vertical(!0);return e};function Kt(t,e){return Math.abs(t-e)}Yt.time=function(){return Yt().tickFormat(dt)},Yt.ordinal=function(){return Yt().prop("ticks",Vt).tickFormat(gt)};var Xt={top:{horizontal:function(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("dy","0.71em").attr("transform",null)},vertical:function(t){t.style("text-anchor","start").attr("dx","0em").attr("dy","0.35em").attr("transform","rotate(-90)")},diagonal:function(t){t.style("text-anchor","start").attr("dx","0.1em").attr("dy","0.1em").attr("transform","translate(-0.5) rotate(-45)")}},bottom:{horizontal:function(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("dy","0.71em").attr("transform",null)},vertical:function(t){t.style("text-anchor","end").attr("dx","-1em").attr("dy","-0.75em").attr("transform","rotate(-90)")},diagonal:function(t){t.style("text-anchor","end").attr("dx","-0.8em").attr("dy","0em").attr("transform","rotate(-45)")}}};function qt(){var o=R.dispatch("start","move","drag","end"),e=tt().prop("debug").prop("xScale").prop("yScale").prop("draggable").prop("cancelScrolling",d).cancelScrolling(!1).prop("fireOnPanOnly",d).fireOnPanOnly(!1).prop("padding",function(t){var e={top:0,left:0,bottom:0,right:0};for(var r in t)e[r]=t[r];return e}).padding({}).render(function(){var t=R.select(this),i=t.props(),e=It(i.xScale).sort(R.ascending),r=It(i.yScale).sort(R.ascending);e[0]-=i.padding.left,e[1]+=i.padding.right,r[0]-=i.padding.top,r[1]+=i.padding.bottom;var n=t.selectAll("[data-sszvis-behavior-move]").data([0]),a=n.enter().append("rect").attr("data-sszvis-behavior-move","").attr("class","sszvis-interactive");n=n.merge(a),i.draggable&&n.classed("sszvis-interactive--draggable",!0),n.attr("x",e[0]).attr("y",r[0]).attr("width",e[1]-e[0]).attr("height",r[1]-r[0]).attr("fill","transparent").on("mouseover",function(){o.apply("start",this,arguments)}).on("mousedown",function(){var n=this,t=R.select(document),e=R.select(window),r=function(){var t=R.mouse(n),e=Qt(i.xScale,t[0]),r=Qt(i.yScale,t[1]);R.event.preventDefault(),o.apply("drag",this,[e,r])},a=function(){n.__dragging__=!1,e.on("mouseup.sszvis-behavior-move",null),e.on("mousemove.sszvis-behavior-move",null),t.on("mouseout.sszvis-behavior-move",null),o.apply("end",this,arguments)};e.on("mousemove.sszvis-behavior-move",r),e.on("mouseup.sszvis-behavior-move",a),t.on("mouseout.sszvis-behavior-move",function(){var t=R.event.relatedTarget||R.event.toElement;t&&"HTML"!==t.nodeName||a()}),n.__dragging__=!0,r()}).on("mousemove",function(){var t=R.mouse(this),e=Qt(i.xScale,t[0]),r=Qt(i.yScale,t[1]);this.__dragging__||o.apply("move",this,[e,r])}).on("mouseout",function(){o.apply("end",this,[])}).on("touchstart",function(){var t=v(R.touches(this)),e=Qt(i.xScale,t[0]),r=Qt(i.yScale,t[1]),n=i.cancelScrolling(e,r);if(n&&R.event.preventDefault(),!i.fireOnPanOnly()||n){o.apply("start",this,[e,r]),o.apply("drag",this,[e,r]),o.apply("move",this,[e,r]);R.select(this).on("touchmove",function(){var t=v(R.touches(this)),e=Qt(i.xScale,t[0]),r=Qt(i.yScale,t[1]),n=i.cancelScrolling(e,r);n&&R.event.preventDefault(),!i.fireOnPanOnly()||n?(o.apply("drag",this,[e,r]),o.apply("move",this,[e,r])):o.apply("end",this,[])}).on("touchend",function(){o.apply("end",this,[]),R.select(this).on("touchmove",null).on("touchend",null)})}}),i.debug&&n.attr("fill","rgba(255,0,0,0.2)")});return e.on=function(){var t=o.on.apply(o,arguments);return t===o?e:t},e}function Qt(t,e){switch(t.invert?"Linear":t.paddingInner?"Band":"Point"){case"Linear":return t.invert(e);case"Band":return function(t,e){var r=t.step(),n=t.paddingOuter()*r,a=t.paddingInner()*r,i=t.bandwidth(),o=t.range(),s=t.domain();if(1===s.length)return o[0]<=e&&o[1]>=e?s[0]:null;for(var l=s.map(function(t,e){return 0===e?[o[0],o[0]+n+i+a/2]:e===s.length-1?[o[1]-(n+i+a/2),o[1]]:[o[0]+n+e*r-a/2,o[0]+n+(e+1)*r-a/2]}),c=0,u=l.length;c<u;c++)if(l[c][0]<e&&e<=l[c][1])return s[c];return null}(t,e);case"Point":return function(t,e){var r=t.step(),n=t.padding()*r,a=t.range(),i=t.domain();if(1===i.length)return a[0]<=e&&a[1]>=e?i[0]:null;for(var o=i.map(function(t,e){return 0===e?[a[0],a[0]+n+r/2]:e===i.length-1?[a[1]-(n+r/2),a[1]]:[a[0]+n+e*r-r/2,a[0]+n+e*r+r/2]}),s=0,l=o.length;s<l;s++)if(o[s][0]<e&&e<=o[s][1])return i[s];return null}(t,e);default:throw new Error("Unknown scale type, could not invert")}}var Zt=function(t){return!n(t)&&_(t)?document.elementFromPoint(t.clientX,t.clientY):null},$t=function(t){if(!n(t)){var e=R.select(t);if(!n(e.attr("data-sszvis-behavior-pannable"))){var r=e.datum();if(_(r))return r}}return null};var te=Math.pow(15,2);function ee(t,e){var r=t.clientX-e[0],n=t.clientY-e[1];return r*r+n*n<te}var re,ne,ae=function(t){var e;return{width:(e=r(t)?R.select(t).node():u(t)?t.node():t)?e.getBoundingClientRect().width:void 0,screenWidth:window.innerWidth,screenHeight:window.innerHeight}},ie=(re=document.createElement("canvas").getContext("2d"),ne={},function(t,e,r){var n=[t,e,r].join("-");return re.font=t+"px "+e,ne[n]||(ne[n]=re.measureText(r).width)}),oe=function(t){return ie(10,"Arial, sans-serif",t)},se=function(t){return ie(12,"Arial, sans-serif",t)},le=516;function ce(t,e){var r=null,n=null;0===arguments.length?r={}:1===arguments.length?c(t)?r=t:n=u(t)?(r={},t):(r={},R.select(t)):(r=t,n=u(e)?e:R.select(e));var a={top:ue(r.top,0),right:ue(r.right,1),bottom:ue(r.bottom,0),left:ue(r.left,1)},i=_(n)?ae(n):{width:le},o=ue(r.width,i.width),s=Wt(i),l=ue(r.height,s+a.top+a.bottom);return{innerHeight:l-a.top-a.bottom,innerWidth:o-a.left-a.right,padding:a,height:l,width:o,screenWidth:i.screenWidth,screenHeight:i.screenHeight}}function ue(t,e){return void 0===t?e:t}function pe(t,e){for(var r in t)e(t[r],r)}function de(){var l,r={},c=[],u=[];return r.apply=function(t){return function r(t,n){if(n>=c.length)return l&&t.sort(l),t;var e=u[n],a=c[n++],i=function(t,e){for(var r,n,a={},i=0,o=t.length;i<o;++i)a[r=e(n=t[i])]?a[r].push(n):a[r]=[n];return a}(t,a.func);if("obj"===a.type){var o={};return pe(i,function(t,e){o[e]=r(t,n)}),o}if("arr"===a.type){var s=[];return e?function(t,e){for(var r=0,n=t.length;r<n;++r)e(t[r],r)}(Object.keys(i).sort(e),function(t){s.push(r(i[t],n))}):pe(i,function(t){s.push(r(t,n))}),s}}(t,0)},r.objectBy=function(t){return c.push({type:"obj",func:t}),r},r.arrayBy=function(t,e){return c.push({type:"arr",func:t}),e&&(u[c.length-1]=e),r},r.sort=function(t){return l=t,r},r}var fe=R.easePolyOut,he=function(){return R.transition().ease(fe).duration(300)},ve=function(){return R.transition().ease(fe).duration(500)};function ge(t){return isNaN(t)?0:t}function me(){return tt().prop("x",d).prop("y",d).prop("width",d).prop("height",d).prop("fill",d).prop("stroke",d).prop("centerTooltip").prop("tooltipAnchor").prop("transition").transition(!0).render(function(t){var e,r=R.select(this),n=r.props(),a=A(ge,n.x),i=A(ge,n.y),o=A(ge,n.width),s=A(ge,n.height),l=r.selectAll(".sszvis-bar").data(t);if(l.exit().remove(),l.enter().append("rect").classed("sszvis-bar",!0).attr("x",a).attr("y",i).attr("width",o).attr("height",s).merge(l).attr("fill",n.fill).attr("stroke",n.stroke),n.transition&&(l=l.transition(he())),l.attr("x",a).attr("y",i).attr("width",o).attr("height",s),n.centerTooltip)e=function(t){return[a(t)+o(t)/2,i(t)+s(t)/2]};else if(n.tooltipAnchor){var c=n.tooltipAnchor.map(parseFloat);e=function(t){return[a(t)+c[0]*o(t),i(t)+c[1]*s(t)]}}else e=function(t){return[a(t)+o(t)/2,i(t)]};var u=st().position(e);r.call(u)})}function ye(){return tt().prop("barPosition").prop("barWidth").prop("mirror").mirror(!1).render(function(t){var e=R.select(this),r=e.props(),n=R.line().x(r.barWidth).y(r.barPosition),a=e.selectAll(".sszvis-pyramid__referenceline").data(t);a.exit().remove();var i=a.enter().append("path").attr("class","sszvis-pyramid__referenceline");(a=a.merge(i)).attr("transform",r.mirror?"scale(-1, 1)":"").transition(he()).attr("d",n)})}var xe=B("stack"),be=B("0"),ke=B("1");function _e(s){return function(a,i,o){return function(t){var e=de().arrayBy(a).objectBy(i).apply(t),r=e.reduce(function(t,e){return w(t.concat(Object.keys(e)))},[]),n=R.stack().keys(r).value(function(t,e){return o(t[e][0])}).order(s)(e);return n.forEach(function(e){e.forEach(function(t){t.series=e.key,t.data=t.data[e.key][0],t.stack=a(t.data)})}),n.keys=r,n.maxValue=R.max(n,function(t){return R.max(t,function(t){return t[1]})}),n}}}var ze=_e(R.stackOrderNone),Ae=_e(R.stackOrderReverse);function we(o){return tt().prop("xScale",d).prop("width",d).prop("yScale",d).prop("height",d).prop("fill").prop("stroke").render(function(t){var e=R.select(this),r=e.props(),n=me().x(o.x(r)).y(o.y(r)).width(o.width(r)).height(o.height(r)).fill(r.fill).stroke(r.stroke),a=e.selectAll(".sszvis-stack").data(t),i=a.enter().append("g").classed("sszvis-stack",!0);a.exit().remove(),(a=a.merge(i)).call(n)})}var Se={x:function(t){return A(t.xScale,be)},y:function(t){return A(t.yScale,xe)},width:function(e){return function(t){return e.xScale(t[1])-e.xScale(t[0])}},height:function(t){return t.height}},Me={x:function(t){return A(t.xScale,xe)},y:function(t){return A(t.yScale,ke)},width:function(t){return t.width},height:function(e){return function(t){return e.yScale(t[0])-e.yScale(t[1])}}},Ce=B("data"),Fe=B("row");function Te(){return tt().prop("stackElement").renderSelection(function(t){var e=t.datum(),r=t.props(),n=t.selectAll("[data-sszvis-stack]").data(e),a=n.enter().append("g").attr("data-sszvis-stack","");n.exit().remove(),(n=n.merge(a)).each(function(t){R.select(this).datum(t).call(r.stackElement)})})}function Ee(){return tt().prop("barPosition").prop("barWidth").prop("mirror").mirror(!1).render(function(t){var e=R.select(this),r=e.props(),n=R.line().x(r.barWidth).y(r.barPosition),a=e.selectAll(".sszvis-path").data(t);a.exit().remove();var i=a.enter().append("path").attr("class","sszvis-path").attr("fill","none").attr("stroke","#aaa").attr("stroke-width",2).attr("stroke-dasharray","3 3");(a=a.merge(i)).attr("transform",r.mirror?"scale(-1, 1)":"").transition(he()).attr("d",n)})}var Pe=2*Math.PI;function Le(t,e){return 0<=e.indexOf(t)}var Re=21;function Be(){return tt().prop("scale").prop("rowHeight").rowHeight(Re).prop("columnWidth").columnWidth(200).prop("rows").rows(3).prop("columns").columns(3).prop("verticallyCentered").verticallyCentered(!1).prop("orientation").prop("reverse").reverse(!1).prop("rightAlign").rightAlign(!1).prop("horizontalFloat").horizontalFloat(!1).prop("floatPadding").floatPadding(20).prop("floatWidth").floatWidth(600).render(function(){var r,n,t=R.select(this),a=t.props(),e=a.scale.domain();a.reverse&&(e=e.slice().reverse()),"horizontal"===a.orientation?(n=Math.ceil(a.columns),r=Math.ceil(e.length/n)):"vertical"===a.orientation&&(r=Math.ceil(a.rows),n=Math.ceil(e.length/r));var i=t.selectAll(".sszvis-legend--entry").data(e),o=i.enter().append("g").classed("sszvis-legend--entry",!0);i.exit().remove();var s=i.merge(o).selectAll(".sszvis-legend__mark").data(function(t){return[t]}),l=s.enter().append("circle").classed("sszvis-legend__mark",!0);s.exit().remove(),s.merge(l).attr("cx",a.rightAlign?-6:6).attr("cy",at(a.rowHeight/2)).attr("r",5).attr("fill",function(t){return a.scale(t)}).attr("stroke",function(t){return a.scale(t)}).attr("stroke-width",1);var c=i.merge(o).selectAll(".sszvis-legend__label").data(function(t){return[t]}),u=c.enter().append("text").classed("sszvis-legend__label",!0);c.exit().remove(),c.merge(u).text(function(t){return t}).attr("dy","0.35em").style("text-anchor",function(){return a.rightAlign?"end":"start"}).attr("transform",function(){return ot(a.rightAlign?-18:18,at(a.rowHeight/2))});var p="";if(a.verticallyCentered&&(p="translate(0,"+String(-e.length*a.rowHeight/2)+") "),a.horizontalFloat){var d=0,f=0;i.merge(o).attr("transform",function(){var t=this.getBoundingClientRect().width;f+t>a.floatWidth&&(d+=a.rowHeight,f=0);var e=ot(f,d);return f+=t+a.floatPadding,p+e})}else i.merge(o).attr("transform",function(t,e){return"horizontal"===a.orientation?p+"translate("+e%n*a.columnWidth+","+Math.floor(e/n)*a.rowHeight+")":"vertical"===a.orientation?p+"translate("+Math.floor(e/r)*a.columnWidth+","+e%r*a.rowHeight+")":void 0})})}var Oe=2,De=40;function We(t,e){var r=t.length,n=R.max(t,Ne),a=R.sum(t,Ne),i=r<=4?1:function t(e,r,n){return n<=1?1:r<=e/n?n:t(e,r,n-1)}(e,n,Oe),o=1===i&&a<=e;return{columns:i,rows:o?1:Math.ceil(r/i),columnWidth:1===i?null:n,legendWidth:i*n,horizontalFloat:o,orientation:o?null:"vertical"}}function Ne(t){return se(t)+De}var He,Ge=(He=0,function(){return++He});var Ie=i(function(t,e,r){return R.geoMercator().fitSize([t,e],r)},function(t,e,r,n){return t+","+e+","+n}),je=function(t,e,r,n){return R.geoPath().projection(Ie(t,e,r,n))},Je="geoId",Ve=function(t,e,r){r||(r=Je);var n=Array.isArray(t)?t.reduce(function(t,e){return t[e[r]]=e,t},{}):{};return e.features.map(function(t){return{geoJson:t,datum:n[t.id]}})},Ue=function(t){if(!t.properties.cachedCenter){var e=t.properties.center;t.properties.cachedCenter=e?e.split(",").map(parseFloat):R.geoCentroid(t)}return t.properties.cachedCenter},Ye=B("datum");function Ke(){return tt().prop("mergedData").prop("geoJson").prop("mapPath").prop("defined",d).defined(!0).prop("fill",d).fill(function(){return"black"}).prop("transitionColor").transitionColor(!0).render(function(){var t=R.select(this),e=t.props();function r(t){return e.defined(t.datum)?e.fill(t.datum):"url(#missing-pattern)"}m(t,"pattern","missing-pattern").call(X);var n=t.selectAll(".sszvis-map__area").data(e.mergedData),a=n.enter().append("path").classed("sszvis-map__area",!0).classed("sszvis-map__area--entering",!0).attr("data-event-target","").attr("fill",r);n.classed("sszvis-map__area--entering",!1),n.exit().remove(),n=n.merge(a),t.selectAll(".sszvis-map__area--undefined").attr("fill",r),n.classed("sszvis-map__area--undefined",function(t){return!_(t.datum)||!e.defined(t.datum)}).attr("d",function(t){return e.mapPath(t.geoJson)}),e.transitionColor?n.transition().call(ve).attr("fill",r):n.attr("fill",r);var i=st().position(function(t){return e.mapPath.projection()(Ue(t.geoJson))});t.selectGroup("tooltipAnchors").datum(e.mergedData).call(i)})}function Xe(){return tt().prop("keyName").keyName(Je).prop("geoJson").prop("mapPath").prop("highlight").highlight([]).prop("highlightStroke",d).highlightStroke("white").prop("highlightStrokeWidth",d).highlightStrokeWidth(2).render(function(){var t=R.select(this),r=t.props(),e=t.selectAll(".sszvis-map__highlight");if(!r.highlight.length)return e.remove(),!0;var n=r.geoJson.features.reduce(function(t,e){return t[e.id]=e,t},{}),a=r.highlight.reduce(function(t,e){return e&&t.push({geoJson:n[e[r.keyName]],datum:e}),t},[]),i=(e=e.data(a)).enter().append("path").classed("sszvis-map__highlight",!0);e.exit().remove(),(e=e.merge(i)).attr("d",function(t){return r.mapPath(t.geoJson)}).style("stroke",function(t){return r.highlightStroke(t.datum)}).style("stroke-width",function(t){return r.highlightStrokeWidth(t.datum)})})}function qe(){return tt().prop("geoJson").prop("mapPath").prop("borderColor").borderColor("white").prop("strokeWidth").strokeWidth(1.25).render(function(){var t=R.select(this),e=t.props(),r=t.selectAll(".sszvis-map__border").data([e.geoJson]),n=r.enter().append("path").classed("sszvis-map__border",!0);r.exit().remove(),(r=r.merge(n)).attr("d",e.mapPath).style("stroke",e.borderColor).style("stroke-width",e.strokeWidth)})}function Qe(){return tt().prop("mapPath").prop("lakeFeature").prop("lakeBounds").prop("lakePathColor").prop("fadeOut").fadeOut(!0).render(function(){var t=R.select(this),e=t.props();m(t,"pattern","lake-pattern").call(q),e.fadeOut&&(m(t,"linearGradient","lake-fade-gradient").call(Q),m(t,"mask","lake-fade-mask").call(Z));var r=t.selectAll(".sszvis-map__lakezurich").data([e.lakeFeature]),n=r.enter().append("path").classed("sszvis-map__lakezurich",!0);r.exit().remove(),(r=r.merge(n)).attr("d",e.mapPath).attr("fill","url(#lake-pattern)"),e.fadeOut&&r.attr("mask","url(#lake-fade-mask)");var a=t.selectAll(".sszvis-map__lakepath").data([e.lakeBounds]),i=a.enter().append("path").classed("sszvis-map__lakepath",!0);a.exit().remove(),(a=a.merge(i)).attr("d",e.mapPath),e.lakePathColor&&a.style("stroke",e.lakePathColor)})}var Ze=R.timeFormatLocale(ct).parse,$e=Ze("%d.%m.%Y"),tr=Ze("%Y");function er(e){return function(){var r,n=(r=[[]],{addLine:function(){r.push([])},addWord:function(t,e){g(r).push({text:d(e),style:t})},lines:function(){return r}});function a(t){return e(n,t)}return a.newline=function(){return n.addLine(),a},["bold","italic","plain"].forEach(function(e){a[e]=function(t){return n.addWord(e,t),a}}),a}}var rr,nr,ar=er((rr={plain:function(t){return t},italic:function(t){return"<em>"+t+"</em>"},bold:function(t){return"<strong>"+t+"</strong>"}},function(t,e){return t.lines().map(function(t){return t.map(function(t){return rr[t.style].call(null,t.text(e))}).join(" ")}).join("<br/>")})),ir=er((nr={plain:function(t){return"<tspan>"+t+"</tspan>"},italic:function(t){return'<tspan style="font-style:italic">'+t+"</tspan>"},bold:function(t){return'<tspan style="font-weight:bold">'+t+"</tspan>"}},function(t,n){return t.lines().reduce(function(t,e,r){return t+'<tspan x="0" dy="'+(0===r?0:"1.2em")+'">'+e.map(function(t){return nr[t.style].call(null,t.text(n))}).join(" ")+"</tspan>"},"")}));var or,sr,lr,cr,ur,pr,dr,fr,hr={resize:[]};"undefined"!=typeof window&&R.select(window).on("resize",(or=500,sr=function(){vr("resize")},pr=null,dr=0,fr=function(){dr=0,ur=sr.apply(lr,cr),pr=lr=cr=null},function(){var t=Date.now();dr||(dr=t);var e=or-(t-dr);return lr=this,cr=arguments,e<=0||or<e?(pr&&(clearTimeout(pr),pr=null),dr=t,ur=sr.apply(lr,cr),pr||(lr=cr=null)):pr||(pr=setTimeout(fr,e)),ur}));var vr=function(t){var e=Array.prototype.slice.call(arguments,1);return hr[t]&&hr[t].forEach(function(t){t.apply(null,e)}),this},gr={on:function(t,e){return hr[t]||(hr[t]=[]),hr[t]=hr[t].filter(function(t){return t!==e}).concat(e),this},off:function(t,e){return hr[t]&&(hr[t]=hr[t].filter(function(t){return t!==e})),this},trigger:vr};t.AGGLOMERATION_2012_KEY="zurichAgglomeration2012",t.DEFAULT_LEGEND_COLOR_ORDINAL_ROW_HEIGHT=Re,t.DEFAULT_WIDTH=le,t.GEO_KEY_DEFAULT=Je,t.RATIO=16/9,t.STADT_KREISE_KEY="zurichStadtKreise",t.STATISTISCHE_QUARTIERE_KEY="zurichStatistischeQuartiere",t.STATISTISCHE_ZONEN_KEY="zurichStatistischeZonen",t.SWITZERLAND_KEY="switzerland",t.WAHL_KREISE_KEY="zurichWahlKreise",t.annotationCircle=function(){return tt().prop("x",d).prop("y",d).prop("r",d).prop("dx",d).prop("dy",d).prop("caption",d).render(function(t){var e=R.select(this),r=e.props();m(e,"pattern","data-area-pattern").call($);var n=e.selectAll(".sszvis-dataareacircle").data(t),a=n.enter().append("circle").classed("sszvis-dataareacircle",!0);if((n=n.merge(a)).attr("cx",r.x).attr("cy",r.y).attr("r",r.r).attr("fill","url(#data-area-pattern)"),r.caption){var i=e.selectAll(".sszvis-dataareacircle__caption").data(t),o=i.enter().append("text").classed("sszvis-dataareacircle__caption",!0);(i=i.merge(o)).attr("x",r.x).attr("y",r.y).attr("dx",r.dx).attr("dy",r.dy).text(r.caption)}})},t.annotationLine=function(){return tt().prop("x1").prop("x2").prop("y1").prop("y2").prop("xScale").prop("yScale").prop("dx",d).dx(0).prop("dy",d).dy(0).prop("caption",d).render(function(t){var e=R.select(this),r=e.props(),n=r.xScale(r.x1),a=r.yScale(r.y1),i=r.xScale(r.x2),o=r.yScale(r.y2),s=e.selectAll(".sszvis-referenceline").data(t);s.exit().remove();var l=s.enter().append("line").classed("sszvis-referenceline",!0);if((s=s.merge(l)).attr("x1",n).attr("y1",a).attr("x2",i).attr("y2",o),r.caption){var c=e.selectAll(".sszvis-referenceline__caption").data([0]);c.exit().remove();var u=c.enter().append("text").classed("sszvis-referenceline__caption",!0);(c=c.merge(u)).attr("transform",function(){var t=i-n,e=o-a,r=180*Math.atan2(e,t)/Math.PI;return"translate("+(n+i)/2+","+(a+o)/2+") rotate("+r+")"}).attr("dx",r.dx).attr("dy",r.dy).text(r.caption)}})},t.annotationRangeFlag=function(){return tt().prop("x",d).prop("y0",d).prop("y1",d).render(function(t){var e=R.select(this),r=e.props(),n=A(at,r.x),a=A(at,r.y0),i=A(at,r.y1);e.selectAll(".sszvis-rangeFlag__mark.bottom").data(t).call(lt("bottom",n,a)),e.selectAll(".sszvis-rangeFlag__mark.top").data(t).call(lt("top",n,i));var o=st().position(function(t){return[n(t),at((r.y0(t)+r.y1(t))/2)]});e.call(o)})},t.annotationRangeRuler=function(){return tt().prop("x",d).prop("y0",d).prop("y1",d).prop("top").prop("bottom").prop("label").label(d("")).prop("total").prop("flip",d).flip(!1).render(function(t){var e=R.select(this),r=e.props(),n=A(at,r.x),a=A(at,r.y0),i=A(at,r.y1),o=e.selectAll(".sszvis-rangeRuler__rule").data([0]),s=o.enter().append("line").classed("sszvis-rangeRuler__rule",!0);o.exit().remove(),(o=o.merge(s)).attr("x1",n).attr("y1",r.top).attr("x2",n).attr("y2",r.bottom);var l=e.selectAll(".sszvis-rangeRuler--mark").data(t),c=l.enter().append("g").classed("sszvis-rangeRuler--mark",!0);l.exit().remove(),l=l.merge(c),c.append("circle").classed("sszvis-rangeRuler__p1",!0),c.append("circle").classed("sszvis-rangeRuler__p2",!0),c.append("text").classed("sszvis-rangeRuler__label",!0),l.selectAll(".sszvis-rangeRuler__p1").data(function(t){return[t]}).attr("cx",n).attr("cy",a).attr("r",1.5),l.selectAll(".sszvis-rangeRuler__p2").data(function(t){return[t]}).attr("cx",n).attr("cy",i).attr("r",1.5),l.selectAll(".sszvis-rangeRuler__label").data(function(t){return[t]}).attr("x",function(t){var e=r.flip(t)?-10:10;return n(t)+e}).attr("y",function(t){return at((r.y0(t)+r.y1(t))/2)}).attr("dy","0.35em").style("text-anchor",function(t){return r.flip(t)?"end":"start"}).text(A(vt,r.label));var u=e.selectAll(".sszvis-rangeRuler__total").data([g(t)]),p=u.enter().append("text").classed("sszvis-rangeRuler__total",!0);u.exit().remove(),(u=u.merge(p)).attr("x",function(t){var e=r.flip(t)?-10:10;return n(t)+e}).attr("y",r.top-10).style("text-anchor",function(t){return r.flip(t)?"end":"start"}).text("Total "+vt(r.total))})},t.annotationRectangle=function(){return tt().prop("x",d).prop("y",d).prop("width",d).prop("height",d).prop("dx",d).prop("dy",d).prop("caption",d).render(function(t){var e=R.select(this),r=e.props();m(e,"pattern","data-area-pattern").call($);var n=e.selectAll(".sszvis-dataarearectangle").data(t),a=n.enter().append("rect").classed("sszvis-dataarearectangle",!0);if((n=n.merge(a)).attr("x",r.x).attr("y",r.y).attr("width",r.width).attr("height",r.height).attr("fill","url(#data-area-pattern)"),r.caption){var i=e.selectAll(".sszvis-dataarearectangle__caption").data(t),o=i.enter().append("text").classed("sszvis-dataarearectangle__caption",!0);(i=i.merge(o)).attr("x",function(t,e){return r.x(t,e)+r.width(t,e)/2}).attr("y",function(t,e){return r.y(t,e)+r.height(t,e)/2}).attr("dx",r.dx).attr("dy",r.dy).text(r.caption)}})},t.annotationRuler=function(){return tt().prop("top").prop("bottom").prop("x",d).prop("y",d).prop("label").label(d("")).prop("color").prop("flip",d).flip(!1).prop("labelId",d).prop("reduceOverlap").reduceOverlap(!0).render(function(t){var e=R.select(this),i=e.props(),n=i.labelId||function(t){return i.x(t)+"_"+i.y(t)},r=e.selectAll(".sszvis-ruler__rule").data(t,n),a=r.enter().append("line").classed("sszvis-ruler__rule",!0);r.exit().remove(),(r=r.merge(a)).attr("x1",A(at,i.x)).attr("y1",i.y).attr("x2",A(at,i.x)).attr("y2",i.bottom);var o=e.selectAll(".sszvis-ruler__dot").data(t,n),s=o.enter().append("circle").classed("sszvis-ruler__dot",!0);o.exit().remove(),(o=o.merge(s)).attr("cx",A(at,i.x)).attr("cy",A(at,i.y)).attr("r",3.5).attr("fill",i.color);var l=e.selectAll(".sszvis-ruler__label-outline").data(t,n),c=l.enter().append("text").classed("sszvis-ruler__label-outline",!0);l.exit().remove(),l=l.merge(c);var u=e.selectAll(".sszvis-ruler__label").data(t,n),p=u.enter().append("text").classed("sszvis-ruler__label",!0);u.exit().remove(),u=u.merge(p);var d=A(at,i.x),f=A(at,i.y),h=e.selectAll(".sszvis-ruler__label, .sszvis-ruler__label-outline").attr("transform",function(t){var e=d(t),r=f(t),n=i.flip(t)?-10:10,a=r<i.top+a?2*a:r>i.bottom-a?0:5;return ot(e+n,r+a)}).style("text-anchor",function(t){return i.flip(t)?"end":"start"}).html(i.label);if(i.reduceOverlap){var v=10,g=[],m={};for(h.attr("y",""),u.each(function(t){var e=this.getBoundingClientRect(),r={top:e.top,bottom:e.bottom,dy:0};g.push(r),m[n(t)]=r}),g.sort(function(t,e){return R.ascending(t.top,e.top)});v--;)g.forEach(function(n,t){g.slice(t+1).forEach(function(t){var e=n.bottom-t.top;if(2<=e){var r=e/2;n.bottom-=r,n.top-=r,n.dy-=r,t.bottom+=r,t.top+=r,t.dy+=r}})});h.attr("y",function(t){return m[n(t)].dy})}})},t.arity=e,t.aspectRatio=Et,t.aspectRatio12to5=Rt,t.aspectRatio16to10=Lt,t.aspectRatio4to3=Pt,t.aspectRatioAuto=Wt,t.aspectRatioPortrait=Ot,t.aspectRatioSquare=Bt,t.axisX=Ut,t.axisY=Yt,t.bar=me,t.bounds=ce,t.breakpointCreateSpec=zt,t.breakpointDefaultSpec=wt,t.breakpointFind=xt,t.breakpointFindByName=bt,t.breakpointLap=Mt,t.breakpointMatch=_t,t.breakpointPalm=St,t.breakpointTest=kt,t.buttonGroup=function(){return tt().prop("values").prop("current").prop("width").width(300).prop("change").change(f).render(function(){var t=R.select(this),e=t.props(),r=e.width/e.values.length,n=t.selectAll(".sszvis-control-optionSelectable").data(["sszvis-control-buttonGroup"],function(t){return t}),a=n.enter().append("div").classed("sszvis-control-optionSelectable",!0).classed("sszvis-control-buttonGroup",!0);n.exit().remove(),(n=n.merge(a)).style("width",e.width+"px");var i=n.selectAll(".sszvis-control-buttonGroup__item").data(e.values),o=i.enter().append("div").classed("sszvis-control-buttonGroup__item",!0);i.exit().remove(),(i=i.merge(o)).style("width",r+"px").classed("selected",function(t){return t===e.current}).text(function(t){return t}).on("click",e.change)})},t.cascade=de,t.choropleth=function(){var i=R.dispatch("over","out","click"),o=Ke(),s=qe(),l=Qe(),c=Xe(),e=tt().prop("width").prop("height").prop("keyName").keyName(Je).prop("withLake").withLake(!0).prop("anchoredShape").prop("features").prop("borders").prop("lakeFeatures").prop("lakeBorders").prop("lakeFadeOut").lakeFadeOut(!1).delegate("defined",o).delegate("fill",o).delegate("transitionColor",o).delegate("borderColor",s).delegate("strokeWidth",s).delegate("highlight",c).delegate("highlightStroke",c).delegate("highlightStrokeWidth",c).delegate("lakePathColor",l).render(function(t){var e=R.select(this),r=e.props(),n=je(r.width,r.height,r.features,"zurichStadtfeatures"),a=Ve(t,r.features,r.keyName);o.geoJson(r.features).mergedData(a).mapPath(n),s.geoJson(r.borders).mapPath(n),l.lakeFeature(r.lakeFeatures).lakeBounds(r.lakeBorders).mapPath(n).fadeOut(r.lakeFadeOut),c.geoJson(r.features).keyName(r.keyName).mapPath(n),e.call(o).call(s),r.withLake&&e.call(l),e.call(c),r.anchoredShape&&(r.anchoredShape.mergedData(a).mapPath(n),e.call(r.anchoredShape)),e.selectAll("[data-event-target]").on("mouseover",function(t){i.call("over",this,t.datum)}).on("mouseout",function(t){i.call("out",this,t.datum)}).on("click",function(t){i.call("click",this,t.datum)})});return e.on=function(){var t=i.on.apply(i,arguments);return t===i?e:t},e},t.colorLegendDimensions=We,t.colorLegendLayout=function(t,e){var r=t.legendLabels,n=t.axisLabels,a=void 0===n?[]:n,i=t.slant,o=void 0===i?"horizontal":i,s=We(r,ae(e).width),l=6<r.length?x().domain(r):b().domain(r),c=Be().scale(l).horizontalFloat(s.horizontalFloat).rows(s.rows).columnWidth(s.columnWidth).orientation(s.orientation),u=function(t,e){switch(t){case"vertical":return 40+R.max(e,oe);case"diagonal":return 40+Math.sqrt(2*Math.pow(R.max(e,oe)/2,2));default:return 60}}(o,a),p=s.rows*Re;return{axisLabelPadding:u,legendPadding:p,bottomPadding:u+p,legendWidth:s.legendWidth,legend:c,scale:l}},t.compose=A,t.contains=function(t,e){return 0<=t.indexOf(e)},t.createHtmlLayer=function(t,e,r){e||(e=ce()),r||(r={});var n="data-sszvis-html-"+(r.key||"default"),a=u(t)?t:R.select(t);a.classed("sszvis-outer-container",!0);var i=a.selectAll("[data-sszvis-html-layer]["+n+"]").data([0]),o=i.enter().append("div").classed("sszvis-html-layer",!0).attr("data-sszvis-html-layer","").attr(n,"");return(i=i.merge(o)).style("position","absolute").style("left",e.padding.left+"px").style("top",e.padding.top+"px"),i},t.createSvgLayer=function(t,e,r){e||(e=ce()),r||(r={});var n="data-sszvis-svg-"+(r.key||"default"),a=r.title||"",i=r.description||"",o=(u(t)?t:R.select(t)).selectAll("svg["+n+"]").data([0]),s=o.enter().append("svg");s.classed("sszvis-svg-layer",!0).attr(n,"").attr("role","img").attr("aria-label",a+" – "+i),s.append("title").text(a),s.append("desc").text(i).classed("sszvis-svg-layer",!0).attr(n,"").attr("role","img"),o.merge(s).attr("height",e.height).attr("width",e.width);var l=o.merge(s).selectAll("[data-sszvis-svg-layer]").data(function(){return[0]}),c=l.enter().append("g").attr("data-sszvis-svg-layer","");return l.merge(c).attr("transform","translate("+e.padding.left+","+e.padding.top+")"),l.merge(c)},t.dataAreaPattern=$,t.defaultTransition=he,t.defined=_,t.derivedSet=function(t,e){e||(e=f);for(var r,n,a=[],i=[],o=0,s=t.length;o<s;++o)n=e(r=t[o],o,t),a.indexOf(n)<0&&(a.push(n),i.push(r));return i},t.dimensionsHeatTable=function(t,e,r,n,a){a||(a={}),a.top||(a.top=0),a.right||(a.right=0),a.bottom||(a.bottom=0),a.left||(a.left=0);var i=t-a.left-a.right,o=Math.min((i-e*(r-1))/r,30),s=o+e,l=r*s-e;return{side:o,paddedSide:s,padRatio:1-o/s,width:l,height:n*s-e,centeredOffset:Math.max((i-l)/2,0)}},t.dimensionsHorizontalBarChart=function(t){var e=24*t+20*(t-1);return{barHeight:24,padHeight:20,padRatio:1-24/44,outerRatio:0,axisOffset:-22,barGroupHeight:e,totalHeight:e+0}},t.dimensionsVerticalBarChart=function(t,e){var r=e-1,n=t*(1-.7)/((1-.7)*r+.7*e),a=(t-n*r)/e;48<a&&(n=(t-(a=48)*e)/r),n<2&&(n=2),100<n&&(n=100);var i=a*e+n*r;return{barWidth:a,padWidth:n,padRatio:1-a/(a+n),outerRatio:(t-i)/2/(a+n),barGroupWidth:i,totalWidth:t}},t.dot=function(){return tt().prop("x",d).prop("y",d).prop("radius").prop("stroke").prop("fill").prop("transition").transition(!0).render(function(t){var e=R.select(this),r=e.props(),n=e.selectAll(".sszvis-circle").data(t);n.exit().remove(),n.enter().append("circle").classed("sszvis-circle",!0).attr("cx",r.x).attr("cy",r.y).attr("r",r.radius).merge(n).attr("stroke",r.stroke).attr("fill",r.fill),r.transition&&(n=n.transition(he())),n.attr("cx",r.x).attr("cy",r.y).attr("r",r.radius);var a=st().position(function(t){return[r.x(t),r.y(t)]});e.call(a)})},t.ensureDefsElement=m,t.every=function(t,e){for(var r=0;r<e.length;r++)if(!t(e[r]))return!1;return!0},t.fallbackCanvasUnsupported=function(){return!document.createElement("canvas").getContext},t.fallbackRender=function(t,e){e||(e={}),e.src||(e.src="fallback.png"),(u(t)?t:R.select(t)).append("img").attr("class","sszvis-fallback-image").attr("src",e.src)},t.fallbackUnsupported=function(){return!(document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)},t.fastTransition=function(){return R.transition().ease(fe).duration(50)},t.filledArray=h,t.find=l,t.first=v,t.firstTouch=s,t.fitTooltip=function(r,t){var n=Math.min(1*t.innerWidth/4,100),a=Math.max(3*t.innerWidth/4,t.innerWidth-100);return function(t){var e=t.x;return a<e?"right":e<n?"left":r}},t.flatten=function(t){return Array.prototype.concat.apply([],t)},t.foldPattern=function(t,e){var r=e[t];if("function"==typeof r)return r();throw new Error("[foldPattern] No definition provided for key: "+t)},t.formatAge=function(t){return String(Math.round(t))},t.formatAxisTimeFormat=dt,t.formatFractionPercent=function(t){return vt(100*t)+" %"},t.formatMonth=ft,t.formatNone=function(){return""},t.formatNumber=vt,t.formatPercent=function(t){return vt(t)+" %"},t.formatPreciseNumber=function t(r,e){return 1<arguments.length?t(r)(e):function(t){var e=Math.abs(t);return 100<=e&&e<1e4?pt("."+r+"f")(t):pt(",."+r+"f")(t)}},t.formatText=gt,t.formatYear=ht,t.functor=d,t.getGeoJsonCenter=Ue,t.groupedBars=function(){return tt().prop("groupScale").prop("groupSize").prop("groupWidth").prop("groupSpace").groupSpace(.05).prop("y",d).prop("height").prop("fill").prop("stroke").prop("defined",d).defined(!0).render(function(t){var e=R.select(this),a=e.props(),i=R.scaleBand().domain(R.range(a.groupSize)).padding(a.groupSpace).paddingOuter(0).rangeRound([0,a.groupWidth]),r=e.selectAll("g.sszvis-bargroup").data(t),n=r.enter().append("g").classed("sszvis-bargroup",!0);r.exit().remove();var o=(r=r.merge(n)).selectAll("g.sszvis-barunit").data(function(t){return t}),s=o.enter().append("g").classed("sszvis-barunit",!0);o.exit().remove(),(o=o.merge(s)).each(function(t,e){t.__sszvisGroupedBarIndex__=e});var l=o.filter(a.defined);l.selectAll("*").remove(),l.attr("transform",function(){return ot(0,0)}),l.append("rect").classed("sszvis-bar",!0).attr("fill",a.fill).attr("x",function(t){return a.groupScale(t)+i(t.__sszvisGroupedBarIndex__)}).attr("y",a.y).attr("width",i.bandwidth()).attr("height",a.height);var c=o.filter(p(a.defined));c.selectAll("*").remove(),c.attr("transform",function(t,e){return ot(a.groupScale(t)+i(t.__sszvisGroupedBarIndex__)+i.bandwidth()/2,a.y(t,e))}),c.append("line").classed("sszvis-bar--missing line1",!0).attr("x1",-4).attr("y1",-4).attr("x2",4).attr("y2",4),c.append("line").classed("sszvis-bar--missing line2",!0).attr("x1",4).attr("y1",-4).attr("x2",-4).attr("y2",4);var u=st().position(function(t){var r=0,n=1/0;return t.forEach(function(t,e){r+=a.groupScale(t)+i(t.__sszvisGroupedBarIndex__)+i.bandwidth()/2,n=Math.min(n,a.y(t,e))}),[r/t.length,n]});e.call(u)})},t.halfPixel=at,t.handleRuler=function(){return tt().prop("x",d).prop("y",d).prop("top").prop("bottom").prop("label").label(d("")).prop("color").prop("flip",d).flip(!1).render(function(t){var e=R.select(this),i=e.props(),r=A(at,i.x),n=A(at,i.y),a=i.bottom-4,o=i.top-24,s=e.selectAll(".sszvis-handleRuler__group").data([0]),l=s.enter().append("g").classed("sszvis-handleRuler__group",!0);s.exit().remove(),s=s.merge(l),l.append("line").classed("sszvis-ruler__rule",!0),l.append("rect").classed("sszvis-handleRuler__handle",!0),l.append("line").classed("sszvis-handleRuler__handle-mark",!0),s.selectAll(".sszvis-ruler__rule").attr("x1",r).attr("y1",at(i.top)).attr("x2",r).attr("y2",at(a)),s.selectAll(".sszvis-handleRuler__handle").attr("x",function(t){return r(t)-5}).attr("y",at(o)).attr("width",10).attr("height",24).attr("rx",2).attr("ry",2),s.selectAll(".sszvis-handleRuler__handle-mark").attr("x1",r).attr("y1",at(o+24*.15)).attr("x2",r).attr("y2",at(o+20.4));var c=s.selectAll(".sszvis-ruler__dot").data(t),u=c.enter().append("circle").classed("sszvis-ruler__dot",!0);c.exit().remove(),(c=c.merge(u)).attr("cx",r).attr("cy",n).attr("r",3.5).attr("fill",i.color);var p=e.selectAll(".sszvis-ruler__label-outline").data(t),d=p.enter().append("text").classed("sszvis-ruler__label-outline",!0);p.exit().remove(),p=p.merge(d);var f=e.selectAll(".sszvis-ruler__label").data(t),h=f.enter().append("text").classed("sszvis-ruler__label",!0);f.exit().remove(),f=f.merge(h),e.selectAll(".sszvis-ruler__label, .sszvis-ruler__label-outline").attr("transform",function(t){var e=A(at,i.x)(t),r=A(at,i.y)(t),n=i.flip(t)?-10:10,a=r<i.top+a?2*a:r>i.bottom-a?0:5;return ot(e+n,r+a)}).style("text-anchor",function(t){return i.flip(t)?"end":"start"}).html(i.label)})},t.hashableSet=function(t,e){e||(e=f);for(var r,n={},a=[],i=0,o=t.length;i<o;++i)n[r=e(t[i],i,t)]||(n[r]=!0,a.push(r));return a},t.heatTableMissingValuePattern=function(t){var e=H(),r="#A4A4A4";t.attr("patternUnits","objectBoundingBox").attr("patternContentUnits","objectBoundingBox").attr("x",0).attr("y",0).attr("width",1).attr("height",1),t.append("rect").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("fill",e),t.append("line").attr("x1",.35).attr("y1",.35).attr("x2",.65).attr("y2",.65).attr("stroke-width",.035).attr("stroke",r),t.append("line").attr("x1",.65).attr("y1",.35).attr("x2",.35).attr("y2",.65).attr("stroke-width",.035).attr("stroke",r)},t.identity=f,t.isFunction=function(t){return"function"==typeof t},t.isNull=n,t.isNumber=function(t){return"[object Number]"===Object.prototype.toString.call(t)},t.isObject=c,t.isSelection=u,t.isString=r,t.last=g,t.layoutPopulationPyramid=function(t,e){for(var r=Math.min(Ot(t),480),n=1*(e-1),a=Math.round((r-n)/e),i=e*(a=Math.max(a,2))+n,o=i-a,s=a+1,l=[];0<=o;)l.push(o),o-=s;var c=Math.min(t/2,.8*Ot.MAX_HEIGHT/2);return{barHeight:a,padding:1,totalHeight:i,positions:l,maxBarLength:c,chartPadding:Math.max((t-2*c)/2,1)}},t.layoutSmallMultiples=function(){return tt().prop("width").prop("height").prop("paddingX").prop("paddingY").prop("rows").prop("cols").render(function(t){var e=R.select(this),r=e.props(),n=(r.width-r.paddingX*(r.cols-1))/r.cols,a=(r.height-r.paddingY*(r.rows-1))/r.rows,i=n/2,o=a/2,s=e.selectAll("g.sszvis-multiple").data(t),l=s.enter().append("g").classed("sszvis-g sszvis-multiple",!0);s.exit().remove();var c=(s=s.merge(l)).selectAll("g.sszvis-multiple-chart").data(function(t){return[t.values]}),u=c.enter().append("g").classed("sszvis-multiple-chart",!0);c.exit().remove(),c=c.merge(u),s.datum(function(t,e){return t.gx=e%r.cols*(n+r.paddingX),t.gw=n,t.cx=i,t.gy=Math.floor(e/r.cols)*(a+r.paddingY),t.gh=a,t.cy=o,t}).attr("transform",function(t){return"translate("+t.gx+","+t.gy+")"})})},t.layoutStackedAreaMultiples=function(t,e,r){r||(r=.1);for(var n=t/(e-r),a=n*(1-r),i=a,o=[];i-t<1;)o.push(i),i+=n;return{range:o,bandHeight:a,padHeight:n*r}},t.legendColorBinned=function(){return tt().prop("scale").prop("displayValues").prop("endpoints").prop("width").width(200).prop("labelFormat").labelFormat(f).render(function(){var t=R.select(this),n=t.props();if(!n.scale)return Ht("legend.binnedColorScale - a scale must be specified.");if(!n.displayValues)return Ht("legend.binnedColorScale - display values must be specified.");if(!n.endpoints)return Ht("legend.binnedColorScale - endpoints must be specified");var e=[0,n.width-10],a=R.scaleLinear().domain(n.endpoints).range(e),i=0,o=[],s=n.endpoints[0];n.displayValues.forEach(function(t){var e=a(t)-i,r=i%1;o.push({x:Math.floor(5+i),w:e+r,c:n.scale(s),p:t}),i+=e,s=t}),o.push({x:Math.floor(5+i),w:e[1]-i,c:n.scale(s)});var r=t.selectAll("circle.sszvis-legend__circle").data(n.endpoints),l=r.enter().append("circle").classed("sszvis-legend__circle",!0);(r=r.merge(l)).exit().remove(),r.attr("r",5).attr("cy",5).attr("cx",function(t,e){return 0===e?5:n.width-5}).attr("fill",n.scale);var c=t.selectAll("rect.sszvis-legend__crispmark").data(o),u=c.enter().append("rect").classed("sszvis-legend__crispmark",!0);(c=c.merge(u)).exit().remove(),c.attr("x",function(t){return t.x}).attr("y",0).attr("width",function(t){return t.w}).attr("height",10).attr("fill",function(t){return t.c});var p=o.slice(0,-1),d=t.selectAll("line.sszvis-legend__crispmark").data(p),f=d.enter().append("line").classed("sszvis-legend__crispmark",!0);d.merge(f),d.exit().remove(),d.attr("x1",function(t){return at(t.x+t.w)}).attr("x2",function(t){return at(t.x+t.w)}).attr("y1",11).attr("y2",16).attr("stroke","#B8B8B8");var h=t.selectAll(".sszvis-legend__axislabel").data(p),v=h.enter().append("text").classed("sszvis-legend__axislabel",!0);(h=h.merge(v)).exit().remove(),h.style("text-anchor","middle").attr("transform",function(t){return"translate("+(t.x+t.w)+",30)"}).text(function(t){return n.labelFormat(t.p)})})},t.legendColorLinear=function(){return tt().prop("scale").prop("displayValues").displayValues([]).prop("width").width(200).prop("segments").segments(8).prop("labelText").prop("labelFormat").labelFormat(f).render(function(){var t=R.select(this),r=t.props();if(!r.scale)return Ht("legend.linearColorScale - a scale must be specified."),!1;var e=r.scale.domain(),n=r.displayValues;!n.length&&r.scale.ticks&&(n=r.scale.ticks(r.segments-1)),n.push(g(e));var a=0<n.length?r.width/n.length:0,i=t.selectAll("rect.sszvis-legend__mark").data(n),o=i.enter().append("rect").classed("sszvis-legend__mark",!0);i.exit().remove(),(i=i.merge(o)).attr("x",function(t,e){return e*a-1}).attr("y",0).attr("width",a+1).attr("height",10).attr("fill",function(t){return r.scale(t)});var s=[v(e),g(e)],l=r.labelText||s,c=t.selectAll("circle.ssvis-legend--mark").data(s),u=c.enter().append("circle").attr("class","ssvis-legend--mark");c.exit().remove(),(c=c.merge(u)).attr("cx",function(t,e){return e*r.width}).attr("cy",5).attr("r",5).attr("fill",function(t){return r.scale(t)});var p=t.selectAll(".sszvis-legend__label").data(l),d=p.enter().append("text").classed("sszvis-legend__label",!0);p.exit().remove(),(p=p.merge(d)).style("text-anchor",function(t,e){return 0===e?"end":"start"}).attr("dy","0.35em").attr("transform",function(t,e){return"translate("+(e*r.width+16*(0===e?-1:1))+", 5)"}).text(function(t,e){return r.labelFormat(t,e)})})},t.legendColorOrdinal=Be,t.legendRadius=function(){return tt().prop("scale").prop("tickFormat").tickFormat(f).prop("tickValues").render(function(){var t=R.select(this),e=t.props(),r=e.scale.domain(),n=e.tickValues||[r[1],e.scale.invert(R.mean(e.scale.range())),r[0]],a=It(e.scale)[1],i=t.selectAll("g.sszvis-legend__elementgroup").data([0]),o=i.enter().append("g").attr("class","sszvis-legend__elementgroup");(i=i.merge(o)).attr("transform",ot(at(a),at(a)));var s=i.selectAll("circle.sszvis-legend__greyline").data(n),l=s.enter().append("circle").classed("sszvis-legend__greyline",!0);function c(t){return a-2*e.scale(t)}s.exit().remove(),(s=s.merge(l)).attr("r",e.scale).attr("stroke-width",1).attr("cy",function(t){return a-e.scale(t)});var u=i.selectAll("line.sszvis-legend__dashedline").data(n),p=u.enter().append("line").classed("sszvis-legend__dashedline",!0);u.exit().remove(),(u=u.merge(p)).attr("x1",0).attr("y1",c).attr("x2",a+15).attr("y2",c);var d=i.selectAll(".sszvis-legend__label").data(n),f=d.enter().append("text").attr("class","sszvis-legend__label sszvis-legend__label--small");d.exit().remove(),(d=d.merge(f)).attr("dx",a+18).attr("y",c).attr("dy","0.35em").text(e.tickFormat)})},t.line=function(){return tt().prop("x").prop("y").prop("stroke").prop("strokeWidth").prop("defined").prop("key").key(function(t,e){return e}).prop("valuesAccessor").valuesAccessor(f).prop("transition").transition(!0).render(function(t){var e=R.select(this),r=e.props(),n=R.line().defined(void 0!==r.defined?r.defined:A(p(isNaN),r.y)).x(r.x).y(r.y),a=e.selectAll(".sszvis-line").data(t,r.key),i=a.enter().append("path").classed("sszvis-line",!0).style("stroke",r.stroke);(a=a.merge(i)).exit().remove(),a.order(),r.transition&&(a=a.transition(he())),a.attr("d",A(n,r.valuesAccessor)).style("stroke",r.stroke).style("stroke-width",r.strokeWidth)})},t.loadError=function(t){Ht(t)},t.locale=ct,t.mapLakeFadeGradient=Q,t.mapLakeGradientMask=Z,t.mapLakePattern=q,t.mapMissingValuePattern=X,t.mapRendererBase=Ke,t.mapRendererBubble=function(){var i=R.dispatch("over","out","click"),e=tt().prop("mergedData").prop("mapPath").prop("radius",d).prop("fill",d).prop("strokeColor",d).strokeColor("#ffffff").prop("strokeWidth",d).strokeWidth(1).prop("transition").transition(!0).render(function(){var t=R.select(this),r=t.props(),e=A(r.radius,Ye),n=t.selectGroup("anchoredCircles").selectAll(".sszvis-anchored-circle").data(r.mergedData,function(t){return t.geoJson.id});if(n.enter().append("circle").attr("class","sszvis-anchored-circle sszvis-anchored-circle--entering").attr("r",e).on("mouseover",function(t){i.call("over",this,t.datum)}).on("mouseout",function(t){i.call("out",this,t.datum)}).on("click",function(t){i.call("click",this,t.datum)}).merge(n).attr("transform",function(t){var e=r.mapPath.projection()(Ue(t.geoJson));return ot(e[0],e[1])}).style("fill",function(t){return r.fill(t.datum)}).style("stroke",function(t){return r.strokeColor(t.datum)}).style("stroke-width",function(t){return r.strokeWidth(t.datum)}).sort(function(t,e){return r.radius(e.datum)-r.radius(t.datum)}),n.classed("sszvis-anchored-circle--entering",!1),r.transition){var a=he();n.exit().transition(a).attr("r",0).remove(),n.transition(a).attr("r",e)}else n.exit().remove(),n.attr("r",e)});return e.on=function(){var t=i.on.apply(i,arguments);return t===i?e:t},e},t.mapRendererGeoJson=function(){var p=R.dispatch("over","out","click"),e=tt().prop("dataKeyName").dataKeyName(Je).prop("geoJsonKeyName").geoJsonKeyName("id").prop("geoJson").prop("mapPath").prop("defined",d).defined(!0).prop("fill",d).fill("black").prop("stroke",d).stroke("black").prop("strokeWidth",d).strokeWidth(1.25).prop("transitionColor").transitionColor(!0).render(function(t){var e=R.select(this),r=e.props();m(e,"pattern","missing-pattern").call(X);var n=B(r.dataKeyName),a=B(r.geoJsonKeyName),i=t.reduce(function(t,e){return t[n(e)]=e,t}),o=r.geoJson.features.map(function(t){return{geoJson:t,datum:i[a(t.properties)]}});function s(t){return _(t.datum)&&r.defined(t.datum)?r.fill(t.datum):"url(#missing-pattern)"}var l=e.selectAll(".sszvis-map__geojsonelement").data(o),c=l.enter().append("path").classed("sszvis-map__geojsonelement",!0).attr("data-event-target","").attr("fill",s);l.exit().remove(),l=l.merge(c),e.selectAll(".sszvis-map__geojsonelement--undefined").attr("fill",s),l.classed("sszvis-map__geojsonelement--undefined",function(t){return!_(t.datum)||!r.defined(t.datum)}).attr("d",function(t){return r.mapPath(t.geoJson)}),r.transitionColor?l.transition().call(ve).attr("fill",s):l.attr("fill",s),l.attr("stroke",function(t){return _(t.datum)&&r.defined(t.datum)?r.stroke(t.datum):""}).attr("stroke-width",r.strokeWidth),e.selectAll("[data-event-target]").on("mouseover",function(t){p.over(t.datum)}).on("mouseout",function(t){p.out(t.datum)}).on("click",function(t){p.click(t.datum)});var u=st().position(function(t){t.geoJson.properties||(t.geoJson.properties={});var e=t.geoJson.properties.sphericalCentroid;return e||(t.geoJson.properties.sphericalCentroid=e=R.geoCentroid(t.geoJson)),r.mapPath.projection()(e)});e.selectGroup("tooltipAnchors").datum(o).call(u)});return e.on=function(){var t=p.on.apply(p,arguments);return t===p?e:t},e},t.mapRendererHighlight=Xe,t.mapRendererImage=function(){return tt().prop("projection").prop("src").prop("geoBounds").prop("opacity").opacity(1).render(function(){var t=R.select(this),e=t.props(),r=t.selectAll(".sszvis-map__image").data([0]),n=r.enter().append("img").classed("sszvis-map__image",!0);r.exit().remove(),r=r.merge(n);var a=e.projection(e.geoBounds[0]),i=e.projection(e.geoBounds[1]);r.attr("src",e.src).style("left",Math.round(a[0])+"px").style("top",Math.round(a[1])+"px").style("width",Math.round(i[0]-a[0])+"px").style("height",Math.round(i[1]-a[1])+"px").style("opacity",e.opacity)})},t.mapRendererMesh=qe,t.mapRendererPatternedLakeOverlay=Qe,t.mapRendererRaster=function(){return tt().prop("debug").debug(!1).prop("width").prop("height").prop("position").prop("cellSide").cellSide(2).prop("fill",d).prop("opacity").opacity(1).render(function(t){var e=R.select(this),r=e.props(),n=e.selectAll(".sszvis-map__rasterimage").data([0]),a=n.enter().append("canvas").classed("sszvis-map__rasterimage",!0);n.exit().remove(),(n=n.merge(a)).attr("width",r.width).attr("height",r.height).style("opacity",r.opacity);var i=n.node().getContext("2d");i.clearRect(0,0,r.width,r.height),r.debug&&(i.fillStyle="rgba(255, 0, 0, 0.2)",i.fillRect(0,0,r.width,r.height));var o=r.cellSide/2;t.forEach(function(t){var e=r.position(t);i.fillStyle=r.fill(t),i.fillRect(e[0]-o,e[1]-o,r.cellSide,r.cellSide)})})},t.measureAxisLabel=oe,t.measureDimensions=ae,t.measureLegendLabel=se,t.measureText=ie,t.memoize=i,t.modularTextHTML=ar,t.modularTextSVG=ir,t.move=qt,t.muchDarker=function(t){return R.hsl(t).darker(.7)},t.not=p,t.panning=function(){var r=R.dispatch("start","pan","end"),e=tt().prop("elementSelector").render(function(){var t=R.select(this),e=t.props();t.selectAll(e.elementSelector).attr("data-sszvis-behavior-pannable","").classed("sszvis-interactive",!0).on("mouseenter",function(){r.apply("start",this,arguments)}).on("mousemove",function(){r.apply("pan",this,arguments)}).on("mouseleave",function(){r.apply("end",this,arguments)}).on("touchstart",function(){R.event.preventDefault(),r.apply("start",this,arguments)}).on("touchmove",function(){var t;R.event.preventDefault(),null!==(t=s(R.event),$t(Zt(t)))?r.apply("pan",this,arguments):r.apply("end",this,arguments)}).on("touchend",function(){r.apply("end",this,arguments)})});return e.on=function(){var t=r.on.apply(r,arguments);return t===r?e:t},e},t.parseDate=function(t){return $e(t)},t.parseNumber=function(t){return""===t.trim()?NaN:+t},t.parseYear=function(t){return tr(t)},t.pie=function(){return tt().prop("radius").prop("fill").prop("stroke").prop("angle",d).render(function(r){var t=R.select(this),n=t.props(),e=0;r.forEach(function(t){t._a0=e,isNaN(t.a0)&&(t.a0=e),e+=n.angle(t),t._a1=e,isNaN(t.a1)&&(t.a1=e)});var a=R.arc().innerRadius(4).outerRadius(n.radius).startAngle(function(t){return t.a0}).endAngle(function(t){return t.a1}),i=t.selectAll(".sszvis-path").each(function(t,e){r[e]&&(r[e].a0=t.a0,r[e].a1=t.a1)}).data(r),o=i.enter().append("path").classed("sszvis-path",!0).attr("transform","translate("+n.radius+","+n.radius+")").attr("fill",n.fill).attr("stroke",n.stroke);i.exit().remove(),(i=i.merge(o)).transition(he()).attr("transform","translate("+n.radius+","+n.radius+")").attrTween("d",function(e){var r=R.interpolate(e.a0,e._a0),n=R.interpolate(e.a1,e._a1);return function(t){return e.a0=r(t),e.a1=n(t),a(e)}}).attr("fill",n.fill).attr("stroke",n.stroke);var s=st().position(function(t){var e=t.a0+Math.abs(t.a1-t.a0)/2-Math.PI/2,r=2*n.radius/3;return[n.radius+Math.cos(e)*r,n.radius+Math.sin(e)*r]});t.datum(r).call(s)})},t.pixelsFromGeoDistance=function(t,e,r){var n=r/(2*Math.PI*6367475)*360/2,a=[[e[0]-n,e[1]-n],[e[0]+n,e[1]+n]].map(t);return(Math.abs(a[1][0]-a[0][0])+Math.abs(a[1][1]-a[0][1]))/2},t.prepareMergedGeoData=Ve,t.prop=B,t.propOr=a,t.pyramid=function(){return tt().prop("barHeight",d).prop("barWidth",d).prop("barPosition",d).prop("barFill",d).barFill("#000").prop("tooltipAnchor").tooltipAnchor([.5,.5]).prop("leftAccessor").prop("rightAccessor").prop("leftRefAccessor").prop("rightRefAccessor").render(function(t){var e=R.select(this),r=e.props(),n=me().x(function(t){return-.5-r.barWidth(t)}).y(r.barPosition).height(r.barHeight).width(r.barWidth).fill(r.barFill).tooltipAnchor(r.tooltipAnchor),a=me().x(.5).y(r.barPosition).height(r.barHeight).width(r.barWidth).fill(r.barFill).tooltipAnchor(r.tooltipAnchor),i=ye().barPosition(r.barPosition).barWidth(r.barWidth).mirror(!0),o=ye().barPosition(r.barPosition).barWidth(r.barWidth);e.selectGroup("left").datum(r.leftAccessor(t)).call(n),e.selectGroup("right").datum(r.rightAccessor(t)).call(a),e.selectGroup("leftReference").datum(r.leftRefAccessor?[r.leftRefAccessor(t)]:[]).call(i),e.selectGroup("rightReference").datum(r.rightRefAccessor?[r.rightRefAccessor(t)]:[]).call(o)})},t.range=It,t.responsiveProps=function(){var o=wt(),s={};function n(a){if(!(c(a)&&_(t=a)&&_(t.width)&&_(t.screenWidth)&&_(t.screenHeight)))return Nt("Could not determine the current breakpoint, returning the default props"),Object.keys(s).reduce(function(t,e,r){return t[r]=e._,t},{});var t,i=_t(o,a);return Object.keys(s).reduce(function(t,e){var r=s[e];if(!function(t,e){if(!_(t._))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&"_"!==r&&!_(bt(e,r)))return!1;return!0}(r,o))return Nt('responsiveProps was given an invalid propSpec for property: "'+e+'". The spec: ',r),t;var n=l(function(t){return _(r[t.name])},i);return t[e]=r[n.name](a.width),t},{})}return n.prop=function(t,e){var r;return s[t]=(r=e,Object.keys(r).reduce(function(t,e){return t[e]=d(r[e]),t},{})),n},n.breakpoints=function(t){return 0===arguments.length?o:(o=zt(t),n)},n},t.roundTransformString=function(t){var a=A(Math.floor,Number);return t.replace(/(translate\()\s*([0-9., ]+)\s*(\))/i,function(t,e,r,n){return e+r.replace(","," ").replace(/\s+/," ").split(" ").map(a).join(",")+n})},t.sankey=function(){return tt().prop("sizeScale").prop("columnPosition").prop("nodeThickness").prop("nodePadding").prop("columnPadding",d).prop("columnLabel",d).columnLabel("").prop("columnLabelOffset",d).columnLabelOffset(0).prop("linkCurvature").linkCurvature(.5).prop("nodeColor",d).prop("linkColor",d).prop("linkSort",d).linkSort(function(t,e){return t.value-e.value}).prop("labelSide",d).labelSide("left").prop("labelSideSwitch").prop("labelOpacity",d).labelOpacity(1).prop("labelHitBoxSize").labelHitBoxSize(0).prop("nameLabel").nameLabel(f).prop("linkSourceLabels").linkSourceLabels([]).prop("linkTargetLabels").linkTargetLabels([]).prop("linkLabel",d).render(function(t){var e=R.select(this),p=e.props(),r=B("id"),n=function(t){return Math.floor(p.columnPadding(t.columnIndex)+p.sizeScale(t.valueOffset)+p.nodePadding*t.nodeIndex)},a=function(t){return p.columnPosition(t.columnIndex)},i=function(t){return n(t)},o=function(){return Math.max(p.nodeThickness,1)},s=function(t){return Math.ceil(Math.max(p.sizeScale(t.value),1))},l=me().x(a).y(i).width(o).height(s).fill(p.nodeColor),c=e.selectGroup("nodes").datum(t.nodes);c.call(l);var u=st().position(function(t){return[a(t)+o()/2,i(t)+s(t)/2]});c.call(u);var d=function(t){return p.columnPosition(t)+p.nodeThickness/2},f=c.selectAll(".sszvis-sankey-column-label").data(t.columnLengths),h=f.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-weak-label sszvis-sankey-column-label");(f=f.merge(h)).exit().remove(),f.attr("transform",function(t,e){return ot(d(e)+p.columnLabelOffset(t,e),-24)}).text(function(t,e){return p.columnLabel(e)});var v=c.selectAll(".sszvis-sankey-column-label-tick").data(t.columnLengths),g=v.enter().append("line").attr("class","sszvis-sankey-column-label-tick");(v=v.merge(g)).exit().remove(),v.attr("x1",function(t,e){return at(d(e))}).attr("x2",function(t,e){return at(d(e))}).attr("y1",at(-16)).attr("y2",at(-12));var m=function(t){return[p.columnPosition(t.src.columnIndex)+p.nodeThickness+1,p.columnPosition(t.tgt.columnIndex)-1,n(t.src)+p.sizeScale(t.srcOffset)+p.sizeScale(t.value)/2,n(t.tgt)+p.sizeScale(t.tgtOffset)+p.sizeScale(t.value)/2]},y=function(t){var e,r,n,a,i=m(t);return e=i[0],r=i[1],n=i[2],a=i[3],[e,r,n,a]},x=e.selectGroup("links"),b=x.selectAll(".sszvis-link").data(t.links,r),k=b.enter().append("path").attr("class","sszvis-link");(b=b.merge(k)).exit().remove(),b.attr("fill","none").attr("d",function(t){var e,r,n,a,i,o,s=m(t),l=R.interpolateNumber(s[0],s[1]),c=l(p.linkCurvature),u=l(1-p.linkCurvature);return e=s[0],r=c,n=u,a=s[1],i=s[2],o=s[3],"M"+e+","+i+"C"+r+","+i+" "+n+","+o+" "+a+","+o}).attr("stroke-width",function(t){return Math.max(p.sizeScale(t.value),1)}).attr("stroke",p.linkColor).sort(p.linkSort),x.datum(t.links);var _=st().position(function(t){var e=y(t);return[(e[0]+e[1])/2,(e[2]+e[3])/2]});x.call(_);var z=e.selectGroup("linklabels"),A=z.selectAll(".sszvis-sankey-link-source-label").data(p.linkSourceLabels),w=A.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-strong-label sszvis-sankey-link-source-label");(A=A.merge(w)).exit().remove(),A.attr("transform",function(t){var e=y(t);return ot(e[0]+6,e[2])}).text(p.linkLabel);var S=z.selectAll(".sszvis-sankey-link-target-label").data(p.linkTargetLabels),M=S.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-strong-label sszvis-sankey-link-target-label");(S=S.merge(M)).exit().remove(),S.attr("transform",function(t){var e=y(t);return ot(e[1]-6,e[3])}).text(p.linkLabel);var C=function(t){var e=p.labelSide(t);return p.labelSideSwitch&&(e="left"===e?"right":"left"),e},F=e.selectGroup("nodelabels"),T=F.selectAll(".sszvis-sankey-node-label").data(t.nodes),E=T.enter().append("text").attr("class","sszvis-sankey-label sszvis-sankey-weak-label sszvis-sankey-node-label");(T=T.merge(E)).exit().remove(),T.text(function(t){return p.nameLabel(t.id)}).attr("text-align","middle").attr("text-anchor",function(t){return"left"===C(t.columnIndex)?"end":"start"}).attr("x",function(t){return"left"===C(t.columnIndex)?a(t)-6:a(t)+p.nodeThickness+6}).attr("y",function(t){return i(t)+s(t)/2}).style("opacity",p.labelOpacity);var P=F.selectAll(".sszvis-sankey-hitbox").data(t.nodes),L=P.enter().append("rect").attr("class","sszvis-sankey-hitbox");(P=P.merge(L)).exit().remove(),P.attr("fill","transparent").attr("x",function(t){return a(t)+("left"===C(t.columnIndex)?-p.labelHitBoxSize:0)}).attr("y",function(t){return i(t)-p.nodePadding/2}).attr("width",p.labelHitBoxSize+p.nodeThickness).attr("height",function(t){return s(t)+p.nodePadding})})},t.sankeyLayout=function(t,r,n,e){var a=R.min(t.map(function(t){var e=.15*n/(t-1);return Math.max(12,Math.min(50,e))})),i=R.min(t.map(function(t,e){return Math.max(1,n-(t-1)*a)/r[e]})),o=a/i,s=a,l=R.max(r),c=t.map(function(t,e){return r[e]*i+(t-1)*s}),u=R.max(c),p=t.map(function(t,e){return(u-c[e])/2}),d=[0,l],f=[0,l*i],h=t.length;return{valuePadding:o,nodePadding:s,columnPaddings:p,valueDomain:d,valueRange:f,nodeThickness:20,columnDomain:[0,1],columnRange:[0,(e-20)/(h-1)]}},t.sankeyPrepareData=function(){var l=f,c=f,u=f,i=[],o=B("value"),t=function(t,e){return R.ascending(o(t),o(e))},p=function(t,e){return R.descending(o(t),o(e))},d=p,e=function(t){var s=i.reduce(function(r,t,n){return t.forEach(function(t){r.has(t)&&Nt("Duplicate column member id passed to sszvis.layout.sankey.prepareData.column:",t,"The existing value will be overwritten");var e={id:t,columnIndex:n,nodeIndex:0,value:0,valueOffset:0,linksFrom:[],linksTo:[]};r.set(t,e)}),r},R.map()),e=t.map(function(t){var e=l(t),r=c(t),n=+u(t)||0,a=s.get(e),i=s.get(r);if(!a)return Nt("Found invalid source column id:",e),null;if(!i)return Nt("Found invalid target column id:",r),null;var o={id:Ge(),value:n,src:a,srcOffset:0,tgt:i,tgtOffset:0};return a.linksFrom.push(o),i.linksTo.push(o),o}),r=s.values(),n=r.reduce(function(t,e){var r=R.sum(e.linksFrom,o),n=R.sum(e.linksTo,o);return e.value=Math.max(0,r,n),t[e.columnIndex]+=e.value,t},h(i.length,0)),a=i.map(function(t){return t.length});return r.sort(d),e.sort(p),r.reduce(function(t,e){return e.valueOffset=t[0][e.columnIndex],e.nodeIndex=t[1][e.columnIndex],t[0][e.columnIndex]+=e.value,t[1][e.columnIndex]+=1,t},[h(i.length,0),h(i.length,0)]),r.forEach(function(t){t.linksFrom.sort(function(t,e){return t.tgt.nodeIndex-e.tgt.nodeIndex}),t.linksTo.sort(function(t,e){return t.src.nodeIndex-e.src.nodeIndex}),t.linksFrom.reduce(function(t,e){return(e.srcOffset=t)+o(e)},0),t.linksTo.reduce(function(t,e){return(e.tgtOffset=t)+o(e)},0)}),{nodes:r,links:e,columnTotals:n,columnLengths:a}};return e.apply=function(t){return e(t)},e.source=function(t){return l=t,e},e.target=function(t){return c=t,e},e.value=function(t){return u=t,e},e.descendingSort=function(){return d=p,e},e.ascendingSort=function(){return d=t,e},e.idLists=function(t){return i=t,e},e},t.scaleDeepGry=V,t.scaleDimGry=j,t.scaleDivNtr=D,t.scaleDivNtrGry=W,t.scaleDivVal=L,t.scaleDivValGry=O,t.scaleGry=I,t.scaleLightGry=H,t.scaleMedGry=J,t.scalePaleGry=G,t.scaleQual12=x,t.scaleQual6=b,t.scaleQual6a=k,t.scaleQual6b=z,t.scaleSeqBlu=C,t.scaleSeqBrn=E,t.scaleSeqGrn=T,t.scaleSeqRed=F,t.selectMenu=function(){return tt().prop("values").prop("current").prop("width").width(300).prop("change").change(f).render(function(){var t=R.select(this),e=t.props(),r=t.selectAll(".sszvis-control-optionSelectable").data(["sszvis-control-select"],function(t){return t}),n=r.enter().append("div").classed("sszvis-control-optionSelectable",!0).classed("sszvis-control-select",!0);r.exit().remove(),(r=r.merge(n)).style("width",e.width+"px");var o=r.selectDiv("selectMetrics").classed("sszvis-control-select__metrics",!0),a=r.selectAll(".sszvis-control-select__element").data([1]),i=a.enter().append("select").classed("sszvis-control-select__element",!0).on("change",function(){var t=R.select(this).property("value");e.change(e.values[t]),setTimeout(function(){window.focus()},0)});(a=a.merge(i)).style("width",e.width+30+"px");var s=a.selectAll("option").data(e.values),l=s.enter().append("option");s.exit().remove(),s.merge(l).attr("selected",function(t){return t===e.current?"selected":null}).attr("value",function(t,e){return e}).text(function(t){return a=o,i=e.width-40,function t(e,r){a.text(e);var n=Math.ceil(a.node().clientWidth);return r<1e3&&i<n?t(e.slice(0,e.length-2)+"…",r+1):e}(t,0);var a,i})})},t.set=w,t.slider=function(){return tt().prop("scale").prop("value").prop("onchange").prop("minorTicks").minorTicks([]).prop("majorTicks").majorTicks([]).prop("tickLabels",d).tickLabels(f).prop("label",d).label(f).render(function(){var t=R.select(this),e=t.props(),r=at(18),n=e.scale.domain(),a=It(e.scale),i=e.scale.copy().range([a[0]+5.5,a[1]-5.5]),o=t.selectAll("g.sszvis-control-slider__backgroundgroup").data([1]),s=o.enter().append("g").classed("sszvis-control-slider__backgroundgroup",!0);(o=o.merge(s)).exit().remove();var l=Ut().scale(i).orient("bottom").hideBorderTickThreshold(0).tickSize(12).tickPadding(6).tickValues(w([].concat(e.majorTicks,e.minorTicks))).tickFormat(function(t){return Le(t,e.majorTicks)?e.tickLabels(t):""}),c=o.selectAll("g.sszvis-axisGroup").data([1]),u=c.enter().append("g").classed("sszvis-axisGroup sszvis-axis sszvis-axis--bottom sszvis-axis--slider",!0);(c=c.merge(u)).attr("transform",ot(0,28)).call(l),c.selectAll(".tick line").filter(function(t){return!Le(t,e.majorTicks)}).attr("y2",4);var p=c.selectAll(".tick text").filter(function(t){return Le(t,e.majorTicks)}),d=p.size();p.style("text-anchor",function(t,e){return 0===e?"start":e===d-1?"end":"middle"});var f=o.selectAll("g.sszvis-slider__background").data([1]),h=f.enter().append("g").classed("sszvis-slider__background",!0);(f=f.merge(h)).attr("transform",ot(0,r));var v=f.selectAll(".sszvis-slider__background__bg1").data([1]),g=v.enter().append("line").classed("sszvis-slider__background__bg1",!0).style("stroke-width",6).style("stroke","#888").style("stroke-linecap","round");(v=v.merge(g)).attr("x1",Math.ceil(a[0]+3)).attr("x2",Math.floor(a[1]-3));var m=f.selectAll(".sszvis-slider__background__bg2").data([1]),y=m.enter().append("line").classed("sszvis-slider__background__bg2",!0).style("stroke-width",5).style("stroke","#fff").style("stroke-linecap","round");(m=m.merge(y)).attr("x1",Math.ceil(a[0]+3)).attr("x2",Math.floor(a[1]-3));var x=f.selectAll(".sszvis-slider__backgroundshadow").data([e.value]),b=x.enter().append("line").attr("class","sszvis-slider__backgroundshadow").attr("stroke-width",5).style("stroke","#E0E0E0").style("stroke-linecap","round");(x=x.merge(b)).attr("x1",Math.ceil(a[0]+3)).attr("x2",A(Math.floor,i));var k=t.selectAll("g.sszvis-control-slider__handle").data([e.value]);k.exit().remove();var _=k.enter().append("g").classed("sszvis-control-slider__handle",!0);(k=k.merge(_)).attr("transform",function(t){return ot(at(i(t)),.5)}),_.append("text").classed("sszvis-control-slider--label",!0),k.selectAll(".sszvis-control-slider--label").data(function(t){return[t]}).text(e.label).style("text-anchor",function(t){return S(t,n[0])?"start":S(t,n[1])?"end":"middle"}).attr("dx",function(t){return S(t,n[0])?-5:S(t,n[1])?5:0}),_.append("rect").classed("sszvis-control-slider__handlebox",!0).attr("x",-5).attr("y",r-11.5).attr("width",10).attr("height",23).attr("rx",2).attr("ry",2),_.append("line").classed("sszvis-control-slider__handleline",!0).attr("y1",r-7.5).attr("y2",r+7.5);var z=qt().xScale(e.scale).yScale(R.scaleLinear().range([-11,40])).draggable(!0).on("drag",e.onchange);t.selectGroup("sliderInteraction").classed("sszvis-control-slider--interactionLayer",!0).attr("transform",ot(0,4)).call(z)})},t.slightlyDarker=function(t){return R.hsl(t).darker(.4)},t.slowTransition=ve,t.some=function(t,e){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1},t.stackedArea=function(){return tt().prop("x").prop("y0").prop("y1").prop("fill").prop("stroke").prop("defined").prop("key").key(function(t,e){return e}).prop("transition").transition(!0).render(function(t){var e=R.select(this),r=e.props(),n=R.area().defined(void 0!==r.defined?r.defined:function(){return A(p(isNaN),r.y0)&&A(p(isNaN),r.y1)}).x(r.x).y0(r.y0).y1(r.y1),a=e.selectAll("path.sszvis-path").data(t,r.key),i=a.enter().append("path").classed("sszvis-path",!0);a.exit().remove(),a=a.merge(i),r.transition&&(a=a.transition(he())),a.attr("d",n).attr("fill",r.fill).attr("stroke",r.stroke)})},t.stackedAreaMultiples=function(){return tt().prop("x").prop("y0").prop("y1").prop("fill").prop("stroke").prop("defined").prop("key").key(function(t,e){return e}).prop("valuesAccessor").valuesAccessor(f).prop("transition").transition(!0).render(function(t){var e=R.select(this),r=e.props();t=t.slice().reverse();var n=R.area().defined(void 0!==r.defined?r.defined:function(){return A(p(isNaN),r.y0)&&A(p(isNaN),r.y1)}).x(r.x).y0(r.y0).y1(r.y1),a=e.selectAll("path.sszvis-path").data(t,r.key),i=a.enter().append("path").classed("sszvis-path",!0);a.exit().remove(),a=i.merge(a),r.transition&&(a=a.transition(he())),a.attr("d",A(n,r.valuesAccessor)).attr("fill",r.fill).attr("stroke",r.stroke)})},t.stackedBarHorizontal=function(){return we(Se)},t.stackedBarHorizontalData=ze,t.stackedBarVertical=function(){return we(Me)},t.stackedBarVerticalData=Ae,t.stackedPyramid=function(){return tt().prop("barHeight",d).prop("barWidth",d).prop("barPosition",d).prop("barFill",d).barFill("#000").prop("tooltipAnchor").tooltipAnchor([.5,.5]).prop("leftAccessor").prop("rightAccessor").prop("leftRefAccessor").prop("rightRefAccessor").render(function(t){var e=R.select(this),r=e.props(),n=me().x(function(t){return-.5-r.barWidth(t[1])}).y(A(r.barPosition,Fe)).height(r.barHeight).width(function(t){return r.barWidth(t[1])-r.barWidth(t[0])}).fill(A(r.barFill,Ce)).tooltipAnchor(r.tooltipAnchor),a=me().x(function(t){return.5+r.barWidth(t[0])}).y(A(r.barPosition,Fe)).height(r.barHeight).width(function(t){return r.barWidth(t[1])-r.barWidth(t[0])}).fill(A(r.barFill,Ce)).tooltipAnchor(r.tooltipAnchor),i=Te().stackElement(n),o=Te().stackElement(a),s=Ee().barPosition(r.barPosition).barWidth(r.barWidth).mirror(!0),l=Ee().barPosition(r.barPosition).barWidth(r.barWidth);e.selectGroup("leftStack").datum(r.leftAccessor(t)).call(i),e.selectGroup("rightStack").datum(r.rightAccessor(t)).call(o),e.selectGroup("leftReference").datum(r.leftRefAccessor?[r.leftRefAccessor(t)]:[]).call(s),e.selectGroup("rightReference").datum(r.rightRefAccessor?[r.rightRefAccessor(t)]:[]).call(l)})},t.stackedPyramidData=function(r,n,a,i){return function(t){var e=de().arrayBy(r).arrayBy(n).objectBy(a).apply(t).map(function(t){var n=Object.keys(t[0]),a=r(t[0][n[0]][0]),e=R.stack().keys(n).value(function(t,e){return i(t[e][0])})(t);return e.forEach(function(t,r){t.forEach(function(t,e){return t.data=t.data[n[r]][0],t.series=n[r],t.side=a,t.row=e,t.value=i(t.data),t})}),e});return e.maxValue=R.max(e,function(t){return R.max(t,function(t){return R.max(t,function(t){return t[1]})})}),e}},t.stringEqual=S,t.sunburst=function(){return tt().prop("angleScale").angleScale(R.scaleLinear().range([0,2*Math.PI])).prop("radiusScale").prop("centerRadius").prop("fill").prop("stroke").stroke("white").render(function(r){var t=R.select(this),n=t.props(),i=function(t){return Math.max(0,Math.min(Pe,n.angleScale(t.x0)))},o=function(t){return Math.max(0,Math.min(Pe,n.angleScale(t.x1)))},s=function(t){return n.centerRadius+Math.max(0,n.radiusScale(t.y0))},l=function(t){return n.centerRadius+Math.max(0,n.radiusScale(t.y1))},a=R.arc().startAngle(i).endAngle(o).innerRadius(s).outerRadius(l);r.forEach(function(t){t._x0=t.x0,t._x1=t.x1});var e=t.selectAll(".sszvis-sunburst-arc").each(function(t,e){r[e]&&(r[e].x0=t.x0,r[e].x1=t.x1)}).data(r),c=e.enter().append("path").attr("class","sszvis-sunburst-arc");e.exit().remove(),(e=e.merge(c)).attr("stroke",n.stroke).attr("fill",function t(e){if(e.data.isSunburstRoot)return"transparent";if(e.parent){if(e.parent.data.isSunburstRoot)return R.hsl(n.fill(e.data.key));var r=t(e.parent);return r.l*=1.15,r}return Nt("Data passed to sszvis.component.sunburst does not have the expected tree structure. You should prepare it using sszvis.format.sunburst.prepareData"),R.hsl(n.fill(e.data.key))}),e.transition(he()).attrTween("d",function(e){var r=R.interpolate(e.x0,e._x0),n=R.interpolate(e.x1,e._x1);return function(t){return e.x0=r(t),e.x1=n(t),a(e)}});var u=st().position(function(t){var e=i(t),r=o(t),n=e+Math.abs(r-e)/2-Math.PI/2,a=(s(t)+l(t))/2;return[Math.cos(n)*a,Math.sin(n)*a]});t.call(u)})},t.sunburstGetRadiusExtent=function(t){return[R.min(t,function(t){return t.y0}),R.max(t,function(t){return t.y1})]},t.sunburstLayout=function(t,e){var r=e/2,n=r/3;return{centerRadius:n,numLayers:t,ringWidth:Math.max(10,Math.min(60,(r-n)/t))}},t.sunburstPrepareData=function(){var r=R.nest(),n=f,a=function(){return 0};function e(t){r.rollup(v);var e=R.hierarchy({isSunburstRoot:!0,values:r.entries(t)},B("values")).sort(a).sum(function(t){return t.value?n(t.value):0});return R.partition()(e),function t(e){return[].concat.apply([e],(e.children||[]).map(t))}(e).filter(function(t){return!t.data.isSunburstRoot})}return e.calculate=function(t){return e(t)},e.layer=function(t){return r.key(t),e},e.value=function(t){return n=t,e},e.sort=function(t){return a=t,e},e},t.swissMapPath=je,t.swissMapProjection=Ie,t.textWrap=jt,t.tooltip=function(){var e=tt().prop("header").prop("body").prop("orientation",d).orientation("bottom").prop("dx",d).dx(1).prop("dy",d).dy(1).prop("opacity",d).opacity(1).renderSelection(function(t){var e=t.datum(),o=t.props(),r=_,s=r(o.header)&&!r(o.body)||!r(o.header)&&r(o.body),n=t.selectAll(".sszvis-tooltip").data(e);n.exit().remove();var a=n.enter().append("div");(n=n.merge(a)).style("pointer-events","none").style("opacity",o.opacity).style("padding-top",function(t){return"top"===o.orientation(t)?"6px":null}).style("padding-right",function(t){return"right"===o.orientation(t)?"6px":null}).style("padding-bottom",function(t){return"bottom"===o.orientation(t)?"6px":null}).style("padding-left",function(t){return"left"===o.orientation(t)?"6px":null}).classed("sszvis-tooltip",!0);var i=a.append("svg").attr("class","sszvis-tooltip__background").attr("height",0).attr("width",0),l=i.append("path");if(void 0!==window.SVGFEColorMatrixElement&&2==SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE){var c=i.append("filter").attr("id","sszvisTooltipShadowFilter").attr("height","150%");c.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",2),c.append("feComponentTransfer").append("feFuncA").attr("type","linear").attr("slope",.2);var u=c.append("feMerge");u.append("feMergeNode"),u.append("feMergeNode").attr("in","SourceGraphic"),l.attr("filter","url(#sszvisTooltipShadowFilter)")}else i.classed("sszvis-tooltip__background--fallback",!0);var p=a.append("div").classed("sszvis-tooltip__content",!0);p.append("div").classed("sszvis-tooltip__header",!0),p.append("div").classed("sszvis-tooltip__body",!0),n.select(".sszvis-tooltip__header").datum(B("datum")).html(o.header||d("")),n.select(".sszvis-tooltip__body").datum(B("datum")).html(function(t){var e=o.body?d(o.body)(t):"";return Array.isArray(e)?'<table class="sszvis-tooltip__body__table">'+e.map(function(t){return"<tr>"+t.map(function(t){return"<td>"+t+"</td>"}).join("")+"</tr>"}).join("")+"</table>":e}),t.selectAll(".sszvis-tooltip").classed("sszvis-tooltip--small",s).each(function(t){var e=R.select(this),r=e.node().getBoundingClientRect(),n=o.orientation.apply(this,arguments);switch(n){case"top":e.style("left",t.x-r.width/2+"px").style("top",t.y+o.dy(t)+"px");break;case"bottom":e.style("left",t.x-r.width/2+"px").style("top",t.y-o.dy(t)-r.height+"px");break;case"left":e.style("left",t.x+o.dx(t)+"px").style("top",t.y-r.height/2+"px");break;case"right":e.style("left",t.x-o.dx(t)-r.width+"px").style("top",t.y-r.height/2+"px")}var a=r.height+10,i=r.width+10;e.select(".sszvis-tooltip__background").attr("height",a).attr("width",i).style("left","-5px").style("top","-5px").select("path").attr("d",function(t,e,r,n){switch(r){case"top":t[1]=t[1]+6;break;case"bottom":e[1]=e[1]-6;break;case"left":t[0]=t[0]+6;break;case"right":e[0]=e[0]-6}function a(t){return t[0]}function i(t){return t[1]}function o(t,e,r,n,a,i,o){var s=r+(a-r)/2,l=n+(i-n)/2,c=["Q",t,e,r,n],u=[];o&&n===i?u=r<a?["L",s-6,l,"L",s,l-6,"L",s+6,l]:["L",s+6,l,"L",s,l+6,"L",s-6,l]:o&&r===a&&(u=n<i?["L",s,l-6,"L",s+6,l,"L",s,l+6]:["L",s,l+6,"L",s-6,l,"L",s,l-6]);var p=["L",a,i];return[].concat(c,u,p)}return[["M",a(t),i(t)+n],o(a(t),i(t),a(t)+n,i(t),a(e)-n,i(t),"top"===r),o(a(e),i(t),a(e),i(t)+n,a(e),i(e)-n,"right"===r),o(a(e),i(e),a(e)-n,i(e),a(t)+n,i(e),"bottom"===r),o(a(t),i(e),a(t),i(e)-n,a(t),i(t)+n,"left"===r)].map(function(t){return t.join(" ")}).join(" ")}([5,5],[i-5,a-5],n,s?3:4))})});return tt().delegate("header",e).delegate("body",e).delegate("orientation",e).delegate("dx",e).delegate("dy",e).delegate("opacity",e).prop("renderInto").prop("visible",d).visible(!1).renderSelection(function(t){var n=t.props(),a=n.renderInto.node().getBoundingClientRect(),i=[];t.each(function(t){if(n.visible(t)){var e=this.getBoundingClientRect(),r=[e.left-a.left,e.top-a.top];i.push({datum:t,x:r[0],y:r[1]})}}),n.renderInto.datum(i).call(e)})},t.tooltipAnchor=st,t.transformTranslateSubpixelShift=it,t.translateString=ot,t.viewport=gr,t.voronoi=function(){var o=R.dispatch("over","out"),e=tt().prop("x").prop("y").prop("bounds").prop("debug").render(function(t){var e=R.select(this),a=e.props();if(!a.bounds)return Ht("behavior.voronoi - requires bounds"),!1;var r=R.voronoi().x(a.x).y(a.y).extent(a.bounds),n=e.selectAll("[data-sszvis-behavior-voronoi]").data(r.polygons(t)),i=n.enter().append("path").attr("data-sszvis-behavior-voronoi","").attr("data-sszvis-behavior-pannable","").attr("class","sszvis-interactive");n.exit().remove(),(n=n.merge(i)).attr("d",function(t){return"M"+t.join("L")+"Z"}).attr("fill","transparent").on("mouseover",function(t){var e=this.parentNode.getBoundingClientRect();ee(R.event,[e.left+a.x(t.data),e.top+a.y(t.data)])&&o.apply("over",this,[t.data])}).on("mousemove",function(t){var e=this.parentNode.getBoundingClientRect();ee(R.event,[e.left+a.x(t.data),e.top+a.y(t.data)])?o.apply("over",this,[t.data]):o.apply("out",this,[])}).on("mouseout",function(){o.apply("out",this,[])}).on("touchstart",function(t){var e=this.parentNode.getBoundingClientRect();ee(s(R.event),[e.left+a.x(t.data),e.top+a.y(t.data)])&&(R.event.preventDefault(),o.apply("over",this,[t.data]),R.select(this).on("touchmove",function(){var t=s(R.event),e=Zt(t),r=$t(e);if(null!==r){var n=e.parentNode.getBoundingClientRect();ee(t,[n.left+a.x(r.data),n.top+a.y(r.data)])?(R.event.cancelable&&R.event.preventDefault(),o.apply("over",this,[r.data])):o.apply("out",this,[])}else o.apply("out",this,[])}).on("touchend",function(){o.apply("out",this,[]),R.select(this).on("touchmove",null).on("touchend",null)}))}),a.debug&&n.attr("stroke","#f00")});return e.on=function(){var t=o.on.apply(o,arguments);return t===o?e:t},e},t.widthAdaptiveMapPathStroke=function(t){return Math.min(Math.max(.8,t/400),1.1)},t.withAlpha=function(t,e){var r=R.rgb(t);return"rgba("+r.r+","+r.g+","+r.b+","+e+")"},Object.defineProperty(t,"__esModule",{value:!0})});
