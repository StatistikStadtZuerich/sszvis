/*! sszvis v3.4.0, Copyright 2014-present Statistik Stadt Zürich */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).sszvis={},t.d3)}(this,function(t,e){"use strict";function r(){const t={};let e=null,r=n;function s(n){e&&(n.props=()=>o(t),e.apply(n,a(arguments))),n.each(function(){this.__props__=o(t),r.apply(this,a(arguments))})}return s.prop=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return s[e]=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;return function(){for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return 0===a.length?t[e]:(t[e]=r.apply(null,a),this)}}(t,e,r.bind(s)).bind(s),s},s.delegate=(t,e)=>(s[t]=function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];const i=e[t].apply(e,a(n));return 0===n.length?i:s},s),s.renderSelection=t=>(e=t,s),s.render=t=>(r=t,s),s}function n(t){return t}function a(t){return Array.prototype.slice.call(t)}function o(t){const e={};for(const r in t)Object.hasOwn(t,r)&&(e[r]=t[r]);return e}e.selection.prototype.selectDiv=function(t){return this.selectAll('[data-d3-selectdiv="'.concat(t,'"]')).data(t=>[t]).join("div").attr("data-d3-selectdiv",t).style("position","absolute")},e.selection.prototype.selectGroup=function(t){return this.selectAll('[data-d3-selectgroup="'.concat(t,'"]')).data(t=>[t]).join("g").attr("data-d3-selectgroup",t)},e.selection.prototype.props=function(){if(arguments.length>0)throw new Error("selection.props() does not accept any arguments");if(1!==this.size())throw new Error("only one group is supported");if(1!==this._groups[0].length)throw new Error("only one node is supported");return this._groups[0][0].__props__||{}};const s=t=>t,i=t=>"[object String]"===Object.prototype.toString.call(t),l=t=>t instanceof e.selection,c=(t,e)=>{switch(t){case 0:return function(){return e.call(this)};case 1:return function(t){return e.call(this,t)};case 2:return function(t,r){return e.call(this,t,r)};case 3:return function(t,r,n){return e.call(this,t,r,n)};case 4:return function(t,r,n,a){return e.call(this,t,r,n,a)};case 5:return function(t,r,n,a,o){return e.call(this,t,r,n,a,o)};case 6:return function(t,r,n,a,o,s){return e.call(this,t,r,n,a,o,s)};case 7:return function(t,r,n,a,o,s,i){return e.call(this,t,r,n,a,o,s,i)};case 8:return function(t,r,n,a,o,s,i,l){return e.call(this,t,r,n,a,o,s,i,l)};case 9:return function(t,r,n,a,o,s,i,l,c){return e.call(this,t,r,n,a,o,s,i,l,c)};case 10:return function(t,r,n,a,o,s,i,l,c,d){return e.call(this,t,r,n,a,o,s,i,l,c,d)};default:return e}},d=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=e.length-1;return function(){let t=n;for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];let s=Reflect.apply(e[t],this,a);for(;t--;)s=e[t].call(this,s);return s}},p=t=>void 0!==t&&null!=t&&!Number.isNaN(t),u=(t,e)=>{const r=Array.from({length:t});for(let n=0;n<t;++n)r[n]=e;return r},h=(t,e)=>{for(const r of e)if(t(r))return r},f=t=>t[0],g=t=>t.touches&&t.touches.length>0?t.touches[0]:t.changedTouches&&t.changedTouches.length>0?t.changedTouches[0]:null,m=t=>null===t,y=t=>Object(t)===t,v=t=>t[t.length-1],b=t=>function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return!Reflect.apply(t,this,r)},_=t=>function(e){return e[t]},x=(t,e)=>function(r){const n=void 0===r?void 0:r[t];return void 0===n?e:n},k=(t,e)=>{const r=e||s;return t.reduce((e,n,a)=>{const o=r(n,a,t);return e.includes(o)?e:[...e,o]},[])},z=(t,e)=>t.toString()===e.toString(),A=t=>"function"==typeof t?t:function(){return t},w=(t,e)=>{if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");const r=function(){const n=e?e(...arguments):arguments.length<=0?void 0:arguments[0],a=r.cache;if(a.has(n))return a.get(n);const o=t(...arguments);return r.cache=a.set(n,o)||a,o};return r.cache=new Map,r};const S=t=>{const e="#CCCCCC";t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",14).attr("height",14),t.append("rect").attr("x",0).attr("y",0).attr("width",14).attr("height",14).attr("fill","#FAFAFA"),t.append("line").attr("x1",1).attr("y1",10).attr("x2",5).attr("y2",14).attr("stroke",e),t.append("line").attr("x1",5).attr("y1",10).attr("x2",1).attr("y2",14).attr("stroke",e),t.append("line").attr("x1",8).attr("y1",3).attr("x2",12).attr("y2",7).attr("stroke",e),t.append("line").attr("x1",12).attr("y1",3).attr("x2",8).attr("y2",7).attr("stroke",e)},F=t=>{t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",6).attr("height",6),t.append("rect").attr("x",0).attr("y",0).attr("width",6).attr("height",6).attr("fill","#fff"),t.append("line").attr("x1",0).attr("y1",3).attr("x2",3).attr("y2",0).attr("stroke","#ddd").attr("stroke-linecap","square"),t.append("line").attr("x1",3).attr("y1",6).attr("x2",6).attr("y2",3).attr("stroke","#ddd").attr("stroke-linecap","square")},j=t=>{t.attr("x1",0).attr("y1",0).attr("x2",.55).attr("y2",1).attr("id","lake-fade-gradient"),t.append("stop").attr("offset",.74).attr("stop-color","white").attr("stop-opacity",1),t.append("stop").attr("offset",.97).attr("stop-color","white").attr("stop-opacity",0)},M=t=>{t.attr("maskContentUnits","objectBoundingBox"),t.append("rect").attr("fill","url(#lake-fade-gradient)").attr("width",1).attr("height",1)},C=t=>{t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",6).attr("height",6),t.append("line").attr("x1",0).attr("y1",3).attr("x2",3).attr("y2",0).attr("stroke","#e6e6e6").attr("stroke-width",1.1),t.append("line").attr("x1",3).attr("y1",6).attr("x2",6).attr("y2",3).attr("stroke","#e6e6e6").attr("stroke-width",1.1)};function P(t,e,r){return function(t){return t.selectAll("defs").data([0]).join("defs")}(t).selectAll("".concat(e,"#").concat(r)).data([0]).join(e).attr("id",r)}const N=e.easePolyOut,R=()=>e.transition().ease(N).duration(300),B=()=>e.transition().ease(N).duration(500);const L=function(t){return Math.floor(t)+.5},D=function(t){const e=d(Math.floor,Number),r=t.match(/(translate\()\s*([\d ,.-]+)\s*(\))/i)[2].replace(","," ").replace(/\s+/," ").split(" ").map(Number);1===r.length&&r.push([0]);const n=r.map(e);return[r[0]-n[0],r[1]-n[1]]};function O(t,e){return"translate("+t+","+e+")"}function T(t){return O.apply(null,t)}function E(){return r().prop("position").position(A([0,0])).prop("debug").render(function(t){const r=e.select(this),n=r.props();if(r.selectAll("[data-tooltip-anchor]").data(t).join("rect").attr("height",1).attr("width",1).attr("fill","none").attr("stroke","none").attr("visibility","none").attr("data-tooltip-anchor","").attr("transform",d(T,n.position)),n.debug){r.selectAll("[data-tooltip-anchor-debug]").data(t).join("circle").attr("data-tooltip-anchor-debug","").attr("r",2).attr("fill","#fff").attr("stroke","#f00").attr("stroke-width",1.5).attr("transform",d(T,n.position))}})}function W(t,e,r){return n=>{n.join("circle").classed("sszvis-rangeFlag__mark",!0).classed(t,!0).attr("r",3.5).attr("cx",e).attr("cy",r)}}const I={decimal:".",thousands:" ",grouping:[3],currency:["CHF ",""]},H={dateTime:"%a. %e. %B %X %Y",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["",""],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},G=e.timeFormatLocale(H).format,K=e.formatLocale(I).format,Y=t=>{const e=[[".%L",t=>t.getMilliseconds()],[":%S",t=>t.getSeconds()],["%H:%M",t=>t.getMinutes()],["%H Uhr",t=>t.getHours()],["%a., %d.",t=>Boolean(t.getDay()&&1!==t.getDate())],["%e. %b",t=>1!==t.getDate()],["%B",t=>t.getMonth()],["%Y",()=>!0]];for(const r of e)if(r[1](t))return G(r[0])(t);return G("%Y")(t)},J=d(t=>t.toUpperCase(),G("%b")),V=G("%Y"),U=t=>{let e;const r=Math.abs(null!=t?t:0);return null==t||Number.isNaN(t)?"–":r>=1e4?K(",.0f")(t):r>=100?(e=Math.min(1,q(t)),Q(K(".".concat(e,"f"))(t))):r>0?(e=Math.min(2,q(t)),Q(K(".".concat(e,"f"))(t))):K(".0f")(0)};const X=String;function q(t){return(String(Math.abs(t)).split(".")[1]||"").length}function Q(t){return t.replace(/(\.\d*[1-9])0+$|\.0*$/,"$1")}const Z=()=>r().prop("header").prop("body").prop("orientation",A).orientation("bottom").prop("dx",A).dx(1).prop("dy",A).dy(1).prop("opacity",A).opacity(1).renderSelection(t=>{const r=t.datum(),n=t.props(),a=p,o=a(n.header)&&!a(n.body)||!a(n.header)&&a(n.body),s=t.selectAll(".sszvis-tooltip").data(r).join("div");s.style("pointer-events","none").style("opacity",t=>String(n.opacity(t))).style("padding-top",t=>"top"===n.orientation(t)?"".concat(6,"px"):null).style("padding-right",t=>"right"===n.orientation(t)?"".concat(6,"px"):null).style("padding-bottom",t=>"bottom"===n.orientation(t)?"".concat(6,"px"):null).style("padding-left",t=>"left"===n.orientation(t)?"".concat(6,"px"):null).classed("sszvis-tooltip",!0);const i=s.selectAll(".sszvis-tooltip__background").data([0]).join("svg").attr("class","sszvis-tooltip__background").attr("height",0).attr("width",0),l=i.selectAll("path").data([0]).join("path");if(void 0!==window.SVGFEColorMatrixElement&&2===SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE){const t=i.selectAll("filter").data([0]).join("filter").attr("id","sszvisTooltipShadowFilter").attr("height","150%");t.selectAll("feGaussianBlur").data([0]).join("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",2),t.selectAll("feComponentTransfer").data([0]).join("feComponentTransfer").selectAll("feFuncA").data([0]).join("feFuncA").attr("type","linear").attr("slope",.2);const e=t.selectAll("feMerge").data([0]).join("feMerge");e.selectAll("feMergeNode").data([0]).join("feMergeNode"),e.selectAll("feMergeNode").data([0]).join("feMergeNode").attr("in","SourceGraphic"),l.attr("filter","url(#sszvisTooltipShadowFilter)")}else i.classed("sszvis-tooltip__background--fallback",!0);const c=s.selectAll(".sszvis-tooltip__content").data([0]).join("div").classed("sszvis-tooltip__content",!0);c.selectAll(".sszvis-tooltip__header").data([0]).join("div").classed("sszvis-tooltip__header",!0),c.selectAll(".sszvis-tooltip__body").data([0]).join("div").classed("sszvis-tooltip__body",!0),s.select(".sszvis-tooltip__header").datum(_("datum")).html(n.header||A("")),s.select(".sszvis-tooltip__body").datum(_("datum")).html(t=>{if(!n.body)return"";const e="function"==typeof n.body?n.body(t):n.body;return Array.isArray(e)?function(t){const e=t.map(t=>"<tr>".concat(t.map(t=>"<td>".concat(t,"</td>")).join(""),"</tr>")).join("");return'<table class="sszvis-tooltip__body__table">'.concat(e,"</table>")}(e):e}),t.selectAll(".sszvis-tooltip").classed("sszvis-tooltip--small",o).each(function(t){const r=e.select(this),a=r.node();if(!a)return;const s=a.getBoundingClientRect(),i=n.orientation(t);switch(i){case"top":r.style("left","".concat(t.x-s.width/2,"px")).style("top","".concat(t.y+Number(n.dy(t)),"px"));break;case"bottom":r.style("left","".concat(t.x-s.width/2,"px")).style("top","".concat(t.y-Number(n.dy(t))-s.height,"px"));break;case"left":r.style("left","".concat(t.x+Number(n.dx(t)),"px")).style("top","".concat(t.y-s.height/2,"px"));break;case"right":r.style("left","".concat(t.x-Number(n.dx(t))-s.width,"px")).style("top","".concat(t.y-s.height/2,"px"))}const l=s.height+10,c=s.width+10;r.select(".sszvis-tooltip__background").attr("height",l).attr("width",c).style("left","".concat(-5,"px")).style("top","".concat(-5,"px")).select("path").attr("d",function(t,e,r,n){switch(r){case"top":t[1]=t[1]+6;break;case"bottom":e[1]=e[1]-6;break;case"left":t[0]=t[0]+6;break;case"right":e[0]=e[0]-6}return[["M",$(t),tt(t)+n],et($(t),tt(t),$(t)+n,tt(t),$(e)-n,tt(t),"top"===r),et($(e),tt(t),$(e),tt(t)+n,$(e),tt(e)-n,"right"===r),et($(e),tt(e),$(e)-n,tt(e),$(t)+n,tt(e),"bottom"===r),et($(t),tt(e),$(t),tt(e)-n,$(t),tt(t)+n,"left"===r)].map(t=>t.join(" ")).join(" ")}([5,5],[c-5,l-5],i,o?3:4))})});function $(t){return t[0]}function tt(t){return t[1]}function et(t,e,r,n,a,o,s){const i=r+(a-r)/2,l=n+(o-n)/2;let c=[];s&&n===o?c=r<a?["L",i-6,l,"L",i,l-6,"L",i+6,l]:["L",i+6,l,"L",i,l+6,"L",i-6,l]:s&&r===a&&(c=n<o?["L",i,l-6,"L",i+6,l,"L",i,l+6]:["L",i,l+6,"L",i-6,l,"L",i,l-6]);const d=["L",a,o];return[...["Q",t,e,r,n],...c,...d]}var rt=Symbol.for("immer-nothing"),nt=Symbol.for("immer-draftable"),at=Symbol.for("immer-state");function ot(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var st=Object.getPrototypeOf;function it(t){return!!t&&!!t[at]}function lt(t){return!!t&&(pt(t)||Array.isArray(t)||!!t[nt]||!!t.constructor?.[nt]||mt(t)||yt(t))}var ct=Object.prototype.constructor.toString(),dt=new WeakMap;function pt(t){if(!t||"object"!=typeof t)return!1;const e=Object.getPrototypeOf(t);if(null===e||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if("function"!=typeof r)return!1;let n=dt.get(r);return void 0===n&&(n=Function.toString.call(r),dt.set(r,n)),n===ct}function ut(t,e,r=!0){if(0===ht(t)){(r?Reflect.ownKeys(t):Object.keys(t)).forEach(r=>{e(r,t[r],t)})}else t.forEach((r,n)=>e(n,r,t))}function ht(t){const e=t[at];return e?e.type_:Array.isArray(t)?1:mt(t)?2:yt(t)?3:0}function ft(t,e){return 2===ht(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function gt(t,e,r){const n=ht(t);2===n?t.set(e,r):3===n?t.add(r):t[e]=r}function mt(t){return t instanceof Map}function yt(t){return t instanceof Set}function vt(t){return t.copy_||t.base_}function bt(t,e){if(mt(t))return new Map(t);if(yt(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=pt(t);if(!0===e||"class_only"===e&&!r){const e=Object.getOwnPropertyDescriptors(t);delete e[at];let r=Reflect.ownKeys(e);for(let n=0;n<r.length;n++){const a=r[n],o=e[a];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(e[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[a]})}return Object.create(st(t),e)}{const e=st(t);if(null!==e&&r)return{...t};const n=Object.create(e);return Object.assign(n,t)}}function _t(t,e=!1){return kt(t)||it(t)||!lt(t)||(ht(t)>1&&Object.defineProperties(t,{set:xt,add:xt,clear:xt,delete:xt}),Object.freeze(t),e&&Object.values(t).forEach(t=>_t(t,!0))),t}var xt={value:function(){ot(2)}};function kt(t){return null===t||"object"!=typeof t||Object.isFrozen(t)}var zt,At={};function wt(t){const e=At[t];return e||ot(0),e}function St(){return zt}function Ft(t,e){e&&(wt("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function jt(t){Mt(t),t.drafts_.forEach(Pt),t.drafts_=null}function Mt(t){t===zt&&(zt=t.parent_)}function Ct(t){return zt={drafts_:[],parent_:zt,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Pt(t){const e=t[at];0===e.type_||1===e.type_?e.revoke_():e.revoked_=!0}function Nt(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return void 0!==t&&t!==r?(r[at].modified_&&(jt(e),ot(4)),lt(t)&&(t=Rt(e,t),e.parent_||Lt(e,t)),e.patches_&&wt("Patches").generateReplacementPatches_(r[at].base_,t,e.patches_,e.inversePatches_)):t=Rt(e,r,[]),jt(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==rt?t:void 0}function Rt(t,e,r){if(kt(e))return e;const n=t.immer_.shouldUseStrictIteration(),a=e[at];if(!a)return ut(e,(n,o)=>Bt(t,a,e,n,o,r),n),e;if(a.scope_!==t)return e;if(!a.modified_)return Lt(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const e=a.copy_;let o=e,s=!1;3===a.type_&&(o=new Set(e),e.clear(),s=!0),ut(o,(n,o)=>Bt(t,a,e,n,o,r,s),n),Lt(t,e,!1),r&&t.patches_&&wt("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function Bt(t,e,r,n,a,o,s){if(null==a)return;if("object"!=typeof a&&!s)return;const i=kt(a);if(!i||s){if(it(a)){const s=Rt(t,a,o&&e&&3!==e.type_&&!ft(e.assigned_,n)?o.concat(n):void 0);if(gt(r,n,s),!it(s))return;t.canAutoFreeze_=!1}else s&&r.add(a);if(lt(a)&&!i){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;if(e&&e.base_&&e.base_[n]===a&&i)return;Rt(t,a),e&&e.scope_.parent_||"symbol"==typeof n||!(mt(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))||Lt(t,a)}}}function Lt(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&_t(e,r)}var Dt={get(t,e){if(e===at)return t;const r=vt(t);if(!ft(r,e))return function(t,e,r){const n=Et(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}(t,r,e);const n=r[e];return t.finalized_||!lt(n)?n:n===Tt(t.base_,e)?(It(t),t.copy_[e]=Ht(n,t)):n},has:(t,e)=>e in vt(t),ownKeys:t=>Reflect.ownKeys(vt(t)),set(t,e,r){const n=Et(vt(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const n=Tt(vt(t),e),a=n?.[at];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}(r,n)&&(void 0!==r||ft(t.base_,e)))return!0;It(t),Wt(t)}return t.copy_[e]===r&&(void 0!==r||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty:(t,e)=>(void 0!==Tt(t.base_,e)||e in t.base_?(t.assigned_[e]=!1,It(t),Wt(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0),getOwnPropertyDescriptor(t,e){const r=vt(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n?{writable:!0,configurable:1!==t.type_||"length"!==e,enumerable:n.enumerable,value:r[e]}:n},defineProperty(){ot(11)},getPrototypeOf:t=>st(t.base_),setPrototypeOf(){ot(12)}},Ot={};function Tt(t,e){const r=t[at];return(r?vt(r):t)[e]}function Et(t,e){if(!(e in t))return;let r=st(t);for(;r;){const t=Object.getOwnPropertyDescriptor(r,e);if(t)return t;r=st(r)}}function Wt(t){t.modified_||(t.modified_=!0,t.parent_&&Wt(t.parent_))}function It(t){t.copy_||(t.copy_=bt(t.base_,t.scope_.immer_.useStrictShallowCopy_))}ut(Dt,(t,e)=>{Ot[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),Ot.deleteProperty=function(t,e){return Ot.set.call(this,t,e,void 0)},Ot.set=function(t,e,r){return Dt.set.call(this,t[0],e,r,t[0])};function Ht(t,e){const r=mt(t)?wt("MapSet").proxyMap_(t,e):yt(t)?wt("MapSet").proxySet_(t,e):function(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:St(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,o=Dt;r&&(a=[n],o=Ot);const{revoke:s,proxy:i}=Proxy.revocable(a,o);return n.draft_=i,n.revoke_=s,i}(t,e);return(e?e.scope_:St()).drafts_.push(r),r}function Gt(t){if(!lt(t)||kt(t))return t;const e=t[at];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=bt(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=bt(t,!0);return ut(r,(t,e)=>{gt(r,t,Gt(e))},n),e&&(e.finalized_=!1),r}var Kt=new class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,e,r)=>{if("function"==typeof t&&"function"!=typeof e){const r=e;e=t;const n=this;return function(t=r,...a){return n.produce(t,t=>e.call(this,t,...a))}}let n;if("function"!=typeof e&&ot(6),void 0!==r&&"function"!=typeof r&&ot(7),lt(t)){const a=Ct(this),o=Ht(t,void 0);let s=!0;try{n=e(o),s=!1}finally{s?jt(a):Mt(a)}return Ft(a,r),Nt(n,a)}if(!t||"object"!=typeof t){if(n=e(t),void 0===n&&(n=t),n===rt&&(n=void 0),this.autoFreeze_&&_t(n,!0),r){const e=[],a=[];wt("Patches").generateReplacementPatches_(t,n,e,a),r(e,a)}return n}ot(1)},this.produceWithPatches=(t,e)=>{if("function"==typeof t)return(e,...r)=>this.produceWithPatches(e,e=>t(e,...r));let r,n;return[this.produce(t,e,(t,e)=>{r=t,n=e}),r,n]},"boolean"==typeof t?.autoFreeze&&this.setAutoFreeze(t.autoFreeze),"boolean"==typeof t?.useStrictShallowCopy&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),"boolean"==typeof t?.useStrictIteration&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){lt(t)||ot(8),it(t)&&(t=function(t){it(t)||ot(10);return Gt(t)}(t));const e=Ct(this),r=Ht(t,void 0);return r[at].isManual_=!0,Mt(e),r}finishDraft(t,e){const r=t&&t[at];r&&r.isManual_||ot(9);const{scope_:n}=r;return Ft(n,e),Nt(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const n=e[r];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}r>-1&&(e=e.slice(r+1));const n=wt("Patches").applyPatches_;return it(t)?n(t,e):this.produce(t,t=>n(t,e))}};Kt.produce;var Yt=Kt.setAutoFreeze.bind(Kt),Jt=Kt.createDraft.bind(Kt),Vt=Kt.finishDraft.bind(Kt);const Ut=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{src:"fallback.png"};(l(t)?t:e.select(t)).append("img").attr("class","sszvis-fallback-image").attr("src",r.src)};function Xt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qt,Qt;var Zt=(Qt||(Qt=1,qt=function(t,e,r){var n,a=0;return arguments.length<3&&(r=!0),function(){var o=arguments,s=this;n=function(){t.apply(s,o),a=(new Date).getTime()+e,n=null,r&&setTimeout(function(){n&&n()},e)},(new Date).getTime()>a&&n()}}),qt),$t=Xt(Zt);const te={resize:[]};void 0!==globalThis.window&&e.select(globalThis).on("resize",$t(()=>{ee("resize")},500));const ee=function(t){const e=Array.prototype.slice.call(arguments,1);if(te[t])for(const r of te[t])r.apply(null,e);return this},re={on:function(t,e){return te[t]||(te[t]=[]),te[t]=[...te[t].filter(t=>t!==e),e],this},off:function(t,e){return te[t]?(te[t]=te[t].filter(t=>t!==e),this):this},trigger:ee};Yt(!1);function ne(t,e){if(!t)throw new Error("[sszvis.app] ".concat(e))}function ae(t){return"function"==typeof t}function oe(t,e){const r=he(e);return h(t=>ie(t,r),t)}function se(t,e){return h(t=>t.name===e,t)}function ie(t,e){const r=t.measurement,n=he(e);return n.width<=r.width&&n.screenHeight<=r.screenHeight}function le(t,e){const r=he(e);return t.filter(t=>ie(t,r))}function ce(t){return[...t.map(fe),fe({name:"_"})]}const de=()=>ce([{name:"palm",width:540},{name:"lap",width:749}]),pe=ge("palm"),ue=ge("lap");function he(t){const e=x("width",1/0),r=x("screenHeight",1/0);return{width:e(t),screenHeight:r(t)}}function fe(t){const e=he("measurement"in t?t.measurement:{width:t.width,screenHeight:t.screenHeight});return{name:t.name,measurement:e}}function ge(t){return e=>{const r=se(de(),t);return!!r&&ie(r,e)}}function me(t,e){const r=t/e;return function(t){return t/r}}const ye=me(4,3),ve=me(16,10),be=function(t){return Math.min(me(12,5)(t),500)};be.MAX_HEIGHT=500;const _e=function(t){return Math.min(me(1,1)(t),420)};_e.MAX_HEIGHT=420;const xe=function(t){return Math.min(me(4,5)(t),600)};xe.MAX_HEIGHT=600;const ke={palm:ye,lap:ve,_:be},ze=function(t){const e=oe(de(),t);return(0,ke[(null==e?void 0:e.name)||"_"])(t.width)},Ae=Se("warn"),we=Se("error");function Se(t){return function(){var e;if(null!==(e=console)&&void 0!==e&&e[t]){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];for(const e of n)console[t](e)}}}const Fe=t=>t.rangeExtent?t.rangeExtent():function(t){const e=t[0],r=t[t.length-1];return e<r?[e,r]:[r,e]}(t.range());function je(t,r,n,a){a=(a||5)-2;const o=r;r-=2*(n=n||5);const s=[];return t.each(function(){const t=e.select(this),i=t.text().split(/[\t\n\v\f\r ]+/).reverse();let l,c=[],d=0;let p,u=t.attr("y"),h=Number.parseFloat(t.attr("dy")),f=1;const g=t.style("text-anchor")||"start";isNaN(h)&&(h=0);if(e.select(t.node().parentNode).classed("tick"))switch(g){case"start":p=-r/2;break;case"middle":p=0;break;case"end":p=r/2}else switch(g){case"start":p=n;break;case"middle":p=o/2;break;case"end":p=o-n}u=+(null===u?a:u);let m=t.text(null).append("tspan").attr("x",p).attr("y",u).attr("dy",h+"em");for(;i.length>0;)l=i.pop(),c.push(l),m.text(c.join(" ")),m.node().getComputedTextLength()>r&&c.length>1&&(c.pop(),m.text(c.join(" ")),c=[l],m=t.append("tspan").attr("x",p).attr("y",u).attr("dy",1.1*++d+h+"em").text(l),++f);s.push(f)}),s}function Me(){return r().prop("scale").prop("orient").prop("ticks").prop("tickValues").prop("tickSize").prop("tickSizeInner").prop("tickSizeOuter").prop("tickPadding").prop("tickFormat").prop("_scale").prop("orient").orient("bottom").prop("alignOuterLabels").alignOuterLabels(!1).prop("contour").prop("hideBorderTickThreshold").hideBorderTickThreshold(8).prop("hideLabelThreshold").hideLabelThreshold(10).prop("highlightTick",A).prop("showZeroY").showZeroY(!1).prop("slant").prop("textWrap").prop("tickLength").prop("title").prop("titleAnchor").prop("titleCenter").prop("dxTitle").prop("dyTitle").prop("titleVertical").prop("vertical").vertical(!1).prop("yOffset").yOffset(0).render(function(){var t;const r=e.select(this),n=r.props(),a=!n.vertical&&"bottom"===n.orient,o=n.scale||n._scale;if(!o)throw new Error("axis: need to specify a scale");let s;switch(n.orient){case"bottom":default:s=e.axisBottom(o);break;case"top":s=e.axisTop(o);break;case"left":s=e.axisLeft(o);break;case"right":s=e.axisRight(o)}void 0!==n.scale&&s.scale(n.scale),void 0!==n.ticks&&(Array.isArray(n.ticks)&&n.ticks.length>0?s.ticks(...n.ticks):s.ticks(n.ticks)),void 0!==n.tickValues&&s.tickValues(n.tickValues),void 0!==n.tickSizeInner&&s.tickSizeInner(n.tickSizeInner),void 0!==n.tickSizeOuter&&s.tickSizeOuter(n.tickSizeOuter),void 0!==n.tickPadding&&s.tickPadding(n.tickPadding),void 0!==n.tickFormat&&s.tickFormat(t=>{var e,r;return null!==(e=null===(r=n.tickFormat)||void 0===r?void 0:r.call(n,t))&&void 0!==e?e:""}),void 0!==n.tickSize&&s.tickSize(n.tickSize),n._scale&&s.scale(n._scale);const i=r.selectGroup("sszvis-axis").classed("sszvis-axis",!0).classed("sszvis-axis--top",!n.vertical&&"top"===n.orient).classed("sszvis-axis--bottom",a).classed("sszvis-axis--vertical",Boolean(n.vertical)).attr("transform",O(0,n.yOffset||0)).call(s);i.attr("fill",null).attr("font-size",null).attr("font-family",null);const l=s.scale(),c=i.selectAll("g.tick"),d=c.selectAll("text");c.each(function(){const t=D(this.getAttribute("transform")||""),r=L(0)-t[0],n=L(a?2:0)+t[1];e.select(this).select("line").attr("transform",O(r,n))}),d.each(function(){"top"!==n.orient&&"bottom"!==n.orient||e.select(this).attr("dx","-0.5"),"left"!==n.orient&&"right"!==n.orient||e.select(this).attr("y","-0.5")}),i.selectAll("path.domain");const u=Fe(l);if(c.selectAll("line").each(function(t){var r;const a=null!==(r=l(t))&&void 0!==r?r:0,o=e.select(this),s=u[0],i=u[1];o.classed("hidden",!o.classed("sszvis-axis__longtick")&&(Re(a,s)<(n.hideBorderTickThreshold||0)||Re(a,i)<(n.hideBorderTickThreshold||0)))}),p(n.tickLength)){const t=l.domain(),e=t.length>0?[t[0],t[t.length-1]]:[void 0,void 0],r=c.filter(t=>void 0!==e[0]&&void 0!==e[1]&&!z(t,e[0])&&!z(t,e[1])),a=n.orient;let o=2;"left"!==a&&"right"!==a||(r.selectAll("text").each(function(){o=Math.max(this.getBoundingClientRect().width,o)}),o+=2);const s=r.selectAll("line.sszvis-axis__longtick").data([0]).join("line").classed("sszvis-axis__longtick",!0);if(n.tickLength>o)switch(a){case"top":s.attr("y1",o).attr("y2",n.tickLength);break;case"bottom":s.attr("y1",-o).attr("y2",-n.tickLength);break;case"left":s.attr("x1",-o).attr("x2",-n.tickLength);break;case"right":s.attr("x1",o).attr("x2",n.tickLength)}else s.remove()}if(n.alignOuterLabels){const t=Fe(l),e=t[0],r=t[1];d.style("text-anchor",t=>{var n;const a=null!==(n=l(t))&&void 0!==n?n:0,o=null!=r?r:0;return Re(a,null!=e?e:0)<12?"start":Re(a,o)<12?"end":"middle"})}if(p(n.textWrap)&&d.call(je,n.textWrap),n.slant&&n.orient&&null!==(t=Le[n.orient])&&void 0!==t&&t[n.slant]&&d.call(Le[n.orient][n.slant]),n.highlightTick){const t=[],r=[];if(d.classed("hidden",!1).classed("active",t=>{var e;return(null===(e=n.highlightTick)||void 0===e?void 0:e.call(n,t))||!1}),(n.hideLabelThreshold||0)>0&&!n.slant){d.each(function(e){var a;const o=this.getBoundingClientRect(),s={node:this,bounds:{top:o.top,right:o.right,bottom:o.bottom,left:o.left}};null!==(a=n.highlightTick)&&void 0!==a&&a.call(n,e)?(s.bounds.left-=n.hideLabelThreshold||0,s.bounds.right+=n.hideLabelThreshold||0,t.push(s)):r.push(s)});for(const n of t)for(const t of r)e.select(t.node).classed("hidden",Be(t.bounds,n.bounds))}}if(n.title){i.selectAll(".sszvis-axis__title").data([n.title]).join("text").classed("sszvis-axis__title",!0).text(t=>t).attr("transform",()=>{const t=n.orient,e=Fe(l),r=n.titleCenter?{left:"left"===t||"right"===t?0:"top"===t||"bottom"===t?(e[0]+e[1])/2:0,top:"left"===t||"right"===t?(e[0]+e[1])/2:"top"===t?0:"bottom"===t?32:0,vertical:!!n.titleVertical}:{left:"left"===t||"right"===t||"top"===t?0:"bottom"===t?e[1]:0,top:"left"===t||"right"===t||"top"===t?0:"bottom"===t?32:0,vertical:!!n.titleVertical};return r.left+=n.dxTitle||0,r.top+=n.dyTitle||0,"translate("+r.left+", "+r.top+") rotate("+(r.vertical?"-90":"0")+")"}).style("text-anchor",()=>{const t=n.orient;if(void 0!==n.titleAnchor)return n.titleAnchor;switch(t){case"left":case"top":case"bottom":return"end";case"right":return"start";default:return null}})}n.contour&&n.slant?Ae("Can't apply contour to slanted labels"):n.contour&&c.each(function(){const t=e.select(this),r=t.select("text").node();let n=t.select(".sszvis-axis__label-contour");n.empty()&&r&&"cloneNode"in r&&(n=e.select(r.cloneNode(!0)).classed("sszvis-axis__label-contour",!0),this.insertBefore(n.node(),r)),r&&"textContent"in r&&n.text(r.textContent||"")})})}const Ce=function(t){const e=this.scale().domain(),r=[],n=Math.round(e.length/t);void 0!==e[0]&&r.push(e[0]);for(let t=n,a=e.length;t<a-1;t+=n)void 0!==e[t]&&r.push(e[t]);return"undefined"!==e[e.length-1]&&r.push(e[e.length-1]),this.tickValues(r),t},Pe=()=>Me().yOffset(2).ticks(3).tickSizeInner(4).tickSizeOuter(6.5).tickPadding(6).tickFormat(c(1,U));Pe.time=()=>Pe().tickFormat(Y).alignOuterLabels(!0),Pe.ordinal=()=>Pe().prop("ticks",Ce).tickFormat(X),Pe.pyramid=()=>Pe().ticks(10).prop("scale",function(t){const e=t.copy(),r=e,n=r.domain(),a=r.range(),o=[-n[1],n[1]],s=[a[0]-a[1],a[0]+a[1]];return r.domain(o),r.range(s),this._scale=e,e}).tickFormat(t=>U(Math.abs(t)));const Ne=()=>{const t=Me().ticks(6).tickSize(0).tickPadding(0).tickFormat(e=>0!==e||t.showZeroY()?U(e):null).vertical(!0);return t};function Re(t,e){return Math.abs(t-e)}function Be(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}Ne.time=()=>Ne().tickFormat(Y),Ne.ordinal=()=>Ne().prop("ticks",Ce).tickFormat(X);const Le={top:{horizontal(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("dy","0.71em").attr("transform",null)},vertical(t){t.style("text-anchor","start").attr("dx","0em").attr("dy","0.35em").attr("transform","rotate(-90)")},diagonal(t){t.style("text-anchor","start").attr("dx","0.1em").attr("dy","0.1em").attr("transform","translate(-0.5) rotate(-45)")}},bottom:{horizontal(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("dy","0.71em").attr("transform",null)},vertical(t){t.style("text-anchor","end").attr("dx","-1em").attr("dy","-0.75em").attr("transform","rotate(-90)")},diagonal(t){t.style("text-anchor","end").attr("dx","-0.8em").attr("dy","0em").attr("transform","rotate(-45)")}},left:{horizontal(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("dy","0.71em").attr("transform",null)},vertical(t){t.style("text-anchor","middle").attr("dx","0em").attr("dy","0.35em").attr("transform","rotate(-90)")},diagonal(t){t.style("text-anchor","end").attr("dx","-0.8em").attr("dy","0em").attr("transform","rotate(-45)")}},right:{horizontal(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("dy","0.71em").attr("transform",null)},vertical(t){t.style("text-anchor","middle").attr("dx","0em").attr("dy","0.35em").attr("transform","rotate(-90)")},diagonal(t){t.style("text-anchor","start").attr("dx","0.1em").attr("dy","0.1em").attr("transform","rotate(-45)")}}};function De(){const t=e.dispatch("start","move","drag","end"),n=r().prop("debug").prop("xScale").prop("yScale").prop("draggable").prop("cancelScrolling",A).cancelScrolling(!1).prop("fireOnPanOnly",A).fireOnPanOnly(!1).prop("padding",t=>{const e={top:0,left:0,bottom:0,right:0};for(const r in t){const n=r;n in e&&void 0!==t[n]&&(e[n]=t[n])}return e}).padding({}).render(function(){const r=e.select(this),n=r.props(),a=Fe(n.xScale).sort(e.ascending),o=Fe(n.yScale).sort(e.ascending);a[0]-=n.padding.left,a[1]+=n.padding.right,o[0]-=n.padding.top,o[1]+=n.padding.bottom;const s=r.selectAll("[data-sszvis-behavior-move]").data([0]).join("rect").attr("data-sszvis-behavior-move","").attr("class","sszvis-interactive");n.draggable&&s.classed("sszvis-interactive--draggable",!0),s.attr("x",a[0]).attr("y",o[0]).attr("width",a[1]-a[0]).attr("height",o[1]-o[0]).attr("fill","transparent").on("mouseover",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this&&t.apply("start",this,r)}).on("mousedown",function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];const o=this,s=e.select(document),i=e.select(window),l=()=>{o.__dragging__=!1,i.on("mousemove.sszvis-behavior-move",null),s.on("mouseout.sszvis-behavior-move",null),o&&t.apply("end",o,n)};i.on("mouseup.sszvis-behavior-move",l),s.on("mouseout.sszvis-behavior-move",()=>{const t=n[0].relatedTarget||n[0].toElement;t&&"HTML"!==t.nodeName||l()}),o.__dragging__=!0}).on("mousemove",function(r){const a=this;if(!a)return;const o=r.sourceCapabilities;if(null!=o&&o.firesTouchEvents)return;let s;try{s=e.pointer(r)}catch(t){return}if(!Number.isFinite(s[0])||!Number.isFinite(s[1]))return;const i=Oe(n.xScale,s[0]),l=Oe(n.yScale,s[1]);a.__dragging__?t.apply("drag",a,[r,i,l]):t.apply("move",a,[r,i,l])}).on("mouseout",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this&&t.apply("end",this,r)}).on("touchstart",function(r){const a=this;if(!a)return;const o=g(r);if(!o)return;if("number"!=typeof o.clientX||!Number.isFinite(o.clientX)||"number"!=typeof o.clientY||!Number.isFinite(o.clientY))return;const s=a.getBoundingClientRect(),i=[o.clientX-s.left,o.clientY-s.top],l=Oe(n.xScale,i[0]),c=Oe(n.yScale,i[1]),d=n.cancelScrolling(l,c);if(d&&r.preventDefault(),!n.fireOnPanOnly()||d){t.apply("start",a,[r,l,c]),t.apply("drag",a,[r,l,c]),t.apply("move",a,[r,l,c]);const o=e=>{const r=g(e);if(!r)return;if("number"!=typeof r.clientX||!Number.isFinite(r.clientX)||"number"!=typeof r.clientY||!Number.isFinite(r.clientY))return;const o=a.getBoundingClientRect(),s=[r.clientX-o.left,r.clientY-o.top],i=Oe(n.xScale,s[0]),l=Oe(n.yScale,s[1]),c=n.cancelScrolling(i,l);c&&e.preventDefault(),!n.fireOnPanOnly()||c?(t.apply("drag",a,[e,i,l]),t.apply("move",a,[e,i,l])):t.apply("end",a,[e])},s=r=>{t.apply("end",a,[r]),e.select(a).on("touchmove",null).on("touchend",null)};e.select(a).on("touchmove",o).on("touchend",s)}}),n.debug&&s.attr("fill","rgba(255,0,0,0.2)")});return n.on=function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];const o=t.on.apply(t,r);return o===t?n:o},n}function Oe(t,e){return"invert"in t?t.invert(e):"paddingInner"in t?function(t,e){const r=t.step(),n=t.paddingOuter()*r,a=t.paddingInner()*r,o=t.bandwidth(),s=t.range(),i=t.domain();if(1===i.length)return s[0]<=e&&s[1]>=e?i[0]:null;const l=i.map((t,e)=>0===e?[s[0],s[0]+n+o+a/2]:e===i.length-1?[s[1]-(n+o+a/2),s[1]]:[s[0]+n+e*r-a/2,s[0]+n+(e+1)*r-a/2]);for(let t=0,r=l.length;t<r;t++)if(l[t][0]<e&&e<=l[t][1])return i[t];return null}(t,e):function(t,e){const r=t.step(),n=t.padding()*r,a=t.range(),o=t.domain();if(1===o.length)return a[0]<=e&&a[1]>=e?o[0]:null;const s=o.map((t,e)=>0===e?[a[0],a[0]+n+r/2]:e===o.length-1?[a[1]-(n+r/2),a[1]]:[a[0]+n+e*r-r/2,a[0]+n+e*r+r/2]);for(let t=0,r=s.length;t<r;t++)if(s[t][0]<e&&e<=s[t][1])return o[t];return null}(t,e)}const Te=t=>!m(t)&&p(t)?document.elementFromPoint(t.clientX,t.clientY):null,Ee=t=>{if(!m(t)){const r=e.select(t);if(!m(r.attr("data-sszvis-behavior-pannable"))){const t=r.datum();if(p(t))return t}}return null};const We=225;function Ie(t,e){const r=t.clientX-e[0],n=t.clientY-e[1];return r*r+n*n<We}const He=t=>{let r;return r=i(t)?e.select(t).node():l(t)?t.node():t,{width:r?r.getBoundingClientRect().width:void 0,screenWidth:window.innerWidth,screenHeight:window.innerHeight}},Ge=(()=>{const t=document.createElement("canvas").getContext("2d"),e={};return(r,n,a)=>{const o=[r,n,a].join("-");return t.font="".concat(r,"px ").concat(n),e[o]||t.measureText(a).width}})(),Ke=t=>Ge(10,"Arial, sans-serif",t),Ye=t=>Ge(12,"Arial, sans-serif",t);function Je(t,r){var n;let a={},o=null;0===arguments.length?a={}:1===arguments.length?y(t)?a=t:l(t)?(a={},o=t):(a={},o=e.select(t)):(a=t,o=l(r)?r:e.select(r));const s={top:Ve(a.top,0),right:Ve(a.right,1),bottom:Ve(a.bottom,0),left:Ve(a.left,1)},i=p(o)?He(o):{width:516,screenWidth:window.innerWidth,screenHeight:window.innerHeight},c=Ve(a.width,null!==(n=i.width)&&void 0!==n?n:516),d={width:c,screenHeight:i.screenHeight},u=ze(d),h=Ve(a.height,u+s.top+s.bottom);return{innerHeight:h-s.top-s.bottom,innerWidth:c-s.left-s.right,padding:s,height:h,width:c,screenWidth:i.screenWidth,screenHeight:i.screenHeight}}function Ve(t,e){return void 0===t?e:t}function Ue(t,e){for(const r in t)e(t[r],r)}function Xe(){const t={},e=[],r=[];let n;function a(t,o){if(o>=e.length)return n&&t.sort(n),t;const s=r[o],i=e[o++],l=function(t,e){const r={};let n;for(let a,o=0,s=t.length;o<s;++o){a=t[o],n=e(a);const s=String(n);r[s]?r[s].push(a):r[s]=[a]}return r}(t,i.func);if("obj"===i.type){const t={};return Ue(l,(e,r)=>{t[r]=a(e,o)}),t}if("arr"===i.type){const t=[];if(s){!function(t,e){for(let r=0,n=t.length;r<n;++r)e(t[r],r)}(Object.keys(l).sort(s),e=>{t.push(a(l[e],o))})}else Ue(l,e=>{t.push(a(e,o))});return t}}return t.apply=t=>a(t,0),t.objectBy=r=>(e.push({type:"obj",func:r}),t),t.arrayBy=(n,a)=>(e.push({type:"arr",func:n}),a&&(r[e.length-1]=a),t),t.sort=e=>(n=e,t),t}function qe(t){return()=>{const r=e.scaleOrdinal().range(t.map(Rr));return r.unknown(Rr(t[0])),Pr(r)}}const Qe="#000000",Ze="#3431DE",$e="#0A8DF6",tr="#23C3F1",er="#7B4FB7",rr="#DB247D",nr="#FB737E",ar="#007C78",or="#1D942E",sr="#99C32E",ir="#9A5B01",lr="#FF720C",cr="#FBB900",dr=qe([Ze,$e,tr,er,rr,nr,ar,or,sr,ir,lr,cr]),pr=qe([Ze,rr,or,cr,tr,lr]),ur=qe([Ze,$e,tr,er,rr,nr]),hr=qe([ar,or,sr,ir,lr,cr]);function fr(t){return()=>Nr(e.scaleLinear().range(t.map(Rr)))}const gr=fr(["#CADEFF","#5B6EFF","#211A8A"]),mr=fr(["#FED2EE","#ED408D","#7D0044"]),yr=fr(["#CFEED8","#34B446","#0C4B1F"]),vr=fr(["#FCDDBB","#EA5D00","#611F00"]);function br(t){return()=>function(t){const r=function(t){const r=t.domain;if(!t.range())return t;const n=t.range().length;return t.domain=function(t){if(!t)return r.call(this,[]);const a=[];for(let r=0;r<n;r++)a.push(e.quantile(t,r/(n-1))||0);return r.call(this,a)},t}(t);return r.reverse=()=>Nr(t.copy().range(t.range().reverse())),r}(e.scaleLinear().range(t.map(Rr)))}const _r=br(["#611F00","#A13200","#EA5D00","#FF9A54","#FCDDBB","#CADEFF","#89AFFF","#5B6EFF","#3431DE","#211A8A"]),xr=br(["#782600","#CC4309","#FF720C","#FFBC88","#E4E0DF","#AECBFF","#6B8EFF","#3B51FF","#2F2ABB"]),kr=br(["#7D0044","#C4006A","#ED408D","#FF83B9","#FED2EE","#CFEED8","#81C789","#34B446","#1A7F2D","#0C4B1F"]),zr=br(["#A30059","#DB247D","#FF579E","#FFA8D0","#E4E0DF","#A8DBB1","#55BC5D","#1D942E","#10652A"]);function Ar(t){return()=>Nr(e.scaleOrdinal().range(t.map(Rr)))}const wr=Ar(["#FAFAFA"]),Sr=Ar(["#EAEAEA"]),Fr=Ar(["#D6D6D6"]),jr=Ar(["#B8B8B8"]),Mr=Ar(["#7C7C7C"]),Cr=Ar(["#545454"]);function Pr(t){const e=t;return e.darker=()=>Pr(t.copy().range(t.range().map(t=>t.brighter(1)))),e.brighter=()=>Pr(t.copy().range(t.range().map(t=>t.darker(1)))),e.reverse=()=>Pr(t.copy().range(t.range().reverse())),e}function Nr(t){const r="interpolate"in t?function(t){const r=t.domain;return t.domain=function(t){if(1===arguments.length&&t&&2===t.length){const n=[t[0],e.mean(t)||0,t[1]];return r.call(this,n)}return Reflect.apply(r,this,arguments)},t}(t):t,n=r;return n.reverse=()=>Nr(("copy"in t?t.copy():t).range(t.range().reverse())),n}function Rr(t){return e.lab(t)}const Br=t=>{if(!t)return Qe;const r=e.rgb(t),n=t=>{const e=t/255;return e<=.03928?e/12.92:((e+.055)/1.055)**2.4};return.2126*n(r.r)+.7152*n(r.g)+.0722*n(r.b)>.179?Qe:"#FFFFFF"};function Lr(t){return isNaN(t)?0:t}function Dr(){return r().prop("x",A).prop("y",A).prop("width",A).prop("height",A).prop("fill",A).prop("stroke",A).prop("centerTooltip").prop("tooltipAnchor").prop("transition").transition(!0).render(function(t){const r=e.select(this),n=r.props(),a=d(Lr,n.x),o=d(Lr,n.y),s=d(Lr,n.width),i=d(Lr,n.height),l=r.selectAll(".sszvis-bar").data(t).join("rect").classed("sszvis-bar",!0).attr("x",a).attr("y",o).attr("width",s).attr("height",i).attr("fill",n.fill).attr("stroke",n.stroke);let c;if(n.transition&&l.transition(R()),l.attr("x",a).attr("y",o).attr("width",s).attr("height",i),n.centerTooltip)c=function(t){return[a(t)+s(t)/2,o(t)+i(t)/2]};else if(n.tooltipAnchor){const t=n.tooltipAnchor.map(Number.parseFloat);c=function(e){return[a(e)+t[0]*s(e),o(e)+t[1]*i(e)]}}else c=function(t){return[a(t)+s(t)/2,o(t)]};const p=E().position(c);r.call(p)})}function Or(t){return r().prop("groupScale").prop("groupSize").prop("groupWidth").prop("groupHeight").prop("groupSpace").groupSpace(.05).prop("x",A).prop("y",A).prop("width").prop("height").prop("fill").prop("stroke").prop("defined",A).defined(!0).render(function(r){var n;const a=e.select(this),o=a.props(),s=e.scaleBand().domain(e.range(o.groupSize)).padding(o.groupSpace).paddingOuter(0).rangeRound(t.inGroupRange(o)),i=a.selectAll("g.sszvis-bargroup").data(r).join("g").classed("sszvis-bargroup",!0).selectAll("g.sszvis-barunit").data(t=>t).join("g").classed("sszvis-barunit",!0);i.each((t,e)=>{t.__sszvisGroupedBarIndex__=e});const l=i.filter(o.defined);l.selectAll("*").remove(),l.attr("transform",()=>O(0,0)),l.append("rect").classed("sszvis-bar",!0).attr("fill",o.fill).attr("stroke",null!==(n=o.stroke)&&void 0!==n?n:null).attr("x",t.x(o,s)).attr("y",t.y(o,s)).attr("width",t.width(o,s)).attr("height",t.height(o,s));const c=i.filter(b(o.defined));c.selectAll("*").remove(),c.attr("transform",t.missingTransform(o,s)),c.append("line").classed("sszvis-bar--missing line1",!0).attr("x1",-4).attr("y1",-4).attr("x2",4).attr("y2",4),c.append("line").classed("sszvis-bar--missing line2",!0).attr("x1",4).attr("y1",-4).attr("x2",-4).attr("y2",4);const d=E().position(t.tooltipPosition(o,s));a.call(d)})}const Tr=()=>Or({inGroupRange:t=>{let{groupWidth:e}=t;return[0,e]},x:(t,e)=>{let{groupScale:r}=t;return(t,n)=>{var a;return r(t)+(void 0!==t.__sszvisGroupedBarIndex__&&null!==(a=e(t.__sszvisGroupedBarIndex__))&&void 0!==a?a:0)}},y:t=>{let{y:e}=t;return e},width:(t,e)=>e.bandwidth(),height:t=>{let{height:e}=t;return e},missingTransform:(t,e)=>{let{groupScale:r,y:n}=t;return(t,a)=>{var o;return O(r(t)+(void 0!==t.__sszvisGroupedBarIndex__&&null!==(o=e(t.__sszvisGroupedBarIndex__))&&void 0!==o?o:0)+e.bandwidth()/2,n(t,a))}},tooltipPosition:(t,e)=>{let{groupScale:r,y:n}=t;return t=>{let a=0,o=1/0;for(const[i,l]of t.entries()){var s;const t=l;a+=r(t)+(void 0!==t.__sszvisGroupedBarIndex__&&null!==(s=e(t.__sszvisGroupedBarIndex__))&&void 0!==s?s:0)+e.bandwidth()/2,o=Math.min(o,n(t,i))}return[a/t.length,o]}}}),Er=Tr;const Wr=_("stack"),Ir=_("0"),Hr=_("1");function Gr(t){return function(r,n,a){return function(o){const s=Xe().arrayBy(r).objectBy(n).apply(o),i=s.reduce((t,e)=>k([...t,...Object.keys(e)]),[]),l=e.stack().keys(i).value((t,e)=>a(t[e][0])).order(t)(s);for(const t of l)for(const e of t)e.series=t.key,e.data=e.data[t.key][0],e.stack=r(e.data);return l.keys=i,l.maxValue=e.max(l,t=>e.max(t,t=>t[1])),l}}}const Kr=Gr(e.stackOrderNone),Yr=Gr(e.stackOrderReverse);function Jr(t){return r().prop("xScale",A).prop("width",A).prop("yScale",A).prop("height",A).prop("fill").prop("stroke").render(function(r){const n=e.select(this),a=n.props(),o=Dr().x(t.x(a)).y(t.y(a)).width(t.width(a)).height(t.height(a)).fill(a.fill).stroke(a.stroke||"#FFFFFF");n.selectAll(".sszvis-stack").data(r).join("g").classed("sszvis-stack",!0).call(o)})}const Vr={x:t=>d(t.xScale,Ir),y:t=>d(t.yScale,Wr),width:t=>function(e){return t.xScale(e[1])-t.xScale(e[0])},height:t=>t.height},Ur={x:t=>d(t.xScale,Wr),y:t=>d(t.yScale,Hr),width:t=>t.width,height:t=>function(e){return t.yScale(e[0])-t.yScale(e[1])}},Xr=function(){return Jr(Ur)};function qr(){return r().prop("barPosition").prop("barWidth").prop("mirror").mirror(!1).render(function(t){const r=e.select(this),n=r.props(),a=e.line().x(n.barWidth).y(n.barPosition);r.selectAll(".sszvis-pyramid__referenceline").data(t).join("path").attr("class","sszvis-pyramid__referenceline").attr("transform",n.mirror?"scale(-1, 1)":"").transition(R()).attr("d",a)})}const Qr=_("data"),Zr=_("row");function $r(){return r().prop("stackElement").renderSelection(t=>{const r=t.datum(),n=t.props();t.selectAll("[data-sszvis-stack]").data(r).join("g").attr("data-sszvis-stack","").each(function(t){e.select(this).datum(t).call(n.stackElement)})})}function tn(){return r().prop("barPosition").prop("barWidth").prop("mirror").mirror(!1).render(function(t){const r=e.select(this),n=r.props(),a=e.line().x(n.barWidth).y(n.barPosition);r.selectAll(".sszvis-path").data(t).join("path").attr("class","sszvis-path").attr("fill","none").attr("stroke","#aaa").attr("stroke-width",2).attr("stroke-dasharray","3 3").attr("transform",n.mirror?"scale(-1, 1)":"").transition(R()).attr("d",a)})}const en=2*Math.PI;function rn(t,e){return e.includes(t)}function nn(){return r().prop("scale").prop("rowHeight").rowHeight(21).prop("columnWidth").columnWidth(200).prop("rows").rows(3).prop("columns").columns(3).prop("verticallyCentered").verticallyCentered(!1).prop("orientation").prop("reverse").reverse(!1).prop("rightAlign").rightAlign(!1).prop("horizontalFloat").horizontalFloat(!1).prop("floatPadding").floatPadding(20).prop("floatWidth").floatWidth(600).render(function(){const t=e.select(this),r=t.props();let n,a,o=r.scale.domain();r.reverse&&(o=[...o].reverse()),"horizontal"===r.orientation?(a=Math.ceil(r.columns),n=Math.ceil(o.length/a)):"vertical"===r.orientation&&(n=Math.ceil(r.rows),a=Math.ceil(o.length/n));const s=t.selectAll(".sszvis-legend--entry").data(o).join("g").classed("sszvis-legend--entry",!0);s.selectAll(".sszvis-legend__mark").data(t=>[t]).join("circle").classed("sszvis-legend__mark",!0).attr("cx",r.rightAlign?-6:6).attr("cy",L(r.rowHeight/2)).attr("r",5).attr("fill",t=>r.scale(t)).attr("stroke",t=>r.scale(t)).attr("stroke-width",1),s.selectAll(".sszvis-legend__label").data(t=>[t]).join("text").classed("sszvis-legend__label",!0).text(t=>t).attr("dy","0.35em").style("text-anchor",()=>r.rightAlign?"end":"start").attr("transform",()=>O(r.rightAlign?-18:18,L(r.rowHeight/2)));let i="";if(r.verticallyCentered&&(i="translate(0,"+String(-o.length*r.rowHeight/2)+") "),r.horizontalFloat){let t=0,e=0;s.attr("transform",function(){const n=this.getBoundingClientRect().width;e+n>r.floatWidth&&(t+=r.rowHeight,e=0);const a=O(e,t);return e+=n+r.floatPadding,i+a})}else s.attr("transform",(t,e)=>"horizontal"===r.orientation?i+"translate("+e%a*r.columnWidth+","+Math.floor(e/a)*r.rowHeight+")":"vertical"===r.orientation?i+"translate("+Math.floor(e/n)*r.columnWidth+","+e%n*r.rowHeight+")":void 0)})}function an(t,r){const n=t.length,a=e.max(t,on),o=e.sum(t,on),s=n<=4?1:sn(r,a,2),i=1===s&&o<=r;return{columns:s,rows:i?1:Math.ceil(n/s),columnWidth:1===s?null:a,legendWidth:s*a,horizontalFloat:i,orientation:i?null:"vertical"}}function on(t){return Ye(t)+40}function sn(t,e,r){return r<=1?1:e<=t/r?r:sn(t,e,r-1)}function ln(){const t=[];let r=s,n=(t,e)=>0;const a={calculate:a=>{if(0===t.length)throw new Error("At least one layer must be specified before calculating hierarchy data");const o={_tag:"root",children:cn(e.rollup(a,f,...t))};return e.hierarchy(o,t=>"leaf"===t._tag?void 0:t.children).sort(n).sum(t=>"leaf"===t._tag?r(t.data):0)},layer:e=>(t.push(e),a),value:t=>(r=t,a),sort:t=>(n=t,a)};return a}function cn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=t;return Array.from(n,t=>{var n;let[a,o]=t;const s=null!==(n=null!=a?a:e)&&void 0!==n?n:"",i=null!=r?r:s;return o instanceof Map&&o.size>0?{_tag:"branch",key:s,rootKey:i,children:cn(o,s,i)}:{_tag:"leaf",key:s,rootKey:i,data:o}})}const dn=function(){let t=0;return function(){return++t}}();const pn=w((t,r,n)=>e.geoMercator().fitSize([t,r],n),(t,e,r,n)=>t+","+e+","+n),un=function(t,r,n,a){return e.geoPath().projection(pn(t,r,n,a))},hn="geoId",fn=function(t,e,r){r||(r=hn);const n=Array.isArray(t)?t.reduce((t,e)=>(t[e[r]]=e,t),{}):{};return e.features.map(t=>({geoJson:t,datum:n[t.id]}))},gn=function(t){if(!t.properties.cachedCenter){const r=t.properties.center;t.properties.cachedCenter=r?r.split(",").map(Number.parseFloat):e.geoCentroid(t)}return t.properties.cachedCenter};function mn(){return r().prop("mergedData").prop("geoJson").prop("mapPath").prop("defined",A).defined(!0).prop("fill",A).fill(()=>"black").prop("transitionColor").transitionColor(!0).render(function(){const t=e.select(this),r=t.props();function n(t){return r.defined(t.datum)?r.fill(t.datum):"url(#missing-pattern)"}P(t,"pattern","missing-pattern").call(S);const a=t.selectAll(".sszvis-map__area").data(r.mergedData).join("path").classed("sszvis-map__area",!0).classed("sszvis-map__area--entering",!0).attr("data-event-target","").attr("fill",n).classed("sszvis-map__area--entering",!1);t.selectAll(".sszvis-map__area--undefined").attr("fill",n),a.classed("sszvis-map__area--undefined",t=>!p(t.datum)||!r.defined(t.datum)).attr("d",t=>r.mapPath(t.geoJson)),r.transitionColor?a.transition().call(B).attr("fill",n):a.attr("fill",n);const o=E().position(t=>r.mapPath.projection()(gn(t.geoJson)));t.selectGroup("tooltipAnchors").datum(r.mergedData).call(o)})}const yn=_("datum");function vn(){return r().prop("keyName").keyName(hn).prop("geoJson").prop("mapPath").prop("highlight").highlight([]).prop("highlightStroke",A).highlightStroke("white").prop("highlightStrokeWidth",A).highlightStrokeWidth(2).render(function(){const t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-map__highlight");if(0===r.highlight.length)return n.remove(),!0;const a=r.geoJson.features.reduce((t,e)=>(t[e.id]=e,t),{}),o=r.highlight.reduce((t,e)=>(e&&t.push({geoJson:a[e[r.keyName]],datum:e}),t),[]);n.data(o).join("path").classed("sszvis-map__highlight",!0).attr("d",t=>r.mapPath(t.geoJson)).style("stroke",t=>r.highlightStroke(t.datum)).style("stroke-width",t=>r.highlightStrokeWidth(t.datum))})}function bn(){return r().prop("geoJson").prop("mapPath").prop("borderColor").borderColor("white").prop("strokeWidth").strokeWidth(1.25).render(function(){const t=e.select(this),r=t.props();t.selectAll(".sszvis-map__border").data([r.geoJson]).join("path").classed("sszvis-map__border",!0).attr("d",r.mapPath).style("stroke",r.borderColor).style("stroke-width",r.strokeWidth)})}function _n(){return r().prop("mapPath").prop("lakeFeature").prop("lakeBounds").prop("lakePathColor").prop("fadeOut").fadeOut(!0).render(function(){const t=e.select(this),r=t.props();P(t,"pattern","lake-pattern").call(F),r.fadeOut&&(P(t,"linearGradient","lake-fade-gradient").call(j),P(t,"mask","lake-fade-mask").call(M));const n=t.selectAll(".sszvis-map__lakezurich").data([r.lakeFeature]).join("path").classed("sszvis-map__lakezurich",!0).attr("d",r.mapPath).attr("fill","url(#lake-pattern)");r.fadeOut&&n.attr("mask","url(#lake-fade-mask)");const a=t.selectAll(".sszvis-map__lakepath").data([r.lakeBounds]).join("path").classed("sszvis-map__lakepath",!0).attr("d",r.mapPath);r.lakePathColor&&a.style("stroke",r.lakePathColor)})}const xn=e.timeFormatLocale(H).parse,kn=xn("%d.%m.%Y"),zn=xn("%Y");function An(t){return function(){const e=function(){const t=[[]];return{addLine(){t.push([])},addWord(e,r){v(t).push({text:A(r),style:e})},lines:()=>t}}();function r(r){return t(e,r)}r.newline=function(){return e.addLine(),r};for(const t of["bold","italic","plain"])r[t]=function(n){return e.addWord(t,n),r};return r}}const wn=An(function(){const t={plain:t=>t,italic:t=>"<em>"+t+"</em>",bold:t=>"<strong>"+t+"</strong>"};return function(e,r){return e.lines().map(e=>e.map(e=>t[e.style].call(null,e.text(r))).join(" ")).join("<br/>")}}()),Sn=An(function(){const t={plain:t=>"<tspan>"+t+"</tspan>",italic:t=>'<tspan style="font-style:italic">'+t+"</tspan>",bold:t=>'<tspan style="font-weight:bold">'+t+"</tspan>"};return function(e,r){return e.lines().reduce((e,n,a)=>e+'<tspan x="0" dy="'+(0===a?0:"1.2em")+'">'+n.map(e=>t[e.style].call(null,e.text(r))).join(" ")+"</tspan>","")}}());t.AGGLOMERATION_2012_KEY="zurichAgglomeration2012",t.DEFAULT_LEGEND_COLOR_ORDINAL_ROW_HEIGHT=21,t.DEFAULT_WIDTH=516,t.GEO_KEY_DEFAULT=hn,t.RATIO=16/9,t.STADT_KREISE_KEY="zurichStadtKreise",t.STATISTISCHE_QUARTIERE_KEY="zurichStatistischeQuartiere",t.STATISTISCHE_ZONEN_KEY="zurichStatistischeZonen",t.SWITZERLAND_KEY="switzerland",t.WAHL_KREISE_KEY="zurichWahlKreise",t.annotationCircle=function(){return r().prop("x",A).prop("y",A).prop("r",A).prop("dx",A).prop("dy",A).prop("caption",A).render(function(t){const r=e.select(this),n=r.props(),a=P(r,"pattern","data-area-pattern");C(a);if(r.selectAll(".sszvis-dataareacircle").data(t).join("circle").classed("sszvis-dataareacircle",!0).attr("cx",t=>Number(n.x(t))).attr("cy",t=>Number(n.y(t))).attr("r",t=>Number(n.r(t))).attr("fill","url(#data-area-pattern)"),n.caption){r.selectAll(".sszvis-dataareacircle__caption").data(t).join("text").classed("sszvis-dataareacircle__caption",!0).attr("x",t=>Number(n.x(t))).attr("y",t=>Number(n.y(t))).attr("dx",n.dx?t=>{var e;return Number(null===(e=n.dx)||void 0===e?void 0:e.call(n,t))}:null).attr("dy",n.dy?t=>{var e;return Number(null===(e=n.dy)||void 0===e?void 0:e.call(n,t))}:null).text(n.caption?t=>{var e;return(null===(e=n.caption)||void 0===e?void 0:e.call(n,t))||""}:null)}})},t.annotationConfidenceArea=function(){return r().prop("x",A).prop("y0",A).prop("y1",A).prop("stroke").prop("strokeWidth").prop("fill").prop("key").key((t,e)=>e).prop("valuesAccessor").valuesAccessor(s).prop("transition").transition(!0).render(function(t){const r=e.select(this),n=r.props(),a=P(r,"pattern","data-area-pattern");C(a);const o=e.area().x(t=>Number(n.x(t))).y0(t=>Number(n.y0(t))).y1(t=>Number(n.y1(t))),s=r.selectAll(".sszvis-area").data(t).join("path").classed("sszvis-area",!0);n.stroke&&s.style("stroke",n.stroke),s.attr("fill","url(#data-area-pattern)").order();const i=n.transition?s.transition().call(R):s;i.attr("d",t=>o(n.valuesAccessor(t))),n.stroke&&i.style("stroke",n.stroke),n.strokeWidth&&i.style("stroke-width",n.strokeWidth),i.attr("fill","url(#data-area-pattern)")})},t.annotationConfidenceBar=function(){return r().prop("x",A).prop("y",A).prop("confidenceLow",A).prop("confidenceHigh",A).prop("width").prop("groupSize").prop("groupWidth").prop("groupSpace").groupSpace(.05).prop("groupScale",A).render(function(t){const r=e.select(this),n=r.props(),a=e.scaleBand().domain(e.range(n.groupSize).map(String)).rangeRound([0,n.groupWidth]).paddingInner(n.groupSpace).paddingOuter(0),o=r.selectAll("g.sszvis-confidence-bargroup").data(t).join("g").classed("sszvis-confidence-bargroup",!0).selectAll("g.sszvis-confidence-barunit").data(t=>t).join("g").classed("sszvis-confidence-barunit",!0);o.each((t,e)=>{t.__sszvisGroupedBarConfidenceIndex__=e});const s=o.filter(()=>!0);s.selectAll("*").remove(),s.append("line").classed("sszvis-confidence-bar",!0).attr("x1",t=>{var e;const r=null!==(e=t.__sszvisGroupedBarConfidenceIndex__)&&void 0!==e?e:0;return n.groupScale(t)+(a(String(r))||0)+a.bandwidth()/2}).attr("y1",t=>Number(n.confidenceHigh(t))).attr("x2",t=>{var e;const r=null!==(e=t.__sszvisGroupedBarConfidenceIndex__)&&void 0!==e?e:0;return n.groupScale(t)+(a(String(r))||0)+a.bandwidth()/2}).attr("y2",t=>Number(n.confidenceLow(t))).attr("stroke","#767676").attr("stroke-width","1"),s.append("line").classed("sszvis-confidence-bar",!0).attr("x1",t=>{var e;const r=null!==(e=t.__sszvisGroupedBarConfidenceIndex__)&&void 0!==e?e:0;return n.groupScale(t)+(a(String(r))||0)+a.bandwidth()/2-n.width/2}).attr("y1",t=>Number(n.confidenceHigh(t))).attr("x2",t=>{var e;const r=null!==(e=t.__sszvisGroupedBarConfidenceIndex__)&&void 0!==e?e:0;return n.groupScale(t)+(a(String(r))||0)+a.bandwidth()/2+n.width/2}).attr("y2",t=>Number(n.confidenceHigh(t))).attr("stroke","#767676").attr("stroke-width","1"),s.append("line").classed("sszvis-confidence-bar",!0).attr("x1",t=>{var e;const r=null!==(e=t.__sszvisGroupedBarConfidenceIndex__)&&void 0!==e?e:0;return n.groupScale(t)+(a(String(r))||0)+a.bandwidth()/2-n.width/2}).attr("y1",t=>Number(n.confidenceLow(t))).attr("x2",t=>{var e;const r=null!==(e=t.__sszvisGroupedBarConfidenceIndex__)&&void 0!==e?e:0;return n.groupScale(t)+(a(String(r))||0)+a.bandwidth()/2+n.width/2}).attr("y2",t=>Number(n.confidenceLow(t))).attr("stroke","#767676").attr("stroke-width","1")})},t.annotationLine=function(){return r().prop("x1").prop("x2").prop("y1").prop("y2").prop("xScale").prop("yScale").prop("dx",A).dx(0).prop("dy",A).dy(0).prop("caption",A).render(function(t){const r=e.select(this),n=r.props(),a=n.xScale(n.x1)||0,o=n.yScale(n.y1)||0,s=n.xScale(n.x2)||0,i=n.yScale(n.y2)||0;if(r.selectAll(".sszvis-referenceline").data(t).join("line").classed("sszvis-referenceline",!0).attr("x1",a).attr("y1",o).attr("x2",s).attr("y2",i),n.caption){r.selectAll(".sszvis-referenceline__caption").data([0]).join("text").classed("sszvis-referenceline__caption",!0).attr("transform",()=>{const t=s-a,e=i-o,r=180*Math.atan2(e,t)/Math.PI;return"translate(".concat((a+s)/2,",").concat((o+i)/2,") rotate(").concat(r,")")}).attr("dx",n.dx?Number(n.dx(t[0])):null).attr("dy",n.dy?Number(n.dy(t[0])):null).text(n.caption?n.caption(t[0]):null)}})},t.annotationRangeFlag=function(){return r().prop("x",A).prop("y0",A).prop("y1",A).render(function(t){const r=e.select(this),n=r.props(),a=d(L,n.x),o=d(L,n.y0),s=d(L,n.y1);r.selectAll(".sszvis-rangeFlag__mark.bottom").data(t).call(W("bottom",a,o)),r.selectAll(".sszvis-rangeFlag__mark.top").data(t).call(W("top",a,s));const i=E().position(t=>[a(t),L((Number(n.y0(t))+Number(n.y1(t)))/2)]);r.call(i)})},t.annotationRangeRuler=function(){return r().prop("x",A).prop("y0",A).prop("y1",A).prop("top").prop("bottom").prop("label").prop("removeStroke").label(A("")).prop("total").prop("flip",A).flip(!1).render(function(t){const r=e.select(this),n=r.props(),a=d(L,n.x),o=d(L,n.y0),s=d(L,n.y1),i=t=>L((Number(n.y0(t))+Number(n.y1(t)))/2);r.selectAll(".sszvis-rangeRuler__rule").data([0]).join("line").classed("sszvis-rangeRuler__rule",!0).attr("x1",a).attr("y1",n.top).attr("x2",a).attr("y2",n.bottom);const l=r.selectAll(".sszvis-rangeRuler--mark").data(t).join("g").classed("sszvis-rangeRuler--mark",!0);l.append("circle").classed("sszvis-rangeRuler__p1",!0),l.append("circle").classed("sszvis-rangeRuler__p2",!0),l.append("text").classed("sszvis-rangeRuler__label-contour",!0),l.append("text").classed("sszvis-rangeRuler__label",!0),l.selectAll(".sszvis-rangeRuler__p1").data(t=>[t]).attr("cx",a).attr("cy",o).attr("r",1.5),l.selectAll(".sszvis-rangeRuler__p2").data(t=>[t]).attr("cx",a).attr("cy",s).attr("r",1.5),l.selectAll(".sszvis-rangeRuler__label").data(t=>[t]).attr("x",t=>{const e=n.flip(t)?-10:10;return a(t)+e}).attr("y",i).attr("dy","0.35em").style("text-anchor",t=>n.flip(t)?"end":"start").text(d(U,n.label)),l.selectAll(".sszvis-rangeRuler__label-contour").data(t=>[t]).attr("x",t=>{const e=n.flip(t)?-10:10;return a(t)+e}).attr("y",i).attr("dy","0.35em").style("text-anchor",t=>n.flip(t)?"end":"start").text(d(U,n.label)),r.selectAll("g.sszvis-rangeRuler--mark").each(function(){const t=e.select(this),r=t.select("text").node();let o=t.select(".sszvis-rangeRuler__label-contour");if(o.empty()){if(r){const t=r.cloneNode(!0);o=e.select(t),o.classed("sszvis-rangeRuler__label-contour",!0).classed("sszvis-rangeRuler__label",!1);const n=o.node();n&&this instanceof Element&&this.insertBefore(n,r)}}else o.attr("x",t=>{const e=n.flip(t)?-10:10;return a(t)+e}).attr("y",t=>i(t)).attr("dy","0.35em").style("text-anchor",t=>n.flip(t)?"end":"start");r&&o.text(r.textContent||"")}),n.removeStroke||l.attr("stroke","white").attr("stroke-width",.5).attr("stroke-opacity",.75);const c=r.selectAll(".sszvis-rangeRuler__total").data([v(t)]).join("text").classed("sszvis-rangeRuler__total",!0);c.attr("x",t=>{const e=n.flip(t)?-10:10;return a(t)+e}).attr("y",n.top-10).style("text-anchor",t=>n.flip(t)?"end":"start").text("Total ".concat(U(n.total)));const p=c.node();let u=r.select(".sszvis-rangeRuler__total-contour");if(u.empty()){if(p){const t=p.cloneNode(!0);u=e.select(t),u.classed("sszvis-rangeRuler__total-contour",!0).classed("sszvis-rangeRuler__total",!1);const r=u.node();r&&this instanceof Element&&this.insertBefore(r,p)}}else u.attr("x",t=>{const e=n.flip(t)?-10:10;return a(t)+e}).attr("y",n.top-10).style("text-anchor",t=>n.flip(t)?"end":"start");p&&u.text(p.textContent||""),n.removeStroke||c.attr("stroke","white").attr("stroke-width",.5).attr("stroke-opacity",.75)})},t.annotationRectangle=function(){return r().prop("x",A).prop("y",A).prop("width",A).prop("height",A).prop("dx",A).prop("dy",A).prop("caption",A).render(function(t){const r=e.select(this),n=r.props(),a=P(r,"pattern","data-area-pattern");C(a);if(r.selectAll(".sszvis-dataarearectangle").data(t).join("rect").classed("sszvis-dataarearectangle",!0).attr("x",t=>Number(n.x(t))).attr("y",t=>Number(n.y(t))).attr("width",t=>Number(n.width(t))).attr("height",t=>Number(n.height(t))).attr("fill","url(#data-area-pattern)"),n.caption){r.selectAll(".sszvis-dataarearectangle__caption").data(t).join("text").classed("sszvis-dataarearectangle__caption",!0).attr("x",t=>Number(n.x(t))+Number(n.width(t))/2).attr("y",t=>Number(n.y(t))+Number(n.height(t))/2).attr("dx",n.dx?t=>{var e;return Number(null===(e=n.dx)||void 0===e?void 0:e.call(n,t))}:null).attr("dy",n.dy?t=>{var e;return Number(null===(e=n.dy)||void 0===e?void 0:e.call(n,t))}:null).text(t=>{var e;return(null===(e=n.caption)||void 0===e?void 0:e.call(n,t))||""})}})},t.annotationRuler=()=>r().prop("top").prop("bottom").prop("x",A).prop("y",A).prop("label").label(A("")).prop("color").prop("flip",A).flip(!1).prop("labelId",A).prop("reduceOverlap").reduceOverlap(!0).render(function(t){const r=e.select(this),n=r.props(),a=n.labelId||(t=>"".concat(n.x(t),"_").concat(n.y(t)));r.selectAll(".sszvis-ruler__rule").data(t,t=>a(t)).join("line").classed("sszvis-ruler__rule",!0).attr("x1",d(L,n.x)).attr("y1",t=>Number(n.y(t))).attr("x2",d(L,n.x)).attr("y2",n.bottom);r.selectAll(".sszvis-ruler__dot").data(t,t=>a(t)).join("circle").classed("sszvis-ruler__dot",!0).attr("cx",d(L,n.x)).attr("cy",d(L,n.y)).attr("r",3.5).attr("fill",n.color||"black"),r.selectAll(".sszvis-ruler__label-outline").data(t,t=>a(t)).join("text").classed("sszvis-ruler__label-outline",!0);const o=r.selectAll(".sszvis-ruler__label").data(t,t=>a(t)).join("text").classed("sszvis-ruler__label",!0),s=d(L,n.x),i=d(L,n.y),l=r.selectAll(".sszvis-ruler__label, .sszvis-ruler__label-outline").attr("transform",t=>{const e=s(t),r=i(t);return O(e+(n.flip(t)?-10:10),r+(r<n.top?2*r:r>n.bottom?0:5))}).style("text-anchor",t=>n.flip(t)?"end":"start").html(t=>n.label(t));if(n.reduceOverlap){const t=2;let r=10;const n=[],s={};for(l.attr("y",""),o.each(function(t){const e=this.getBoundingClientRect(),r={top:e.top,bottom:e.bottom,dy:0};n.push(r),s[a(t)]=r}),n.sort((t,r)=>e.ascending(t.top,r.top));r--;)for(const[e,r]of n.entries())for(const a of n.slice(e+1)){const e=r.bottom-a.top;if(e>=t){const t=e/2;r.bottom-=t,r.top-=t,r.dy-=t,a.bottom+=t,a.top+=t,a.dy+=t}}l.attr("y",t=>s[a(t)].dy)}}),t.app=t=>{let e,r,{init:n,render:a,actions:o={},fallback:s}=t;ne(ae(n),'An "init" function returning a Promise must be provided.'),ne(ae(a),'A "render" function must be provided.');const i=Object.keys(o).reduce((t,e)=>(t[e]=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];c(e,r)},t),{});function l(t){e||(e=!0,requestAnimationFrame(()=>{a(r,i),e=!1})),ae(t)&&t(c)}function c(t,e){ne(null!=o[t],'Action "'.concat(t,'" is not defined, add it to "actions".'));const n=Jt(r),a=o[t](n,...e);r=Vt(n),l(a)}const d=Jt({});n(d).then(t=>{r=Vt(d),l(t),re.on("resize",l)}).catch(t=>{ne(!1,t),s&&Ut(s.element,{src:s.src})})},t.arity=c,t.aspectRatio=me,t.aspectRatio12to5=be,t.aspectRatio16to10=ve,t.aspectRatio4to3=ye,t.aspectRatioAuto=ze,t.aspectRatioPortrait=xe,t.aspectRatioSquare=_e,t.axisX=Pe,t.axisY=Ne,t.bar=Dr,t.bounds=Je,t.breadcrumb=function(){return r().prop("renderInto").prop("items").items([]).prop("label",A).label(t=>t.label).prop("onClick").onClick(()=>{}).prop("rootLabel").rootLabel("Root").prop("separator").separator(" › ").prop("width").width(800).renderSelection(t=>{const e=t.props(),r=[{label:e.rootLabel,node:null},...e.items],n=e.renderInto.selectDiv("breadcrumbs").style("position","absolute").style("top","-40px").style("left","0px").style("width","".concat(e.width,"px")).style("height","30px").style("display","flex").style("align-items","center").style("gap","8px").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size","14px").selectAll("span.sszvis-breadcrumb-item").data(r,t=>e.label(t)),a=n.enter().append("span").classed("sszvis-breadcrumb-item",!0);a.append("a").style("color","#0073B3").style("cursor","pointer").style("text-decoration","none"),a.append("span").classed("sszvis-breadcrumb-separator",!0).style("color","#666").text(e.separator);const o=a.merge(n);o.select("a").text(t=>e.label(t)).style("font-weight",(t,e)=>e===r.length-1?"bold":"normal").style("color",(t,e)=>e===r.length-1?"#333":"#0073B3").style("cursor",(t,e)=>e===r.length-1?"default":"pointer").on("click",(t,n)=>{const a=r.indexOf(n);a!==r.length-1&&(t.preventDefault(),e.onClick(n,a))}),o.select(".sszvis-breadcrumb-separator").style("display",(t,e)=>e===r.length-1?"none":"inline"),n.exit().remove()})},t.breakpointCreateSpec=ce,t.breakpointDefaultSpec=de,t.breakpointFind=oe,t.breakpointFindByName=se,t.breakpointLap=ue,t.breakpointMatch=le,t.breakpointPalm=pe,t.breakpointTest=ie,t.buttonGroup=function(){return r().prop("values").prop("current").prop("width").width(300).prop("change").change(s).render(function(){const t=e.select(this),r=t.props(),n=r.width/r.values.length,a=t.selectAll(".sszvis-control-optionSelectable").data(["sszvis-control-buttonGroup"],t=>t).join("div").classed("sszvis-control-optionSelectable",!0).classed("sszvis-control-buttonGroup",!0);a.style("width",r.width+"px");a.selectAll(".sszvis-control-buttonGroup__item").data(r.values).join("div").classed("sszvis-control-buttonGroup__item",!0).style("width",n+"px").classed("selected",t=>t===r.current).text(t=>t).on("click",r.change)})},t.cascade=Xe,t.choropleth=function(){const t=e.dispatch("over","out","click"),n=mn(),a=bn(),o=_n(),s=vn(),i=r().prop("width").prop("height").prop("keyName").keyName(hn).prop("withLake").withLake(!0).prop("anchoredShape").prop("features").prop("borders").prop("lakeFeatures").prop("lakeBorders").prop("lakeFadeOut").lakeFadeOut(!1).delegate("defined",n).delegate("fill",n).delegate("transitionColor",n).delegate("borderColor",a).delegate("strokeWidth",a).delegate("highlight",s).delegate("highlightStroke",s).delegate("highlightStrokeWidth",s).delegate("lakePathColor",o).render(function(r){const i=e.select(this),l=i.props(),c=un(l.width,l.height,l.features,"zurichStadtfeatures"),d=fn(r,l.features,l.keyName);n.geoJson(l.features).mergedData(d).mapPath(c),a.geoJson(l.borders).mapPath(c),o.lakeFeature(l.lakeFeatures).lakeBounds(l.lakeBorders).mapPath(c).fadeOut(l.lakeFadeOut),s.geoJson(l.features).keyName(l.keyName).mapPath(c),i.call(n).call(a),l.withLake&&i.call(o),i.call(s),l.anchoredShape&&(l.anchoredShape.mergedData(d).mapPath(c),i.call(l.anchoredShape)),i.selectAll("[data-event-target]").on("mouseover",function(e){t.call("over",this,e.datum)}).on("mouseout",function(e){t.call("out",this,e.datum)}).on("click",function(e){t.call("click",this,e.datum)})});return i.on=function(){const e=t.on.apply(t,arguments);return e===t?i:e},i},t.colorLegendDimensions=an,t.colorLegendLayout=function(t,r){let{legendLabels:n,axisLabels:a=[],slant:o="horizontal"}=t;const s=an(n,He(r).width),i=n.length>6?dr().domain(n):pr().domain(n),l=nn().scale(i).horizontalFloat(s.horizontalFloat).rows(s.rows).columnWidth(s.columnWidth).orientation(s.orientation),c=function(t,r){switch(t){case"vertical":return 40+e.max(r,Ke);case"diagonal":return 40+Math.sqrt(2*Math.pow(e.max(r,Ke)/2,2));default:return 60}}(o,a),d=21*s.rows;return{axisLabelPadding:c,legendPadding:d,bottomPadding:c+d,legendWidth:s.legendWidth,legend:l,scale:i}},t.compose=d,t.contains=(t,e)=>t.includes(e),t.createBreadcrumbItems=function(t){return t?t.ancestors().reverse().slice(1).map(t=>({label:"leaf"===t.data._tag||"branch"===t.data._tag?t.data.key:"",node:t})):[]},t.createHtmlLayer=function(t,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{padding:a}=r||Je(),o=n.key||"default",s="data-sszvis-html-".concat(o),i=l(t)?t:e.select(t);return i.classed("sszvis-outer-container",!0),i.selectAll("[data-sszvis-html-layer][".concat(s,"]")).data([0]).join("div").classed("sszvis-html-layer",!0).attr("data-sszvis-html-layer","").attr(s,"").style("position","absolute").style("left","".concat(a.left,"px")).style("top","".concat(a.top,"px"))},t.createSvgLayer=function(t,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{padding:a,height:o,width:s}=r||Je(),i=n.key||"default",c="data-sszvis-svg-".concat(i),d=n.title||"",p=n.description||"",u=(l(t)?t:e.select(t)).selectAll("svg[".concat(c,"]")).data([0]).join("svg").classed("sszvis-svg-layer",!0).attr(c,"").attr("role","img").attr("aria-label","".concat(d," – ").concat(p)).attr("height",o).attr("width",s);return u.selectAll("title").data([0]).join("title").text(d),u.selectAll("desc").data([0]).join("desc").text(p).classed("sszvis-svg-layer",!0).attr(c,"").attr("role","img"),u.selectAll("[data-sszvis-svg-layer]").data(()=>[0]).join("g").attr("data-sszvis-svg-layer","").attr("transform","translate(".concat(a.left,",").concat(a.top,")"))},t.dataAreaPattern=C,t.defaultTransition=R,t.defined=p,t.derivedSet=(t,e)=>{const r=e||s,n=[],a=[];let o,i;for(let e=0,s=t.length;e<s;++e)o=t[e],i=r(o,e,t),n.includes(i)||(n.push(i),a.push(o));return a},t.dimensionsHeatTable=function(t,e,r,n,a){a||(a={}),a.top||(a.top=0),a.right||(a.right=0),a.bottom||(a.bottom=0),a.left||(a.left=0);const o=t-a.left-a.right,s=Math.min((o-e*(r-1))/r,30),i=s+e,l=r*i-e;return{side:s,paddedSide:i,padRatio:1-s/i,width:l,height:n*i-e,centeredOffset:Math.max((o-l)/2,0)}},t.dimensionsHorizontalBarChart=function(t){const e=24*t+20*(t-1);return{barHeight:24,padHeight:20,padRatio:1-24/44,outerRatio:0,axisOffset:-22,barGroupHeight:e,totalHeight:e+0}},t.dimensionsVerticalBarChart=function(t,e){const r=1-.7,n=e-1;let a=t*r/(r*n+.7*e),o=(t-a*n)/e;o>48&&(o=48,a=(t-o*e)/n),a<2&&(a=2),a>100&&(a=100);const s=o*e+a*n;return{barWidth:o,padWidth:a,padRatio:1-o/(o+a),outerRatio:(t-s)/2/(o+a),barGroupWidth:s,totalWidth:t}},t.dot=function(){return r().prop("x",A).prop("y",A).prop("radius").prop("stroke").prop("fill").prop("transition").transition(!0).render(function(t){const r=e.select(this),n=r.props();let a=r.selectAll(".sszvis-circle").data(t).join("circle").classed("sszvis-circle",!0).attr("cx",n.x).attr("cy",n.y).attr("r",n.radius).attr("stroke",n.stroke).attr("fill",n.fill);n.transition&&(a=a.transition(R())),a.attr("cx",n.x).attr("cy",n.y).attr("r",n.radius);const o=E().position(t=>[n.x(t),n.y(t)]);r.call(o)})},t.ensureDefsElement=P,t.every=(t,e)=>{for(const r of e)if(!t(r))return!1;return!0},t.fallbackCanvasUnsupported=()=>!!!document.createElement("canvas").getContext,t.fallbackRender=Ut,t.fallbackUnsupported=()=>!(!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect),t.fastTransition=()=>e.transition().ease(N).duration(50),t.filledArray=u,t.find=h,t.first=f,t.firstTouch=g,t.fitTooltip=function(t,e){const r=Math.min(1*e.innerWidth/4,100),n=Math.max(3*e.innerWidth/4,e.innerWidth-100);return e=>{const a=e.x;return a>n?"right":a<r?"left":t}},t.flatten=t=>t.flat(),t.foldPattern=(t,e)=>{const r=e[t];if("function"==typeof r)return r();throw new Error("[foldPattern] No definition provided for key: "+t)},t.formatAge=t=>String(Math.round(t)),t.formatAxisTimeFormat=Y,t.formatFractionPercent=t=>"".concat(U(100*t)," %"),t.formatLocale=I,t.formatMonth=J,t.formatNone=()=>"",t.formatNumber=U,t.formatPercent=t=>"".concat(U(t)," %"),t.formatPreciseNumber=function t(e,r){return arguments.length>1&&void 0!==r?t(e)(r):t=>{const r=Math.abs(t);return r>=100&&r<1e4?K(".".concat(e,"f"))(t):K(",.".concat(e,"f"))(t)}},t.formatText=X,t.formatYear=V,t.functor=A,t.getAccessibleTextColor=Br,t.getGeoJsonCenter=gn,t.groupedBars=Er,t.groupedBarsHorizontal=()=>Or({inGroupRange:t=>[0,t.groupHeight],x:t=>{let{x:e}=t;return e},y:(t,e)=>{let{groupScale:r}=t;return t=>{var n;return r(t)+(void 0!==t.__sszvisGroupedBarIndex__&&null!==(n=e(t.__sszvisGroupedBarIndex__))&&void 0!==n?n:0)}},width:t=>{let{width:e}=t;return e},height:(t,e)=>e.bandwidth(),missingTransform:(t,e)=>{let{groupScale:r,x:n}=t;return(t,a)=>{var o;return O(n(t,a),r(t)+(void 0!==t.__sszvisGroupedBarIndex__&&null!==(o=e(t.__sszvisGroupedBarIndex__))&&void 0!==o?o:0)+e.bandwidth()/2)}},tooltipPosition:(t,e)=>{let{groupScale:r,x:n}=t;return t=>{let a=0,o=-1/0;for(const[i,l]of t.entries()){var s;const t=l;a+=r(t)+(void 0!==t.__sszvisGroupedBarIndex__&&null!==(s=e(t.__sszvisGroupedBarIndex__))&&void 0!==s?s:0)+e.bandwidth()/2,o=Math.max(o,n(t,i))}return[o,a/t.length]}}}),t.groupedBarsVertical=Tr,t.halfPixel=L,t.handleRuler=function(){return r().prop("x",A).prop("y",A).prop("top").prop("bottom").prop("label").label(A("")).prop("color").prop("flip",A).flip(!1).render(function(t){const r=e.select(this),n=r.props(),a=d(L,n.x),o=d(L,n.y),s=n.bottom-4,i=n.top-24,l=r.selectAll(".sszvis-handleRuler__group").data([0]).join("g").classed("sszvis-handleRuler__group",!0);l.append("line").classed("sszvis-ruler__rule",!0),l.append("rect").classed("sszvis-handleRuler__handle",!0),l.append("line").classed("sszvis-handleRuler__handle-mark",!0),l.selectAll(".sszvis-ruler__rule").attr("x1",a).attr("y1",L(n.top)).attr("x2",a).attr("y2",L(s)),l.selectAll(".sszvis-handleRuler__handle").attr("x",t=>a(t)-5).attr("y",L(i)).attr("width",10).attr("height",24).attr("rx",2).attr("ry",2),l.selectAll(".sszvis-handleRuler__handle-mark").attr("x1",a).attr("y1",L(i+24*.15)).attr("x2",a).attr("y2",L(i+20.4));l.selectAll(".sszvis-ruler__dot").data(t).join("circle").classed("sszvis-ruler__dot",!0).attr("cx",a).attr("cy",o).attr("r",3.5).attr("fill",n.color),r.selectAll(".sszvis-ruler__label-outline").data(t).join("text").classed("sszvis-ruler__label-outline",!0),r.selectAll(".sszvis-ruler__label").data(t).join("text").classed("sszvis-ruler__label",!0),r.selectAll(".sszvis-ruler__label, .sszvis-ruler__label-outline").attr("transform",t=>{const e=d(L,n.x)(t),r=d(L,n.y)(t);return O(e+(n.flip(t)?-10:10),r+(r<n.top?2*r:r>n.bottom?0:5))}).style("text-anchor",t=>n.flip(t)?"end":"start").html(n.label)})},t.hashableSet=(t,e)=>{const r=e||s,n={},a=[];let o;for(let e=0,s=t.length;e<s;++e)o=r(t[e],e,t),n[o]||(n[o]=!0,a.push(o));return a},t.heatTableMissingValuePattern=t=>{const e="#A4A4A4",r=.35,n=.65;t.attr("patternUnits","objectBoundingBox").attr("patternContentUnits","objectBoundingBox").attr("x",0).attr("y",0).attr("width",1).attr("height",1),t.append("rect").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("fill","#FAFAFA"),t.append("line").attr("x1",r).attr("y1",r).attr("x2",n).attr("y2",n).attr("stroke-width",.035).attr("stroke",e),t.append("line").attr("x1",n).attr("y1",r).attr("x2",r).attr("y2",n).attr("stroke-width",.035).attr("stroke",e)},t.identity=s,t.isFunction=t=>"function"==typeof t,t.isNull=m,t.isNumber=t=>"[object Number]"===Object.prototype.toString.call(t)&&!Number.isNaN(t),t.isObject=y,t.isSelection=l,t.isString=i,t.last=v,t.layoutPopulationPyramid=function(t,e){const r=Math.min(xe(t),480),n=1*(e-1);let a=Math.round((r-n)/e);a=Math.max(a,2);const o=e*a+n;let s=o-a;const i=a+1,l=[];for(;s>=0;)l.push(s),s-=i;const c=Math.min(t/2,.8*xe.MAX_HEIGHT/2);return{barHeight:a,padding:1,totalHeight:o,positions:l,maxBarLength:c,chartPadding:Math.max((t-2*c)/2,1)}},t.layoutSmallMultiples=function(){return r().prop("width").prop("height").prop("paddingX").prop("paddingY").prop("rows").prop("cols").prop("showTitle").showTitle(!1).prop("titleLabel").titleLabel(()=>"").prop("titleAnchor").titleAnchor("middle").prop("titleY").titleY(0).render(function(t){const r=e.select(this),n=r.props(),a=(n.width-n.paddingX*(n.cols-1))/n.cols,o=(n.height-n.paddingY*(n.rows-1))/n.rows,s=a/2,i=o/2,l=r.selectAll("g.sszvis-multiple").data(t).join("g").classed("sszvis-g sszvis-multiple",!0);if(l.selectAll("g.sszvis-multiple-chart").data(t=>[t.values]).join("g").classed("sszvis-multiple-chart",!0),l.datum((t,e)=>(t.gx=e%n.cols*(a+n.paddingX),t.gw=a,t.cx=s,t.gy=Math.floor(e/n.cols)*(o+n.paddingY),t.gh=o,t.cy=i,t)).attr("transform",t=>"translate("+t.gx+","+t.gy+")"),n.showTitle){const t="start"===n.titleAnchor?0:"end"===n.titleAnchor?a:s;l.selectAll(".sszvis-multiple-title").data(t=>[t]).join("text").classed("sszvis-multiple-title",!0).attr("x",t).attr("y",n.titleY).attr("text-anchor",n.titleAnchor).text(n.titleLabel)}else l.selectAll(".sszvis-multiple-title").remove()})},t.layoutStackedAreaMultiples=function(t,e,r){r||(r=.1);const n=t/(e-r),a=n*(1-r),o=[];let s=a;for(;s-t<1;)o.push(s),s+=n;return{range:o,bandHeight:a,padHeight:n*r}},t.legendColorBinned=function(){return r().prop("scale").prop("displayValues").prop("endpoints").prop("width").width(200).prop("labelFormat").labelFormat(s).render(function(){const t=e.select(this),r=t.props();if(!r.scale)return we("legend.binnedColorScale - a scale must be specified.");if(!r.displayValues)return we("legend.binnedColorScale - display values must be specified.");if(!r.endpoints)return we("legend.binnedColorScale - endpoints must be specified");const n=[0,r.width-10],a=e.scaleLinear().domain(r.endpoints).range(n);let o=0;const s=[];let i=r.endpoints[0];for(const t of r.displayValues){const e=a(t)-o,n=o%1;s.push({x:Math.floor(5+o),w:e+n,c:r.scale(i),p:t}),o+=e,i=t}s.push({x:Math.floor(5+o),w:n[1]-o,c:r.scale(i)});t.selectAll("circle.sszvis-legend__circle").data(r.endpoints).join("circle").classed("sszvis-legend__circle",!0).attr("r",5).attr("cy",5).attr("cx",(t,e)=>0===e?5:r.width-5).attr("fill",r.scale);t.selectAll("rect.sszvis-legend__crispmark").data(s).join("rect").classed("sszvis-legend__crispmark",!0).attr("x",t=>t.x).attr("y",0).attr("width",t=>t.w).attr("height",10).attr("fill",t=>t.c);const l=s.slice(0,-1);t.selectAll("line.sszvis-legend__crispmark").data(l).join("line").classed("sszvis-legend__crispmark",!0).attr("x1",t=>L(t.x+t.w)).attr("x2",t=>L(t.x+t.w)).attr("y1",11).attr("y2",16).attr("stroke","#B8B8B8");t.selectAll(".sszvis-legend__axislabel").data(l).join("text").classed("sszvis-legend__axislabel",!0).style("text-anchor","middle").attr("transform",t=>"translate("+(t.x+t.w)+",30)").text(t=>r.labelFormat(t.p))})},t.legendColorLinear=function(){return r().prop("scale").prop("displayValues").displayValues([]).prop("width").width(200).prop("segments").segments(8).prop("labelText").prop("labelFormat").labelFormat(s).render(function(){const t=e.select(this),r=t.props();if(!r.scale)return we("legend.linearColorScale - a scale must be specified."),!1;const n=r.scale.domain();let a=r.displayValues;0===a.length&&r.scale.ticks&&(a=r.scale.ticks(r.segments-1)),a.push(v(n));const o=a.length>0?r.width/a.length:0;t.selectAll("rect.sszvis-legend__mark").data(a).join("rect").classed("sszvis-legend__mark",!0).attr("x",(t,e)=>e*o-1).attr("y",0).attr("width",o+1).attr("height",10).attr("fill",t=>r.scale(t));const s=[f(n),v(n)],i=r.labelText||s;t.selectAll("circle.ssvis-legend--mark").data(s).join("circle").attr("class","ssvis-legend--mark").attr("cx",(t,e)=>e*r.width).attr("cy",5).attr("r",5).attr("fill",t=>r.scale(t));const l=t.selectAll(".sszvis-legend__label").data(i).join("text").classed("sszvis-legend__label",!0);l.style("text-anchor",(t,e)=>0===e?"end":"start").attr("dy","0.35em").attr("transform",(t,e)=>"translate("+(e*r.width+16*(0===e?-1:1))+", 5)").text((t,e)=>r.labelFormat(t,e))})},t.legendColorOrdinal=nn,t.legendRadius=function(){return r().prop("scale").prop("tickFormat").tickFormat(s).prop("tickValues").render(function(){const t=e.select(this),r=t.props(),n=r.scale.domain(),a=r.tickValues||[n[1],r.scale.invert(e.mean(r.scale.range())),n[0]],o=Fe(r.scale)[1],s=t.selectAll("g.sszvis-legend__elementgroup").data([0]).join("g").attr("class","sszvis-legend__elementgroup");s.attr("transform",O(L(o),L(o)));function i(t){return o-2*r.scale(t)}s.selectAll("circle.sszvis-legend__greyline").data(a).join("circle").classed("sszvis-legend__greyline",!0).attr("r",r.scale).attr("stroke-width",1).attr("cy",function(t){return o-r.scale(t)});s.selectAll("line.sszvis-legend__dashedline").data(a).join("line").classed("sszvis-legend__dashedline",!0).attr("x1",0).attr("y1",i).attr("x2",o+15).attr("y2",i);s.selectAll(".sszvis-legend__label").data(a).join("text").attr("class","sszvis-legend__label sszvis-legend__label--small").attr("dx",o+18).attr("y",i).attr("dy","0.35em").text(r.tickFormat)})},t.line=function(){return r().prop("x").prop("y").prop("stroke").prop("strokeWidth").prop("defined").prop("key").key((t,e)=>e).prop("valuesAccessor").valuesAccessor(s).prop("transition").transition(!0).render(function(t){const r=e.select(this),n=r.props(),a=e.line().defined(void 0===n.defined?d(b(isNaN),n.y):n.defined).x(n.x).y(n.y);let o=r.selectAll(".sszvis-line").data(t,n.key).join("path").classed("sszvis-line",!0).style("stroke",n.stroke);o.order(),n.transition&&(o=o.transition(R())),o.attr("d",d(a,n.valuesAccessor)).style("stroke",n.stroke).style("stroke-width",n.strokeWidth)})},t.loadError=t=>{we(t)},t.mapLakeFadeGradient=j,t.mapLakeGradientMask=M,t.mapLakePattern=F,t.mapMissingValuePattern=S,t.mapRendererBase=mn,t.mapRendererBubble=function(){const t=e.dispatch("over","out","click"),n=r().prop("mergedData").prop("mapPath").prop("radius",A).prop("fill",A).prop("strokeColor",A).strokeColor("#ffffff").prop("strokeWidth",A).strokeWidth(1).prop("transition").transition(!0).render(function(){const r=e.select(this),n=r.props(),a=d(n.radius,yn),o=r.selectGroup("anchoredCircles").selectAll(".sszvis-anchored-circle").data(n.mergedData,t=>t.geoJson.id).join("circle").attr("class","sszvis-anchored-circle sszvis-anchored-circle--entering").attr("r",a).on("mouseover",function(e){t.call("over",this,e.datum)}).on("mouseout",function(e){t.call("out",this,e.datum)}).on("click",function(e){t.call("click",this,e.datum)}).attr("transform",t=>{const e=n.mapPath.projection()(gn(t.geoJson));return O(e[0],e[1])}).style("fill",t=>n.fill(t.datum)).style("stroke",t=>n.strokeColor(t.datum)).style("stroke-width",t=>n.strokeWidth(t.datum)).sort((t,e)=>n.radius(e.datum)-n.radius(t.datum));if(o.classed("sszvis-anchored-circle--entering",!1),n.transition){const t=R();o.exit().transition(t).attr("r",0).remove(),o.transition(t).attr("r",a)}else o.exit().remove(),o.attr("r",a)});return n.on=function(){const e=t.on.apply(t,arguments);return e===t?n:e},n},t.mapRendererGeoJson=function(){const t=e.dispatch("over","out","click"),n=r().prop("dataKeyName").dataKeyName(hn).prop("geoJsonKeyName").geoJsonKeyName("id").prop("geoJson").prop("mapPath").prop("defined",A).defined(!0).prop("fill",A).fill("black").prop("stroke",A).stroke("black").prop("strokeWidth",A).strokeWidth(1.25).prop("transitionColor").transitionColor(!0).render(function(r){const n=e.select(this),a=n.props();P(n,"pattern","missing-pattern").call(S);const o=_(a.dataKeyName),s=_(a.geoJsonKeyName),i=r.reduce((t,e)=>(t[o(e)]=e,t)),l=a.geoJson.features.map(t=>({geoJson:t,datum:i[s(t.properties)]}));function c(t){return p(t.datum)&&a.defined(t.datum)?a.fill(t.datum):"url(#missing-pattern)"}const d=n.selectAll(".sszvis-map__geojsonelement").data(l).join("path").classed("sszvis-map__geojsonelement",!0).attr("data-event-target","").attr("fill",c);n.selectAll(".sszvis-map__geojsonelement--undefined").attr("fill",c),d.classed("sszvis-map__geojsonelement--undefined",t=>!p(t.datum)||!a.defined(t.datum)).attr("d",t=>a.mapPath(t.geoJson)),a.transitionColor?d.transition().call(B).attr("fill",c):d.attr("fill",c),d.attr("stroke",function(t){return p(t.datum)&&a.defined(t.datum)?a.stroke(t.datum):""}).attr("stroke-width",a.strokeWidth),n.selectAll("[data-event-target]").on("mouseover",e=>{t.over(e.datum)}).on("mouseout",e=>{t.out(e.datum)}).on("click",e=>{t.click(e.datum)});const u=E().position(t=>{t.geoJson.properties||(t.geoJson.properties={});let r=t.geoJson.properties.sphericalCentroid;return r||(t.geoJson.properties.sphericalCentroid=r=e.geoCentroid(t.geoJson)),a.mapPath.projection()(r)});n.selectGroup("tooltipAnchors").datum(l).call(u)});return n.on=function(){const e=t.on.apply(t,arguments);return e===t?n:e},n},t.mapRendererHighlight=vn,t.mapRendererImage=function(){return r().prop("projection").prop("src").prop("geoBounds").prop("opacity").opacity(1).render(function(){const t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-map__image").data([0]).join("img").classed("sszvis-map__image",!0),a=r.projection(r.geoBounds[0]),o=r.projection(r.geoBounds[1]);n.attr("src",r.src).style("left",Math.round(a[0])+"px").style("top",Math.round(a[1])+"px").style("width",Math.round(o[0]-a[0])+"px").style("height",Math.round(o[1]-a[1])+"px").style("opacity",r.opacity)})},t.mapRendererMesh=bn,t.mapRendererPatternedLakeOverlay=_n,t.mapRendererRaster=function(){return r().prop("debug").debug(!1).prop("width").prop("height").prop("position").prop("cellSide").cellSide(2).prop("fill",A).prop("opacity").opacity(1).render(function(t){const r=e.select(this),n=r.props(),a=r.selectAll(".sszvis-map__rasterimage").data([0]).join("canvas").classed("sszvis-map__rasterimage",!0);a.attr("width",n.width).attr("height",n.height).style("opacity",n.opacity);const o=a.node().getContext("2d");o.clearRect(0,0,n.width,n.height),n.debug&&(o.fillStyle="rgba(255, 0, 0, 0.2)",o.fillRect(0,0,n.width,n.height));const s=n.cellSide/2;for(const e of t){const t=n.position(e);o.fillStyle=n.fill(e),o.fillRect(t[0]-s,t[1]-s,n.cellSide,n.cellSide)}})},t.measureAxisLabel=Ke,t.measureDimensions=He,t.measureLegendLabel=Ye,t.measureText=Ge,t.memoize=w,t.modularTextHTML=wn,t.modularTextSVG=Sn,t.move=De,t.muchDarker=t=>e.hsl(t).darker(.7),t.nestedStackedBarsVertical=()=>r().prop("offset",A).prop("xScale",A).prop("yScale",A).prop("fill",A).prop("tooltip",A).prop("xAcc",A).prop("xLabel",A).prop("xLabel",A).prop("slant").render(function(t){const r=e.select(this),n=r.props(),{offset:a,xScale:o,yScale:s,fill:i,tooltip:l,xAcc:c,xLabel:d}=n,p=Pe.ordinal().scale(o).ticks(1).tickSize(0).orient("bottom").slant(n.slant).title(d),u=r.selectAll("[data-nested-stacked-bars]").data(t).join("g").attr("data-nested-stacked-bars",t=>c(t[0][0].data));u.attr("transform",t=>"translate(".concat(a(t)," 0)")),u.selectGroup("nested-x-axis").attr("transform",O(0,s(0))).call(p);const h=Xr().xScale(o).width(o.bandwidth()).yScale(s).fill(i);u.selectGroup("barchart").call(h).selectAll("[data-tooltip-anchor]").call(l)}),t.not=b,t.pack=function(){return r().prop("colorScale").prop("transition").transition(!0).prop("containerWidth").containerWidth(800).prop("containerHeight").containerHeight(600).prop("showLabels").showLabels(!1).prop("label",A).label(t=>t.data&&"key"in t.data?t.data.key:"").prop("minRadius").minRadius(20).prop("circleStroke").circleStroke("#ffffff").prop("circleStrokeWidth").circleStrokeWidth(1).prop("radiusScale",A).prop("onClick").render(function(t){const r=e.select(this),n=r.props();e.pack().size([n.containerWidth,n.containerHeight]).padding(4).radius(n.radiusScale||null)(t);const a=function t(e){const r=[];if(e.children)for(const n of e.children)"root"!==n.data._tag&&r.push(n),r.push(...t(n));else"root"!==e.data._tag&&r.push(e);return r}(t),o=a.filter(t=>t.r>(n.minRadius||1)),s=r.selectAll(".sszvis-pack-circle").data(o).join("circle").classed("sszvis-pack-circle",!0).attr("cx",t=>t.x).attr("cy",t=>t.y).attr("r",t=>t.r).attr("fill",t=>{if(t.children)return"white";if("rootKey"in t.data&&t.data.rootKey)return n.colorScale(t.data.rootKey);const e=t.ancestors(),r=e.find((t,r)=>{var n;return r<e.length-1&&"root"===(null===(n=e[r+1])||void 0===n?void 0:n.data._tag)});return r&&"key"in r.data?n.colorScale(r.data.key):"key"in t.data?n.colorScale(t.data.key):"#cccccc"}).attr("stroke",t=>{if("rootKey"in t.data&&t.data.rootKey)return n.colorScale(t.data.rootKey);const e=t.ancestors(),r=e.find((t,r)=>{var n;return r<e.length-1&&"root"===(null===(n=e[r+1])||void 0===n?void 0:n.data._tag)});return r&&"key"in r.data?n.colorScale(r.data.key):t.children?"key"in t.data?n.colorScale(t.data.key):"#cccccc":n.circleStroke}).attr("stroke-width",t=>t.children?2:n.circleStrokeWidth).style("cursor",n.onClick?"pointer":"default").on("click",(t,e)=>{var r;return null===(r=n.onClick)||void 0===r?void 0:r.call(n,t,e)});if(n.transition&&s.transition(R()).attr("cx",t=>t.x).attr("cy",t=>t.y).attr("r",t=>t.r),n.showLabels){const t=12,e=t=>"function"==typeof n.label?n.label(t):n.label||"",a=t=>t.x,s=e=>e.y+t/3,i=t=>Br((()=>{if("rootKey"in t.data&&t.data.rootKey)return n.colorScale(t.data.rootKey);const e=t.ancestors(),r=e.find((t,r)=>{var n;return r<e.length-1&&"root"===(null===(n=e[r+1])||void 0===n?void 0:n.data._tag)});return r&&"key"in r.data?n.colorScale(r.data.key):"key"in t.data?n.colorScale(t.data.key):"#cccccc"})()),l=o.filter(t=>!t.children).filter(t=>e(t).length<t.r/3),c=r.selectAll(".sszvis-pack-label").data(l).join("text").classed("sszvis-pack-label",!0).attr("x",a).attr("y",s).attr("fill",i).attr("font-size",t).attr("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').attr("text-anchor","middle").attr("dominant-baseline","middle").style("pointer-events","none").text(e);n.transition&&c.transition(R()).attr("x",a).attr("y",s).attr("font-size",t).text(e)}else r.selectAll(".sszvis-pack-label").remove();const i=E().position(t=>[t.x,t.y]);r.call(i)})},t.panning=function(){const t=e.dispatch("start","pan","end"),n=r().prop("elementSelector").render(function(){const r=e.select(this),n=r.props();r.selectAll(n.elementSelector).attr("data-sszvis-behavior-pannable","").classed("sszvis-interactive",!0).on("mouseenter",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this&&t.apply("start",this,r)}).on("mousemove",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this&&t.apply("pan",this,r)}).on("mouseleave",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this&&t.apply("end",this,r)}).on("touchstart",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];r[0].preventDefault(),this&&t.apply("start",this,r)}).on("touchmove",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];r[0].preventDefault();null===(t=>{const e=Te(t);return Ee(e)})(g(r[0]))?this&&t.apply("end",this,r):this&&t.apply("pan",this,r)}).on("touchend",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this&&t.apply("end",this,r)})});return n.on=function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];const o=t.on.apply(t,r);return o===t?n:o},n},t.parseDate=t=>kn(t),t.parseNumber=t=>""===t.trim()?Number.NaN:+t,t.parseYear=t=>zn(t),t.pie=function(){return r().prop("radius").prop("fill").prop("stroke").prop("angle",A).render(function(t){const r=e.select(this),n=r.props(),a=n.stroke||"#FFFFFF";let o=0;for(const e of t)e._a0=o,(null==e.a0||isNaN(e.a0))&&(e.a0=o),o+=n.angle(e),e._a1=o,(null==e.a1||isNaN(e.a1))&&(e.a1=o);const s=e.arc().innerRadius(4).outerRadius(n.radius).startAngle(t=>t.a0).endAngle(t=>t.a1);r.selectAll(".sszvis-path").each((e,r)=>{t[r]&&(t[r].a0=e.a0,t[r].a1=e.a1)}).data(t).join("path").classed("sszvis-path",!0).attr("transform","translate("+n.radius+","+n.radius+")").attr("fill",n.fill).attr("stroke",a).transition(R()).attr("transform","translate("+n.radius+","+n.radius+")").attrTween("d",t=>{const r=e.interpolate(t.a0,t._a0),n=e.interpolate(t.a1,t._a1);return function(e){return t.a0=r(e),t.a1=n(e),s(t)}}).attr("fill",n.fill).attr("stroke",a);const i=E().position(t=>{const e=t.a0+Math.abs(t.a1-t.a0)/2-Math.PI/2,r=2*n.radius/3;return[n.radius+Math.cos(e)*r,n.radius+Math.sin(e)*r]});r.datum(t).call(i)})},t.pixelsFromGeoDistance=function(t,e,r){const n=r/(2*Math.PI*6367475)*360/2,a=[[e[0]-n,e[1]-n],[e[0]+n,e[1]+n]].map(t);return(Math.abs(a[1][0]-a[0][0])+Math.abs(a[1][1]-a[0][1]))/2},t.prepareHierarchyData=function(t,e){if(void 0!==t&&void 0!==e){const r=ln();return e.layers.forEach(t=>{r.layer(t)}),r.value(e.valueAccessor),r.calculate(t)}return ln()},t.prepareMergedGeoData=fn,t.prop=_,t.propOr=x,t.pyramid=function(){return r().prop("barHeight",A).prop("barWidth",A).prop("barPosition",A).prop("barFill",A).barFill("#000").prop("tooltipAnchor").tooltipAnchor([.5,.5]).prop("leftAccessor").prop("rightAccessor").prop("leftRefAccessor").prop("rightRefAccessor").render(function(t){const r=e.select(this),n=r.props(),a=Dr().x(t=>-.5-n.barWidth(t)).y(n.barPosition).height(n.barHeight).width(n.barWidth).fill(n.barFill).tooltipAnchor(n.tooltipAnchor),o=Dr().x(.5).y(n.barPosition).height(n.barHeight).width(n.barWidth).fill(n.barFill).tooltipAnchor(n.tooltipAnchor),s=qr().barPosition(n.barPosition).barWidth(n.barWidth).mirror(!0),i=qr().barPosition(n.barPosition).barWidth(n.barWidth);r.selectGroup("left").datum(n.leftAccessor(t)).call(a),r.selectGroup("right").datum(n.rightAccessor(t)).call(o),r.selectGroup("leftReference").datum(n.leftRefAccessor?[n.leftRefAccessor(t)]:[]).call(s),r.selectGroup("rightReference").datum(n.rightRefAccessor?[n.rightRefAccessor(t)]:[]).call(i)})},t.range=Fe,t.responsiveProps=function(){let t=de();const e={};function r(r){return y(r)&&(p(n=r)&&p(n.width)&&p(n.screenWidth)&&p(n.screenHeight))?Object.keys(e).reduce((n,a)=>{const o=e[a],s=le(t,r);if(!function(t,e){if(!p(t._))return!1;for(const r in t)if(Object.hasOwn(t,r)&&"_"!==r&&!p(se(e,r)))return!1;return!0}(o,t))return Ae("ResponsiveProps - invalid propSpec for "+a+". Make sure you define the '_' fallback and that all breakpoint names are valid."),n;const i=h(t=>p(o[t.name]),s);if(i)n[a]=o[i.name](r.width);else{const t=o._;n[a]="function"==typeof t?t(r.width):t}return n},{}):(Ae("Could not determine the current breakpoint, returning the default props"),Object.keys(e).reduce((t,e,r)=>(t[r]=e,t),{}));var n}return r.prop=(t,n)=>(e[t]=function(t){const e={};return Object.keys(t).forEach(r=>{const n=t[r];e[r]="function"==typeof n?n:()=>n}),e}(n),r),r.breakpoints=function(){if(0===arguments.length)return t;return t=ce(arguments.length<=0?void 0:arguments[0]),r},r},t.roundTransformString=function(t){const e=d(Math.floor,Number);return t.replace(/(translate\()\s*([\d ,.]+)\s*(\))/i,(t,r,n,a)=>r+n.replace(","," ").replace(/\s+/," ").split(" ").map(e).join(",")+a)},t.rulerLabelVerticalSeparate=t=>r=>{const n=[];r.selectAll("text").each(function(){e.select(this).attr("y","")}),r.selectAll(".sszvis-ruler__label").each(function(e){const r=this.getBoundingClientRect();n.push({category:t(e),top:r.top,bottom:r.bottom,dy:0})}),n.sort((t,r)=>e.ascending(t.top,r.top));for(let t=0;t<10;t++)for(let t=0;t<n.length;t++)for(let e=t+1;e<n.length;e++){if(t===e)continue;const r=n[t],a=n[e],o=r.bottom-a.top;o>=2&&(r.bottom-=o/2,r.top-=o/2,r.dy-=o/2,a.bottom+=o/2,a.top+=o/2,a.dy+=o/2)}r.selectAll("text").each(function(r){const a=h(e=>e.category===t(r),n);a&&e.select(this).attr("y",a.dy)})},t.sankey=function(){return r().prop("sizeScale").prop("columnPosition").prop("nodeThickness").prop("nodePadding").prop("columnPadding",A).prop("columnLabel",A).columnLabel("").prop("columnLabelOffset",A).columnLabelOffset(0).prop("linkCurvature").linkCurvature(.5).prop("nodeColor",A).prop("linkColor",A).prop("linkSort",A).linkSort((t,e)=>t.value-e.value).prop("labelSide",A).labelSide("left").prop("labelSideSwitch").prop("labelOpacity",A).labelOpacity(1).prop("labelHitBoxSize").labelHitBoxSize(0).prop("nameLabel").nameLabel(s).prop("linkSourceLabels").linkSourceLabels([]).prop("linkTargetLabels").linkTargetLabels([]).prop("linkLabel",A).render(function(t){const r=e.select(this),n=r.props(),a=_("id"),o=function(t){return Math.floor(n.columnPadding(t.columnIndex)+n.sizeScale(t.valueOffset)+n.nodePadding*t.nodeIndex)},s=function(t){return n.columnPosition(t.columnIndex)},i=function(t){return o(t)},l=function(){return Math.max(n.nodeThickness,1)},c=function(t){return Math.ceil(Math.max(n.sizeScale(t.value),1))},d=Dr().x(s).y(i).width(l).height(c).fill(n.nodeColor),p=r.selectGroup("nodes").datum(t.nodes);p.call(d);const u=E().position(t=>[s(t)+l()/2,i(t)+c(t)/2]);p.call(u);const h=function(t){return n.columnPosition(t)+n.nodeThickness/2};p.selectAll(".sszvis-sankey-column-label").data(t.columnLengths).join("text").attr("class","sszvis-sankey-label sszvis-sankey-weak-label sszvis-sankey-column-label").attr("transform",(t,e)=>O(h(e)+n.columnLabelOffset(t,e),-24)).text((t,e)=>n.columnLabel(e));p.selectAll(".sszvis-sankey-column-label-tick").data(t.columnLengths).join("line").attr("class","sszvis-sankey-column-label-tick").attr("x1",(t,e)=>L(h(e))).attr("x2",(t,e)=>L(h(e))).attr("y1",L(-16)).attr("y2",L(-12));const f=function(t){return[n.columnPosition(t.src.columnIndex)+n.nodeThickness+1,n.columnPosition(t.tgt.columnIndex)-1,o(t.src)+n.sizeScale(t.srcOffset)+n.sizeScale(t.value)/2,o(t.tgt)+n.sizeScale(t.tgtOffset)+n.sizeScale(t.value)/2]},g=function(t){const e=f(t);return r=e[0],n=e[1],a=e[2],o=e[3],[r,n,a,o];var r,n,a,o},m=r.selectGroup("links");m.selectAll(".sszvis-link").data(t.links,a).join("path").attr("class","sszvis-link").attr("fill","none").attr("d",function(t){const r=f(t),a=e.interpolateNumber(r[0],r[1]),o=a(n.linkCurvature),s=a(1-n.linkCurvature);return i=r[0],l=o,c=s,d=r[1],p=r[2],u=r[3],"M"+i+","+p+"C"+l+","+p+" "+c+","+u+" "+d+","+u;var i,l,c,d,p,u}).attr("stroke-width",function(t){return Math.max(n.sizeScale(t.value),1)}).attr("stroke",n.linkColor).sort(n.linkSort),m.datum(t.links);const y=E().position(t=>{const e=g(t);return[(e[0]+e[1])/2,(e[2]+e[3])/2]});m.call(y);const v=r.selectGroup("linklabels");v.selectAll(".sszvis-sankey-link-source-label").data(n.linkSourceLabels).join("text").attr("class","sszvis-sankey-label sszvis-sankey-strong-label sszvis-sankey-link-source-label").attr("transform",t=>{const e=g(t);return O(e[0]+6,e[2])}).text(n.linkLabel);v.selectAll(".sszvis-sankey-link-target-label").data(n.linkTargetLabels).join("text").attr("class","sszvis-sankey-label sszvis-sankey-strong-label sszvis-sankey-link-target-label").attr("transform",t=>{const e=g(t);return O(e[1]-6,e[3])}).text(n.linkLabel);const b=function(t){let e=n.labelSide(t);return n.labelSideSwitch&&(e="left"===e?"right":"left"),e},x=r.selectGroup("nodelabels");x.selectAll(".sszvis-sankey-node-label").data(t.nodes).join("text").attr("class","sszvis-sankey-label sszvis-sankey-weak-label sszvis-sankey-node-label").text(t=>n.nameLabel(t.id)).attr("text-align","middle").attr("text-anchor",t=>"left"===b(t.columnIndex)?"end":"start").attr("x",t=>"left"===b(t.columnIndex)?s(t)-6:s(t)+n.nodeThickness+6).attr("y",t=>i(t)+c(t)/2).style("opacity",n.labelOpacity);x.selectAll(".sszvis-sankey-hitbox").data(t.nodes).join("rect").attr("class","sszvis-sankey-hitbox").attr("fill","transparent").attr("x",t=>s(t)+("left"===b(t.columnIndex)?-n.labelHitBoxSize:0)).attr("y",t=>i(t)-n.nodePadding/2).attr("width",n.labelHitBoxSize+n.nodeThickness).attr("height",t=>c(t)+n.nodePadding)})},t.sankeyLayout=function(t,r,n,a){const o=e.min(t.map(t=>{const e=.15*n/(t-1);return Math.max(12,Math.min(50,e))})),s=e.min(t.map((t,e)=>Math.max(1,n-(t-1)*o)/r[e])),i=o/s,l=o,c=e.max(r),d=t.map((t,e)=>r[e]*s+(t-1)*l),p=e.max(d),u=t.map((t,e)=>(p-d[e])/2),h=[0,c],f=[0,c*s],g=t.length;return{valuePadding:i,nodePadding:l,columnPaddings:u,valueDomain:h,valueRange:f,nodeThickness:20,columnDomain:[0,1],columnRange:[0,(a-20)/(g-1)]}},t.sankeyPrepareData=function(){let t=s,r=s,n=s,a=[];const o=_("value"),i=function(t,r){return e.ascending(o(t),o(r))},l=function(t,r){return e.descending(o(t),o(r))};let c=l;const d=function(s){const i=a.reduce((t,e,r)=>{for(const n of e){t.has(n)&&Ae("Duplicate column member id passed to sszvis.layout.sankey.prepareData.column:",n,"The existing value will be overwritten");const e={id:n,columnIndex:r,nodeIndex:0,value:0,valueOffset:0,linksFrom:[],linksTo:[]};t.set(n,e)}return t},new Map),d=s.map(e=>{const a=t(e),o=r(e),s=+n(e)||0,l=i.get(a),c=i.get(o);if(!l)return Ae("Found invalid source column id:",a),null;if(!c)return Ae("Found invalid target column id:",o),null;const d={id:dn(),value:s,src:l,srcOffset:0,tgt:c,tgtOffset:0};return l.linksFrom.push(d),c.linksTo.push(d),d}),p=[...i.values()],h=p.reduce((t,r)=>{const n=e.sum(r.linksFrom,o),a=e.sum(r.linksTo,o);return r.value=Math.max(0,n,a),t[r.columnIndex]+=r.value,t},u(a.length,0)),f=a.map(t=>t.length);p.sort(c),d.sort(l),p.reduce((t,e)=>(e.valueOffset=t[0][e.columnIndex],e.nodeIndex=t[1][e.columnIndex],t[0][e.columnIndex]+=e.value,t[1][e.columnIndex]+=1,t),[u(a.length,0),u(a.length,0)]);for(const t of p)t.linksFrom.sort((t,e)=>t.tgt.nodeIndex-e.tgt.nodeIndex),t.linksTo.sort((t,e)=>t.src.nodeIndex-e.src.nodeIndex),t.linksFrom.reduce((t,e)=>(e.srcOffset=t,t+o(e)),0),t.linksTo.reduce((t,e)=>(e.tgtOffset=t,t+o(e)),0);return{nodes:p,links:d,columnTotals:h,columnLengths:f}};return d.apply=function(t){return d(t)},d.source=function(e){return t=e,d},d.target=function(t){return r=t,d},d.value=function(t){return n=t,d},d.descendingSort=function(){return c=l,d},d.ascendingSort=function(){return c=i,d},d.idLists=function(t){return a=t,d},d},t.scaleDeepGry=Cr,t.scaleDimGry=jr,t.scaleDivNtr=kr,t.scaleDivNtrGry=zr,t.scaleDivVal=_r,t.scaleDivValGry=xr,t.scaleGender3=()=>qe(["#349894","#FFD736","#986AD5"])().domain(["Frauen","Männer","Divers"]),t.scaleGender5Wedding=()=>qe(["#349894","#FFD736","#3431DE","#B8B8B8","#D6D6D6"])().domain(["Frau / Frau","Mann / Mann","Frau / Mann","Frau / Unbekannt","Mann / Unbekannt"]),t.scaleGender6Origin=()=>qe(["#00615D","#349894","#DA9C00","#FFD736","#5E359A","#986AD5"])().domain(["Schweizerinnen","Ausländerinnen","Schweizer","Ausländer","Divers Schweiz","Divers Ausland"]),t.scaleGry=Fr,t.scaleLightGry=wr,t.scaleMedGry=Mr,t.scalePaleGry=Sr,t.scaleQual12=dr,t.scaleQual6=pr,t.scaleQual6a=ur,t.scaleQual6b=hr,t.scaleSeqBlu=gr,t.scaleSeqBrn=vr,t.scaleSeqGrn=yr,t.scaleSeqRed=mr,t.selectMenu=function(){return r().prop("values").prop("current").prop("width").width(300).prop("change").change(s).render(function(){const t=e.select(this),r=t.props(),n=t.selectAll(".sszvis-control-optionSelectable").data(["sszvis-control-select"],t=>t).join("div").classed("sszvis-control-optionSelectable",!0).classed("sszvis-control-select",!0);n.style("width",r.width+"px");const a=n.selectDiv("selectMetrics").classed("sszvis-control-select__metrics",!0),o=n.selectAll(".sszvis-control-select__element").data([1]).join("select").classed("sszvis-control-select__element",!0).on("change",function(t){const n=e.select(this).property("value");r.change(t,r.values[n]),setTimeout(()=>{window.focus()},0)});o.style("width",r.width+30+"px"),o.selectAll("option").data(r.values).join("option").attr("selected",t=>t===r.current?"selected":null).attr("value",(t,e)=>e).text(t=>function(t,e,r){const n=1e3,a=function(r,o){t.text(r);const s=Math.ceil(t.node().clientWidth);return o<n&&s>e?a(r.slice(0,-2)+"…",o+1):r};return a(r,0)}(a,r.width-40,t))})},t.set=k,t.slider=function(){return r().prop("scale").prop("value").prop("onchange").prop("minorTicks").minorTicks([]).prop("majorTicks").majorTicks([]).prop("tickLabels",A).prop("slant").tickLabels(s).prop("label",A).label(s).render(function(){const t=e.select(this),r=t.props(),n=L(18),a=r.scale.domain(),o=Fe(r.scale),s=r.scale.copy().range([o[0]+5.5,o[1]-5.5]),i=t.selectAll("g.sszvis-control-slider__backgroundgroup").data([1]).join("g").classed("sszvis-control-slider__backgroundgroup",!0),l=Pe().scale(s).orient("bottom").slant(r.slant).hideBorderTickThreshold(0).tickSize(12).tickPadding(6).tickValues(k([...r.majorTicks,...r.minorTicks])).tickFormat(t=>rn(t,r.majorTicks)?r.tickLabels(t):""),c=i.selectAll("g.sszvis-axisGroup").data([1]).join("g").classed("sszvis-axisGroup sszvis-axis sszvis-axis--bottom sszvis-axis--slider",!0);c.attr("transform",O(0,28)).call(l),c.selectAll(".tick line").filter(t=>!rn(t,r.majorTicks)).attr("y2",4);const p=c.selectAll(".tick text").filter(t=>rn(t,r.majorTicks));if(!r.slant||"horizontal"===r.slant){const t=p.size();p.style("text-anchor",(e,r)=>0===r?"start":r===t-1?"end":"middle")}"vertical"===r.slant&&(p.attr("dx","-1.8em"),p.attr("dy","-1.5em")),"diagonal"===r.slant&&(p.attr("dx","-1.6em"),p.attr("dy","0.2em"));const u=i.selectAll("g.sszvis-slider__background").data([1]).join("g").classed("sszvis-slider__background",!0).attr("transform",O(0,n));u.selectAll(".sszvis-slider__background__bg1").data([1]).join("line").classed("sszvis-slider__background__bg1",!0).style("stroke-width",6).style("stroke","#888").style("stroke-linecap","round").attr("x1",Math.ceil(o[0]+3)).attr("x2",Math.floor(o[1]-3)),u.selectAll(".sszvis-slider__background__bg2").data([1]).join("line").classed("sszvis-slider__background__bg2",!0).style("stroke-width",5).style("stroke","#fff").style("stroke-linecap","round").attr("x1",Math.ceil(o[0]+3)).attr("x2",Math.floor(o[1]-3)),u.selectAll(".sszvis-slider__backgroundshadow").data([r.value]).join("line").attr("class","sszvis-slider__backgroundshadow").attr("stroke-width",5).style("stroke","#E0E0E0").style("stroke-linecap","round").attr("x1",Math.ceil(o[0]+3)).attr("x2",d(Math.floor,s));const h=t.selectAll("g.sszvis-control-slider__handle").data([r.value]).join("g").classed("sszvis-control-slider__handle",!0).attr("transform",t=>O(L(s(t)),.5));h.append("text").classed("sszvis-control-slider--label",!0),h.selectAll(".sszvis-control-slider--label").data(t=>[t]).text(r.label).style("text-anchor",t=>z(t,a[0])?"start":z(t,a[1])?"end":"middle").attr("dx",t=>z(t,a[0])?-5:z(t,a[1])?5:0),h.selectAll(".sszvis-control-slider__handlebox").data([1]).join("rect").classed("sszvis-control-slider__handlebox",!0).attr("x",-5).attr("y",n-11.5).attr("width",10).attr("height",23).attr("rx",2).attr("ry",2);h.selectAll(".sszvis-control-slider__handleline").data([1]).join("line").classed("sszvis-control-slider__handleline",!0).attr("y1",n-7.5).attr("y2",n+7.5);const f=De().xScale(r.scale).yScale(e.scaleLinear().range([-11,40])).draggable(!0).on("drag",r.onchange);t.selectGroup("sliderInteraction").classed("sszvis-control-slider--interactionLayer",!0).attr("transform",O(0,4)).call(f)})},t.slightlyDarker=t=>e.hsl(t).darker(.4),t.slowTransition=B,t.some=(t,e)=>{for(const r of e)if(t(r))return!0;return!1},t.stackedArea=function(){return r().prop("x").prop("y0").prop("y1").prop("fill").prop("stroke").prop("strokeWidth").prop("defined").prop("key").key((t,e)=>e).prop("transition").transition(!0).render(function(t){const r=e.select(this),n=r.props(),a=e.area().defined(void 0===n.defined?function(){return d(b(isNaN),n.y0)&&d(b(isNaN),n.y1)}:n.defined).x(n.x).y0(n.y0).y1(n.y1);let o=r.selectAll("path.sszvis-path").data(t,n.key).join("path").classed("sszvis-path",!0);n.transition&&(o=o.transition(R())),o.attr("d",a).attr("fill",n.fill).attr("stroke",n.stroke||"#ffffff").attr("stroke-width",void 0===n.strokeWidth?1:n.strokeWidth)})},t.stackedAreaMultiples=function(){return r().prop("x").prop("y0").prop("y1").prop("fill").prop("stroke").prop("strokeWidth").prop("defined").prop("key").key((t,e)=>e).prop("valuesAccessor").valuesAccessor(s).prop("transition").transition(!0).render(function(t){const r=e.select(this),n=r.props();t=[...t].reverse();const a=e.area().defined(void 0===n.defined?function(){return d(b(isNaN),n.y0)&&d(b(isNaN),n.y1)}:n.defined).x(n.x).y0(n.y0).y1(n.y1),o=r.selectAll("path.sszvis-path").data(t,n.key).join("path").classed("sszvis-path",!0);n.transition&&o.transition(R()),o.attr("d",d(a,n.valuesAccessor)).attr("fill",n.fill).attr("stroke",n.stroke).attr("stroke-width",void 0===n.strokeWidth?1:n.strokeWidth)})},t.stackedBarHorizontal=function(){return Jr(Vr)},t.stackedBarHorizontalData=Kr,t.stackedBarVertical=Xr,t.stackedBarVerticalData=Yr,t.stackedPyramid=function(){return r().prop("barHeight",A).prop("barWidth",A).prop("barPosition",A).prop("barFill",A).barFill("#000").prop("tooltipAnchor").tooltipAnchor([.5,.5]).prop("leftAccessor").prop("rightAccessor").prop("leftRefAccessor").prop("rightRefAccessor").render(function(t){const r=e.select(this),n=r.props(),a=Dr().x(t=>-.5-n.barWidth(t[1])).y(d(n.barPosition,Zr)).height(n.barHeight).width(t=>n.barWidth(t[1])-n.barWidth(t[0])).fill(d(n.barFill,Qr)).tooltipAnchor(n.tooltipAnchor),o=Dr().x(t=>.5+n.barWidth(t[0])).y(d(n.barPosition,Zr)).height(n.barHeight).width(t=>n.barWidth(t[1])-n.barWidth(t[0])).fill(d(n.barFill,Qr)).tooltipAnchor(n.tooltipAnchor),s=$r().stackElement(a),i=$r().stackElement(o),l=tn().barPosition(n.barPosition).barWidth(n.barWidth).mirror(!0),c=tn().barPosition(n.barPosition).barWidth(n.barWidth);r.selectGroup("leftStack").datum(n.leftAccessor(t)).call(s),r.selectGroup("rightStack").datum(n.rightAccessor(t)).call(i),r.selectGroup("leftReference").datum(n.leftRefAccessor?[n.leftRefAccessor(t)]:[]).call(l),r.selectGroup("rightReference").datum(n.rightRefAccessor?[n.rightRefAccessor(t)]:[]).call(c)})},t.stackedPyramidData=function(t,r,n,a){return function(o){const s=Xe().arrayBy(t).arrayBy(r).objectBy(n).apply(o).map(r=>{const n=Object.keys(r[0]),o=t(r[0][n[0]][0]),s=e.stack().keys(n).value((t,e)=>a(t[e][0]))(r);for(const[t,e]of s.entries())for(const[r,s]of e.entries())s.data=s.data[n[t]][0],s.series=n[t],s.side=o,s.row=r,s.value=a(s.data);return s});return s.maxValue=e.max(s,t=>e.max(t,t=>e.max(t,t=>t[1]))),s}},t.stringEqual=z,t.sunburst=function(){return r().prop("angleScale").angleScale(e.scaleLinear().range([0,2*Math.PI])).prop("radiusScale").prop("centerRadius").prop("fill").prop("stroke").stroke("white").render(function(t){const r=e.select(this),n=r.props();let a;if(Array.isArray(t))a=t;else{function u(t){return Array.prototype.concat.apply([t],(t.children||[]).map(u))}e.partition()(t),a=u(t).filter(t=>"root"!==t.data._tag)}const o=function(t){return Math.max(0,Math.min(en,n.angleScale(t.x0)))},s=function(t){return Math.max(0,Math.min(en,n.angleScale(t.x1)))},i=function(t){return n.centerRadius+Math.max(0,n.radiusScale(t.y0))},l=function(t){return n.centerRadius+Math.max(0,n.radiusScale(t.y1))},c=e.arc().startAngle(o).endAngle(s).innerRadius(i).outerRadius(l);for(const h of a)h._x0=h.x0,h._x1=h.x1;const d=r.selectAll(".sszvis-sunburst-arc").each((t,e)=>{a[e]&&(a[e].x0=t.x0,a[e].x1=t.x1)}).data(a).join("path").attr("class","sszvis-sunburst-arc");d.attr("stroke",n.stroke).attr("fill",function t(r){if("root"===r.data._tag)return"transparent";if(r.parent){if("root"===r.parent.data._tag)return e.hsl(n.fill(r.data.key));{const e=t(r.parent);return e.l*=1.15,e}}return Ae("Data passed to sszvis.component.sunburst does not have the expected tree structure. You should prepare it using sszvis.prepareHierarchyData"),e.hsl(n.fill(r.data.key))}),d.transition(R()).attrTween("d",t=>{const r=e.interpolate(t.x0,t._x0),n=e.interpolate(t.x1,t._x1);return function(e){return t.x0=r(e),t.x1=n(e),c(t)}});const p=E().position(t=>{const e=o(t),r=s(t),n=e+Math.abs(r-e)/2-Math.PI/2,a=(i(t)+l(t))/2;return[Math.cos(n)*a,Math.sin(n)*a]});r.call(p)})},t.sunburstGetRadiusExtent=t=>[e.min(t,t=>t.y0),e.max(t,t=>t.y1)],t.sunburstLayout=(t,e)=>{const r=e/2,n=r/3;return{centerRadius:n,numLayers:t,ringWidth:Math.max(10,Math.min(60,(r-n)/t))}},t.swissMapPath=un,t.swissMapProjection=pn,t.textWrap=je,t.timeLocale=H,t.tooltip=function(){const t=Z();return r().delegate("header",t).delegate("body",t).delegate("orientation",t).delegate("dx",t).delegate("dy",t).delegate("opacity",t).prop("renderInto").prop("visible",A).visible(!1).renderSelection(e=>{const r=e.props(),n=r.renderInto.node().getBoundingClientRect(),a=[];e.each(function(t){if(r.visible(t)){const e=this.getBoundingClientRect(),r=[e.left-n.left,e.top-n.top];a.push({datum:t,x:r[0],y:r[1]})}}),r.renderInto.datum(a).call(t)})},t.tooltipAnchor=E,t.transformTranslateSubpixelShift=D,t.translateString=O,t.treemap=function(){return r().prop("colorScale").prop("transition").transition(!0).prop("containerWidth").containerWidth(800).prop("containerHeight").containerHeight(600).prop("showLabels").showLabels(!1).prop("label",A).label(t=>t.data&&"key"in t.data?t.data.key:"").prop("labelPosition").labelPosition("center").prop("onClick").render(function(t){const r=e.select(this),n=r.props();e.treemap().tile(e.treemapSquarify).size([n.containerWidth,n.containerHeight]).round(!0).paddingInner(1).paddingOuter(2)(t);const a=function t(e){const r=[];if(e.children)for(const n of e.children)"root"!==n.data._tag&&r.push(n),r.push(...t(n));else"root"!==e.data._tag&&r.push(e);return r}(t),o=a.filter(t=>t.x1-t.x0>.5&&t.y1-t.y0>.5).filter(t=>!t.children),s=r.selectAll(".sszvis-treemap-rect").data(o).join("rect").classed("sszvis-treemap-rect",!0).attr("x",t=>t.x0).attr("y",t=>t.y0).attr("width",t=>t.x1-t.x0).attr("height",t=>t.y1-t.y0).attr("fill",t=>{if("rootKey"in t.data&&t.data.rootKey)return n.colorScale(t.data.rootKey);const e=t.ancestors(),r=e.find((t,r)=>{var n;return r<e.length-1&&"root"===(null===(n=e[r+1])||void 0===n?void 0:n.data._tag)});return r&&"key"in r.data?n.colorScale(r.data.key):"key"in t.data?n.colorScale(t.data.key):"#cccccc"}).attr("stroke","#ffffff").attr("stroke-width",1).style("cursor",n.onClick?"pointer":"default").on("click",(t,e)=>{var r;return null===(r=n.onClick)||void 0===r?void 0:r.call(n,t,e)});if(n.transition&&s.transition(R()).attr("x",t=>t.x0).attr("y",t=>t.y0).attr("width",t=>t.x1-t.x0).attr("height",t=>t.y1-t.y0),n.showLabels){const t=12,e=(e,r)=>{switch(r){case"top-left":default:return{x:e.x0+8,y:e.y0+t+8};case"center":return{x:e.x0+(e.x1-e.x0)/2,y:e.y0+(e.y1-e.y0)/2+t/3};case"top-right":return{x:e.x1-8,y:e.y0+t+8};case"bottom-left":return{x:e.x0+8,y:e.y1-8};case"bottom-right":return{x:e.x1-8,y:e.y1-8}}},a=t=>"function"==typeof n.label?n.label(t):n.label||"",s=t=>e(t,n.labelPosition||"top-left").x,i=t=>e(t,n.labelPosition||"top-left").y,l=t=>Br((()=>{if("rootKey"in t.data&&t.data.rootKey)return n.colorScale(t.data.rootKey);const e=t.ancestors(),r=e.find((t,r)=>{var n;return r<e.length-1&&"root"===(null===(n=e[r+1])||void 0===n?void 0:n.data._tag)});return r&&"key"in r.data?n.colorScale(r.data.key):"key"in t.data?n.colorScale(t.data.key):"#cccccc"})()),c=o.filter(t=>!t.children).filter(t=>a(t).length<(t.x1-t.x0)/7),d=r.selectAll(".sszvis-treemap-label").data(c).join("text").classed("sszvis-treemap-label",!0).attr("x",s).attr("y",i).attr("fill",l).attr("font-size",t).attr("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("pointer-events","none").attr("text-anchor",()=>{switch(n.labelPosition||"top-left"){case"top-right":case"bottom-right":return"end";case"center":return"middle";default:return"start"}}).attr("dominant-baseline",()=>{switch(n.labelPosition||"top-left"){case"center":return"middle";case"bottom-left":case"bottom-right":return"alphabetic";default:return"hanging"}}).text(a);n.transition&&d.transition(R()).attr("x",s).attr("y",i).attr("font-size",t).text(a)}else r.selectAll(".sszvis-treemap-label").remove();const i=E().position(t=>[(t.x0+t.x1)/2,(t.y0+t.y1)/2]);r.call(i)})},t.viewport=re,t.voronoi=function(){const t=e.dispatch("over","out"),n=r().prop("x").prop("y").prop("bounds").prop("debug").render(function(r){const n=e.select(this),a=n.props();if(!a.bounds)return void we("behavior.voronoi - requires bounds");const o=e.Delaunay.from(r,t=>a.x(t),t=>a.y(t)),s=o.voronoi(a.bounds),i=n.selectAll("[data-sszvis-behavior-voronoi]").data(s.cellPolygons()).join("path").attr("data-sszvis-behavior-voronoi","").attr("data-sszvis-behavior-pannable","").attr("class","sszvis-interactive");i.attr("d",t=>"M".concat(t.join("L"),"Z")).attr("fill","transparent").on("mouseover",function(e){const n=this.parentNode;if(!n)return;const s=n.getBoundingClientRect(),i=o.find(e.clientX-s.left,e.clientY-s.top);Ie(e,[s.left+a.x(r[i]),s.top+a.y(r[i])])&&this&&t.apply("over",this,[e,r[i]])}).on("mousemove",function(e){const n=this.parentNode;if(!n)return;const s=n.getBoundingClientRect(),i=o.find(e.clientX-s.left,e.clientY-s.top);Ie(e,[s.left+a.x(r[i]),s.top+a.y(r[i])])?this&&t.apply("over",this,[e,r[i]]):this&&t.apply("out",this,[e])}).on("mouseout",function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this&&t.apply("out",this,r)}).on("touchstart",function(n){const s=this.parentNode;if(!s)return;const i=s.getBoundingClientRect(),l=g(n);if(!l)return;const c=o.find(l.clientX-i.left,l.clientY-i.top);if(Ie(l,[i.left+a.x(r[c]),i.top+a.y(r[c])])){n.preventDefault(),this&&t.apply("over",this,[n,r[c]]);const o=this,s=()=>{const e=g(n);if(!e)return;const r=Te(e),s=Ee(r);if(null===s)o&&t.apply("out",o,[n]);else{const i=null==r?void 0:r.parentNode;if(!i)return;const l=i.getBoundingClientRect();Ie(e,[l.left+a.x(s.data),l.top+a.y(s.data)])?(n.cancelable&&n.preventDefault(),o&&t.apply("over",o,[n,s.data])):o&&t.apply("out",o,[n])}},i=()=>{o&&t.apply("out",o,[n]),e.select(o).on("touchmove",null).on("touchend",null)};e.select(this).on("touchmove",s).on("touchend",i)}}),a.debug&&i.attr("stroke","#f00")});return n.on=function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];const o=t.on.apply(t,r);return o===t?n:o},n},t.widthAdaptiveMapPathStroke=function(t){return Math.min(Math.max(.8,t/400),1.1)},t.withAlpha=(t,r)=>{const n=e.rgb(t);return"rgba(".concat(n.r,",").concat(n.g,",").concat(n.b,",").concat(r,")")}});
//# sourceMappingURL=sszvis.min.js.map
