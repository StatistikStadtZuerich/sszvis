/*! sszvis v3.2.1, Copyright 2014-present Statistik Stadt Zürich */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).sszvis={},t.d3)}(this,function(t,e){"use strict";function r(){const t={};let e=null,r=a;function o(a){e&&(a.props=()=>s(t),e.apply(a,n(arguments))),a.each(function(){this.__props__=s(t),r.apply(this,n(arguments))})}return o.prop=(e,r)=>(r||(r=a),o[e]=function(t,e,r){return r||(r=a),function(){return 0===arguments.length?t[e]:(t[e]=r.apply(null,n(arguments)),this)}}(t,e,r.bind(o)).bind(o),o),o.delegate=(t,e)=>(o[t]=()=>{const r=e[t].apply(e,n(arguments));return 0===arguments.length?r:o},o),o.renderSelection=t=>(e=t,o),o.render=t=>(r=t,o),o}function a(t){return t}function n(t){return Array.prototype.slice.call(t)}function s(t){const e={};for(const r in t)Object.hasOwn(t,r)&&(e[r]=t[r]);return e}e.selection.prototype.selectDiv=function(t){return this.selectAll('[data-d3-selectdiv="'+t+'"]').data(t=>[t]).join("div").attr("data-d3-selectdiv",t).style("position","absolute")},e.selection.prototype.selectGroup=function(t){return this.selectAll('[data-d3-selectgroup="'+t+'"]').data(t=>[t]).join("g").attr("data-d3-selectgroup",t)},e.selection.prototype.props=function(){if(arguments.length>0)throw new Error("selection.props() does not accept any arguments");if(1!=this.size())throw new Error("only one group is supported");if(1!=this._groups[0].length)throw new Error("only one node is supported");return this._groups[0][0].__props__||{}};const o=t=>t,i=t=>"[object String]"===Object.prototype.toString.call(t),l=t=>t instanceof e.selection,c=(t,e)=>{switch(t){case 0:return function(){return e.call(this)};case 1:return function(t){return e.call(this,t)};case 2:return function(t,r){return e.call(this,t,r)};case 3:return function(t,r,a){return e.call(this,t,r,a)};case 4:return function(t,r,a,n){return e.call(this,t,r,a,n)};case 5:return function(t,r,a,n,s){return e.call(this,t,r,a,n,s)};case 6:return function(t,r,a,n,s,o){return e.call(this,t,r,a,n,s,o)};case 7:return function(t,r,a,n,s,o,i){return e.call(this,t,r,a,n,s,o,i)};case 8:return function(t,r,a,n,s,o,i,l){return e.call(this,t,r,a,n,s,o,i,l)};case 9:return function(t,r,a,n,s,o,i,l,c){return e.call(this,t,r,a,n,s,o,i,l,c)};case 10:return function(t,r,a,n,s,o,i,l,c,p){return e.call(this,t,r,a,n,s,o,i,l,c,p)};default:return e}},p=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const a=e.length-1;return function(){let t=a;for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];let o=Reflect.apply(e[t],this,n);for(;t--;)o=e[t].call(this,o);return o}},d=t=>void 0!==t&&null!=t&&!Number.isNaN(t),u=(t,e)=>{const r=Array.from({length:t});for(let a=0;a<t;++a)r[a]=e;return r},h=(t,e)=>{for(const r of e)if(t(r))return r},f=t=>t[0],g=t=>t.touches&&t.touches.length>0?t.touches[0]:t.changedTouches&&t.changedTouches.length>0?t.changedTouches[0]:null,m=t=>null===t,y=t=>Object(t)===t,v=t=>t[t.length-1],b=t=>function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return!Reflect.apply(t,this,r)},_=t=>e=>e[t],k=(t,e)=>r=>{const a=void 0===r?void 0:r[t];return void 0===a?e:a},x=(t,e)=>{const r=e||o;return t.reduce((e,a,n)=>{const s=r(a,n,t);return e.includes(s)?e:[...e,s]},[])},z=(t,e)=>t.toString()===e.toString(),A=t=>"function"==typeof t?t:()=>t,w=(t,e)=>{if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");const r=function(){const a=e?e(...arguments):arguments.length<=0?void 0:arguments[0],n=r.cache;if(n.has(a))return n.get(a);const s=t(...arguments);return r.cache=n.set(a,s)||n,s};return r.cache=new Map,r};function S(t){return()=>ot(e.scaleOrdinal().range(t.map(lt)).unknown(lt(t[0])))}const j="#3431DE",F="#0A8DF6",M="#23C3F1",P="#7B4FB7",R="#DB247D",C="#FB737E",D="#007C78",T="#1D942E",O="#99C32E",L="#9A5B01",B="#FF720C",E="#FBB900",W=S([j,F,M,P,R,C,D,T,O,L,B,E]),N=S([j,R,T,E,M,B]),G=S([j,F,M,P,R,C]),H=S([D,T,O,L,B,E]);function I(t){return()=>it(e.scaleLinear().range(t.map(lt)))}const J=I(["#CADEFF","#5B6EFF","#211A8A"]),V=I(["#FED2EE","#ED408D","#7D0044"]),Y=I(["#CFEED8","#34B446","#0C4B1F"]),U=I(["#FCDDBB","#EA5D00","#611F00"]);function K(t){return()=>function(t){return t=function(t){const r=t.domain;if(!t.range())return t;const a=t.range().length;return t.domain=function(t){if(!t)return r.call(this);const n=[];for(let r=0;r<a;r++)n.push(e.quantile(t,r/(a-1)));return r.call(this,n)},t}(t),t.reverse=()=>it(t.copy().range(t.range().reverse())),t}(e.scaleLinear().range(t.map(lt)))}const X=K(["#611F00","#A13200","#EA5D00","#FF9A54","#FCDDBB","#CADEFF","#89AFFF","#5B6EFF","#3431DE","#211A8A"]),q=K(["#782600","#CC4309","#FF720C","#FFBC88","#E4E0DF","#AECBFF","#6B8EFF","#3B51FF","#2F2ABB"]),Q=K(["#7D0044","#C4006A","#ED408D","#FF83B9","#FED2EE","#CFEED8","#81C789","#34B446","#1A7F2D","#0C4B1F"]),Z=K(["#A30059","#DB247D","#FF579E","#FFA8D0","#E4E0DF","#A8DBB1","#55BC5D","#1D942E","#10652A"]);function $(t){return()=>it(e.scaleOrdinal().range(t.map(lt)))}const tt=$(["#FAFAFA"]),et=$(["#EAEAEA"]),rt=$(["#D6D6D6"]),at=$(["#B8B8B8"]),nt=$(["#7C7C7C"]),st=$(["#545454"]);function ot(t){return t.darker=()=>ot(t.copy().range(t.range().map(t=>t.brighter(1)))),t.brighter=()=>ot(t.copy().range(t.range().map(t=>t.darker(1)))),t.reverse=()=>ot(t.copy().range(t.range().reverse())),t}function it(t){return t=function(t){const r=t.domain;return t.domain=function(t){if(1===arguments.length){const a=[t[0],e.mean(t),t[1]];return r.call(this,a)}return Reflect.apply(r,this,arguments)},t}(t),t.reverse=()=>it(t.copy().range(t.range().reverse())),t}function lt(t){return e.lab(t)}const ct=t=>{const e="#CCCCCC";t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",14).attr("height",14),t.append("rect").attr("x",0).attr("y",0).attr("width",14).attr("height",14).attr("fill","#FAFAFA"),t.append("line").attr("x1",1).attr("y1",10).attr("x2",5).attr("y2",14).attr("stroke",e),t.append("line").attr("x1",5).attr("y1",10).attr("x2",1).attr("y2",14).attr("stroke",e),t.append("line").attr("x1",8).attr("y1",3).attr("x2",12).attr("y2",7).attr("stroke",e),t.append("line").attr("x1",12).attr("y1",3).attr("x2",8).attr("y2",7).attr("stroke",e)},pt=t=>{t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",6).attr("height",6),t.append("rect").attr("x",0).attr("y",0).attr("width",6).attr("height",6).attr("fill","#fff"),t.append("line").attr("x1",0).attr("y1",3).attr("x2",3).attr("y2",0).attr("stroke","#ddd").attr("stroke-linecap","square"),t.append("line").attr("x1",3).attr("y1",6).attr("x2",6).attr("y2",3).attr("stroke","#ddd").attr("stroke-linecap","square")},dt=t=>{t.attr("x1",0).attr("y1",0).attr("x2",.55).attr("y2",1).attr("id","lake-fade-gradient"),t.append("stop").attr("offset",.74).attr("stop-color","white").attr("stop-opacity",1),t.append("stop").attr("offset",.97).attr("stop-color","white").attr("stop-opacity",0)},ut=t=>{t.attr("maskContentUnits","objectBoundingBox"),t.append("rect").attr("fill","url(#lake-fade-gradient)").attr("width",1).attr("height",1)},ht=t=>{t.attr("patternUnits","userSpaceOnUse").attr("patternContentUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",6).attr("height",6),t.append("line").attr("x1",0).attr("y1",3).attr("x2",3).attr("y2",0).attr("stroke","#e6e6e6").attr("stroke-width",1.1),t.append("line").attr("x1",3).attr("y1",6).attr("x2",6).attr("y2",3).attr("stroke","#e6e6e6").attr("stroke-width",1.1)};function ft(t,e,r){return function(t){return t.selectAll("defs").data([0]).join("defs")}(t).selectAll(e+"#"+r).data([0]).join(e).attr("id",r)}const gt=e.easePolyOut,mt=()=>e.transition().ease(gt).duration(300),yt=()=>e.transition().ease(gt).duration(500);function vt(t,e){return"translate("+t+","+e+")"}function bt(t){return vt.apply(null,t)}function _t(){return r().prop("position").position(A([0,0])).prop("debug").render(function(t){const r=e.select(this),a=r.props();if(r.selectAll("[data-tooltip-anchor]").data(t).join("rect").attr("height",1).attr("width",1).attr("fill","none").attr("stroke","none").attr("visibility","none").attr("data-tooltip-anchor","").attr("transform",p(bt,a.position)),a.debug){r.selectAll("[data-tooltip-anchor-debug]").data(t).join("circle").attr("data-tooltip-anchor-debug","").attr("r",2).attr("fill","#fff").attr("stroke","#f00").attr("stroke-width",1.5).attr("transform",p(bt,a.position))}})}const kt=t=>Math.floor(t)+.5,xt=t=>{const e=p(Math.floor,Number),r=t.match(/(translate\()\s*([\d ,.-]+)\s*(\))/i)[2].replace(","," ").replace(/\s+/," ").split(" ").map(Number);1===r.length&&r.push([0]);const a=r.map(e);return[r[0]-a[0],r[1]-a[1]]};function zt(t,e,r){return a=>{a.join("circle").classed("sszvis-rangeFlag__mark",!0).classed(t,!0).attr("r",3.5).attr("cx",e).attr("cy",r)}}const At={decimal:".",thousands:" ",grouping:[3],currency:["CHF ",""],dateTime:"%a. %e. %B %X %Y",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["",""],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},wt=e.timeFormatLocale(At).format,St=e.formatLocale(At).format,jt=t=>{const e=[[".%L",t=>t.getMilliseconds()],[":%S",t=>t.getSeconds()],["%H:%M",t=>t.getMinutes()],["%H Uhr",t=>t.getHours()],["%a., %d.",t=>Boolean(t.getDay()&&1!=t.getDate())],["%e. %b",t=>1!=t.getDate()],["%B",t=>t.getMonth()],["%Y",()=>!0]];for(const r of e)if(r[1](t))return wt(r[0])(t);return wt("%Y")(t)},Ft=p(t=>t.toUpperCase(),wt("%b")),Mt=wt("%Y"),Pt=t=>{let e;const r=Math.abs(null!=t?t:0);return null==t||isNaN(t)?"–":r>=1e4?St(",.0f")(t):r>=100?(e=Math.min(1,Ct(t)),Dt(St("."+e+"f")(t))):r>0?(e=Math.min(2,Ct(t)),Dt(St("."+e+"f")(t))):St(".0f")(0)};const Rt=String;function Ct(t){return(String(Math.abs(t)).split(".")[1]||"").length}function Dt(t){return t.replace(/(\.\d*[1-9])0+$|\.0*$/,"$1")}const Tt=()=>r().prop("header").prop("body").prop("orientation",A).orientation("bottom").prop("dx",A).dx(1).prop("dy",A).dy(1).prop("opacity",A).opacity(1).renderSelection(t=>{const r=t.datum(),a=t.props(),n=d,s=n(a.header)&&!n(a.body)||!n(a.header)&&n(a.body),o=t.selectAll(".sszvis-tooltip").data(r).join("div");o.style("pointer-events","none").style("opacity",a.opacity).style("padding-top",t=>"top"===a.orientation(t)?"6px":null).style("padding-right",t=>"right"===a.orientation(t)?"6px":null).style("padding-bottom",t=>"bottom"===a.orientation(t)?"6px":null).style("padding-left",t=>"left"===a.orientation(t)?"6px":null).classed("sszvis-tooltip",!0);const i=o.selectAll(".sszvis-tooltip__background").data([0]).join("svg").attr("class","sszvis-tooltip__background").attr("height",0).attr("width",0),l=i.selectAll("path").data([0]).join("path");if(void 0!==window.SVGFEColorMatrixElement&&2==SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE){const t=i.selectAll("filter").data([0]).join("filter").attr("id","sszvisTooltipShadowFilter").attr("height","150%");t.selectAll("feGaussianBlur").data([0]).join("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",2),t.selectAll("feComponentTransfer").data([0]).join("feComponentTransfer").selectAll("feFuncA").data([0]).join("feFuncA").attr("type","linear").attr("slope",.2);const e=t.selectAll("feMerge").data([0]).join("feMerge");e.selectAll("feMergeNode").data([0]).join("feMergeNode"),e.selectAll("feMergeNode").data([0]).join("feMergeNode").attr("in","SourceGraphic"),l.attr("filter","url(#sszvisTooltipShadowFilter)")}else i.classed("sszvis-tooltip__background--fallback",!0);const c=o.selectAll(".sszvis-tooltip__content").data([0]).join("div").classed("sszvis-tooltip__content",!0);c.selectAll(".sszvis-tooltip__header").data([0]).join("div").classed("sszvis-tooltip__header",!0),c.selectAll(".sszvis-tooltip__body").data([0]).join("div").classed("sszvis-tooltip__body",!0),o.select(".sszvis-tooltip__header").datum(_("datum")).html(a.header||A("")),o.select(".sszvis-tooltip__body").datum(_("datum")).html(t=>{const e=a.body?A(a.body)(t):"";return Array.isArray(e)?'<table class="sszvis-tooltip__body__table">'+e.map(t=>"<tr>"+t.map(t=>"<td>"+t+"</td>").join("")+"</tr>").join("")+"</table>":e}),t.selectAll(".sszvis-tooltip").classed("sszvis-tooltip--small",s).each(function(t){const r=e.select(this),n=r.node().getBoundingClientRect(),o=Reflect.apply(a.orientation,this,arguments);switch(o){case"top":r.style("left",t.x-n.width/2+"px").style("top",t.y+a.dy(t)+"px");break;case"bottom":r.style("left",t.x-n.width/2+"px").style("top",t.y-a.dy(t)-n.height+"px");break;case"left":r.style("left",t.x+a.dx(t)+"px").style("top",t.y-n.height/2+"px");break;case"right":r.style("left",t.x-a.dx(t)-n.width+"px").style("top",t.y-n.height/2+"px")}const i=n.height+10,l=n.width+10;r.select(".sszvis-tooltip__background").attr("height",i).attr("width",l).style("left","-5px").style("top","-5px").select("path").attr("d",function(t,e,r,a){switch(r){case"top":t[1]=t[1]+6;break;case"bottom":e[1]=e[1]-6;break;case"left":t[0]=t[0]+6;break;case"right":e[0]=e[0]-6}return[["M",Ot(t),Lt(t)+a],Bt(Ot(t),Lt(t),Ot(t)+a,Lt(t),Ot(e)-a,Lt(t),"top"===r),Bt(Ot(e),Lt(t),Ot(e),Lt(t)+a,Ot(e),Lt(e)-a,"right"===r),Bt(Ot(e),Lt(e),Ot(e)-a,Lt(e),Ot(t)+a,Lt(e),"bottom"===r),Bt(Ot(t),Lt(e),Ot(t),Lt(e)-a,Ot(t),Lt(t)+a,"left"===r)].map(t=>t.join(" ")).join(" ")}([5,5],[l-5,i-5],o,s?3:4))})});function Ot(t){return t[0]}function Lt(t){return t[1]}function Bt(t,e,r,a,n,s,o){const i=r+(n-r)/2,l=a+(s-a)/2;let c=[];o&&a===s?c=r<n?["L",i-6,l,"L",i,l-6,"L",i+6,l]:["L",i+6,l,"L",i,l+6,"L",i-6,l]:o&&r===n&&(c=a<s?["L",i,l-6,"L",i+6,l,"L",i,l+6]:["L",i,l+6,"L",i-6,l,"L",i,l-6]);const p=["L",n,s];return[...["Q",t,e,r,a],...c,...p]}var Et=Symbol.for("immer-nothing"),Wt=Symbol.for("immer-draftable"),Nt=Symbol.for("immer-state");function Gt(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Ht=Object.getPrototypeOf;function It(t){return!!t&&!!t[Nt]}function Jt(t){return!!t&&(Yt(t)||Array.isArray(t)||!!t[Wt]||!!t.constructor?.[Wt]||Qt(t)||Zt(t))}var Vt=Object.prototype.constructor.toString();function Yt(t){if(!t||"object"!=typeof t)return!1;const e=Ht(t);if(null===e)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===Vt}function Ut(t,e){0===Kt(t)?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,a)=>e(a,r,t))}function Kt(t){const e=t[Nt];return e?e.type_:Array.isArray(t)?1:Qt(t)?2:Zt(t)?3:0}function Xt(t,e){return 2===Kt(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function qt(t,e,r){const a=Kt(t);2===a?t.set(e,r):3===a?t.add(r):t[e]=r}function Qt(t){return t instanceof Map}function Zt(t){return t instanceof Set}function $t(t){return t.copy_||t.base_}function te(t,e){if(Qt(t))return new Map(t);if(Zt(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Yt(t);if(!0===e||"class_only"===e&&!r){const e=Object.getOwnPropertyDescriptors(t);delete e[Nt];let r=Reflect.ownKeys(e);for(let a=0;a<r.length;a++){const n=r[a],s=e[n];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(e[n]={configurable:!0,writable:!0,enumerable:s.enumerable,value:t[n]})}return Object.create(Ht(t),e)}{const e=Ht(t);if(null!==e&&r)return{...t};const a=Object.create(e);return Object.assign(a,t)}}function ee(t,e=!1){return ae(t)||It(t)||!Jt(t)||(Kt(t)>1&&Object.defineProperties(t,{set:{value:re},add:{value:re},clear:{value:re},delete:{value:re}}),Object.freeze(t),e&&Object.values(t).forEach(t=>ee(t,!0))),t}function re(){Gt(2)}function ae(t){return Object.isFrozen(t)}var ne,se={};function oe(t){const e=se[t];return e||Gt(0),e}function ie(){return ne}function le(t,e){e&&(oe("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function ce(t){pe(t),t.drafts_.forEach(ue),t.drafts_=null}function pe(t){t===ne&&(ne=t.parent_)}function de(t){return ne={drafts_:[],parent_:ne,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ue(t){const e=t[Nt];0===e.type_||1===e.type_?e.revoke_():e.revoked_=!0}function he(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return void 0!==t&&t!==r?(r[Nt].modified_&&(ce(e),Gt(4)),Jt(t)&&(t=fe(e,t),e.parent_||me(e,t)),e.patches_&&oe("Patches").generateReplacementPatches_(r[Nt].base_,t,e.patches_,e.inversePatches_)):t=fe(e,r,[]),ce(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Et?t:void 0}function fe(t,e,r){if(ae(e))return e;const a=e[Nt];if(!a)return Ut(e,(n,s)=>ge(t,a,e,n,s,r)),e;if(a.scope_!==t)return e;if(!a.modified_)return me(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const e=a.copy_;let n=e,s=!1;3===a.type_&&(n=new Set(e),e.clear(),s=!0),Ut(n,(n,o)=>ge(t,a,e,n,o,r,s)),me(t,e,!1),r&&t.patches_&&oe("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function ge(t,e,r,a,n,s,o){if(It(n)){const o=fe(t,n,s&&e&&3!==e.type_&&!Xt(e.assigned_,a)?s.concat(a):void 0);if(qt(r,a,o),!It(o))return;t.canAutoFreeze_=!1}else o&&r.add(n);if(Jt(n)&&!ae(n)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;fe(t,n),e&&e.scope_.parent_||"symbol"==typeof a||!(Qt(r)?r.has(a):Object.prototype.propertyIsEnumerable.call(r,a))||me(t,n)}}function me(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&ee(e,r)}var ye={get(t,e){if(e===Nt)return t;const r=$t(t);if(!Xt(r,e))return function(t,e,r){const a=_e(e,r);return a?"value"in a?a.value:a.get?.call(t.draft_):void 0}(t,r,e);const a=r[e];return t.finalized_||!Jt(a)?a:a===be(t.base_,e)?(xe(t),t.copy_[e]=ze(a,t)):a},has:(t,e)=>e in $t(t),ownKeys:t=>Reflect.ownKeys($t(t)),set(t,e,r){const a=_e($t(t),e);if(a?.set)return a.set.call(t.draft_,r),!0;if(!t.modified_){const a=be($t(t),e),n=a?.[Nt];if(n&&n.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}(r,a)&&(void 0!==r||Xt(t.base_,e)))return!0;xe(t),ke(t)}return t.copy_[e]===r&&(void 0!==r||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty:(t,e)=>(void 0!==be(t.base_,e)||e in t.base_?(t.assigned_[e]=!1,xe(t),ke(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0),getOwnPropertyDescriptor(t,e){const r=$t(t),a=Reflect.getOwnPropertyDescriptor(r,e);return a?{writable:!0,configurable:1!==t.type_||"length"!==e,enumerable:a.enumerable,value:r[e]}:a},defineProperty(){Gt(11)},getPrototypeOf:t=>Ht(t.base_),setPrototypeOf(){Gt(12)}},ve={};function be(t,e){const r=t[Nt];return(r?$t(r):t)[e]}function _e(t,e){if(!(e in t))return;let r=Ht(t);for(;r;){const t=Object.getOwnPropertyDescriptor(r,e);if(t)return t;r=Ht(r)}}function ke(t){t.modified_||(t.modified_=!0,t.parent_&&ke(t.parent_))}function xe(t){t.copy_||(t.copy_=te(t.base_,t.scope_.immer_.useStrictShallowCopy_))}Ut(ye,(t,e)=>{ve[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),ve.deleteProperty=function(t,e){return ve.set.call(this,t,e,void 0)},ve.set=function(t,e,r){return ye.set.call(this,t[0],e,r,t[0])};function ze(t,e){const r=Qt(t)?oe("MapSet").proxyMap_(t,e):Zt(t)?oe("MapSet").proxySet_(t,e):function(t,e){const r=Array.isArray(t),a={type_:r?1:0,scope_:e?e.scope_:ie(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=a,s=ye;r&&(n=[a],s=ve);const{revoke:o,proxy:i}=Proxy.revocable(n,s);return a.draft_=i,a.revoke_=o,i}(t,e);return(e?e.scope_:ie()).drafts_.push(r),r}function Ae(t){if(!Jt(t)||ae(t))return t;const e=t[Nt];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=te(t,e.scope_.immer_.useStrictShallowCopy_)}else r=te(t,!0);return Ut(r,(t,e)=>{qt(r,t,Ae(e))}),e&&(e.finalized_=!1),r}var we=new class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,e,r)=>{if("function"==typeof t&&"function"!=typeof e){const r=e;e=t;const a=this;return function(t=r,...n){return a.produce(t,t=>e.call(this,t,...n))}}let a;if("function"!=typeof e&&Gt(6),void 0!==r&&"function"!=typeof r&&Gt(7),Jt(t)){const n=de(this),s=ze(t,void 0);let o=!0;try{a=e(s),o=!1}finally{o?ce(n):pe(n)}return le(n,r),he(a,n)}if(!t||"object"!=typeof t){if(a=e(t),void 0===a&&(a=t),a===Et&&(a=void 0),this.autoFreeze_&&ee(a,!0),r){const e=[],n=[];oe("Patches").generateReplacementPatches_(t,a,e,n),r(e,n)}return a}Gt(1)},this.produceWithPatches=(t,e)=>{if("function"==typeof t)return(e,...r)=>this.produceWithPatches(e,e=>t(e,...r));let r,a;return[this.produce(t,e,(t,e)=>{r=t,a=e}),r,a]},"boolean"==typeof t?.autoFreeze&&this.setAutoFreeze(t.autoFreeze),"boolean"==typeof t?.useStrictShallowCopy&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Jt(t)||Gt(8),It(t)&&(t=function(t){It(t)||Gt(10);return Ae(t)}(t));const e=de(this),r=ze(t,void 0);return r[Nt].isManual_=!0,pe(e),r}finishDraft(t,e){const r=t&&t[Nt];r&&r.isManual_||Gt(9);const{scope_:a}=r;return le(a,e),he(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(0===a.path.length&&"replace"===a.op){t=a.value;break}}r>-1&&(e=e.slice(r+1));const a=oe("Patches").applyPatches_;return It(t)?a(t,e):this.produce(t,t=>a(t,e))}};we.produce;var Se=we.setAutoFreeze.bind(we),je=we.createDraft.bind(we),Fe=we.finishDraft.bind(we);const Me=(t,r)=>{r||(r={}),r.src||(r.src="fallback.png");(l(t)?t:e.select(t)).append("img").attr("class","sszvis-fallback-image").attr("src",r.src)};function Pe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Re,Ce;var De=(Ce||(Ce=1,Re=function(t,e,r){var a,n=0;return arguments.length<3&&(r=!0),function(){var s=arguments,o=this;a=function(){t.apply(o,s),n=(new Date).getTime()+e,a=null,r&&setTimeout(function(){a&&a()},e)},(new Date).getTime()>n&&a()}}),Re),Te=Pe(De);const Oe={resize:[]};void 0!==globalThis.window&&e.select(globalThis).on("resize",Te(()=>{Le("resize")},500));const Le=function(t){const e=Array.prototype.slice.call(arguments,1);if(Oe[t])for(const r of Oe[t])r.apply(null,e);return this},Be={on:function(t,e){return Oe[t]||(Oe[t]=[]),Oe[t]=[...Oe[t].filter(t=>t!==e),e],this},off:function(t,e){return Oe[t]?(Oe[t]=Oe[t].filter(t=>t!==e),this):this},trigger:Le};Se(!1);function Ee(t,e){if(!t)throw new Error("[sszvis.app] ".concat(e))}function We(t){return"function"==typeof t}function Ne(t,e){const r=Ke(e);return h(t=>He(t,r),t)}function Ge(t,e){return h(t=>t.name===e,t)}function He(t,e){const r=t.measurement,a=Ke(e);return a.width<=r.width&&a.screenHeight<=r.screenHeight}function Ie(t,e){const r=Ke(e);return t.filter(t=>He(t,r))}function Je(t){return[...t.map(Xe),Xe({name:"_"})]}const Ve=(()=>{const t=Je([{name:"palm",width:540},{name:"lap",width:749}]);return()=>t})(),Ye=qe("palm"),Ue=qe("lap");function Ke(t){const e=k("width",1/0),r=k("screenHeight",1/0);return{width:e(t),screenHeight:r(t)}}function Xe(t){const e=d(t.measurement)?Ke(t.measurement):Ke({width:t.width,screenHeight:t.screenHeight});return{name:t.name,measurement:e}}function qe(t){return e=>He(Ge(Ve(),t),e)}function Qe(t,e){const r=t/e;return t=>t/r}const Ze=Qe(4,3),$e=Qe(16,10),tr=t=>Math.min(Qe(12,5)(t),500);tr.MAX_HEIGHT=500;const er=t=>Math.min(Qe(1,1)(t),420);er.MAX_HEIGHT=420;const rr=t=>Math.min(Qe(4,5)(t),600);rr.MAX_HEIGHT=600;const ar={palm:Ze,lap:$e,_:tr},nr=t=>{const e=Ne(Ve(),t);return(0,ar[e.name])(t.width)},sr=ir("warn"),or=ir("error");function ir(t){return()=>{if(console&&console[t])for(const r of(e=arguments,Array.prototype.slice.call(e)))console[t](r);var e}}const lr=t=>t.rangeExtent?t.rangeExtent():function(t){const e=t[0],r=t[t.length-1];return e<r?[e,r]:[r,e]}(t.range());function cr(t,r,a,n){n=(n||5)-2;const s=r;r-=2*(a=a||5);const o=[];return t.each(function(){const t=e.select(this),i=t.text().split(/[\t\n\v\f\r ]+/).reverse();let l,c=[],p=0;let d,u=t.attr("y"),h=Number.parseFloat(t.attr("dy")),f=1;const g=t.style("text-anchor")||"start";isNaN(h)&&(h=0);if(e.select(t.node().parentNode).classed("tick"))switch(g){case"start":d=-r/2;break;case"middle":d=0;break;case"end":d=r/2}else switch(g){case"start":d=a;break;case"middle":d=s/2;break;case"end":d=s-a}u=+(null===u?n:u);let m=t.text(null).append("tspan").attr("x",d).attr("y",u).attr("dy",h+"em");for(;i.length>0;)l=i.pop(),c.push(l),m.text(c.join(" ")),m.node().getComputedTextLength()>r&&c.length>1&&(c.pop(),m.text(c.join(" ")),c=[l],m=t.append("tspan").attr("x",d).attr("y",u).attr("dy",1.1*++p+h+"em").text(l),++f);o.push(f)}),o}const pr=()=>r().prop("scale").prop("orient").prop("ticks").prop("tickValues").prop("tickSize").prop("tickSizeInner").prop("tickSizeOuter").prop("tickPadding").prop("tickFormat").prop("_scale").prop("orient").orient("bottom").prop("alignOuterLabels").alignOuterLabels(!1).prop("contour").prop("hideBorderTickThreshold").hideBorderTickThreshold(8).prop("hideLabelThreshold").hideLabelThreshold(10).prop("highlightTick",A).prop("showZeroY").showZeroY(!1).prop("slant").prop("textWrap").prop("tickLength").prop("title").prop("titleAnchor").prop("titleCenter").prop("dxTitle").prop("dyTitle").prop("titleVertical").prop("vertical").vertical(!1).prop("yOffset").yOffset(0).render(function(){const t=e.select(this),r=t.props(),a=!r.vertical&&"bottom"===r.orient,n=(()=>{switch(r.orient){case"bottom":return e.axisBottom();case"top":return e.axisTop();case"left":return e.axisLeft();case"right":return e.axisRight()}})();for(const t of["scale","ticks","tickValues","tickSizeInner","tickSizeOuter","tickPadding","tickFormat","tickSize"])if(void 0!==r[t]){if(void 0===n[t])throw new Error('axis: "'+t+'" not available');n[t](r[t])}r._scale&&n.scale(r._scale);const s=t.selectGroup("sszvis-axis").classed("sszvis-axis",!0).classed("sszvis-axis--top",!r.vertical&&"top"===r.orient).classed("sszvis-axis--bottom",a).classed("sszvis-axis--vertical",r.vertical).attr("transform",vt(0,r.yOffset)).call(n);s.attr("fill",null).attr("font-size",null).attr("font-family",null);const o=n.scale(),i=s.selectAll("g.tick"),l=i.selectAll("text");i.each(function(){const t=xt(this.getAttribute("transform")),r=kt(0)-t[0],n=kt(a?2:0)+t[1];e.select(this).select("line").attr("transform",vt(r,n))}),l.each(function(){"top"!==r.orient&&"bottom"!==r.orient||e.select(this).attr("dx","-0.5"),"left"!==r.orient&&"right"!==r.orient||e.select(this).attr("y","-0.5")}),s.selectAll("path.domain");const c=lr(o);if(i.selectAll("line").each(function(t){const a=o(t),n=e.select(this);n.classed("hidden",!n.classed("sszvis-axis__longtick")&&(fr(a,c[0])<r.hideBorderTickThreshold||fr(a,c[1])<r.hideBorderTickThreshold))}),d(r.tickLength)){const t=e.extent(o.domain()),a=i.filter(e=>!z(e,t[0])&&!z(e,t[1])),n=r.orient;let s=2;"left"!==n&&"right"!==n||(a.selectAll("text").each(function(){s=Math.max(this.getBoundingClientRect().width,s)}),s+=2);const l=a.selectAll("line.sszvis-axis__longtick").data([0]).join("line").classed("sszvis-axis__longtick",!0);if(r.tickLength>s)switch(n){case"top":l.attr("y1",s).attr("y2",r.tickLength);break;case"bottom":l.attr("y1",-s).attr("y2",-r.tickLength);break;case"left":l.attr("x1",-s).attr("x2",-r.tickLength);break;case"right":l.attr("x1",s).attr("x2",r.tickLength)}else l.remove()}if(r.alignOuterLabels){const t=lr(o),e=t[0],r=t[1];l.style("text-anchor",t=>{const a=o(t);return fr(a,e)<12?"start":fr(a,r)<12?"end":"middle"})}if(d(r.textWrap)&&l.call(cr,r.textWrap),r.slant&&l.call(mr[r.orient][r.slant]),r.highlightTick){const t=[],a=[];if(l.classed("hidden",!1).classed("active",r.highlightTick),r.hideLabelThreshold>0&&!r.slant){l.each(function(e){const n=this.getBoundingClientRect(),s={node:this,bounds:{top:n.top,right:n.right,bottom:n.bottom,left:n.left}};r.highlightTick(e)?(s.bounds.left-=r.hideLabelThreshold,s.bounds.right+=r.hideLabelThreshold,t.push(s)):a.push(s)});for(const r of t)for(const t of a)e.select(t.node).classed("hidden",gr(t.bounds,r.bounds))}}if(r.title){s.selectAll(".sszvis-axis__title").data([r.title]).join("text").classed("sszvis-axis__title",!0).text(t=>t).attr("transform",()=>{const t=r.orient,e=lr(o),a=r.titleCenter?{left:"left"===t||"right"===t?0:"top"===t||"bottom"===t?(e[0]+e[1])/2:0,top:"left"===t||"right"===t?(e[0]+e[1])/2:"top"===t?0:"bottom"===t?32:0}:{left:"left"===t||"right"===t||"top"===t?0:"bottom"===t?e[1]:0,top:"left"===t||"right"===t||"top"===t?0:"bottom"===t?32:0};return a.vertical=!!r.titleVertical,a.left+=r.dxTitle||0,a.top+=r.dyTitle||0,"translate("+a.left+", "+a.top+") rotate("+(a.vertical?"-90":"0")+")"}).style("text-anchor",()=>{const t=r.orient;if(void 0!==r.titleAnchor)return r.titleAnchor;switch(t){case"left":case"top":case"bottom":return"end";case"right":return"start"}})}r.contour&&r.slant?sr("Can't apply contour to slanted labels"):r.contour&&i.each(function(){const t=e.select(this),r=t.select("text").node();let a=t.select(".sszvis-axis__label-contour");a.empty()&&(a=e.select(r.cloneNode()).classed("sszvis-axis__label-contour",!0),this.insertBefore(a.node(),r)),a.text(r.textContent)})}),dr=function(t){const e=this.scale().domain(),r=[],a=Math.round(e.length/t);void 0!==e[0]&&r.push(e[0]);for(let t=a,n=e.length;t<n-1;t+=a)void 0!==e[t]&&r.push(e[t]);return"undefined"!==e[e.length-1]&&r.push(e[e.length-1]),this.tickValues(r),t},ur=()=>pr().yOffset(2).ticks(3).tickSizeInner(4).tickSizeOuter(6.5).tickPadding(6).tickFormat(c(1,Pt));ur.time=()=>ur().tickFormat(jt).alignOuterLabels(!0),ur.ordinal=()=>ur().prop("ticks",dr).tickFormat(Rt),ur.pyramid=()=>ur().ticks(10).prop("scale",function(t){const e=t.copy(),r=e.domain(),a=e.range();return e.domain([-r[1],r[1]]).range([a[0]-a[1],a[0]+a[1]]),this._scale(e),e}).tickFormat(t=>Pt(Math.abs(t)));const hr=()=>{const t=pr().ticks(6).tickSize(0,0).tickPadding(0).tickFormat(e=>0!==e||t.showZeroY()?Pt(e):null).vertical(!0);return t};function fr(t,e){return Math.abs(t-e)}function gr(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}hr.time=()=>hr().tickFormat(jt),hr.ordinal=()=>hr().prop("ticks",dr).tickFormat(Rt);const mr={top:{horizontal(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("dy","0.71em").attr("transform",null)},vertical(t){t.style("text-anchor","start").attr("dx","0em").attr("dy","0.35em").attr("transform","rotate(-90)")},diagonal(t){t.style("text-anchor","start").attr("dx","0.1em").attr("dy","0.1em").attr("transform","translate(-0.5) rotate(-45)")}},bottom:{horizontal(t){t.style("text-anchor","middle").attr("dx","-0.5").attr("dy","0.71em").attr("transform",null)},vertical(t){t.style("text-anchor","end").attr("dx","-1em").attr("dy","-0.75em").attr("transform","rotate(-90)")},diagonal(t){t.style("text-anchor","end").attr("dx","-0.8em").attr("dy","0em").attr("transform","rotate(-45)")}}};function yr(){const t=e.dispatch("start","move","drag","end"),a=r().prop("debug").prop("xScale").prop("yScale").prop("draggable").prop("cancelScrolling",A).cancelScrolling(!1).prop("fireOnPanOnly",A).fireOnPanOnly(!1).prop("padding",t=>{const e={top:0,left:0,bottom:0,right:0};for(const r in t)e[r]=t[r];return e}).padding({}).render(function(){const r=e.select(this),a=r.props(),n=lr(a.xScale).sort(e.ascending),s=lr(a.yScale).sort(e.ascending);n[0]-=a.padding.left,n[1]+=a.padding.right,s[0]-=a.padding.top,s[1]+=a.padding.bottom;const o=r.selectAll("[data-sszvis-behavior-move]").data([0]).join("rect").attr("data-sszvis-behavior-move","").attr("class","sszvis-interactive");a.draggable&&o.classed("sszvis-interactive--draggable",!0),o.attr("x",n[0]).attr("y",s[0]).attr("width",n[1]-n[0]).attr("height",s[1]-s[0]).attr("fill","transparent").on("mouseover",function(){t.apply("start",this,arguments)}).on("mousedown",function(r){const a=this,n=e.select(document),s=e.select(globalThis),o=function(){a.__dragging__=!1,s.on("mousemove.sszvis-behavior-move",null),n.on("mouseout.sszvis-behavior-move",null),t.apply("end",this,arguments)};s.on("mouseup.sszvis-behavior-move",o),n.on("mouseout.sszvis-behavior-move",()=>{const t=r.relatedTarget||r.toElement;t&&"HTML"!==t.nodeName||o()}),a.__dragging__=!0}).on("mousemove",function(r){const n=e.pointer(r),s=vr(a.xScale,n[0]),o=vr(a.yScale,n[1]);this.__dragging__?t.apply("drag",this,[r,s,o]):t.apply("move",this,[r,s,o])}).on("mouseout",function(e){t.apply("end",this,[e])}).on("touchstart",function(r){const n=f(e.pointer(r)),s=vr(a.xScale,n[0]),o=vr(a.yScale,n[1]),i=a.cancelScrolling(s,o);if(i&&r.preventDefault(),!a.fireOnPanOnly()||i){t.apply("start",this,[r,s,o]),t.apply("drag",this,[r,s,o]),t.apply("move",this,[r,s,o]);const n=function(){const n=f(e.pointer(r)),s=vr(a.xScale,n[0]),o=vr(a.yScale,n[1]),i=a.cancelScrolling(s,o);i&&r.preventDefault(),!a.fireOnPanOnly()||i?(t.apply("drag",this,[r,s,o]),t.apply("move",this,[r,s,o])):t.apply("end",this,[r])},i=function(){t.apply("end",this,[r]),e.select(this).on("touchmove",null).on("touchend",null)};e.select(this).on("touchmove",n).on("touchend",i)}}),a.debug&&o.attr("fill","rgba(255,0,0,0.2)")});return a.on=()=>{const e=t.on.apply(t,arguments);return e===t?a:e},a}function vr(t,e){switch(t.invert?"Linear":t.paddingInner?"Band":"Point"){case"Linear":return t.invert(e);case"Band":return function(t,e){const r=t.step(),a=t.paddingOuter()*r,n=t.paddingInner()*r,s=t.bandwidth(),o=t.range(),i=t.domain();if(1===i.length)return o[0]<=e&&o[1]>=e?i[0]:null;const l=i.map((t,e)=>0===e?[o[0],o[0]+a+s+n/2]:e===i.length-1?[o[1]-(a+s+n/2),o[1]]:[o[0]+a+e*r-n/2,o[0]+a+(e+1)*r-n/2]);for(let t=0,r=l.length;t<r;t++)if(l[t][0]<e&&e<=l[t][1])return i[t];return null}(t,e);case"Point":return function(t,e){const r=t.step(),a=t.padding()*r,n=t.range(),s=t.domain();if(1===s.length)return n[0]<=e&&n[1]>=e?s[0]:null;const o=s.map((t,e)=>0===e?[n[0],n[0]+a+r/2]:e===s.length-1?[n[1]-(a+r/2),n[1]]:[n[0]+a+e*r-r/2,n[0]+a+e*r+r/2]);for(let t=0,r=o.length;t<r;t++)if(o[t][0]<e&&e<=o[t][1])return s[t];return null}(t,e);default:throw new Error("Unknown scale type, could not invert")}}const br=t=>!m(t)&&d(t)?document.elementFromPoint(t.clientX,t.clientY):null,_r=t=>{if(!m(t)){const r=e.select(t);if(!m(r.attr("data-sszvis-behavior-pannable"))){const t=r.datum();if(d(t))return t}}return null};const kr=225;function xr(t,e){const r=t.clientX-e[0],a=t.clientY-e[1];return r*r+a*a<kr}const zr=t=>{let r;return r=i(t)?e.select(t).node():l(t)?t.node():t,{width:r?r.getBoundingClientRect().width:void 0,screenWidth:window.innerWidth,screenHeight:window.innerHeight}},Ar=(()=>{const t=document.createElement("canvas").getContext("2d"),e={};return(r,a,n)=>{const s=[r,a,n].join("-");return t.font=r+"px "+a,e[s]||(e[s]=t.measureText(n).width)}})(),wr=t=>Ar(10,"Arial, sans-serif",t),Sr=t=>Ar(12,"Arial, sans-serif",t);function jr(t,r){let a=null,n=null;0===arguments.length?a={}:1===arguments.length?y(t)?a=t:l(t)?(a={},n=t):(a={},n=e.select(t)):(a=t,n=l(r)?r:e.select(r));const s={top:Fr(a.top,0),right:Fr(a.right,1),bottom:Fr(a.bottom,0),left:Fr(a.left,1)},o=d(n)?zr(n):{width:516},i=Fr(a.width,o.width),c=nr(o),p=Fr(a.height,c+s.top+s.bottom);return{innerHeight:p-s.top-s.bottom,innerWidth:i-s.left-s.right,padding:s,height:p,width:i,screenWidth:o.screenWidth,screenHeight:o.screenHeight}}function Fr(t,e){return void 0===t?e:t}function Mr(t,e){for(const r in t)e(t[r],r)}function Pr(){const t={},e=[],r=[];let a;function n(t,s){if(s>=e.length)return a&&t.sort(a),t;const o=r[s],i=e[s++],l=function(t,e){const r={};let a;for(let n,s=0,o=t.length;s<o;++s)n=t[s],a=e(n),r[a]?r[a].push(n):r[a]=[n];return r}(t,i.func);if("obj"===i.type){const t={};return Mr(l,(e,r)=>{t[r]=n(e,s)}),t}if("arr"===i.type){const t=[];if(o){!function(t,e){for(let r=0,a=t.length;r<a;++r)e(t[r],r)}(Object.keys(l).sort(o),e=>{t.push(n(l[e],s))})}else Mr(l,e=>{t.push(n(e,s))});return t}}return t.apply=t=>n(t,0),t.objectBy=r=>(e.push({type:"obj",func:r}),t),t.arrayBy=(a,n)=>(e.push({type:"arr",func:a}),n&&(r[e.length-1]=n),t),t.sort=e=>(a=e,t),t}function Rr(t){return isNaN(t)?0:t}function Cr(){return r().prop("x",A).prop("y",A).prop("width",A).prop("height",A).prop("fill",A).prop("stroke",A).prop("centerTooltip").prop("tooltipAnchor").prop("transition").transition(!0).render(function(t){const r=e.select(this),a=r.props(),n=p(Rr,a.x),s=p(Rr,a.y),o=p(Rr,a.width),i=p(Rr,a.height),l=r.selectAll(".sszvis-bar").data(t).join("rect").classed("sszvis-bar",!0).attr("x",n).attr("y",s).attr("width",o).attr("height",i).attr("fill",a.fill).attr("stroke",a.stroke);let c;if(a.transition&&l.transition(mt()),l.attr("x",n).attr("y",s).attr("width",o).attr("height",i),a.centerTooltip)c=t=>[n(t)+o(t)/2,s(t)+i(t)/2];else if(a.tooltipAnchor){const t=a.tooltipAnchor.map(Number.parseFloat);c=e=>[n(e)+t[0]*o(e),s(e)+t[1]*i(e)]}else c=t=>[n(t)+o(t)/2,s(t)];const d=_t().position(c);r.call(d)})}const Dr=_("stack"),Tr=_("0"),Or=_("1");function Lr(t){return(r,a,n)=>s=>{const o=Pr().arrayBy(r).objectBy(a).apply(s),i=o.reduce((t,e)=>x([...t,...Object.keys(e)]),[]),l=e.stack().keys(i).value((t,e)=>n(t[e][0])).order(t)(o);for(const t of l)for(const e of t)e.series=t.key,e.data=e.data[t.key][0],e.stack=r(e.data);return l.keys=i,l.maxValue=e.max(l,t=>e.max(t,t=>t[1])),l}}const Br=Lr(e.stackOrderNone),Er=Lr(e.stackOrderReverse);function Wr(t){return r().prop("xScale",A).prop("width",A).prop("yScale",A).prop("height",A).prop("fill").prop("stroke").render(function(r){const a=e.select(this),n=a.props(),s=Cr().x(t.x(n)).y(t.y(n)).width(t.width(n)).height(t.height(n)).fill(n.fill).stroke(n.stroke||"#FFFFFF");a.selectAll(".sszvis-stack").data(r).join("g").classed("sszvis-stack",!0).call(s)})}const Nr={x:t=>p(t.xScale,Tr),y:t=>p(t.yScale,Dr),width:t=>e=>t.xScale(e[1])-t.xScale(e[0]),height:t=>t.height},Gr={x:t=>p(t.xScale,Dr),y:t=>p(t.yScale,Or),width:t=>t.width,height:t=>e=>t.yScale(e[0])-t.yScale(e[1])},Hr=()=>Wr(Gr);function Ir(){return r().prop("barPosition").prop("barWidth").prop("mirror").mirror(!1).render(function(t){const r=e.select(this),a=r.props(),n=e.line().x(a.barWidth).y(a.barPosition);r.selectAll(".sszvis-pyramid__referenceline").data(t).join("path").attr("class","sszvis-pyramid__referenceline").attr("transform",a.mirror?"scale(-1, 1)":"").transition(mt()).attr("d",n)})}const Jr=_("data"),Vr=_("row");function Yr(){return r().prop("stackElement").renderSelection(t=>{const r=t.datum(),a=t.props();t.selectAll("[data-sszvis-stack]").data(r).join("g").attr("data-sszvis-stack","").each(function(t){e.select(this).datum(t).call(a.stackElement)})})}function Ur(){return r().prop("barPosition").prop("barWidth").prop("mirror").mirror(!1).render(function(t){const r=e.select(this),a=r.props(),n=e.line().x(a.barWidth).y(a.barPosition);r.selectAll(".sszvis-path").data(t).join("path").attr("class","sszvis-path").attr("fill","none").attr("stroke","#aaa").attr("stroke-width",2).attr("stroke-dasharray","3 3").attr("transform",a.mirror?"scale(-1, 1)":"").transition(mt()).attr("d",n)})}const Kr=2*Math.PI;function Xr(t,e){return e.includes(t)}function qr(){return r().prop("scale").prop("rowHeight").rowHeight(21).prop("columnWidth").columnWidth(200).prop("rows").rows(3).prop("columns").columns(3).prop("verticallyCentered").verticallyCentered(!1).prop("orientation").prop("reverse").reverse(!1).prop("rightAlign").rightAlign(!1).prop("horizontalFloat").horizontalFloat(!1).prop("floatPadding").floatPadding(20).prop("floatWidth").floatWidth(600).render(function(){const t=e.select(this),r=t.props();let a,n,s=r.scale.domain();r.reverse&&(s=[...s].reverse()),"horizontal"===r.orientation?(n=Math.ceil(r.columns),a=Math.ceil(s.length/n)):"vertical"===r.orientation&&(a=Math.ceil(r.rows),n=Math.ceil(s.length/a));const o=t.selectAll(".sszvis-legend--entry").data(s).join("g").classed("sszvis-legend--entry",!0);o.selectAll(".sszvis-legend__mark").data(t=>[t]).join("circle").classed("sszvis-legend__mark",!0).attr("cx",r.rightAlign?-6:6).attr("cy",kt(r.rowHeight/2)).attr("r",5).attr("fill",t=>r.scale(t)).attr("stroke",t=>r.scale(t)).attr("stroke-width",1),o.selectAll(".sszvis-legend__label").data(t=>[t]).join("text").classed("sszvis-legend__label",!0).text(t=>t).attr("dy","0.35em").style("text-anchor",()=>r.rightAlign?"end":"start").attr("transform",()=>vt(r.rightAlign?-18:18,kt(r.rowHeight/2)));let i="";if(r.verticallyCentered&&(i="translate(0,"+String(-s.length*r.rowHeight/2)+") "),r.horizontalFloat){let t=0,e=0;o.attr("transform",function(){const a=this.getBoundingClientRect().width;e+a>r.floatWidth&&(t+=r.rowHeight,e=0);const n=vt(e,t);return e+=a+r.floatPadding,i+n})}else o.attr("transform",(t,e)=>"horizontal"===r.orientation?i+"translate("+e%n*r.columnWidth+","+Math.floor(e/n)*r.rowHeight+")":"vertical"===r.orientation?i+"translate("+Math.floor(e/a)*r.columnWidth+","+e%a*r.rowHeight+")":void 0)})}function Qr(t,r){const a=t.length,n=e.max(t,Zr),s=e.sum(t,Zr),o=a<=4?1:$r(r,n,2),i=1===o&&s<=r;return{columns:o,rows:i?1:Math.ceil(a/o),columnWidth:1===o?null:n,legendWidth:o*n,horizontalFloat:i,orientation:i?null:"vertical"}}function Zr(t){return Sr(t)+40}function $r(t,e,r){return r<=1?1:e<=t/r?r:$r(t,e,r-1)}const ta=(()=>{let t=0;return()=>++t})();function ea(t){return Array.from(t,t=>{let[e,r]=t;return{key:e,values:r.size>0?ea(r):void 0,value:r.size>0?void 0:r}})}let ra=()=>0;const aa=w((t,r,a)=>e.geoMercator().fitSize([t,r],a),(t,e,r,a)=>t+","+e+","+a),na=(t,r,a,n)=>e.geoPath().projection(aa(t,r,a,n)),sa="geoId",oa=(t,e,r)=>{r||(r=sa);const a=Array.isArray(t)?t.reduce((t,e)=>(t[e[r]]=e,t),{}):{};return e.features.map(t=>({geoJson:t,datum:a[t.id]}))},ia=t=>{if(!t.properties.cachedCenter){const r=t.properties.center;t.properties.cachedCenter=r?r.split(",").map(Number.parseFloat):e.geoCentroid(t)}return t.properties.cachedCenter};function la(){return r().prop("mergedData").prop("geoJson").prop("mapPath").prop("defined",A).defined(!0).prop("fill",A).fill(()=>"black").prop("transitionColor").transitionColor(!0).render(function(){const t=e.select(this),r=t.props();function a(t){return r.defined(t.datum)?r.fill(t.datum):"url(#missing-pattern)"}ft(t,"pattern","missing-pattern").call(ct);const n=t.selectAll(".sszvis-map__area").data(r.mergedData).join("path").classed("sszvis-map__area",!0).classed("sszvis-map__area--entering",!0).attr("data-event-target","").attr("fill",a).classed("sszvis-map__area--entering",!1);t.selectAll(".sszvis-map__area--undefined").attr("fill",a),n.classed("sszvis-map__area--undefined",t=>!d(t.datum)||!r.defined(t.datum)).attr("d",t=>r.mapPath(t.geoJson)),r.transitionColor?n.transition().call(yt).attr("fill",a):n.attr("fill",a);const s=_t().position(t=>r.mapPath.projection()(ia(t.geoJson)));t.selectGroup("tooltipAnchors").datum(r.mergedData).call(s)})}const ca=_("datum");function pa(){return r().prop("keyName").keyName(sa).prop("geoJson").prop("mapPath").prop("highlight").highlight([]).prop("highlightStroke",A).highlightStroke("white").prop("highlightStrokeWidth",A).highlightStrokeWidth(2).render(function(){const t=e.select(this),r=t.props(),a=t.selectAll(".sszvis-map__highlight");if(0===r.highlight.length)return a.remove(),!0;const n=r.geoJson.features.reduce((t,e)=>(t[e.id]=e,t),{}),s=r.highlight.reduce((t,e)=>(e&&t.push({geoJson:n[e[r.keyName]],datum:e}),t),[]);a.data(s).join("path").classed("sszvis-map__highlight",!0).attr("d",t=>r.mapPath(t.geoJson)).style("stroke",t=>r.highlightStroke(t.datum)).style("stroke-width",t=>r.highlightStrokeWidth(t.datum))})}function da(){return r().prop("geoJson").prop("mapPath").prop("borderColor").borderColor("white").prop("strokeWidth").strokeWidth(1.25).render(function(){const t=e.select(this),r=t.props();t.selectAll(".sszvis-map__border").data([r.geoJson]).join("path").classed("sszvis-map__border",!0).attr("d",r.mapPath).style("stroke",r.borderColor).style("stroke-width",r.strokeWidth)})}function ua(){return r().prop("mapPath").prop("lakeFeature").prop("lakeBounds").prop("lakePathColor").prop("fadeOut").fadeOut(!0).render(function(){const t=e.select(this),r=t.props();ft(t,"pattern","lake-pattern").call(pt),r.fadeOut&&(ft(t,"linearGradient","lake-fade-gradient").call(dt),ft(t,"mask","lake-fade-mask").call(ut));const a=t.selectAll(".sszvis-map__lakezurich").data([r.lakeFeature]).join("path").classed("sszvis-map__lakezurich",!0).attr("d",r.mapPath).attr("fill","url(#lake-pattern)");r.fadeOut&&a.attr("mask","url(#lake-fade-mask)");const n=t.selectAll(".sszvis-map__lakepath").data([r.lakeBounds]).join("path").classed("sszvis-map__lakepath",!0).attr("d",r.mapPath);r.lakePathColor&&n.style("stroke",r.lakePathColor)})}const ha=e.timeFormatLocale(At).parse,fa=ha("%d.%m.%Y"),ga=ha("%Y");function ma(t){return()=>{const e=function(){const t=[[]];return{addLine(){t.push([])},addWord(e,r){v(t).push({text:A(r),style:e})},lines:()=>t}}();function r(r){return t(e,r)}r.newline=()=>(e.addLine(),r);for(const t of["bold","italic","plain"])r[t]=a=>(e.addWord(t,a),r);return r}}const ya=ma(function(){const t={plain:t=>t,italic:t=>"<em>"+t+"</em>",bold:t=>"<strong>"+t+"</strong>"};return(e,r)=>e.lines().map(e=>e.map(e=>t[e.style].call(null,e.text(r))).join(" ")).join("<br/>")}()),va=ma(function(){const t={plain:t=>"<tspan>"+t+"</tspan>",italic:t=>'<tspan style="font-style:italic">'+t+"</tspan>",bold:t=>'<tspan style="font-weight:bold">'+t+"</tspan>"};return(e,r)=>e.lines().reduce((e,a,n)=>e+'<tspan x="0" dy="'+(0===n?0:"1.2em")+'">'+a.map(e=>t[e.style].call(null,e.text(r))).join(" ")+"</tspan>","")}());t.AGGLOMERATION_2012_KEY="zurichAgglomeration2012",t.DEFAULT_LEGEND_COLOR_ORDINAL_ROW_HEIGHT=21,t.DEFAULT_WIDTH=516,t.GEO_KEY_DEFAULT=sa,t.RATIO=16/9,t.STADT_KREISE_KEY="zurichStadtKreise",t.STATISTISCHE_QUARTIERE_KEY="zurichStatistischeQuartiere",t.STATISTISCHE_ZONEN_KEY="zurichStatistischeZonen",t.SWITZERLAND_KEY="switzerland",t.WAHL_KREISE_KEY="zurichWahlKreise",t.annotationCircle=function(){return r().prop("x",A).prop("y",A).prop("r",A).prop("dx",A).prop("dy",A).prop("caption",A).render(function(t){const r=e.select(this),a=r.props();ft(r,"pattern","data-area-pattern").call(ht);if(r.selectAll(".sszvis-dataareacircle").data(t).join("circle").classed("sszvis-dataareacircle",!0).attr("cx",a.x).attr("cy",a.y).attr("r",a.r).attr("fill","url(#data-area-pattern)"),a.caption){r.selectAll(".sszvis-dataareacircle__caption").data(t).join("text").classed("sszvis-dataareacircle__caption",!0).attr("x",a.x).attr("y",a.y).attr("dx",a.dx).attr("dy",a.dy).text(a.caption)}})},t.annotationConfidenceArea=function(){return r().prop("x").prop("y0").prop("y1").prop("stroke").prop("strokeWidth").prop("fill").prop("key").key((t,e)=>e).prop("valuesAccessor").valuesAccessor(o).prop("transition").transition(!0).render(function(t){const r=e.select(this),a=r.props();ft(r,"pattern","data-area-pattern").call(ht);const n=e.area().x(a.x).y0(a.y0).y1(a.y1);let s=r.selectAll(".sszvis-area").data(t,a.key).join("path").classed("sszvis-area",!0).style("stroke",a.stroke).attr("fill","url(#data-area-pattern)").order();a.transition&&(s=s.transition().call(mt)),s.attr("d",p(n,a.valuesAccessor)).style("stroke",a.stroke).style("stroke-width",a.strokeWidth).attr("fill","url(#data-area-pattern)")})},t.annotationLine=function(){return r().prop("x1").prop("x2").prop("y1").prop("y2").prop("xScale").prop("yScale").prop("dx",A).dx(0).prop("dy",A).dy(0).prop("caption",A).render(function(t){const r=e.select(this),a=r.props(),n=a.xScale(a.x1),s=a.yScale(a.y1),o=a.xScale(a.x2),i=a.yScale(a.y2);if(r.selectAll(".sszvis-referenceline").data(t).join("line").classed("sszvis-referenceline",!0).attr("x1",n).attr("y1",s).attr("x2",o).attr("y2",i),a.caption){r.selectAll(".sszvis-referenceline__caption").data([0]).join("text").classed("sszvis-referenceline__caption",!0).attr("transform",()=>{const t=o-n,e=i-s,r=180*Math.atan2(e,t)/Math.PI;return"translate("+(n+o)/2+","+(s+i)/2+") rotate("+r+")"}).attr("dx",a.dx).attr("dy",a.dy).text(a.caption)}})},t.annotationRangeFlag=function(){return r().prop("x",A).prop("y0",A).prop("y1",A).render(function(t){const r=e.select(this),a=r.props(),n=p(kt,a.x),s=p(kt,a.y0),o=p(kt,a.y1);r.selectAll(".sszvis-rangeFlag__mark.bottom").data(t).call(zt("bottom",n,s)),r.selectAll(".sszvis-rangeFlag__mark.top").data(t).call(zt("top",n,o));const i=_t().position(t=>[n(t),kt((a.y0(t)+a.y1(t))/2)]);r.call(i)})},t.annotationRangeRuler=function(){return r().prop("x",A).prop("y0",A).prop("y1",A).prop("top").prop("bottom").prop("label").prop("removeStroke").label(A("")).prop("total").prop("flip",A).flip(!1).render(function(t){const r=e.select(this),a=r.props(),n=p(kt,a.x),s=p(kt,a.y0),o=p(kt,a.y1),i=t=>kt((a.y0(t)+a.y1(t))/2);r.selectAll(".sszvis-rangeRuler__rule").data([0]).join("line").classed("sszvis-rangeRuler__rule",!0).attr("x1",n).attr("y1",a.top).attr("x2",n).attr("y2",a.bottom);const l=r.selectAll(".sszvis-rangeRuler--mark").data(t).join("g").classed("sszvis-rangeRuler--mark",!0);l.append("circle").classed("sszvis-rangeRuler__p1",!0),l.append("circle").classed("sszvis-rangeRuler__p2",!0),l.append("text").classed("sszvis-rangeRuler__label-contour",!0),l.append("text").classed("sszvis-rangeRuler__label",!0),l.selectAll(".sszvis-rangeRuler__p1").data(t=>[t]).attr("cx",n).attr("cy",s).attr("r",1.5),l.selectAll(".sszvis-rangeRuler__p2").data(t=>[t]).attr("cx",n).attr("cy",o).attr("r",1.5),l.selectAll(".sszvis-rangeRuler__label").data(t=>[t]).attr("x",t=>{const e=a.flip(t)?-10:10;return n(t)+e}).attr("y",i).attr("dy","0.35em").style("text-anchor",t=>a.flip(t)?"end":"start").text(p(Pt,a.label)),l.selectAll(".sszvis-rangeRuler__label-contour").data(t=>[t]).attr("x",t=>{const e=a.flip(t)?-10:10;return n(t)+e}).attr("y",i).attr("dy","0.35em").style("text-anchor",t=>a.flip(t)?"end":"start").text(p(Pt,a.label)),r.selectAll("g.sszvis-rangeRuler--mark").each(function(){const t=e.select(this),r=t.select("text").node();let s=t.select(".sszvis-rangeRuler__label-contour");s.empty()?(s=e.select(r.cloneNode()).classed("sszvis-rangeRuler__label-contour",!0).classed("sszvis-rangeRuler__label",!1),this.insertBefore(s.node(),r)):s.attr("x",t=>{const e=a.flip(t)?-10:10;return n(t)+e}).attr("y",i).attr("dy","0.35em").style("text-anchor",t=>a.flip(t)?"end":"start"),s.text(r.textContent)}),a.removeStroke||l.attr("stroke","white").attr("stroke-width",.5).attr("stroke-opacity",.75);const c=r.selectAll(".sszvis-rangeRuler__total").data([v(t)]).join("text").classed("sszvis-rangeRuler__total",!0);c.attr("x",t=>{const e=a.flip(t)?-10:10;return n(t)+e}).attr("y",a.top-10).style("text-anchor",t=>a.flip(t)?"end":"start").text("Total "+Pt(a.total));const d=c.node();let u=r.select(".sszvis-rangeRuler__total-contour");u.empty()?(u=e.select(d.cloneNode()).classed("sszvis-rangeRuler__total-contour",!0).classed("sszvis-rangeRuler__total",!1),this.insertBefore(u.node(),d)):u.attr("x",t=>{const e=a.flip(t)?-10:10;return n(t)+e}).attr("y",a.top-10).style("text-anchor",t=>a.flip(t)?"end":"start"),u.text(d.textContent),a.removeStroke||c.attr("stroke","white").attr("stroke-width",.5).attr("stroke-opacity",.75)})},t.annotationRectangle=function(){return r().prop("x",A).prop("y",A).prop("width",A).prop("height",A).prop("dx",A).prop("dy",A).prop("caption",A).render(function(t){const r=e.select(this),a=r.props();ft(r,"pattern","data-area-pattern").call(ht);if(r.selectAll(".sszvis-dataarearectangle").data(t).join("rect").classed("sszvis-dataarearectangle",!0).attr("x",a.x).attr("y",a.y).attr("width",a.width).attr("height",a.height).attr("fill","url(#data-area-pattern)"),a.caption){r.selectAll(".sszvis-dataarearectangle__caption").data(t).join("text").classed("sszvis-dataarearectangle__caption",!0).attr("x",(t,e)=>a.x(t,e)+a.width(t,e)/2).attr("y",(t,e)=>a.y(t,e)+a.height(t,e)/2).attr("dx",a.dx).attr("dy",a.dy).text(a.caption)}})},t.annotationRuler=()=>r().prop("top").prop("bottom").prop("x",A).prop("y",A).prop("label").label(A("")).prop("color").prop("flip",A).flip(!1).prop("labelId",A).prop("reduceOverlap").reduceOverlap(!0).render(function(t){const r=e.select(this),a=r.props(),n=a.labelId||(t=>a.x(t)+"_"+a.y(t));r.selectAll(".sszvis-ruler__rule").data(t,n).join("line").classed("sszvis-ruler__rule",!0).attr("x1",p(kt,a.x)).attr("y1",a.y).attr("x2",p(kt,a.x)).attr("y2",a.bottom);r.selectAll(".sszvis-ruler__dot").data(t,n).join("circle").classed("sszvis-ruler__dot",!0).attr("cx",p(kt,a.x)).attr("cy",p(kt,a.y)).attr("r",3.5).attr("fill",a.color),r.selectAll(".sszvis-ruler__label-outline").data(t,n).join("text").classed("sszvis-ruler__label-outline",!0);const s=r.selectAll(".sszvis-ruler__label").data(t,n).join("text").classed("sszvis-ruler__label",!0),o=p(kt,a.x),i=p(kt,a.y),l=r.selectAll(".sszvis-ruler__label, .sszvis-ruler__label-outline").attr("transform",t=>{const e=o(t),r=i(t);return vt(e+(a.flip(t)?-10:10),r+(r<a.top?2*r:r>a.bottom?0:5))}).style("text-anchor",t=>a.flip(t)?"end":"start").html(a.label);if(a.reduceOverlap){const t=2;let r=10;const a=[],o={};for(l.attr("y",""),s.each(function(t){const e=this.getBoundingClientRect(),r={top:e.top,bottom:e.bottom,dy:0};a.push(r),o[n(t)]=r}),a.sort((t,r)=>e.ascending(t.top,r.top));r--;)for(const[e,r]of a.entries())for(const n of a.slice(e+1)){const e=r.bottom-n.top;if(e>=t){const t=e/2;r.bottom-=t,r.top-=t,r.dy-=t,n.bottom+=t,n.top+=t,n.dy+=t}}l.attr("y",t=>o[n(t)].dy)}}),t.app=t=>{let e,r,{init:a,render:n,actions:s={},fallback:o}=t;Ee(We(a),'An "init" function returning a Promise must be provided.'),Ee(We(n),'A "render" function must be provided.');const i=Object.keys(s).reduce((t,e)=>(t[e]=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];c(e,r)},t),{});function l(t){e||(e=!0,requestAnimationFrame(()=>{n(r,i),e=!1})),We(t)&&t(c)}function c(t,e){Ee(null!=s[t],'Action "'.concat(t,'" is not defined, add it to "actions".'));const a=je(r),n=s[t](a,...e);r=Fe(a),l(n)}const p=je({});a(p).then(t=>{r=Fe(p),l(t),Be.on("resize",l)}).catch(t=>{Ee(!1,t),o&&Me(o.element,{src:o.src})})},t.arity=c,t.aspectRatio=Qe,t.aspectRatio12to5=tr,t.aspectRatio16to10=$e,t.aspectRatio4to3=Ze,t.aspectRatioAuto=nr,t.aspectRatioPortrait=rr,t.aspectRatioSquare=er,t.axisX=ur,t.axisY=hr,t.bar=Cr,t.bounds=jr,t.breakpointCreateSpec=Je,t.breakpointDefaultSpec=Ve,t.breakpointFind=Ne,t.breakpointFindByName=Ge,t.breakpointLap=Ue,t.breakpointMatch=Ie,t.breakpointPalm=Ye,t.breakpointTest=He,t.buttonGroup=function(){return r().prop("values").prop("current").prop("width").width(300).prop("change").change(o).render(function(){const t=e.select(this),r=t.props(),a=r.width/r.values.length,n=t.selectAll(".sszvis-control-optionSelectable").data(["sszvis-control-buttonGroup"],t=>t).join("div").classed("sszvis-control-optionSelectable",!0).classed("sszvis-control-buttonGroup",!0);n.style("width",r.width+"px");n.selectAll(".sszvis-control-buttonGroup__item").data(r.values).join("div").classed("sszvis-control-buttonGroup__item",!0).style("width",a+"px").classed("selected",t=>t===r.current).text(t=>t).on("click",r.change)})},t.cascade=Pr,t.choropleth=function(){const t=e.dispatch("over","out","click"),a=la(),n=da(),s=ua(),o=pa(),i=r().prop("width").prop("height").prop("keyName").keyName(sa).prop("withLake").withLake(!0).prop("anchoredShape").prop("features").prop("borders").prop("lakeFeatures").prop("lakeBorders").prop("lakeFadeOut").lakeFadeOut(!1).delegate("defined",a).delegate("fill",a).delegate("transitionColor",a).delegate("borderColor",n).delegate("strokeWidth",n).delegate("highlight",o).delegate("highlightStroke",o).delegate("highlightStrokeWidth",o).delegate("lakePathColor",s).render(function(r){const i=e.select(this),l=i.props(),c=na(l.width,l.height,l.features,"zurichStadtfeatures"),p=oa(r,l.features,l.keyName);a.geoJson(l.features).mergedData(p).mapPath(c),n.geoJson(l.borders).mapPath(c),s.lakeFeature(l.lakeFeatures).lakeBounds(l.lakeBorders).mapPath(c).fadeOut(l.lakeFadeOut),o.geoJson(l.features).keyName(l.keyName).mapPath(c),i.call(a).call(n),l.withLake&&i.call(s),i.call(o),l.anchoredShape&&(l.anchoredShape.mergedData(p).mapPath(c),i.call(l.anchoredShape)),i.selectAll("[data-event-target]").on("mouseover",function(e){t.call("over",this,e.datum)}).on("mouseout",function(e){t.call("out",this,e.datum)}).on("click",function(e){t.call("click",this,e.datum)})});return i.on=()=>{const e=t.on.apply(t,arguments);return e===t?i:e},i},t.colorLegendDimensions=Qr,t.colorLegendLayout=function(t,r){let{legendLabels:a,axisLabels:n=[],slant:s="horizontal"}=t;const o=Qr(a,zr(r).width),i=a.length>6?W().domain(a):N().domain(a),l=qr().scale(i).horizontalFloat(o.horizontalFloat).rows(o.rows).columnWidth(o.columnWidth).orientation(o.orientation),c=function(t,r){switch(t){case"vertical":return 40+e.max(r,wr);case"diagonal":return 40+Math.sqrt(2*(e.max(r,wr)/2)**2);default:return 60}}(s,n),p=21*o.rows;return{axisLabelPadding:c,legendPadding:p,bottomPadding:c+p,legendWidth:o.legendWidth,legend:l,scale:i}},t.compose=p,t.contains=(t,e)=>t.includes(e),t.createHtmlLayer=function(t,r,a){r||(r=jr()),a||(a={});const n="data-sszvis-html-"+(a.key||"default"),s=l(t)?t:e.select(t);return s.classed("sszvis-outer-container",!0),s.selectAll("[data-sszvis-html-layer]["+n+"]").data([0]).join("div").classed("sszvis-html-layer",!0).attr("data-sszvis-html-layer","").attr(n,"").style("position","absolute").style("left",r.padding.left+"px").style("top",r.padding.top+"px")},t.createSvgLayer=function(t,r,a){r||(r=jr()),a||(a={});const n="data-sszvis-svg-"+(a.key||"default"),s=a.title||"",o=a.description||"",i=(l(t)?t:e.select(t)).selectAll("svg["+n+"]").data([0]).join("svg").classed("sszvis-svg-layer",!0).attr(n,"").attr("role","img").attr("aria-label",s+" – "+o).attr("height",r.height).attr("width",r.width);return i.selectAll("title").data([0]).join("title").text(s),i.selectAll("desc").data([0]).join("desc").text(o).classed("sszvis-svg-layer",!0).attr(n,"").attr("role","img"),i.selectAll("[data-sszvis-svg-layer]").data(()=>[0]).join("g").attr("data-sszvis-svg-layer","").attr("transform","translate("+r.padding.left+","+r.padding.top+")")},t.dataAreaPattern=ht,t.defaultTransition=mt,t.defined=d,t.derivedSet=(t,e)=>{const r=e||o,a=[],n=[];let s,i;for(let e=0,o=t.length;e<o;++e)s=t[e],i=r(s,e,t),a.includes(i)||(a.push(i),n.push(s));return n},t.dimensionsHeatTable=function(t,e,r,a,n){n||(n={}),n.top||(n.top=0),n.right||(n.right=0),n.bottom||(n.bottom=0),n.left||(n.left=0);const s=t-n.left-n.right,o=Math.min((s-e*(r-1))/r,30),i=o+e,l=r*i-e;return{side:o,paddedSide:i,padRatio:1-o/i,width:l,height:a*i-e,centeredOffset:Math.max((s-l)/2,0)}},t.dimensionsHorizontalBarChart=function(t){const e=24*t+20*(t-1);return{barHeight:24,padHeight:20,padRatio:1-24/44,outerRatio:0,axisOffset:-22,barGroupHeight:e,totalHeight:e+0}},t.dimensionsVerticalBarChart=function(t,e){const r=1-.7,a=e-1;let n=t*r/(r*a+.7*e),s=(t-n*a)/e;s>48&&(s=48,n=(t-s*e)/a),n<2&&(n=2),n>100&&(n=100);const o=s*e+n*a;return{barWidth:s,padWidth:n,padRatio:1-s/(s+n),outerRatio:(t-o)/2/(s+n),barGroupWidth:o,totalWidth:t}},t.dot=function(){return r().prop("x",A).prop("y",A).prop("radius").prop("stroke").prop("fill").prop("transition").transition(!0).render(function(t){const r=e.select(this),a=r.props();let n=r.selectAll(".sszvis-circle").data(t).join("circle").classed("sszvis-circle",!0).attr("cx",a.x).attr("cy",a.y).attr("r",a.radius).attr("stroke",a.stroke).attr("fill",a.fill);a.transition&&(n=n.transition(mt())),n.attr("cx",a.x).attr("cy",a.y).attr("r",a.radius);const s=_t().position(t=>[a.x(t),a.y(t)]);r.call(s)})},t.ensureDefsElement=ft,t.every=(t,e)=>{for(const r of e)if(!t(r))return!1;return!0},t.fallbackCanvasUnsupported=()=>!!!document.createElement("canvas").getContext,t.fallbackRender=Me,t.fallbackUnsupported=()=>!(!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect),t.fastTransition=()=>e.transition().ease(gt).duration(50),t.filledArray=u,t.find=h,t.first=f,t.firstTouch=g,t.fitTooltip=function(t,e){const r=Math.min(1*e.innerWidth/4,100),a=Math.max(3*e.innerWidth/4,e.innerWidth-100);return e=>{const n=e.x;return n>a?"right":n<r?"left":t}},t.flatten=t=>t.flat(),t.foldPattern=(t,e)=>{const r=e[t];if("function"==typeof r)return r();throw new Error("[foldPattern] No definition provided for key: "+t)},t.formatAge=t=>String(Math.round(t)),t.formatAxisTimeFormat=jt,t.formatFractionPercent=t=>Pt(100*t)+" %",t.formatMonth=Ft,t.formatNone=()=>"",t.formatNumber=Pt,t.formatPercent=t=>Pt(t)+" %",t.formatPreciseNumber=function t(e,r){return arguments.length>1&&void 0!==r?t(e)(r):t=>{const r=Math.abs(t);return r>=100&&r<1e4?St("."+e+"f")(t):St(",."+e+"f")(t)}},t.formatText=Rt,t.formatYear=Mt,t.functor=A,t.getGeoJsonCenter=ia,t.groupedBars=function(){return r().prop("groupScale").prop("groupSize").prop("groupWidth").prop("groupSpace").groupSpace(.05).prop("y",A).prop("height").prop("fill").prop("stroke").prop("defined",A).defined(!0).render(function(t){const r=e.select(this),a=r.props(),n=e.scaleBand().domain(e.range(a.groupSize)).padding(a.groupSpace).paddingOuter(0).rangeRound([0,a.groupWidth]),s=r.selectAll("g.sszvis-bargroup").data(t).join("g").classed("sszvis-bargroup",!0).selectAll("g.sszvis-barunit").data(t=>t).join("g").classed("sszvis-barunit",!0);s.each((t,e)=>{t.__sszvisGroupedBarIndex__=e});const o=s.filter(a.defined);o.selectAll("*").remove(),o.attr("transform",()=>vt(0,0)),o.append("rect").classed("sszvis-bar",!0).attr("fill",a.fill).attr("x",t=>a.groupScale(t)+n(t.__sszvisGroupedBarIndex__)).attr("y",a.y).attr("width",n.bandwidth()).attr("height",a.height);const i=s.filter(b(a.defined));i.selectAll("*").remove(),i.attr("transform",(t,e)=>vt(a.groupScale(t)+n(t.__sszvisGroupedBarIndex__)+n.bandwidth()/2,a.y(t,e))),i.append("line").classed("sszvis-bar--missing line1",!0).attr("x1",-4).attr("y1",-4).attr("x2",4).attr("y2",4),i.append("line").classed("sszvis-bar--missing line2",!0).attr("x1",4).attr("y1",-4).attr("x2",-4).attr("y2",4);const l=_t().position(t=>{let e=0,r=1/0;for(const[s,o]of t.entries())e+=a.groupScale(o)+n(o.__sszvisGroupedBarIndex__)+n.bandwidth()/2,r=Math.min(r,a.y(o,s));return[e/t.length,r]});r.call(l)})},t.halfPixel=kt,t.handleRuler=function(){return r().prop("x",A).prop("y",A).prop("top").prop("bottom").prop("label").label(A("")).prop("color").prop("flip",A).flip(!1).render(function(t){const r=e.select(this),a=r.props(),n=p(kt,a.x),s=p(kt,a.y),o=a.bottom-4,i=a.top-24,l=r.selectAll(".sszvis-handleRuler__group").data([0]).join("g").classed("sszvis-handleRuler__group",!0);l.append("line").classed("sszvis-ruler__rule",!0),l.append("rect").classed("sszvis-handleRuler__handle",!0),l.append("line").classed("sszvis-handleRuler__handle-mark",!0),l.selectAll(".sszvis-ruler__rule").attr("x1",n).attr("y1",kt(a.top)).attr("x2",n).attr("y2",kt(o)),l.selectAll(".sszvis-handleRuler__handle").attr("x",t=>n(t)-5).attr("y",kt(i)).attr("width",10).attr("height",24).attr("rx",2).attr("ry",2),l.selectAll(".sszvis-handleRuler__handle-mark").attr("x1",n).attr("y1",kt(i+24*.15)).attr("x2",n).attr("y2",kt(i+20.4));l.selectAll(".sszvis-ruler__dot").data(t).join("circle").classed("sszvis-ruler__dot",!0).attr("cx",n).attr("cy",s).attr("r",3.5).attr("fill",a.color),r.selectAll(".sszvis-ruler__label-outline").data(t).join("text").classed("sszvis-ruler__label-outline",!0),r.selectAll(".sszvis-ruler__label").data(t).join("text").classed("sszvis-ruler__label",!0),r.selectAll(".sszvis-ruler__label, .sszvis-ruler__label-outline").attr("transform",t=>{const e=p(kt,a.x)(t),r=p(kt,a.y)(t);return vt(e+(a.flip(t)?-10:10),r+(r<a.top?2*r:r>a.bottom?0:5))}).style("text-anchor",t=>a.flip(t)?"end":"start").html(a.label)})},t.hashableSet=(t,e)=>{const r=e||o,a={},n=[];let s;for(let e=0,o=t.length;e<o;++e)s=r(t[e],e,t),a[s]||(a[s]=!0,n.push(s));return n},t.heatTableMissingValuePattern=t=>{const e=tt(),r="#A4A4A4",a=.35,n=.65;t.attr("patternUnits","objectBoundingBox").attr("patternContentUnits","objectBoundingBox").attr("x",0).attr("y",0).attr("width",1).attr("height",1),t.append("rect").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("fill",e),t.append("line").attr("x1",a).attr("y1",a).attr("x2",n).attr("y2",n).attr("stroke-width",.035).attr("stroke",r),t.append("line").attr("x1",n).attr("y1",a).attr("x2",a).attr("y2",n).attr("stroke-width",.035).attr("stroke",r)},t.identity=o,t.isFunction=t=>"function"==typeof t,t.isNull=m,t.isNumber=t=>"[object Number]"===Object.prototype.toString.call(t)&&!Number.isNaN(t),t.isObject=y,t.isSelection=l,t.isString=i,t.last=v,t.layoutPopulationPyramid=function(t,e){const r=Math.min(rr(t),480),a=1*(e-1);let n=Math.round((r-a)/e);n=Math.max(n,2);const s=e*n+a;let o=s-n;const i=n+1,l=[];for(;o>=0;)l.push(o),o-=i;const c=Math.min(t/2,.8*rr.MAX_HEIGHT/2);return{barHeight:n,padding:1,totalHeight:s,positions:l,maxBarLength:c,chartPadding:Math.max((t-2*c)/2,1)}},t.layoutSmallMultiples=function(){return r().prop("width").prop("height").prop("paddingX").prop("paddingY").prop("rows").prop("cols").render(function(t){const r=e.select(this),a=r.props(),n=(a.width-a.paddingX*(a.cols-1))/a.cols,s=(a.height-a.paddingY*(a.rows-1))/a.rows,o=n/2,i=s/2,l=r.selectAll("g.sszvis-multiple").data(t).join("g").classed("sszvis-g sszvis-multiple",!0);l.selectAll("g.sszvis-multiple-chart").data(t=>[t.values]).join("g").classed("sszvis-multiple-chart",!0),l.datum((t,e)=>(t.gx=e%a.cols*(n+a.paddingX),t.gw=n,t.cx=o,t.gy=Math.floor(e/a.cols)*(s+a.paddingY),t.gh=s,t.cy=i,t)).attr("transform",t=>"translate("+t.gx+","+t.gy+")")})},t.layoutStackedAreaMultiples=function(t,e,r){r||(r=.1);const a=t/(e-r),n=a*(1-r),s=[];let o=n;for(;o-t<1;)s.push(o),o+=a;return{range:s,bandHeight:n,padHeight:a*r}},t.legendColorBinned=function(){return r().prop("scale").prop("displayValues").prop("endpoints").prop("width").width(200).prop("labelFormat").labelFormat(o).render(function(){const t=e.select(this),r=t.props();if(!r.scale)return or("legend.binnedColorScale - a scale must be specified.");if(!r.displayValues)return or("legend.binnedColorScale - display values must be specified.");if(!r.endpoints)return or("legend.binnedColorScale - endpoints must be specified");const a=[0,r.width-10],n=e.scaleLinear().domain(r.endpoints).range(a);let s=0;const o=[];let i=r.endpoints[0];for(const t of r.displayValues){const e=n(t)-s,a=s%1;o.push({x:Math.floor(5+s),w:e+a,c:r.scale(i),p:t}),s+=e,i=t}o.push({x:Math.floor(5+s),w:a[1]-s,c:r.scale(i)});t.selectAll("circle.sszvis-legend__circle").data(r.endpoints).join("circle").classed("sszvis-legend__circle",!0).attr("r",5).attr("cy",5).attr("cx",(t,e)=>0===e?5:r.width-5).attr("fill",r.scale);t.selectAll("rect.sszvis-legend__crispmark").data(o).join("rect").classed("sszvis-legend__crispmark",!0).attr("x",t=>t.x).attr("y",0).attr("width",t=>t.w).attr("height",10).attr("fill",t=>t.c);const l=o.slice(0,-1);t.selectAll("line.sszvis-legend__crispmark").data(l).join("line").classed("sszvis-legend__crispmark",!0).attr("x1",t=>kt(t.x+t.w)).attr("x2",t=>kt(t.x+t.w)).attr("y1",11).attr("y2",16).attr("stroke","#B8B8B8");t.selectAll(".sszvis-legend__axislabel").data(l).join("text").classed("sszvis-legend__axislabel",!0).style("text-anchor","middle").attr("transform",t=>"translate("+(t.x+t.w)+",30)").text(t=>r.labelFormat(t.p))})},t.legendColorLinear=function(){return r().prop("scale").prop("displayValues").displayValues([]).prop("width").width(200).prop("segments").segments(8).prop("labelText").prop("labelFormat").labelFormat(o).render(function(){const t=e.select(this),r=t.props();if(!r.scale)return or("legend.linearColorScale - a scale must be specified."),!1;const a=r.scale.domain();let n=r.displayValues;0===n.length&&r.scale.ticks&&(n=r.scale.ticks(r.segments-1)),n.push(v(a));const s=n.length>0?r.width/n.length:0;t.selectAll("rect.sszvis-legend__mark").data(n).join("rect").classed("sszvis-legend__mark",!0).attr("x",(t,e)=>e*s-1).attr("y",0).attr("width",s+1).attr("height",10).attr("fill",t=>r.scale(t));const o=[f(a),v(a)],i=r.labelText||o;t.selectAll("circle.ssvis-legend--mark").data(o).join("circle").attr("class","ssvis-legend--mark").attr("cx",(t,e)=>e*r.width).attr("cy",5).attr("r",5).attr("fill",t=>r.scale(t));const l=t.selectAll(".sszvis-legend__label").data(i).join("text").classed("sszvis-legend__label",!0);l.style("text-anchor",(t,e)=>0===e?"end":"start").attr("dy","0.35em").attr("transform",(t,e)=>"translate("+(e*r.width+16*(0===e?-1:1))+", 5)").text((t,e)=>r.labelFormat(t,e))})},t.legendColorOrdinal=qr,t.legendRadius=function(){return r().prop("scale").prop("tickFormat").tickFormat(o).prop("tickValues").render(function(){const t=e.select(this),r=t.props(),a=r.scale.domain(),n=r.tickValues||[a[1],r.scale.invert(e.mean(r.scale.range())),a[0]],s=lr(r.scale)[1],o=t.selectAll("g.sszvis-legend__elementgroup").data([0]).join("g").attr("class","sszvis-legend__elementgroup");o.attr("transform",vt(kt(s),kt(s)));function i(t){return s-2*r.scale(t)}o.selectAll("circle.sszvis-legend__greyline").data(n).join("circle").classed("sszvis-legend__greyline",!0).attr("r",r.scale).attr("stroke-width",1).attr("cy",function(t){return s-r.scale(t)});o.selectAll("line.sszvis-legend__dashedline").data(n).join("line").classed("sszvis-legend__dashedline",!0).attr("x1",0).attr("y1",i).attr("x2",s+15).attr("y2",i);o.selectAll(".sszvis-legend__label").data(n).join("text").attr("class","sszvis-legend__label sszvis-legend__label--small").attr("dx",s+18).attr("y",i).attr("dy","0.35em").text(r.tickFormat)})},t.line=function(){return r().prop("x").prop("y").prop("stroke").prop("strokeWidth").prop("defined").prop("key").key((t,e)=>e).prop("valuesAccessor").valuesAccessor(o).prop("transition").transition(!0).render(function(t){const r=e.select(this),a=r.props(),n=e.line().defined(void 0===a.defined?p(b(isNaN),a.y):a.defined).x(a.x).y(a.y);let s=r.selectAll(".sszvis-line").data(t,a.key).join("path").classed("sszvis-line",!0).style("stroke",a.stroke);s.order(),a.transition&&(s=s.transition(mt())),s.attr("d",p(n,a.valuesAccessor)).style("stroke",a.stroke).style("stroke-width",a.strokeWidth)})},t.loadError=t=>{or(t)},t.locale=At,t.mapLakeFadeGradient=dt,t.mapLakeGradientMask=ut,t.mapLakePattern=pt,t.mapMissingValuePattern=ct,t.mapRendererBase=la,t.mapRendererBubble=function(){const t=e.dispatch("over","out","click"),a=r().prop("mergedData").prop("mapPath").prop("radius",A).prop("fill",A).prop("strokeColor",A).strokeColor("#ffffff").prop("strokeWidth",A).strokeWidth(1).prop("transition").transition(!0).render(function(){const r=e.select(this),a=r.props(),n=p(a.radius,ca),s=r.selectGroup("anchoredCircles").selectAll(".sszvis-anchored-circle").data(a.mergedData,t=>t.geoJson.id).join("circle").attr("class","sszvis-anchored-circle sszvis-anchored-circle--entering").attr("r",n).on("mouseover",function(e){t.call("over",this,e.datum)}).on("mouseout",function(e){t.call("out",this,e.datum)}).on("click",function(e){t.call("click",this,e.datum)}).attr("transform",t=>{const e=a.mapPath.projection()(ia(t.geoJson));return vt(e[0],e[1])}).style("fill",t=>a.fill(t.datum)).style("stroke",t=>a.strokeColor(t.datum)).style("stroke-width",t=>a.strokeWidth(t.datum)).sort((t,e)=>a.radius(e.datum)-a.radius(t.datum));if(s.classed("sszvis-anchored-circle--entering",!1),a.transition){const t=mt();s.exit().transition(t).attr("r",0).remove(),s.transition(t).attr("r",n)}else s.exit().remove(),s.attr("r",n)});return a.on=()=>{const e=t.on.apply(t,arguments);return e===t?a:e},a},t.mapRendererGeoJson=function(){const t=e.dispatch("over","out","click"),a=r().prop("dataKeyName").dataKeyName(sa).prop("geoJsonKeyName").geoJsonKeyName("id").prop("geoJson").prop("mapPath").prop("defined",A).defined(!0).prop("fill",A).fill("black").prop("stroke",A).stroke("black").prop("strokeWidth",A).strokeWidth(1.25).prop("transitionColor").transitionColor(!0).render(function(r){const a=e.select(this),n=a.props();ft(a,"pattern","missing-pattern").call(ct);const s=_(n.dataKeyName),o=_(n.geoJsonKeyName),i=r.reduce((t,e)=>(t[s(e)]=e,t)),l=n.geoJson.features.map(t=>({geoJson:t,datum:i[o(t.properties)]}));function c(t){return d(t.datum)&&n.defined(t.datum)?n.fill(t.datum):"url(#missing-pattern)"}const p=a.selectAll(".sszvis-map__geojsonelement").data(l).join("path").classed("sszvis-map__geojsonelement",!0).attr("data-event-target","").attr("fill",c);a.selectAll(".sszvis-map__geojsonelement--undefined").attr("fill",c),p.classed("sszvis-map__geojsonelement--undefined",t=>!d(t.datum)||!n.defined(t.datum)).attr("d",t=>n.mapPath(t.geoJson)),n.transitionColor?p.transition().call(yt).attr("fill",c):p.attr("fill",c),p.attr("stroke",function(t){return d(t.datum)&&n.defined(t.datum)?n.stroke(t.datum):""}).attr("stroke-width",n.strokeWidth),a.selectAll("[data-event-target]").on("mouseover",e=>{t.over(e.datum)}).on("mouseout",e=>{t.out(e.datum)}).on("click",e=>{t.click(e.datum)});const u=_t().position(t=>{t.geoJson.properties||(t.geoJson.properties={});let r=t.geoJson.properties.sphericalCentroid;return r||(t.geoJson.properties.sphericalCentroid=r=e.geoCentroid(t.geoJson)),n.mapPath.projection()(r)});a.selectGroup("tooltipAnchors").datum(l).call(u)});return a.on=()=>{const e=t.on.apply(t,arguments);return e===t?a:e},a},t.mapRendererHighlight=pa,t.mapRendererImage=function(){return r().prop("projection").prop("src").prop("geoBounds").prop("opacity").opacity(1).render(function(){const t=e.select(this),r=t.props(),a=t.selectAll(".sszvis-map__image").data([0]).join("img").classed("sszvis-map__image",!0),n=r.projection(r.geoBounds[0]),s=r.projection(r.geoBounds[1]);a.attr("src",r.src).style("left",Math.round(n[0])+"px").style("top",Math.round(n[1])+"px").style("width",Math.round(s[0]-n[0])+"px").style("height",Math.round(s[1]-n[1])+"px").style("opacity",r.opacity)})},t.mapRendererMesh=da,t.mapRendererPatternedLakeOverlay=ua,t.mapRendererRaster=function(){return r().prop("debug").debug(!1).prop("width").prop("height").prop("position").prop("cellSide").cellSide(2).prop("fill",A).prop("opacity").opacity(1).render(function(t){const r=e.select(this),a=r.props(),n=r.selectAll(".sszvis-map__rasterimage").data([0]).join("canvas").classed("sszvis-map__rasterimage",!0);n.attr("width",a.width).attr("height",a.height).style("opacity",a.opacity);const s=n.node().getContext("2d");s.clearRect(0,0,a.width,a.height),a.debug&&(s.fillStyle="rgba(255, 0, 0, 0.2)",s.fillRect(0,0,a.width,a.height));const o=a.cellSide/2;for(const e of t){const t=a.position(e);s.fillStyle=a.fill(e),s.fillRect(t[0]-o,t[1]-o,a.cellSide,a.cellSide)}})},t.measureAxisLabel=wr,t.measureDimensions=zr,t.measureLegendLabel=Sr,t.measureText=Ar,t.memoize=w,t.modularTextHTML=ya,t.modularTextSVG=va,t.move=yr,t.muchDarker=t=>e.hsl(t).darker(.7),t.nestedStackedBarsVertical=()=>r().prop("offset",A).prop("xScale",A).prop("yScale",A).prop("fill",A).prop("tooltip",A).prop("xAcc",A).prop("xLabel",A).prop("xLabel",A).prop("slant").render(function(t){const r=e.select(this),a=r.props(),{offset:n,xScale:s,yScale:o,fill:i,tooltip:l,xAcc:c,xLabel:p}=a,d=ur.ordinal().scale(s).ticks(1).tickSize(0).orient("bottom").slant(a.slant).title(p),u=r.selectAll("[data-nested-stacked-bars]").data(t).join("g").attr("data-nested-stacked-bars",t=>c(t[0][0].data));u.attr("transform",t=>"translate(".concat(n(t)," 0)")),u.selectGroup("nested-x-axis").attr("transform",vt(0,o(0))).call(d);const h=Hr().xScale(s).width(s.bandwidth()).yScale(o).fill(i);u.selectGroup("barchart").call(h).selectAll("[data-tooltip-anchor]").call(l)}),t.not=b,t.panning=function(){const t=e.dispatch("start","pan","end"),a=r().prop("elementSelector").render(function(){const r=e.select(this),a=r.props();r.selectAll(a.elementSelector).attr("data-sszvis-behavior-pannable","").classed("sszvis-interactive",!0).on("mouseenter",function(){t.apply("start",this,arguments)}).on("mousemove",function(){t.apply("pan",this,arguments)}).on("mouseleave",function(){t.apply("end",this,arguments)}).on("touchstart",function(e){e.preventDefault(),t.apply("start",this,arguments)}).on("touchmove",function(e){e.preventDefault();var r;null===(r=g(e),_r(br(r)))?t.apply("end",this,arguments):t.apply("pan",this,arguments)}).on("touchend",function(){t.apply("end",this,arguments)})});return a.on=()=>{const e=t.on.apply(t,arguments);return e===t?a:e},a},t.parseDate=t=>fa(t),t.parseNumber=t=>""===t.trim()?Number.NaN:+t,t.parseYear=t=>ga(t),t.pie=function(){return r().prop("radius").prop("fill").prop("stroke").prop("angle",A).render(function(t){const r=e.select(this),a=r.props(),n=a.stroke||"#FFFFFF";let s=0;for(const e of t)e._a0=s,(null==e.a0||isNaN(e.a0))&&(e.a0=s),s+=a.angle(e),e._a1=s,(null==e.a1||isNaN(e.a1))&&(e.a1=s);const o=e.arc().innerRadius(4).outerRadius(a.radius).startAngle(t=>t.a0).endAngle(t=>t.a1);r.selectAll(".sszvis-path").each((e,r)=>{t[r]&&(t[r].a0=e.a0,t[r].a1=e.a1)}).data(t).join("path").classed("sszvis-path",!0).attr("transform","translate("+a.radius+","+a.radius+")").attr("fill",a.fill).attr("stroke",n).transition(mt()).attr("transform","translate("+a.radius+","+a.radius+")").attrTween("d",t=>{const r=e.interpolate(t.a0,t._a0),a=e.interpolate(t.a1,t._a1);return e=>(t.a0=r(e),t.a1=a(e),o(t))}).attr("fill",a.fill).attr("stroke",n);const i=_t().position(t=>{const e=t.a0+Math.abs(t.a1-t.a0)/2-Math.PI/2,r=2*a.radius/3;return[a.radius+Math.cos(e)*r,a.radius+Math.sin(e)*r]});r.datum(t).call(i)})},t.pixelsFromGeoDistance=(t,e,r)=>{const a=r/(2*Math.PI*6367475)*360/2,n=[[e[0]-a,e[1]-a],[e[0]+a,e[1]+a]].map(t);return(Math.abs(n[1][0]-n[0][0])+Math.abs(n[1][1]-n[0][1]))/2},t.prepareMergedGeoData=oa,t.prop=_,t.propOr=k,t.pyramid=function(){return r().prop("barHeight",A).prop("barWidth",A).prop("barPosition",A).prop("barFill",A).barFill("#000").prop("tooltipAnchor").tooltipAnchor([.5,.5]).prop("leftAccessor").prop("rightAccessor").prop("leftRefAccessor").prop("rightRefAccessor").render(function(t){const r=e.select(this),a=r.props(),n=Cr().x(t=>-.5-a.barWidth(t)).y(a.barPosition).height(a.barHeight).width(a.barWidth).fill(a.barFill).tooltipAnchor(a.tooltipAnchor),s=Cr().x(.5).y(a.barPosition).height(a.barHeight).width(a.barWidth).fill(a.barFill).tooltipAnchor(a.tooltipAnchor),o=Ir().barPosition(a.barPosition).barWidth(a.barWidth).mirror(!0),i=Ir().barPosition(a.barPosition).barWidth(a.barWidth);r.selectGroup("left").datum(a.leftAccessor(t)).call(n),r.selectGroup("right").datum(a.rightAccessor(t)).call(s),r.selectGroup("leftReference").datum(a.leftRefAccessor?[a.leftRefAccessor(t)]:[]).call(o),r.selectGroup("rightReference").datum(a.rightRefAccessor?[a.rightRefAccessor(t)]:[]).call(i)})},t.range=lr,t.responsiveProps=function(){let t=Ve();const e={};function r(r){if(!(y(r)&&(a=r,d(a)&&d(a.width)&&d(a.screenWidth)&&d(a.screenHeight))))return sr("Could not determine the current breakpoint, returning the default props"),Object.keys(e).reduce((t,e,r)=>(t[r]=e._,t),{});var a;const n=Ie(t,r);return Object.keys(e).reduce((a,s)=>{const o=e[s];if(!function(t,e){if(!d(t._))return!1;for(const r in t)if(Object.hasOwn(t,r)&&"_"!==r&&!d(Ge(e,r)))return!1;return!0}(o,t))return sr('responsiveProps was given an invalid propSpec for property: "'+s+'". The spec: ',o),a;const i=h(t=>d(o[t.name]),n);return a[s]=o[i.name](r.width),a},{})}return r.prop=(t,a)=>{var n;return e[t]=(n=a,Object.keys(n).reduce((t,e)=>(t[e]=A(n[e]),t),{})),r},r.breakpoints=e=>0===arguments.length?t:(t=Je(e),r),r},t.roundTransformString=t=>{const e=p(Math.floor,Number);return t.replace(/(translate\()\s*([\d ,.]+)\s*(\))/i,(t,r,a,n)=>r+a.replace(","," ").replace(/\s+/," ").split(" ").map(e).join(",")+n)},t.rulerLabelVerticalSeparate=t=>r=>{const a=[];r.selectAll("text").each(function(){e.select(this).attr("y","")}),r.selectAll(".sszvis-ruler__label").each(function(e){const r=this.getBoundingClientRect();a.push({category:t(e),top:r.top,bottom:r.bottom,dy:0})}),a.sort((t,r)=>e.ascending(t.top,r.top));for(let t=0;t<10;t++)for(let t=0;t<a.length;t++)for(let e=t+1;e<a.length;e++){if(t===e)continue;const r=a[t],n=a[e],s=r.bottom-n.top;s>=2&&(r.bottom-=s/2,r.top-=s/2,r.dy-=s/2,n.bottom+=s/2,n.top+=s/2,n.dy+=s/2)}r.selectAll("text").each(function(r){const n=h(e=>e.category===t(r),a);n&&e.select(this).attr("y",n.dy)})},t.sankey=function(){return r().prop("sizeScale").prop("columnPosition").prop("nodeThickness").prop("nodePadding").prop("columnPadding",A).prop("columnLabel",A).columnLabel("").prop("columnLabelOffset",A).columnLabelOffset(0).prop("linkCurvature").linkCurvature(.5).prop("nodeColor",A).prop("linkColor",A).prop("linkSort",A).linkSort((t,e)=>t.value-e.value).prop("labelSide",A).labelSide("left").prop("labelSideSwitch").prop("labelOpacity",A).labelOpacity(1).prop("labelHitBoxSize").labelHitBoxSize(0).prop("nameLabel").nameLabel(o).prop("linkSourceLabels").linkSourceLabels([]).prop("linkTargetLabels").linkTargetLabels([]).prop("linkLabel",A).render(function(t){const r=e.select(this),a=r.props(),n=_("id"),s=t=>Math.floor(a.columnPadding(t.columnIndex)+a.sizeScale(t.valueOffset)+a.nodePadding*t.nodeIndex),o=t=>a.columnPosition(t.columnIndex),i=t=>s(t),l=()=>Math.max(a.nodeThickness,1),c=t=>Math.ceil(Math.max(a.sizeScale(t.value),1)),p=Cr().x(o).y(i).width(l).height(c).fill(a.nodeColor),d=r.selectGroup("nodes").datum(t.nodes);d.call(p);const u=_t().position(t=>[o(t)+l()/2,i(t)+c(t)/2]);d.call(u);const h=t=>a.columnPosition(t)+a.nodeThickness/2;d.selectAll(".sszvis-sankey-column-label").data(t.columnLengths).join("text").attr("class","sszvis-sankey-label sszvis-sankey-weak-label sszvis-sankey-column-label").attr("transform",(t,e)=>vt(h(e)+a.columnLabelOffset(t,e),-24)).text((t,e)=>a.columnLabel(e));d.selectAll(".sszvis-sankey-column-label-tick").data(t.columnLengths).join("line").attr("class","sszvis-sankey-column-label-tick").attr("x1",(t,e)=>kt(h(e))).attr("x2",(t,e)=>kt(h(e))).attr("y1",kt(-16)).attr("y2",kt(-12));const f=t=>[a.columnPosition(t.src.columnIndex)+a.nodeThickness+1,a.columnPosition(t.tgt.columnIndex)-1,s(t.src)+a.sizeScale(t.srcOffset)+a.sizeScale(t.value)/2,s(t.tgt)+a.sizeScale(t.tgtOffset)+a.sizeScale(t.value)/2],g=t=>{const e=f(t);return r=e[0],a=e[1],n=e[2],s=e[3],[r,a,n,s];var r,a,n,s},m=r.selectGroup("links");m.selectAll(".sszvis-link").data(t.links,n).join("path").attr("class","sszvis-link").attr("fill","none").attr("d",t=>{const r=f(t),n=e.interpolateNumber(r[0],r[1]),s=n(a.linkCurvature),o=n(1-a.linkCurvature);return i=r[0],l=s,c=o,p=r[1],d=r[2],u=r[3],"M"+i+","+d+"C"+l+","+d+" "+c+","+u+" "+p+","+u;var i,l,c,p,d,u}).attr("stroke-width",t=>Math.max(a.sizeScale(t.value),1)).attr("stroke",a.linkColor).sort(a.linkSort),m.datum(t.links);const y=_t().position(t=>{const e=g(t);return[(e[0]+e[1])/2,(e[2]+e[3])/2]});m.call(y);const v=r.selectGroup("linklabels");v.selectAll(".sszvis-sankey-link-source-label").data(a.linkSourceLabels).join("text").attr("class","sszvis-sankey-label sszvis-sankey-strong-label sszvis-sankey-link-source-label").attr("transform",t=>{const e=g(t);return vt(e[0]+6,e[2])}).text(a.linkLabel);v.selectAll(".sszvis-sankey-link-target-label").data(a.linkTargetLabels).join("text").attr("class","sszvis-sankey-label sszvis-sankey-strong-label sszvis-sankey-link-target-label").attr("transform",t=>{const e=g(t);return vt(e[1]-6,e[3])}).text(a.linkLabel);const b=t=>{let e=a.labelSide(t);return a.labelSideSwitch&&(e="left"===e?"right":"left"),e},k=r.selectGroup("nodelabels");k.selectAll(".sszvis-sankey-node-label").data(t.nodes).join("text").attr("class","sszvis-sankey-label sszvis-sankey-weak-label sszvis-sankey-node-label").text(t=>a.nameLabel(t.id)).attr("text-align","middle").attr("text-anchor",t=>"left"===b(t.columnIndex)?"end":"start").attr("x",t=>"left"===b(t.columnIndex)?o(t)-6:o(t)+a.nodeThickness+6).attr("y",t=>i(t)+c(t)/2).style("opacity",a.labelOpacity);k.selectAll(".sszvis-sankey-hitbox").data(t.nodes).join("rect").attr("class","sszvis-sankey-hitbox").attr("fill","transparent").attr("x",t=>o(t)+("left"===b(t.columnIndex)?-a.labelHitBoxSize:0)).attr("y",t=>i(t)-a.nodePadding/2).attr("width",a.labelHitBoxSize+a.nodeThickness).attr("height",t=>c(t)+a.nodePadding)})},t.sankeyLayout=(t,r,a,n)=>{const s=e.min(t.map(t=>{const e=.15*a/(t-1);return Math.max(12,Math.min(50,e))})),o=e.min(t.map((t,e)=>Math.max(1,a-(t-1)*s)/r[e])),i=s/o,l=s,c=e.max(r),p=t.map((t,e)=>r[e]*o+(t-1)*l),d=e.max(p),u=t.map((t,e)=>(d-p[e])/2),h=[0,c],f=[0,c*o],g=t.length;return{valuePadding:i,nodePadding:l,columnPaddings:u,valueDomain:h,valueRange:f,nodeThickness:20,columnDomain:[0,1],columnRange:[0,(n-20)/(g-1)]}},t.sankeyPrepareData=()=>{let t=o,r=o,a=o,n=[];const s=_("value"),i=(t,r)=>e.ascending(s(t),s(r)),l=(t,r)=>e.descending(s(t),s(r));let c=l;const p=o=>{const i=n.reduce((t,e,r)=>{for(const a of e){t.has(a)&&sr("Duplicate column member id passed to sszvis.layout.sankey.prepareData.column:",a,"The existing value will be overwritten");const e={id:a,columnIndex:r,nodeIndex:0,value:0,valueOffset:0,linksFrom:[],linksTo:[]};t.set(a,e)}return t},new Map),p=o.map(e=>{const n=t(e),s=r(e),o=+a(e)||0,l=i.get(n),c=i.get(s);if(!l)return sr("Found invalid source column id:",n),null;if(!c)return sr("Found invalid target column id:",s),null;const p={id:ta(),value:o,src:l,srcOffset:0,tgt:c,tgtOffset:0};return l.linksFrom.push(p),c.linksTo.push(p),p}),d=[...i.values()],h=d.reduce((t,r)=>{const a=e.sum(r.linksFrom,s),n=e.sum(r.linksTo,s);return r.value=Math.max(0,a,n),t[r.columnIndex]+=r.value,t},u(n.length,0)),f=n.map(t=>t.length);d.sort(c),p.sort(l),d.reduce((t,e)=>(e.valueOffset=t[0][e.columnIndex],e.nodeIndex=t[1][e.columnIndex],t[0][e.columnIndex]+=e.value,t[1][e.columnIndex]+=1,t),[u(n.length,0),u(n.length,0)]);for(const t of d)t.linksFrom.sort((t,e)=>t.tgt.nodeIndex-e.tgt.nodeIndex),t.linksTo.sort((t,e)=>t.src.nodeIndex-e.src.nodeIndex),t.linksFrom.reduce((t,e)=>(e.srcOffset=t,t+s(e)),0),t.linksTo.reduce((t,e)=>(e.tgtOffset=t,t+s(e)),0);return{nodes:d,links:p,columnTotals:h,columnLengths:f}};return p.apply=t=>p(t),p.source=e=>(t=e,p),p.target=t=>(r=t,p),p.value=t=>(a=t,p),p.descendingSort=()=>(c=l,p),p.ascendingSort=()=>(c=i,p),p.idLists=t=>(n=t,p),p},t.scaleDeepGry=st,t.scaleDimGry=at,t.scaleDivNtr=Q,t.scaleDivNtrGry=Z,t.scaleDivVal=X,t.scaleDivValGry=q,t.scaleGender3=()=>S(["#349894","#FFD736","#986AD5"])().domain(["Frauen","Männer","Divers"]),t.scaleGender5Wedding=()=>S(["#349894","#FFD736","#3431DE","#B8B8B8","#D6D6D6"])().domain(["Frau / Frau","Mann / Mann","Frau / Mann","Frau / Unbekannt","Mann / Unbekannt"]),t.scaleGender6Origin=()=>S(["#00615D","#349894","#DA9C00","#FFD736","#5E359A","#986AD5"])().domain(["Schweizerinnen","Ausländerinnen","Schweizer","Ausländer","Divers Schweiz","Divers Ausland"]),t.scaleGry=rt,t.scaleLightGry=tt,t.scaleMedGry=nt,t.scalePaleGry=et,t.scaleQual12=W,t.scaleQual6=N,t.scaleQual6a=G,t.scaleQual6b=H,t.scaleSeqBlu=J,t.scaleSeqBrn=U,t.scaleSeqGrn=Y,t.scaleSeqRed=V,t.selectMenu=function(){return r().prop("values").prop("current").prop("width").width(300).prop("change").change(o).render(function(){const t=e.select(this),r=t.props(),a=t.selectAll(".sszvis-control-optionSelectable").data(["sszvis-control-select"],t=>t).join("div").classed("sszvis-control-optionSelectable",!0).classed("sszvis-control-select",!0);a.style("width",r.width+"px");const n=a.selectDiv("selectMetrics").classed("sszvis-control-select__metrics",!0),s=a.selectAll(".sszvis-control-select__element").data([1]).join("select").classed("sszvis-control-select__element",!0).on("change",function(t){const a=e.select(this).property("value");r.change(t,r.values[a]),setTimeout(()=>{window.focus()},0)});s.style("width",r.width+30+"px"),s.selectAll("option").data(r.values).join("option").attr("selected",t=>t===r.current?"selected":null).attr("value",(t,e)=>e).text(t=>function(t,e,r){const a=1e3,n=(r,s)=>{t.text(r);const o=Math.ceil(t.node().clientWidth);return s<a&&o>e?n(r.slice(0,-2)+"…",s+1):r};return n(r,0)}(n,r.width-40,t))})},t.set=x,t.slider=function(){return r().prop("scale").prop("value").prop("onchange").prop("minorTicks").minorTicks([]).prop("majorTicks").majorTicks([]).prop("tickLabels",A).prop("slant").tickLabels(o).prop("label",A).label(o).render(function(){const t=e.select(this),r=t.props(),a=kt(18),n=r.scale.domain(),s=lr(r.scale),o=r.scale.copy().range([s[0]+5.5,s[1]-5.5]),i=t.selectAll("g.sszvis-control-slider__backgroundgroup").data([1]).join("g").classed("sszvis-control-slider__backgroundgroup",!0),l=ur().scale(o).orient("bottom").slant(r.slant).hideBorderTickThreshold(0).tickSize(12).tickPadding(6).tickValues(x([...r.majorTicks,...r.minorTicks])).tickFormat(t=>Xr(t,r.majorTicks)?r.tickLabels(t):""),c=i.selectAll("g.sszvis-axisGroup").data([1]).join("g").classed("sszvis-axisGroup sszvis-axis sszvis-axis--bottom sszvis-axis--slider",!0);c.attr("transform",vt(0,28)).call(l),c.selectAll(".tick line").filter(t=>!Xr(t,r.majorTicks)).attr("y2",4);const d=c.selectAll(".tick text").filter(t=>Xr(t,r.majorTicks));if(!r.slant||"horizontal"===r.slant){const t=d.size();d.style("text-anchor",(e,r)=>0===r?"start":r===t-1?"end":"middle")}"vertical"===r.slant&&(d.attr("dx","-1.8em"),d.attr("dy","-1.5em")),"diagonal"===r.slant&&(d.attr("dx","-1.6em"),d.attr("dy","0.2em"));const u=i.selectAll("g.sszvis-slider__background").data([1]).join("g").classed("sszvis-slider__background",!0).attr("transform",vt(0,a));u.selectAll(".sszvis-slider__background__bg1").data([1]).join("line").classed("sszvis-slider__background__bg1",!0).style("stroke-width",6).style("stroke","#888").style("stroke-linecap","round").attr("x1",Math.ceil(s[0]+3)).attr("x2",Math.floor(s[1]-3)),u.selectAll(".sszvis-slider__background__bg2").data([1]).join("line").classed("sszvis-slider__background__bg2",!0).style("stroke-width",5).style("stroke","#fff").style("stroke-linecap","round").attr("x1",Math.ceil(s[0]+3)).attr("x2",Math.floor(s[1]-3)),u.selectAll(".sszvis-slider__backgroundshadow").data([r.value]).join("line").attr("class","sszvis-slider__backgroundshadow").attr("stroke-width",5).style("stroke","#E0E0E0").style("stroke-linecap","round").attr("x1",Math.ceil(s[0]+3)).attr("x2",p(Math.floor,o));const h=t.selectAll("g.sszvis-control-slider__handle").data([r.value]).join("g").classed("sszvis-control-slider__handle",!0).attr("transform",t=>vt(kt(o(t)),.5));h.append("text").classed("sszvis-control-slider--label",!0),h.selectAll(".sszvis-control-slider--label").data(t=>[t]).text(r.label).style("text-anchor",t=>z(t,n[0])?"start":z(t,n[1])?"end":"middle").attr("dx",t=>z(t,n[0])?-5:z(t,n[1])?5:0),h.selectAll(".sszvis-control-slider__handlebox").data([1]).join("rect").classed("sszvis-control-slider__handlebox",!0).attr("x",-5).attr("y",a-11.5).attr("width",10).attr("height",23).attr("rx",2).attr("ry",2);h.selectAll(".sszvis-control-slider__handleline").data([1]).join("line").classed("sszvis-control-slider__handleline",!0).attr("y1",a-7.5).attr("y2",a+7.5);const f=yr().xScale(r.scale).yScale(e.scaleLinear().range([-11,40])).draggable(!0).on("drag",r.onchange);t.selectGroup("sliderInteraction").classed("sszvis-control-slider--interactionLayer",!0).attr("transform",vt(0,4)).call(f)})},t.slightlyDarker=t=>e.hsl(t).darker(.4),t.slowTransition=yt,t.some=(t,e)=>{for(const r of e)if(t(r))return!0;return!1},t.stackedArea=function(){return r().prop("x").prop("y0").prop("y1").prop("fill").prop("stroke").prop("strokeWidth").prop("defined").prop("key").key((t,e)=>e).prop("transition").transition(!0).render(function(t){const r=e.select(this),a=r.props(),n=e.area().defined(void 0===a.defined?()=>p(b(isNaN),a.y0)&&p(b(isNaN),a.y1):a.defined).x(a.x).y0(a.y0).y1(a.y1);let s=r.selectAll("path.sszvis-path").data(t,a.key).join("path").classed("sszvis-path",!0);a.transition&&(s=s.transition(mt())),s.attr("d",n).attr("fill",a.fill).attr("stroke",a.stroke||"#ffffff").attr("stroke-width",void 0===a.strokeWidth?1:a.strokeWidth)})},t.stackedAreaMultiples=function(){return r().prop("x").prop("y0").prop("y1").prop("fill").prop("stroke").prop("strokeWidth").prop("defined").prop("key").key((t,e)=>e).prop("valuesAccessor").valuesAccessor(o).prop("transition").transition(!0).render(function(t){const r=e.select(this),a=r.props();t=[...t].reverse();const n=e.area().defined(void 0===a.defined?()=>p(b(isNaN),a.y0)&&p(b(isNaN),a.y1):a.defined).x(a.x).y0(a.y0).y1(a.y1),s=r.selectAll("path.sszvis-path").data(t,a.key).join("path").classed("sszvis-path",!0);a.transition&&s.transition(mt()),s.attr("d",p(n,a.valuesAccessor)).attr("fill",a.fill).attr("stroke",a.stroke).attr("stroke-width",void 0===a.strokeWidth?1:a.strokeWidth)})},t.stackedBarHorizontal=()=>Wr(Nr),t.stackedBarHorizontalData=Br,t.stackedBarVertical=Hr,t.stackedBarVerticalData=Er,t.stackedPyramid=function(){return r().prop("barHeight",A).prop("barWidth",A).prop("barPosition",A).prop("barFill",A).barFill("#000").prop("tooltipAnchor").tooltipAnchor([.5,.5]).prop("leftAccessor").prop("rightAccessor").prop("leftRefAccessor").prop("rightRefAccessor").render(function(t){const r=e.select(this),a=r.props(),n=Cr().x(t=>-.5-a.barWidth(t[1])).y(p(a.barPosition,Vr)).height(a.barHeight).width(t=>a.barWidth(t[1])-a.barWidth(t[0])).fill(p(a.barFill,Jr)).tooltipAnchor(a.tooltipAnchor),s=Cr().x(t=>.5+a.barWidth(t[0])).y(p(a.barPosition,Vr)).height(a.barHeight).width(t=>a.barWidth(t[1])-a.barWidth(t[0])).fill(p(a.barFill,Jr)).tooltipAnchor(a.tooltipAnchor),o=Yr().stackElement(n),i=Yr().stackElement(s),l=Ur().barPosition(a.barPosition).barWidth(a.barWidth).mirror(!0),c=Ur().barPosition(a.barPosition).barWidth(a.barWidth);r.selectGroup("leftStack").datum(a.leftAccessor(t)).call(o),r.selectGroup("rightStack").datum(a.rightAccessor(t)).call(i),r.selectGroup("leftReference").datum(a.leftRefAccessor?[a.leftRefAccessor(t)]:[]).call(l),r.selectGroup("rightReference").datum(a.rightRefAccessor?[a.rightRefAccessor(t)]:[]).call(c)})},t.stackedPyramidData=function(t,r,a,n){return s=>{const o=Pr().arrayBy(t).arrayBy(r).objectBy(a).apply(s).map(r=>{const a=Object.keys(r[0]),s=t(r[0][a[0]][0]),o=e.stack().keys(a).value((t,e)=>n(t[e][0]))(r);for(const[t,e]of o.entries())for(const[r,o]of e.entries())o.data=o.data[a[t]][0],o.series=a[t],o.side=s,o.row=r,o.value=n(o.data);return o});return o.maxValue=e.max(o,t=>e.max(t,t=>e.max(t,t=>t[1]))),o}},t.stringEqual=z,t.sunburst=function(){return r().prop("angleScale").angleScale(e.scaleLinear().range([0,2*Math.PI])).prop("radiusScale").prop("centerRadius").prop("fill").prop("stroke").stroke("white").render(function(t){const r=e.select(this),a=r.props();const n=t=>Math.max(0,Math.min(Kr,a.angleScale(t.x0))),s=t=>Math.max(0,Math.min(Kr,a.angleScale(t.x1))),o=t=>a.centerRadius+Math.max(0,a.radiusScale(t.y0)),i=t=>a.centerRadius+Math.max(0,a.radiusScale(t.y1)),l=e.arc().startAngle(n).endAngle(s).innerRadius(o).outerRadius(i);for(const e of t)e._x0=e.x0,e._x1=e.x1;const c=r.selectAll(".sszvis-sunburst-arc").each((e,r)=>{t[r]&&(t[r].x0=e.x0,t[r].x1=e.x1)}).data(t).join("path").attr("class","sszvis-sunburst-arc");c.attr("stroke",a.stroke).attr("fill",function t(r){if(r.data.isSunburstRoot)return"transparent";if(r.parent){if(r.parent.data.isSunburstRoot)return e.hsl(a.fill(r.data.key));{const e=t(r.parent);return e.l*=1.15,e}}return sr("Data passed to sszvis.component.sunburst does not have the expected tree structure. You should prepare it using sszvis.format.sunburst.prepareData"),e.hsl(a.fill(r.data.key))}),c.transition(mt()).attrTween("d",t=>{const r=e.interpolate(t.x0,t._x0),a=e.interpolate(t.x1,t._x1);return e=>(t.x0=r(e),t.x1=a(e),l(t))});const p=_t().position(t=>{const e=n(t),r=s(t),a=e+Math.abs(r-e)/2-Math.PI/2,l=(o(t)+i(t))/2;return[Math.cos(a)*l,Math.sin(a)*l]});r.call(p)})},t.sunburstGetRadiusExtent=t=>[e.min(t,t=>t.y0),e.max(t,t=>t.y1)],t.sunburstLayout=(t,e)=>{const r=e/2,a=r/3;return{centerRadius:a,numLayers:t,ringWidth:Math.max(10,Math.min(60,(r-a)/t))}},t.sunburstPrepareData=()=>{const t=[];let r=o;function a(a){const n=ea(e.rollup(a,f,...t)),s=e.hierarchy({isSunburstRoot:!0,values:n},_("values")).sort(ra).sum(t=>t.value?r(t.value):0);return e.partition()(s),function t(e){return Array.prototype.concat.apply([e],(e.children||[]).map(t))}(s).filter(t=>!t.data.isSunburstRoot)}return a.calculate=t=>a(t),a.layer=e=>(t.push(e),a),a.value=t=>(r=t,a),a.sort=t=>(ra=t,a),a},t.swissMapPath=na,t.swissMapProjection=aa,t.textWrap=cr,t.tooltip=function(){const t=Tt();return r().delegate("header",t).delegate("body",t).delegate("orientation",t).delegate("dx",t).delegate("dy",t).delegate("opacity",t).prop("renderInto").prop("visible",A).visible(!1).renderSelection(e=>{const r=e.props(),a=r.renderInto.node().getBoundingClientRect(),n=[];e.each(function(t){if(r.visible(t)){const e=this.getBoundingClientRect(),r=[e.left-a.left,e.top-a.top];n.push({datum:t,x:r[0],y:r[1]})}}),r.renderInto.datum(n).call(t)})},t.tooltipAnchor=_t,t.transformTranslateSubpixelShift=xt,t.translateString=vt,t.viewport=Be,t.voronoi=function(){const t=e.dispatch("over","out"),a=r().prop("x").prop("y").prop("bounds").prop("debug").render(function(r){const a=e.select(this),n=a.props();if(!n.bounds)return or("behavior.voronoi - requires bounds"),!1;const s=e.Delaunay.from(r,t=>n.x(t),t=>n.y(t)),o=s.voronoi(n.bounds),i=a.selectAll("[data-sszvis-behavior-voronoi]").data(o.cellPolygons()).join("path").attr("data-sszvis-behavior-voronoi","").attr("data-sszvis-behavior-pannable","").attr("class","sszvis-interactive");i.attr("d",t=>"M"+t.join("L")+"Z").attr("fill","transparent").on("mouseover",function(e){const a=this.parentNode.getBoundingClientRect(),o=s.find(e.clientX-a.left,e.clientY-a.top);xr(e,[a.left+n.x(r[o]),a.top+n.y(r[o])])&&t.apply("over",this,[e,r[o]])}).on("mousemove",function(e){const a=this.parentNode.getBoundingClientRect(),o=s.find(e.clientX-a.left,e.clientY-a.top);xr(e,[a.left+n.x(r[o]),a.top+n.y(r[o])])?t.apply("over",this,[e,r[o]]):t.apply("out",this,[e])}).on("mouseout",function(e){t.apply("out",this,[e])}).on("touchstart",function(a){const o=this.parentNode.getBoundingClientRect(),i=s.find(a.clientX-o.left,a.clientY-o.top);if(xr(g(a),[o.left+n.x(r[i]),o.top+n.y(r[i])])){a.preventDefault(),t.apply("over",this,[a,r[i]]);const s=function(){const e=g(a),r=br(e),s=_r(r);if(null===s)t.apply("out",this,[a]);else{const o=r.parentNode.getBoundingClientRect();xr(e,[o.left+n.x(s.data),o.top+n.y(s.data)])?(a.cancelable&&a.preventDefault(),t.apply("over",this,[a,s.data])):t.apply("out",this,[a])}},o=function(){t.apply("out",this,[a]),e.select(this).on("touchmove",null).on("touchend",null)};e.select(this).on("touchmove",s).on("touchend",o)}}),n.debug&&i.attr("stroke","#f00")});return a.on=()=>{const e=t.on.apply(t,arguments);return e===t?a:e},a},t.widthAdaptiveMapPathStroke=t=>Math.min(Math.max(.8,t/400),1.1),t.withAlpha=(t,r)=>{const a=e.rgb(t);return"rgba("+a.r+","+a.g+","+a.b+","+r+")"}});
//# sourceMappingURL=sszvis.min.js.map
