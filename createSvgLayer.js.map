{"version":3,"file":"createSvgLayer.js","sources":["../src/createSvgLayer.js"],"sourcesContent":["/**\n * Factory that returns an SVG element appended to the given target selector,\n * ensuring that it is only created once, even when run again.\n *\n * @module sszvis/createSvgLayer\n *\n * @param {string|d3.selection} selector\n * @param {d3.bounds} bounds\n * @param {object} [metadata] Metadata for this chart. Can include any number of the following:\n *   @property {string} key Used as a unique key for this layer. If you pass different values\n *                          of key to this function, the app will create and return different layers.\n *                          If you pass the same value (including undefined), you will always get back\n *                          the same DOM element. This is useful for adding multiple SVG elements.\n *                          See the binned raster map for an example of using this effectively.\n *                          Note: For more information about this argument, see the detailed explanation in\n *                          the source code for createHtmlLayer.\n *\n * @returns {d3.selection}\n */\n\nimport { select } from \"d3\";\nimport { bounds as mkBounds } from \"./bounds.js\";\nimport * as fn from \"./fn.js\";\n\nexport function createSvgLayer(selector, bounds, metadata) {\n  bounds || (bounds = mkBounds());\n  metadata || (metadata = {});\n\n  const key = metadata.key || \"default\";\n  const elementDataKey = \"data-sszvis-svg-\" + key;\n  const title = metadata.title || \"\";\n  const description = metadata.description || \"\";\n\n  const root = fn.isSelection(selector) ? selector : select(selector);\n  const svg = root\n    .selectAll(\"svg[\" + elementDataKey + \"]\")\n    .data([0])\n    .join(\"svg\")\n    .classed(\"sszvis-svg-layer\", true)\n    .attr(elementDataKey, \"\")\n    .attr(\"role\", \"img\")\n    .attr(\"aria-label\", title + \" â€“ \" + description)\n    .attr(\"height\", bounds.height)\n    .attr(\"width\", bounds.width);\n\n  svg.selectAll(\"title\").data([0]).join(\"title\").text(title);\n\n  svg\n    .selectAll(\"desc\")\n    .data([0])\n    .join(\"desc\")\n    .text(description)\n    .classed(\"sszvis-svg-layer\", true)\n    .attr(elementDataKey, \"\")\n    .attr(\"role\", \"img\");\n\n  return svg\n    .selectAll(\"[data-sszvis-svg-layer]\")\n    .data(() => [0])\n    .join(\"g\")\n    .attr(\"data-sszvis-svg-layer\", \"\")\n    .attr(\"transform\", \"translate(\" + bounds.padding.left + \",\" + bounds.padding.top + \")\");\n}\n"],"names":["createSvgLayer","selector","bounds","metadata","mkBounds","key","elementDataKey","title","description","root","fn","select","svg","selectAll","data","join","classed","attr","height","width","text","padding","left","top"],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAMO,SAASA,cAAcA,CAACC,QAAQ,EAAEC,QAAM,EAAEC,QAAQ,EAAE;AACzDD,EAAAA,QAAM,KAAKA,QAAM,GAAGE,MAAQ,EAAE,CAAC;AAC/BD,EAAAA,QAAQ,KAAKA,QAAQ,GAAG,EAAE,CAAC;AAE3B,EAAA,MAAME,GAAG,GAAGF,QAAQ,CAACE,GAAG,IAAI,SAAS;AACrC,EAAA,MAAMC,cAAc,GAAG,kBAAkB,GAAGD,GAAG;AAC/C,EAAA,MAAME,KAAK,GAAGJ,QAAQ,CAACI,KAAK,IAAI,EAAE;AAClC,EAAA,MAAMC,WAAW,GAAGL,QAAQ,CAACK,WAAW,IAAI,EAAE;AAE9C,EAAA,MAAMC,IAAI,GAAGC,WAAc,CAACT,QAAQ,CAAC,GAAGA,QAAQ,GAAGU,MAAM,CAACV,QAAQ,CAAC;AACnE,EAAA,MAAMW,GAAG,GAAGH,IAAI,CACbI,SAAS,CAAC,MAAM,GAAGP,cAAc,GAAG,GAAG,CAAC,CACxCQ,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CACTC,IAAI,CAAC,KAAK,CAAC,CACXC,OAAO,CAAC,kBAAkB,EAAE,IAAI,CAAC,CACjCC,IAAI,CAACX,cAAc,EAAE,EAAE,CAAC,CACxBW,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CACnBA,IAAI,CAAC,YAAY,EAAEV,KAAK,GAAG,KAAK,GAAGC,WAAW,CAAC,CAC/CS,IAAI,CAAC,QAAQ,EAAEf,QAAM,CAACgB,MAAM,CAAC,CAC7BD,IAAI,CAAC,OAAO,EAAEf,QAAM,CAACiB,KAAK,CAAC;EAE9BP,GAAG,CAACC,SAAS,CAAC,OAAO,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,OAAO,CAAC,CAACK,IAAI,CAACb,KAAK,CAAC;AAE1DK,EAAAA,GAAG,CACAC,SAAS,CAAC,MAAM,CAAC,CACjBC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CACTC,IAAI,CAAC,MAAM,CAAC,CACZK,IAAI,CAACZ,WAAW,CAAC,CACjBQ,OAAO,CAAC,kBAAkB,EAAE,IAAI,CAAC,CACjCC,IAAI,CAACX,cAAc,EAAE,EAAE,CAAC,CACxBW,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC;EAEtB,OAAOL,GAAG,CACPC,SAAS,CAAC,yBAAyB,CAAC,CACpCC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CACfC,IAAI,CAAC,GAAG,CAAC,CACTE,IAAI,CAAC,uBAAuB,EAAE,EAAE,CAAC,CACjCA,IAAI,CAAC,WAAW,EAAE,YAAY,GAAGf,QAAM,CAACmB,OAAO,CAACC,IAAI,GAAG,GAAG,GAAGpB,QAAM,CAACmB,OAAO,CAACE,GAAG,GAAG,GAAG,CAAC;AAC3F;;;;"}