{"version":3,"file":"rectangle.js","sources":["../../src/annotation/rectangle.js"],"sourcesContent":["/**\n * Rectangle annotation\n *\n * A component for creating rectangular data areas. The component should be passed\n * an array of data values, each of which will be used to render a data area by\n * passing it through the accessor functions. You can specify a caption to display,\n * which can be offset from the center of the data area by specifying dx or dy properties.\n *\n * @module sszvis/annotation/rectangle\n *\n * @param {number, function} x        The x-position of the upper left corner of the data area.\n * @param {number, function} y        The y-position of the upper left corner of the data area.\n * @param {number, function} width    The width of the data area.\n * @param {number, function} height   The height of the data area.\n * @param {number, function} dx       The x-offset of the data area caption.\n * @param {number, function} dy       The y-offset of the data area caption.\n * @param {string, function} caption  The caption for the data area.\n *\n * @returns {sszvis.component} a rectangular data area component\n */\n\nimport { select } from \"d3\";\n\nimport * as fn from \"../fn.js\";\nimport ensureDefsElement from \"../svgUtils/ensureDefsElement.js\";\nimport { dataAreaPattern } from \"../patterns.js\";\nimport { component } from \"../d3-component.js\";\n\nexport default function () {\n  return component()\n    .prop(\"x\", fn.functor)\n    .prop(\"y\", fn.functor)\n    .prop(\"width\", fn.functor)\n    .prop(\"height\", fn.functor)\n    .prop(\"dx\", fn.functor)\n    .prop(\"dy\", fn.functor)\n    .prop(\"caption\", fn.functor)\n    .render(function (data) {\n      const selection = select(this);\n      const props = selection.props();\n\n      ensureDefsElement(selection, \"pattern\", \"data-area-pattern\").call(dataAreaPattern);\n\n      const dataArea = selection\n        .selectAll(\".sszvis-dataarearectangle\")\n        .data(data)\n        .join(\"rect\")\n        .classed(\"sszvis-dataarearectangle\", true);\n\n      dataArea\n        .attr(\"x\", props.x)\n        .attr(\"y\", props.y)\n        .attr(\"width\", props.width)\n        .attr(\"height\", props.height)\n        .attr(\"fill\", \"url(#data-area-pattern)\");\n\n      if (props.caption) {\n        const dataCaptions = selection\n          .selectAll(\".sszvis-dataarearectangle__caption\")\n          .data(data)\n          .join(\"text\")\n          .classed(\"sszvis-dataarearectangle__caption\", true);\n\n        dataCaptions\n          .attr(\"x\", (d, i) => props.x(d, i) + props.width(d, i) / 2)\n          .attr(\"y\", (d, i) => props.y(d, i) + props.height(d, i) / 2)\n          .attr(\"dx\", props.dx)\n          .attr(\"dy\", props.dy)\n          .text(props.caption);\n      }\n    });\n}\n"],"names":["component","prop","fn","render","data","selection","select","props","ensureDefsElement","call","dataAreaPattern","dataArea","selectAll","join","classed","attr","x","y","width","height","caption","dataCaptions","d","i","dx","dy","text"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AASe,kBAAY,IAAA;AACzB,EAAA,OAAOA,SAAS,EAAE,CACfC,IAAI,CAAC,GAAG,EAAEC,OAAU,CAAC,CACrBD,IAAI,CAAC,GAAG,EAAEC,OAAU,CAAC,CACrBD,IAAI,CAAC,OAAO,EAAEC,OAAU,CAAC,CACzBD,IAAI,CAAC,QAAQ,EAAEC,OAAU,CAAC,CAC1BD,IAAI,CAAC,IAAI,EAAEC,OAAU,CAAC,CACtBD,IAAI,CAAC,IAAI,EAAEC,OAAU,CAAC,CACtBD,IAAI,CAAC,SAAS,EAAEC,OAAU,CAAC,CAC3BC,MAAM,CAAC,UAAUC,IAAI,EAAE;AACtB,IAAA,MAAMC,SAAS,GAAGC,MAAM,CAAC,IAAI,CAAC;AAC9B,IAAA,MAAMC,KAAK,GAAGF,SAAS,CAACE,KAAK,EAAE;IAE/BC,iBAAiB,CAACH,SAAS,EAAE,SAAS,EAAE,mBAAmB,CAAC,CAACI,IAAI,CAACC,eAAe,CAAC;IAElF,MAAMC,QAAQ,GAAGN,SAAS,CACvBO,SAAS,CAAC,2BAA2B,CAAC,CACtCR,IAAI,CAACA,IAAI,CAAC,CACVS,IAAI,CAAC,MAAM,CAAC,CACZC,OAAO,CAAC,0BAA0B,EAAE,IAAI,CAAC;AAE5CH,IAAAA,QAAQ,CACLI,IAAI,CAAC,GAAG,EAAER,KAAK,CAACS,CAAC,CAAC,CAClBD,IAAI,CAAC,GAAG,EAAER,KAAK,CAACU,CAAC,CAAC,CAClBF,IAAI,CAAC,OAAO,EAAER,KAAK,CAACW,KAAK,CAAC,CAC1BH,IAAI,CAAC,QAAQ,EAAER,KAAK,CAACY,MAAM,CAAC,CAC5BJ,IAAI,CAAC,MAAM,EAAE,yBAAyB,CAAC;IAE1C,IAAIR,KAAK,CAACa,OAAO,EAAE;MACjB,MAAMC,YAAY,GAAGhB,SAAS,CAC3BO,SAAS,CAAC,oCAAoC,CAAC,CAC/CR,IAAI,CAACA,IAAI,CAAC,CACVS,IAAI,CAAC,MAAM,CAAC,CACZC,OAAO,CAAC,mCAAmC,EAAE,IAAI,CAAC;AAErDO,MAAAA,YAAY,CACTN,IAAI,CAAC,GAAG,EAAE,CAACO,CAAC,EAAEC,CAAC,KAAKhB,KAAK,CAACS,CAAC,CAACM,CAAC,EAAEC,CAAC,CAAC,GAAGhB,KAAK,CAACW,KAAK,CAACI,CAAC,EAAEC,CAAC,CAAC,GAAG,CAAC,CAAC,CAC1DR,IAAI,CAAC,GAAG,EAAE,CAACO,CAAC,EAAEC,CAAC,KAAKhB,KAAK,CAACU,CAAC,CAACK,CAAC,EAAEC,CAAC,CAAC,GAAGhB,KAAK,CAACY,MAAM,CAACG,CAAC,EAAEC,CAAC,CAAC,GAAG,CAAC,CAAC,CAC3DR,IAAI,CAAC,IAAI,EAAER,KAAK,CAACiB,EAAE,CAAC,CACpBT,IAAI,CAAC,IAAI,EAAER,KAAK,CAACkB,EAAE,CAAC,CACpBC,IAAI,CAACnB,KAAK,CAACa,OAAO,CAAC;AACxB;AACF,GAAC,CAAC;AACN;;;;"}