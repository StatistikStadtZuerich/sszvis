{"version":3,"file":"rangeFlag.js","sources":["../../src/annotation/rangeFlag.js"],"sourcesContent":["/**\n * Range Flag annotation\n *\n * The range flag component creates a pair of small white circles which fit well with the range ruler.\n * However, this is a separate component for implementation reasons, because the data for the range flag\n * should usually be only one value, distinct from the range ruler which expects multiple values. The range\n * flag also creates a tooltip anchor between the two dots, to which you can attach a tooltip. See the\n * interactive stacked area chart examples for a use of the range flag.\n *\n * @module sszvis/annotation/rangeFlag\n *\n * @property {number functor} x           A value for the x-value of the range flag\n * @property {number functor} y0          A value for the y-value of the lower range flag dot\n * @property {number functor} y1          A value for the y-value of the upper range flag dot\n *\n * @returns {sszvis.component}\n */\n\nimport { select } from \"d3\";\n\nimport * as fn from \"../fn.js\";\nimport { halfPixel } from \"../svgUtils/crisp.js\";\nimport tooltipAnchor from \"../annotation/tooltipAnchor.js\";\nimport { component } from \"../d3-component.js\";\n\nexport default function () {\n  return component()\n    .prop(\"x\", fn.functor)\n    .prop(\"y0\", fn.functor)\n    .prop(\"y1\", fn.functor)\n    .render(function (data) {\n      const selection = select(this);\n      const props = selection.props();\n\n      const crispX = fn.compose(halfPixel, props.x);\n      const crispY0 = fn.compose(halfPixel, props.y0);\n      const crispY1 = fn.compose(halfPixel, props.y1);\n\n      selection\n        .selectAll(\".sszvis-rangeFlag__mark.bottom\")\n        .data(data)\n        .call(makeFlagDot(\"bottom\", crispX, crispY0));\n\n      selection\n        .selectAll(\".sszvis-rangeFlag__mark.top\")\n        .data(data)\n        .call(makeFlagDot(\"top\", crispX, crispY1));\n\n      const ta = tooltipAnchor().position((d) => [\n        crispX(d),\n        halfPixel((props.y0(d) + props.y1(d)) / 2),\n      ]);\n\n      selection.call(ta);\n    });\n}\n\nfunction makeFlagDot(classed, cx, cy) {\n  return function (dot) {\n    dot\n      .join(\"circle\")\n      .classed(\"sszvis-rangeFlag__mark\", true)\n      .classed(classed, true)\n      .attr(\"r\", 3.5)\n      .attr(\"cx\", cx)\n      .attr(\"cy\", cy);\n  };\n}\n"],"names":["component","prop","fn","render","data","selection","select","props","crispX","halfPixel","x","crispY0","y0","crispY1","y1","selectAll","call","makeFlagDot","ta","tooltipAnchor","position","d","classed","cx","cy","dot","join","attr"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AASe,kBAAY,IAAA;AACzB,EAAA,OAAOA,SAAS,EAAE,CACfC,IAAI,CAAC,GAAG,EAAEC,OAAU,CAAC,CACrBD,IAAI,CAAC,IAAI,EAAEC,OAAU,CAAC,CACtBD,IAAI,CAAC,IAAI,EAAEC,OAAU,CAAC,CACtBC,MAAM,CAAC,UAAUC,IAAI,EAAE;AACtB,IAAA,MAAMC,SAAS,GAAGC,MAAM,CAAC,IAAI,CAAC;AAC9B,IAAA,MAAMC,KAAK,GAAGF,SAAS,CAACE,KAAK,EAAE;IAE/B,MAAMC,MAAM,GAAGN,OAAU,CAACO,SAAS,EAAEF,KAAK,CAACG,CAAC,CAAC;IAC7C,MAAMC,OAAO,GAAGT,OAAU,CAACO,SAAS,EAAEF,KAAK,CAACK,EAAE,CAAC;IAC/C,MAAMC,OAAO,GAAGX,OAAU,CAACO,SAAS,EAAEF,KAAK,CAACO,EAAE,CAAC;IAE/CT,SAAS,CACNU,SAAS,CAAC,gCAAgC,CAAC,CAC3CX,IAAI,CAACA,IAAI,CAAC,CACVY,IAAI,CAACC,WAAW,CAAC,QAAQ,EAAET,MAAM,EAAEG,OAAO,CAAC,CAAC;IAE/CN,SAAS,CACNU,SAAS,CAAC,6BAA6B,CAAC,CACxCX,IAAI,CAACA,IAAI,CAAC,CACVY,IAAI,CAACC,WAAW,CAAC,KAAK,EAAET,MAAM,EAAEK,OAAO,CAAC,CAAC;AAE5C,IAAA,MAAMK,EAAE,GAAGC,aAAa,EAAE,CAACC,QAAQ,CAAEC,CAAC,IAAK,CACzCb,MAAM,CAACa,CAAC,CAAC,EACTZ,SAAS,CAAC,CAACF,KAAK,CAACK,EAAE,CAACS,CAAC,CAAC,GAAGd,KAAK,CAACO,EAAE,CAACO,CAAC,CAAC,IAAI,CAAC,CAAC,CAC3C,CAAC;AAEFhB,IAAAA,SAAS,CAACW,IAAI,CAACE,EAAE,CAAC;AACpB,GAAC,CAAC;AACN;AAEA,SAASD,WAAWA,CAACK,OAAO,EAAEC,EAAE,EAAEC,EAAE,EAAE;EACpC,OAAO,UAAUC,GAAG,EAAE;AACpBA,IAAAA,GAAG,CACAC,IAAI,CAAC,QAAQ,CAAC,CACdJ,OAAO,CAAC,wBAAwB,EAAE,IAAI,CAAC,CACvCA,OAAO,CAACA,OAAO,EAAE,IAAI,CAAC,CACtBK,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CACdA,IAAI,CAAC,IAAI,EAAEJ,EAAE,CAAC,CACdI,IAAI,CAAC,IAAI,EAAEH,EAAE,CAAC;GAClB;AACH;;;;"}