{"version":3,"file":"ruler.js","sources":["../../src/annotation/ruler.ts"],"sourcesContent":[null],"names":["annotationRuler","component","prop","fn","label","flip","reduceOverlap","render","data","selection","select","props","labelId","d","concat","x","y","ruler","selectAll","join","classed","attr","halfPixel","Number","bottom","dot","color","crispX","crispY","textSelection","dx","dy","top","translateString","style","html","THRESHOLD","ITERATIONS","labelBounds","labelBoundsIndex","each","bounds","getBoundingClientRect","item","push","sort","a","b","ascending","index","firstLabel","entries","secondLabel","slice","overlap","offset","textLabel","rulerLabelVerticalSeparate","cAcc","g","category","i","j","length","k","l"],"mappings":"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"}