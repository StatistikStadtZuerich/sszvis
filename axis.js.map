{"version":3,"file":"axis.js","sources":["../src/axis.js"],"sourcesContent":["/**\n * Axis component\n *\n * This component is an extension of d3.axis and provides the same interface\n * with some custom additions. It provides good defaults for sszvis charts\n * and helps with some commonly used functionality.\n *\n * @module sszvis/axis\n *\n * The following properties are directly delegated to the d3.axis component.\n * They are documented in the d3 documentation.\n * @see https://github.com/mbostock/d3/wiki/SVG-Axes\n *\n * @property {function} scale         Delegates to d3.axis\n * @property {function} orient        Delegates to d3.axis\n * @property {function} ticks         Delegates to d3.axis\n * @property {function} tickValues    Delegates to d3.axis\n * @property {function} tickSize      Delegates to d3.axis\n * @property {function} innerTickSize Delegates to d3.axis\n * @property {function} outerTickSize Delegates to d3.axis\n * @property {function} tickPadding   Delegates to d3.axis\n * @property {function} tickFormat    Delegates to d3.axis\n *\n * The following properties are custom additions.\n *\n * @property {boolean} alignOuterLabels                 Whether or not to align the outer labels to the axis extent so that they do not fall outside the axis space.\n * @property {boolean} contour                          Specify a 'contour' background for the axis labels.\n * @property {number} hideBorderTickThreshold           Specifies the pixel distance threshold for the visible tick correction. Ticks which are closer than\n *                                                      this threshold to the end of the axis (i.e. a tick which is 1 or two pixels from the end) will be\n *                                                      hidden from view. This prevents the display of a tick very close to the ending line.\n * @property {number} hideLabelThreshold                By default, labels are hidden when they are closer than LABEL_PROXIMITY_THRESHOLD to a highlighted label.\n *                                                      If this value is set to 0 or lower, labels won't be hidden, even if they overlap with the highlighted label.\n * @property {function} highlightTick                   Specifies a predicate function to use to determine whether axis ticks should be highlighted.\n *                                                      Any tick value which returns true for this predicate function will be treated specially as a highlighted tick.\n *                                                      Note that this function does NOT have any effect over which ticks are actually included on the axis. To create special\n *                                                      custom ticks, use tickValues.\n * @property {boolean} showZeroY                        Whether the axis should display a label for at y=0.\n * @property {string} slant                             Specify a label slant for the tick labels. Can be \"vertical\" - labels are displayed vertically - or\n *                                                      \"diagonal\" - labels are displayed at a 45 degree angle to the axis.\n *                                                      Use \"horizontal\" to reset to a horizontal slant.\n * @property {number} textWrap                          Specify a width at which to wrap the axis label text.\n * @property {number, function} tickLength              specify a number or a function which returns a number for setting the tick length.\n * @property {string} title                             Specify a string to use as the title of this chart. Default title position depends on the chart orientation\n * @property {string} titleAnchor                       specify the title text-anchor. Values are 'start', 'middle', and 'end'. Corresponds to the 'text-anchor' svg styling attribute\n *                                                      the default depends on the axis orient property\n * @property {boolean} titleCenter                      whether or not to center the axis title along the axis. If true, this sets the title anchor point\n *                                                      as the midpoint between axis extremes. Should usually be used with titleAnchor('middle') to ensure exact title centering. (default: false)\n * @property {number} dxTitle                           specify an amount by which to offset the title towards the left. This offsets away from the default position. (default: 0)\n * @property {number} dyTitle                           specify an amount by which to offset the title towards the top. This offsets away from the default position. (default: 0)\n * @property {boolean} titleVertical                    whether or not to rotate the title 90 degrees so that it appears vertical, reading from bottom to top. (default: false)\n * @property {boolean} vertical                         whether the axis is a vertical axis. When true, this property changes certain display properties of the axis according to the style guide.\n *\n * @return {sszvis.component}\n */\n\nimport { axisBottom, axisLeft, axisRight, axisTop, select, extent } from \"d3\";\nimport { component } from \"./d3-component.js\";\nimport * as fn from \"./fn.js\";\nimport { formatAxisTimeFormat, formatNumber, formatText } from \"./format.js\";\nimport * as logger from \"./logger.js\";\nimport { range } from \"./scale.js\";\nimport { halfPixel, transformTranslateSubpixelShift } from \"./svgUtils/crisp.js\";\nimport textWrap from \"./svgUtils/textWrap.js\";\nimport translateString from \"./svgUtils/translateString.js\";\n\nconst TICK_PROXIMITY_THRESHOLD = 8;\nconst TICK_END_THRESHOLD = 12;\nconst LABEL_PROXIMITY_THRESHOLD = 10;\n\nconst axis = function () {\n  // const axisDelegate = d3.axisBottom();\n  // axisDelegate.orient = function() { return 'bottom'; };\n\n  // axisComponent.__delegate__ = axisDelegate;\n\n  return (\n    component()\n      .prop(\"scale\")\n      .prop(\"orient\")\n      .prop(\"ticks\")\n      .prop(\"tickValues\")\n      .prop(\"tickSize\")\n      .prop(\"tickSizeInner\")\n      .prop(\"tickSizeOuter\")\n      .prop(\"tickPadding\")\n      .prop(\"tickFormat\")\n\n      .prop(\"_scale\")\n\n      .prop(\"orient\")\n      .orient(\"bottom\")\n      .prop(\"alignOuterLabels\")\n      .alignOuterLabels(false)\n      .prop(\"contour\")\n      .prop(\"hideBorderTickThreshold\")\n      .hideBorderTickThreshold(TICK_PROXIMITY_THRESHOLD)\n      .prop(\"hideLabelThreshold\")\n      .hideLabelThreshold(LABEL_PROXIMITY_THRESHOLD)\n      .prop(\"highlightTick\", fn.functor)\n      .prop(\"showZeroY\")\n      .showZeroY(false)\n      .prop(\"slant\")\n      .prop(\"textWrap\")\n      .prop(\"tickLength\")\n      .prop(\"title\")\n      .prop(\"titleAnchor\") // start, end, or middle\n      .prop(\"titleCenter\") // a boolean value - whether to center the title\n      .prop(\"dxTitle\") // a numeric value for the left offset of the title\n      .prop(\"dyTitle\") // a numeric value for the top offset of the title\n      .prop(\"titleVertical\")\n      .prop(\"vertical\")\n      .vertical(false)\n      //this property is typically used for the x-axis, but not for the y axis\n      //it creates a gap between chart and x-axis by offsetting the the chart by a number of pixels\n      .prop(\"yOffset\")\n      .yOffset(0)\n      .render(function () {\n        const selection = select(this);\n        const props = selection.props();\n\n        const isBottom = !props.vertical && props.orient === \"bottom\";\n\n        const axisDelegate = (function () {\n          switch (props.orient) {\n            case \"bottom\": {\n              return axisBottom();\n            }\n            case \"top\": {\n              return axisTop();\n            }\n            case \"left\": {\n              return axisLeft();\n            }\n            case \"right\": {\n              return axisRight();\n            }\n          }\n        })();\n\n        for (const prop of [\n          \"scale\",\n          \"ticks\",\n          \"tickValues\",\n          \"tickSizeInner\",\n          \"tickSizeOuter\",\n          \"tickPadding\",\n          \"tickFormat\",\n          \"tickSize\",\n        ]) {\n          if (props[prop] !== undefined) {\n            if (axisDelegate[prop] === undefined) {\n              throw new Error('axis: \"' + prop + '\" not available');\n            }\n            axisDelegate[prop](props[prop]);\n          }\n        }\n\n        if (props._scale) {\n          axisDelegate.scale(props._scale);\n        }\n\n        const group = selection\n          .selectGroup(\"sszvis-axis\")\n          .classed(\"sszvis-axis\", true)\n          .classed(\"sszvis-axis--top\", !props.vertical && props.orient === \"top\")\n          .classed(\"sszvis-axis--bottom\", isBottom)\n          .classed(\"sszvis-axis--vertical\", props.vertical)\n          .attr(\"transform\", translateString(0, props.yOffset))\n          .call(axisDelegate);\n\n        group.attr(\"fill\", null).attr(\"font-size\", null).attr(\"font-family\", null);\n        // .attr(\"text-anchor\", null);\n\n        const axisScale = axisDelegate.scale();\n\n        // Create selections here which will be used later for many custom configurations\n        // Note: Inconstiant: This is only valid so long as new .tick groups or tick label texts\n        // are not being added after these selections are constructed. If that changes, these\n        // selections need to be re-constructed.\n        const tickGroups = group.selectAll(\"g.tick\");\n        const tickTexts = tickGroups.selectAll(\"text\");\n\n        // To prevent anti-aliasing on elements that need to be rendered crisply\n        // we need to position them on a half-pixel grid: 0.5, 1.5, 2.5, etc.\n        // We can't translate the whole .tick group, however, because this\n        // leads to weird type rendering artefacts in some browsers. That's\n        // why we reach into the group and translate lines onto the half-pixel\n        // grid by taking the translation of the group into account.\n        tickGroups.each(function () {\n          const subpixelShift = transformTranslateSubpixelShift(this.getAttribute(\"transform\"));\n          const dx = halfPixel(0) - subpixelShift[0];\n          const dy = halfPixel(isBottom ? 2 : 0) + subpixelShift[1];\n          select(this).select(\"line\").attr(\"transform\", translateString(dx, dy));\n        });\n\n        tickTexts.each(function () {\n          if (props.orient === \"top\" || props.orient === \"bottom\") {\n            select(this).attr(\"dx\", \"-0.5\");\n          }\n          if (props.orient === \"left\" || props.orient === \"right\") {\n            select(this).attr(\"y\", \"-0.5\");\n          }\n        });\n\n        // Place axis line on a half-pixel grid to prevent anti-aliasing\n        group.selectAll(\"path.domain\");\n        // .attr('transform', translateString(halfPixel(0), halfPixel(0)));\n\n        // hide ticks which are too close to one endpoint\n        const rangeExtent = range(axisScale);\n        tickGroups.selectAll(\"line\").each(function (d) {\n          const pos = axisScale(d),\n            d3this = select(this);\n          d3this.classed(\n            \"hidden\",\n            !d3this.classed(\"sszvis-axis__longtick\") &&\n              (absDistance(pos, rangeExtent[0]) < props.hideBorderTickThreshold ||\n                absDistance(pos, rangeExtent[1]) < props.hideBorderTickThreshold)\n          );\n        });\n\n        if (fn.defined(props.tickLength)) {\n          const domainExtent = extent(axisScale.domain());\n          const ticks = tickGroups.filter(\n            (d) => !fn.stringEqual(d, domainExtent[0]) && !fn.stringEqual(d, domainExtent[1])\n          );\n          const orientation = props.orient;\n\n          let longLinePadding = 2;\n          if (orientation === \"left\" || orientation === \"right\") {\n            ticks.selectAll(\"text\").each(function () {\n              longLinePadding = Math.max(this.getBoundingClientRect().width, longLinePadding);\n            });\n            longLinePadding += 2; // a lil' extra on the end\n          }\n\n          const lines = ticks\n            .selectAll(\"line.sszvis-axis__longtick\")\n            .data([0])\n            .join(\"line\")\n            .classed(\"sszvis-axis__longtick\", true);\n\n          if (props.tickLength > longLinePadding) {\n            switch (orientation) {\n              case \"top\": {\n                lines.attr(\"y1\", longLinePadding).attr(\"y2\", props.tickLength);\n\n                break;\n              }\n              case \"bottom\": {\n                lines.attr(\"y1\", -longLinePadding).attr(\"y2\", -props.tickLength);\n\n                break;\n              }\n              case \"left\": {\n                lines.attr(\"x1\", -longLinePadding).attr(\"x2\", -props.tickLength);\n\n                break;\n              }\n              case \"right\": {\n                lines.attr(\"x1\", longLinePadding).attr(\"x2\", props.tickLength);\n\n                break;\n              }\n              // No default\n            }\n          } else {\n            lines.remove();\n          }\n        }\n\n        if (props.alignOuterLabels) {\n          const alignmentBounds = range(axisScale);\n          const min = alignmentBounds[0];\n          const max = alignmentBounds[1];\n\n          tickTexts.style(\"text-anchor\", (d) => {\n            const value = axisScale(d);\n            if (absDistance(value, min) < TICK_END_THRESHOLD) {\n              return \"start\";\n            } else if (absDistance(value, max) < TICK_END_THRESHOLD) {\n              return \"end\";\n            }\n            return \"middle\";\n          });\n        }\n\n        if (fn.defined(props.textWrap)) {\n          tickTexts.call(textWrap, props.textWrap);\n        }\n\n        if (props.slant) {\n          tickTexts.call(slantLabel[props.orient][props.slant]);\n        }\n\n        // Highlight axis labels that return true for props.highlightTick.\n        if (props.highlightTick) {\n          const activeBounds = [];\n          const passiveBounds = [];\n\n          tickTexts.classed(\"hidden\", false).classed(\"active\", props.highlightTick);\n\n          // Hide axis labels that overlap with highlighted labels unless\n          // the labels are slanted (in which case the bounding boxes overlap)\n          if (props.hideLabelThreshold > 0 && !props.slant) {\n            tickTexts.each(function (d) {\n              // although getBoundingClientRect returns coordinates relative to the window, not the document,\n              // this should still work, since all tick bounds are affected equally by scroll position changes.\n              const bcr = this.getBoundingClientRect();\n              const b = {\n                node: this,\n                bounds: {\n                  top: bcr.top,\n                  right: bcr.right,\n                  bottom: bcr.bottom,\n                  left: bcr.left,\n                },\n              };\n              if (props.highlightTick(d)) {\n                b.bounds.left -= props.hideLabelThreshold;\n                b.bounds.right += props.hideLabelThreshold;\n                activeBounds.push(b);\n              } else {\n                passiveBounds.push(b);\n              }\n            });\n\n            for (const active of activeBounds) {\n              for (const passive of passiveBounds) {\n                select(passive.node).classed(\n                  \"hidden\",\n                  boundsOverlap(passive.bounds, active.bounds)\n                );\n              }\n            }\n          }\n        }\n\n        if (props.title) {\n          const title = group\n            .selectAll(\".sszvis-axis__title\")\n            .data([props.title])\n            .join(\"text\")\n            .classed(\"sszvis-axis__title\", true);\n\n          title\n            .text((d) => d)\n            .attr(\"transform\", () => {\n              const orient = props.orient,\n                axisScaleExtent = range(axisScale);\n\n              const titleProps = props.titleCenter\n                ? {\n                    left:\n                      orient === \"left\" || orient === \"right\"\n                        ? 0\n                        : orient === \"top\" || orient === \"bottom\"\n                          ? (axisScaleExtent[0] + axisScaleExtent[1]) / 2\n                          : 0,\n                    top:\n                      orient === \"left\" || orient === \"right\"\n                        ? (axisScaleExtent[0] + axisScaleExtent[1]) / 2\n                        : orient === \"top\"\n                          ? 0\n                          : orient === \"bottom\"\n                            ? 32\n                            : 0,\n                  }\n                : {\n                    left:\n                      orient === \"left\" || orient === \"right\" || orient === \"top\"\n                        ? 0\n                        : orient === \"bottom\"\n                          ? axisScaleExtent[1]\n                          : 0,\n                    top:\n                      orient === \"left\" || orient === \"right\" || orient === \"top\"\n                        ? 0\n                        : orient === \"bottom\"\n                          ? 32\n                          : 0,\n                  };\n\n              titleProps.vertical = !!props.titleVertical;\n              titleProps.left += props.dxTitle || 0;\n              titleProps.top += props.dyTitle || 0;\n              return (\n                \"translate(\" +\n                titleProps.left +\n                \", \" +\n                titleProps.top +\n                \") rotate(\" +\n                (titleProps.vertical ? \"-90\" : \"0\") +\n                \")\"\n              );\n            })\n            .style(\"text-anchor\", () => {\n              const orient = props.orient;\n              if (props.titleAnchor === undefined) {\n                switch (orient) {\n                  case \"left\": {\n                    return \"end\";\n                  }\n                  case \"right\": {\n                    return \"start\";\n                  }\n                  case \"top\":\n                  case \"bottom\": {\n                    return \"end\";\n                  }\n                  // No default\n                }\n              } else {\n                return props.titleAnchor;\n              }\n            });\n        }\n\n        /**\n         * Add a background to axis labels to make them more readable on\n         * colored backgrounds\n         */\n        if (props.contour && props.slant) {\n          logger.warn(\"Can't apply contour to slanted labels\");\n        } else if (props.contour) {\n          tickGroups.each(function () {\n            const g = select(this);\n            const textNode = g.select(\"text\").node();\n            let textContour = g.select(\".sszvis-axis__label-contour\");\n            if (textContour.empty()) {\n              textContour = select(textNode.cloneNode()).classed(\n                \"sszvis-axis__label-contour\",\n                true\n              );\n              this.insertBefore(textContour.node(), textNode);\n            }\n            textContour.text(textNode.textContent);\n          });\n        }\n      })\n  );\n};\n\nconst setOrdinalTicks = function (count) {\n  // in this function, the 'this' context should be an sszvis.axis\n  const domain = this.scale().domain(),\n    values = [],\n    step = Math.round(domain.length / count);\n\n  // include the first value\n  if (domain[0] !== undefined) values.push(domain[0]);\n  for (let i = step, l = domain.length; i < l - 1; i += step) {\n    if (domain[i] !== undefined) values.push(domain[i]);\n  }\n  // include the last value\n  if (domain[domain.length - 1] !== \"undefined\") values.push(domain[domain.length - 1]);\n\n  this.tickValues(values);\n\n  return count;\n};\n\nexport const axisX = function () {\n  return axis()\n    .yOffset(2) //gap between chart and x-axis\n    .ticks(3)\n    .tickSizeInner(4)\n    .tickSizeOuter(6.5)\n    .tickPadding(6)\n    .tickFormat(fn.arity(1, formatNumber));\n};\n\naxisX.time = function () {\n  return axisX().tickFormat(formatAxisTimeFormat).alignOuterLabels(true);\n};\n\naxisX.ordinal = function () {\n  return (\n    axisX()\n      // extend this class a little with a custom implementation of 'ticks'\n      // that allows you to set a custom number of ticks,\n      // including the first and last value in the ordinal scale\n      .prop(\"ticks\", setOrdinalTicks)\n      .tickFormat(formatText)\n  );\n};\n\n// need to be a little tricky to get the built-in d3.axis to display as if the underlying scale is discontinuous\naxisX.pyramid = function () {\n  return axisX()\n    .ticks(10)\n    .prop(\"scale\", function (s) {\n      const extended = s.copy(),\n        extendedDomain = extended.domain(),\n        extendedRange = extended.range();\n\n      extended\n        // the domain is mirrored - ±domain[1]\n        .domain([-extendedDomain[1], extendedDomain[1]])\n        // the range is mirrored – ±range[1]\n        .range([extendedRange[0] - extendedRange[1], extendedRange[0] + extendedRange[1]]);\n\n      this._scale(extended);\n      return extended;\n    })\n    .tickFormat((v) =>\n      // this tick format means that the axis appears to be divergent around 0\n      // when in fact it is -domain[1] -> +domain[1]\n      formatNumber(Math.abs(v))\n    );\n};\n\nexport const axisY = function () {\n  const newAxis = axis()\n    .ticks(6)\n    .tickSize(0, 0)\n    .tickPadding(0)\n    .tickFormat((d) => (0 === d && !newAxis.showZeroY() ? null : formatNumber(d)))\n    .vertical(true);\n  return newAxis;\n};\n\naxisY.time = function () {\n  return axisY().tickFormat(formatAxisTimeFormat);\n};\n\naxisY.ordinal = function () {\n  return (\n    axisY()\n      // add custom 'ticks' function\n      .prop(\"ticks\", setOrdinalTicks)\n      .tickFormat(formatText)\n  );\n};\n\n/* Helper functions\n----------------------------------------------- */\n\nfunction absDistance(a, b) {\n  return Math.abs(a - b);\n}\n\nfunction boundsOverlap(boundsA, boundsB) {\n  return !(\n    boundsB.left > boundsA.right ||\n    boundsB.right < boundsA.left ||\n    boundsB.top > boundsA.bottom ||\n    boundsB.bottom < boundsA.top\n  );\n}\n\nconst slantLabel = {\n  top: {\n    horizontal(selection) {\n      selection\n        .style(\"text-anchor\", \"middle\")\n        .attr(\"dx\", \"-0.5\")\n        .attr(\"dy\", \"0.71em\")\n        .attr(\"transform\", null);\n    },\n    vertical(selection) {\n      selection\n        .style(\"text-anchor\", \"start\")\n        .attr(\"dx\", \"0em\")\n        .attr(\"dy\", \"0.35em\") // vertically-center\n        .attr(\"transform\", \"rotate(-90)\");\n    },\n    diagonal(selection) {\n      selection\n        .style(\"text-anchor\", \"start\")\n        .attr(\"dx\", \"0.1em\")\n        .attr(\"dy\", \"0.1em\")\n        .attr(\"transform\", \"translate(-0.5) rotate(-45)\");\n    },\n  },\n  bottom: {\n    horizontal(selection) {\n      selection\n        .style(\"text-anchor\", \"middle\")\n        .attr(\"dx\", \"-0.5\")\n        .attr(\"dy\", \"0.71em\")\n        .attr(\"transform\", null);\n    },\n    vertical(selection) {\n      selection\n        .style(\"text-anchor\", \"end\")\n        .attr(\"dx\", \"-1em\")\n        .attr(\"dy\", \"-0.75em\")\n        .attr(\"transform\", \"rotate(-90)\");\n    },\n    diagonal(selection) {\n      selection\n        .style(\"text-anchor\", \"end\")\n        .attr(\"dx\", \"-0.8em\")\n        .attr(\"dy\", \"0em\")\n        .attr(\"transform\", \"rotate(-45)\");\n    },\n  },\n};\n"],"names":["TICK_PROXIMITY_THRESHOLD","TICK_END_THRESHOLD","LABEL_PROXIMITY_THRESHOLD","axis","component","prop","orient","alignOuterLabels","hideBorderTickThreshold","hideLabelThreshold","fn","showZeroY","vertical","yOffset","render","selection","select","props","isBottom","axisDelegate","axisBottom","axisTop","axisLeft","axisRight","undefined","Error","_scale","scale","group","selectGroup","classed","attr","translateString","call","axisScale","tickGroups","selectAll","tickTexts","each","subpixelShift","transformTranslateSubpixelShift","getAttribute","dx","halfPixel","dy","rangeExtent","range","d","pos","d3this","absDistance","tickLength","domainExtent","extent","domain","ticks","filter","orientation","longLinePadding","Math","max","getBoundingClientRect","width","lines","data","join","remove","alignmentBounds","min","style","value","textWrap","slant","slantLabel","highlightTick","activeBounds","passiveBounds","bcr","b","node","bounds","top","right","bottom","left","push","active","passive","boundsOverlap","title","text","axisScaleExtent","titleProps","titleCenter","titleVertical","dxTitle","dyTitle","titleAnchor","contour","logger","g","textNode","textContour","empty","cloneNode","insertBefore","textContent","setOrdinalTicks","count","values","step","round","length","i","l","tickValues","axisX","tickSizeInner","tickSizeOuter","tickPadding","tickFormat","formatNumber","time","formatAxisTimeFormat","ordinal","formatText","pyramid","s","extended","copy","extendedDomain","extendedRange","v","abs","axisY","newAxis","tickSize","a","boundsA","boundsB","horizontal","diagonal"],"mappings":"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"}