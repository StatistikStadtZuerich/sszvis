{"version":3,"file":"stackedAreaMultiples.js","sources":["../../src/component/stackedAreaMultiples.js"],"sourcesContent":["/**\n * Stacked Area Multiples component\n *\n * This component, like stackedArea, requires an array of layer objects, where each layer object is one of the multiples.\n * In addition to stackedArea, this chart's layers can be separated to provide two views on the data: a sum of all\n * elements as well as every element on its own.\n *\n * @module sszvis/component/stackedAreaMultiples\n *\n * @property {number, function} x             Accessor function for the *x*-values. Passed a data object and should return a value\n *                                            in screen pixels.\n * @property {number, function} y0            Accessor function for the *y0*-value (the baseline of the area). Passed a data object\n *                                            and should return a value in screen pixels.\n * @property {number, function} y1            Accessor function for the *y1*-value (the top line of the area). Passed a data object\n *                                            and should return a value in screen pixels.\n * @property {string, function} fill          Accessor function for the area fill. Passed a layer object.\n * @property {string, function} stroke        Accessor function for the area stroke. Passed a layer object.\n * @property {function} key                   Specify a key function for use in the data join. The value returned by the key should\n *                                            be unique among stacks. This option is particularly important when creating a chart\n *                                            which transitions between stacked and separated views.\n * @property {function} valuesAccessor        Specify an accessor for the values of the layer objects. The default treats the layer object\n *                                            as an array of values. Use this if your layer objects should be treated as something other than\n *                                            arrays of values.\n *\n * @return {sszvis.component}\n */\n\nimport { area, select } from \"d3\";\nimport { component } from \"../d3-component.js\";\nimport * as fn from \"../fn.js\";\nimport { defaultTransition } from \"../transition.js\";\n\nexport default function () {\n  return component()\n    .prop(\"x\")\n    .prop(\"y0\")\n    .prop(\"y1\")\n    .prop(\"fill\")\n    .prop(\"stroke\")\n    .prop(\"strokeWidth\")\n    .prop(\"defined\")\n    .prop(\"key\")\n    .key((d, i) => i)\n    .prop(\"valuesAccessor\")\n    .valuesAccessor(fn.identity)\n    .prop(\"transition\")\n    .transition(true)\n    .render(function (data) {\n      const selection = select(this);\n      const props = selection.props();\n\n      //sszsch why reverse?\n      data = [...data].reverse();\n\n      const defaultDefined = function () {\n        return fn.compose(fn.not(isNaN), props.y0) && fn.compose(fn.not(isNaN), props.y1);\n      };\n\n      const areaGen = area()\n        .defined(props.defined === undefined ? defaultDefined : props.defined)\n        .x(props.x)\n        .y0(props.y0)\n        .y1(props.y1);\n\n      const paths = selection\n        .selectAll(\"path.sszvis-path\")\n        .data(data, props.key)\n        .join(\"path\")\n        .classed(\"sszvis-path\", true);\n\n      if (props.transition) {\n        paths.transition(defaultTransition());\n      }\n\n      paths\n        .attr(\"d\", fn.compose(areaGen, props.valuesAccessor))\n        .attr(\"fill\", props.fill)\n        .attr(\"stroke\", props.stroke)\n        .attr(\"stroke-width\", props.strokeWidth === undefined ? 1 : props.strokeWidth);\n    });\n}\n"],"names":["component","prop","key","d","i","valuesAccessor","fn","transition","render","data","selection","select","props","reverse","defaultDefined","isNaN","y0","y1","areaGen","area","defined","undefined","x","paths","selectAll","join","classed","defaultTransition","attr","fill","stroke","strokeWidth"],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAOe,6BAAA,IAAY;AACzB,EAAA,OAAOA,SAAS,EAAE,CACfC,IAAI,CAAC,GAAG,CAAC,CACTA,IAAI,CAAC,IAAI,CAAC,CACVA,IAAI,CAAC,IAAI,CAAC,CACVA,IAAI,CAAC,MAAM,CAAC,CACZA,IAAI,CAAC,QAAQ,CAAC,CACdA,IAAI,CAAC,aAAa,CAAC,CACnBA,IAAI,CAAC,SAAS,CAAC,CACfA,IAAI,CAAC,KAAK,CAAC,CACXC,GAAG,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAAC,CAChBH,IAAI,CAAC,gBAAgB,CAAC,CACtBI,cAAc,CAACC,QAAW,CAAC,CAC3BL,IAAI,CAAC,YAAY,CAAC,CAClBM,UAAU,CAAC,IAAI,CAAC,CAChBC,MAAM,CAAC,UAAUC,IAAI,EAAE;AACtB,IAAA,MAAMC,SAAS,GAAGC,MAAM,CAAC,IAAI,CAAC;AAC9B,IAAA,MAAMC,KAAK,GAAGF,SAAS,CAACE,KAAK,EAAE;;AAE/B;IACAH,IAAI,GAAG,CAAC,GAAGA,IAAI,CAAC,CAACI,OAAO,EAAE;AAE1B,IAAA,MAAMC,cAAc,GAAG,YAAY;AACjC,MAAA,OAAOR,OAAU,CAACA,GAAM,CAACS,KAAK,CAAC,EAAEH,KAAK,CAACI,EAAE,CAAC,IAAIV,OAAU,CAACA,GAAM,CAACS,KAAK,CAAC,EAAEH,KAAK,CAACK,EAAE,CAAC;IACnF,CAAC;AAED,IAAA,MAAMC,OAAO,GAAGC,IAAI,EAAE,CACnBC,OAAO,CAACR,KAAK,CAACQ,OAAO,KAAKC,SAAS,GAAGP,cAAc,GAAGF,KAAK,CAACQ,OAAO,CAAC,CACrEE,CAAC,CAACV,KAAK,CAACU,CAAC,CAAC,CACVN,EAAE,CAACJ,KAAK,CAACI,EAAE,CAAC,CACZC,EAAE,CAACL,KAAK,CAACK,EAAE,CAAC;AAEf,IAAA,MAAMM,KAAK,GAAGb,SAAS,CACpBc,SAAS,CAAC,kBAAkB,CAAC,CAC7Bf,IAAI,CAACA,IAAI,EAAEG,KAAK,CAACV,GAAG,CAAC,CACrBuB,IAAI,CAAC,MAAM,CAAC,CACZC,OAAO,CAAC,aAAa,EAAE,IAAI,CAAC;IAE/B,IAAId,KAAK,CAACL,UAAU,EAAE;AACpBgB,MAAAA,KAAK,CAAChB,UAAU,CAACoB,iBAAiB,EAAE,CAAC;AACvC,IAAA;IAEAJ,KAAK,CACFK,IAAI,CAAC,GAAG,EAAEtB,OAAU,CAACY,OAAO,EAAEN,KAAK,CAACP,cAAc,CAAC,CAAC,CACpDuB,IAAI,CAAC,MAAM,EAAEhB,KAAK,CAACiB,IAAI,CAAC,CACxBD,IAAI,CAAC,QAAQ,EAAEhB,KAAK,CAACkB,MAAM,CAAC,CAC5BF,IAAI,CAAC,cAAc,EAAEhB,KAAK,CAACmB,WAAW,KAAKV,SAAS,GAAG,CAAC,GAAGT,KAAK,CAACmB,WAAW,CAAC;AAClF,EAAA,CAAC,CAAC;AACN;;;;"}